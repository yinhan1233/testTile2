(()=>{var e=Object.create,A=Object.defineProperty,t=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,s=Object.getPrototypeOf,n=Object.prototype.hasOwnProperty,r=(e,A)=>()=>(A||e((A={exports:{}}).exports,A),A.exports),o=(r,o,a)=>(a=null!=r?e(s(r)):{},((e,s,r,o)=>{if(s&&"object"==typeof s||"function"==typeof s)for(let a of i(s))!n.call(e,a)&&a!==r&&A(e,a,{get:()=>s[a],enumerable:!(o=t(s,a))||o.enumerable});return e})(!o&&r&&r.__esModule?a:A(a,"default",{value:r,enumerable:!0}),r)),a=r(((e,A)=>{A.exports={name:"spray-conch-compile",version:"2.1.10",description:"",private:!0,egg:{declarations:!0},dependencies:{"@babel/core":"^7.12.3","@babel/generator":"^7.18.2","@babel/parser":"^7.18.5","@babel/preset-env":"^7.12.1","@babel/traverse":"^7.18.2","@babel/types":"^7.18.4","@rollup/plugin-node-resolve":"^13.3.0","@rollup/plugin-strip":"^2.1.0","@vue/babel-helper-vue-jsx-merge-props":"^1.2.1","@vue/babel-preset-jsx":"^1.2.3","@vue/compiler-sfc":"^2.6.14",babylon:"^6.18.0","cross-env":"^7.0.2",egg:"^2.15.1","egg-axios":"^1.1.5","egg-cors":"^2.2.3","egg-logrotator":"^3.1.0","egg-scripts":"^2.11.0",esbuild:"^0.14.43",jscodeshift:"^0.13.1","patch-package":"^6.5.0",rimraf:"^3.0.2",rollup:"^2.32.1","rollup-plugin-babel":"^4.4.0","rollup-plugin-terser":"^7.0.2",sass:"^1.27.0",shelljs:"^0.8.4","string-to-file-stream":"^1.2.0"},devDependencies:{"@release-it/conventional-changelog":"^3.3.0",autod:"^3.0.1","autod-egg":"^1.1.0",compressing:"^1.5.1","egg-bin":"^4.11.0","egg-ci":"^1.11.0","egg-mock":"^3.21.0",eslint:"^5.13.0","eslint-config-egg":"^7.1.0","release-it":"^14.11.8",rimraf:"^3.0.2"},engines:{node:">=10.0.0"},scripts:{start:"cross-env EGG_SERVER_ENV=prod egg-scripts start --daemon --workers=4 --title=egg-server-spray-conch-compile","start-test":"cross-env EGG_SERVER_ENV=test egg-scripts start --daemon --workers=4 --title=egg-server-spray-conch-compile",stop:"egg-scripts stop --title=egg-server-spray-conch-compile",dev:"egg-bin dev EGG_SERVER_ENV=local",debug:"egg-bin debug",test:"npm run lint -- --fix && npm run test-local","test-local":"egg-bin test",cov:"egg-bin cov",lint:"eslint .",ci:"npm run lint && npm run cov",autod:"autod",build:"node ./script/build.js",restart:"npm run stop && npm run start","restart-test":"npm run stop && npm run start-test",release:"release-it --no-npm.publish",postinstall:"patch-package"},ci:{version:"10"},repository:{type:"git",url:"git@git.uino.com:hundun/nanshan-compile-preview.git"},author:"zhanglin@uinnova.com",license:"MIT",babel:{presets:["@vue/babel-preset-jsx"]}}})),l=r(((e,A)=>{var t=a(),i=[["rgb(255, 255, 204)","rgb(222, 252, 205)","rgb(189, 249, 206)","rgb(157, 246, 207)","rgb(124, 242, 208)","rgb(91, 239, 209)"],["rgb(52, 255, 245)","rgb(49, 224, 242)","rgb(45, 192, 238)","rgb(42, 161, 235)","rgb(39, 130, 231)","rgb(35, 98, 228)"],["rgb(255, 220, 132)","rgb(255, 196, 124)","rgb(254, 171, 117)","rgb(254, 147, 109)","rgb(254, 123, 101)","rgb(253, 98, 94)"],["rgb(109, 212, 0)","rgb(91, 218, 39)","rgb(73, 224, 78)","rgb(55, 230, 117)","rgb(36, 235, 156)","rgb(18, 241, 195)"],["rgb(215, 74, 255)","rgb(198, 78, 255)","rgb(181, 82, 255)","rgb(164, 86, 255)","rgb(146, 90, 255)","rgb(129, 94, 255)"],["rgb(68, 215, 182)","rgb(99, 198, 159)","rgb(130, 182, 137)","rgb(162, 165, 114)","rgb(193, 148, 91)","rgb(224, 132, 69)"],["rgb(255, 87, 56)","rgb(239, 141, 122)","rgb(223, 196, 189)","rgb(207, 250, 255)","rgb(138, 214, 255)","rgb(69, 178, 255)"],["rgb(120, 69, 255)","rgb(165, 121, 251)","rgb(210, 173, 247)","rgb(255, 225, 243)","rgb(255, 170, 197)","rgb(255, 116, 151)"],["rgb(255, 104, 61)","rgb(255, 144, 122)","rgb(255, 185, 182)","rgb(255, 225, 243)","rgb(170, 209, 219)","rgb(85, 192, 196)"],["rgb(91, 11, 255)","rgb(146, 82, 251)","rgb(200, 154, 247)","rgb(255, 225, 243)","rgb(255, 170, 237)","rgb(255, 116, 231)"],["rgb(255, 112, 76)","rgb(255, 150, 132)","rgb(255, 187, 187)","rgb(255, 225, 243)","rgb(255, 204, 162)","rgb(255, 182, 81)"],["rgb(77, 177, 86)","rgb(136, 193, 138)","rgb(196, 209, 191)","rgb(255, 225, 243)","rgb(190, 197, 247)","rgb(126, 170, 251)"]];A.exports={version:t.version,globalVar:{themeColor:i,scripts:{},async:!1,printLog:!0},themeColor:i}}));function c(e){let A=parseInt("none"===e.style.display?0:getComputedStyle(e).height);return Number.isNaN(A)?0:A}function h(e,A,t=!0){Object.getOwnPropertyNames(A).forEach((i=>{(!e[i]||e[i]&&t)&&(e[i]=A[i])}))}function u(e={}){if(e){if(!Array.isArray(e)){let{top:A=0,right:t=0,bottom:i=0,left:s=0}=e;e=[A,t,i,s]}return e.map((e=>m(e))).join(" ")}return 0}function d(e,A=""){if(!e)return;let t,i=A.split(".");for(;t=i.shift();){if(!e[t])return null;e=e[t]}return e}function p(e){if(!e||"object"!=typeof e)return e;let A=e instanceof Array?[]:{};for(let t in e)A[t]="object"==typeof e[t]?p(e[t]):e[t];return A}function g(e,A){return typeof e!=typeof A&&console.warn("组件数据类型发生更改可能存在错误"),e&&A&&!Array.isArray(e)&&!Array.isArray(A)&&"object"==typeof e&&"object"==typeof A?Object.assign(A,e):e}function B(e,A){!e||Object.entries(e).forEach(A)}var m=e=>`${e||0}px`,f=e=>"function"==typeof e,y=e=>null==e;function C({id:e="",instance:A={},error:t}){conch.__globalVar.printLog&&console.error(e+"图表执行错误:\n"+t),conch.errorHandler&&conch.errorHandler({id:e,...A},t)}var w=class{static init(){let{options:e}=this.__richConfig;if(e)if("string"==typeof e)try{e=new Function("return "+e)()}catch{throw e={},new Error("转换图表json出现错误")}else e=p(e);else e={};if(Array.isArray(e)?e={blueprint:{name:"蓝图节点",group:"UI-Chart",inputs:[{name:"显示",type:"exec"},{name:"隐藏",type:"exec"},{name:"数据",type:"any"}],outputs:[]},propertyPanel:e}:(!e.blueprint||Object.keys(e.blueprint).length<2)&&(e.blueprint={name:"蓝图节点",group:"UI-Chart",inputs:[{name:"显示",type:"exec"},{name:"隐藏",type:"exec"},{name:"数据",type:"any"}],outputs:[]}),Array.isArray(e.propertyPanel)&&e.propertyPanel.length>0){let A={};e.propertyPanel.forEach((e=>{let t=A;if(e.key){let A=e.key.split(".");A.shift();for(let i=0;i<A.length;i++)i<A.length-1?(t[A[i]]||(t[A[i]]={name:A[i],type:"group",children:{}}),t=t[A[i]].children):(e.default=e.value,delete e.value,delete e.key,t[A[i]]=e)}else func(e.children)})),e.propertyPanel=A}this._options=e}getBlueprintNode(e,A){let t=this;return class extends BaseNode{static config={...t._options.blueprint,name:e||t._options.blueprint.name,id:A};constructor(){super()}isEntrance(){return!0}onExecute(e,A,i){t.onExecute(e,A,i,this)}onStop(){t.onStop(this)}}}onExecute(e,A,t,i){switch(i.curExecName){case"显示":this.show();break;case"隐藏":this.hide()}A._updateData_&&this.setData(A._updateData_)}onStop(){}};function E(e){return[e.text,{...e.font,textAlign:e.site,fontSize:m(e.font.fontSize),lineHeight:e.lineHeight?m(e.lineHeight):null,padding:u(e.padding)}]}function b(e,A,t){e.innerHTML=A,t&&Object.assign(e.style,t)}var I=class{static init(){this.titleDom=document.createElement("div"),this.subTitleDom=document.createElement("div"),this.parentDom.appendChild(this.titleDom),Object.assign(this.titleDom.style,{flexShrink:0}),Object.assign(this.subTitleDom.style,{flexShrink:0}),this.parentDom.appendChild(this.subTitleDom)}__resizeParentHeight(){this.dom.style.height=`calc(100% - ${m(c(this.titleDom)+c(this.subTitleDom))})`}setTitle(e,A){b(this.titleDom,e,A)}setSubTitle(e,A){b(this.subTitleDom,e,A)}openTitle(){this.titleDom.style.display="block",this.resize()}closeTitle(){this.titleDom.style.display="none",this.resize()}openSubTitle(){this.subTitleDom.style.display="block",this.resize()}closeSubTitle(){this.subTitleDom.style.display="none",this.resize()}updateTitle(e){e&&(this.titleDom.style.display=e.show?"block":"none",this.setTitle(...E(e)))}updateSubTitle(e){e&&(this.subTitleDom.style.display=e.show?"block":"none",this.setSubTitle(...E(e)))}},U=o(l()),T=class{static init(){this.themes=U.themeColor,this.themeIndex=1}__setPadding(e){this.padding!==e&&(this.padding=e),Object.assign(this.parentDom.style,{padding:u(e)})}setPadding(e){this.__setPadding(e),this.resize()}setCompBG(e=""){Object.assign(this.parentDom.style,{background:e,backgroundRepeat:"no-repeat",backgroundSize:"100% 100%"})}setTheme(e){this.theme!==e&&(this.theme=e),this.render()}__updateTheme(e=this.theme){if(e)if(e.backgroundColor&&e.backgroundColor.show){let A=e.backgroundColor,{type:t,value:i}=A,s="";if("image"===t)A.url&&(s=`url(${A.url})`);else if(i)switch(t){case"flat":s=i;break;case"linearGradient":let{angle:e,stops:A}=i;s=`linear-gradient(${e}deg, ${A.map((e=>`${e.color} ${e.offset}%`)).join(",")})`;break;case"radialGradient":s=`radial-gradient(${i.stops.map((e=>`${e.color} ${e.offset}%`)).join(",")})`}this.setCompBG(s)}else this.setCompBG("")}__transform(){this.padding&&this.__setPadding(this.padding);let e=d(this.config||this.opts,"menu.title");if(e){let{title:A,subTitle:t}=e;this.updateTitle(A),this.updateSubTitle(t)}}},Q=class{constructor(e){this.identified=e,this.operations=[]}done(...e){this.operations=this.operations.concat(e.filter((e=>"function"==typeof e)))}async _run(...e){for(let A,t=0;A=this.operations[t];t++)await A(...e)}destroy(){this.identified=null,this.operations=null}},v=class{constructor(e){this.actions={},this.instance=e}wait(e){return this.actions[e]?this.actions[e]:this.actions[e]=new Q(e)}clearWait(){Object.values(this.actions).forEach((e=>e.destroy())),this.actions={}}trigger(e,...A){this.actions[e]&&this.actions[e]._run(...A)}},F=class{static init(){this._waiter=new v(this)}trigger(...e){return this._waiter.trigger(...e)}on(e,A){this._waitAction(e).done(A)}_waitAction(e){return this._waiter.wait(e)}_clearWaitAction(){this._waiter.clearWait()}},_=class{static init(){this._eventTypes={},this._eventBus={}}$on(e,A,t=this){return this.hasType(e)||(this._eventTypes[e]=e,this._eventBus[e]=[]),this._eventBus[e].push([A,t]),this}$once(e,A,t){let i=(...s)=>{this.$off(e,i),A.apply(t,s)};return i.fn=A,this.$on(e,i),this}$off(e,A,t){if(!e&&!A)return this.destroy(),this;if(!this.hasType(e))return this;if(!A)return this._eventBus[e]=[],this;let i=this._eventBus[e],s=i.length;for(;s>-1;){if(!i[s]){s--;continue}let[e,n]=i[s];(e===A||e.fn===A)&&(t?n===t&&i.splice(s,1):i.splice(s,1)),s--}return this}$emit(e,...A){if(!this.hasType(e))return this;let t=this._eventBus[e];if(t&&t.length){let e=[...t];for(let t of e){let[e,i]=t;e.apply(i,A)}}return this}$offAll(){this._eventTypes={},this._eventBus={}}hasType(e){return this._eventTypes[e]===e}},S=o(l()),L={script:([e,A],t)=>new Promise((i=>{let s=window.document.head.querySelector("#"+e);s?s.isLoading?i():s.addEventListener("load",(()=>{i()})):(s=document.createElement("script"),s.src=(t||"")+A,s.type="text/javascript",s.isLoading=!1,s.addEventListener("load",(()=>{s.isLoading=!0,i()})),s.addEventListener("error",(()=>{i()})),s.id=e,window.document.head.appendChild(s))})),css([e,A],t){let i=window.document.head.querySelector("#"+e+"css");i||(i=document.createElement("link"),i.href=(t||"")+A,i.rel="stylesheet",i.id=e+"css",window.document.head.appendChild(i))},font:(e,A)=>new Promise((async t=>{let i=Array.from(window.document.fonts.values());for(let t=0;t<e.length;t++){let{file:s,psName:n,descriptors:r,files:o}=e[t];if(i.some((e=>e.family===n)))return;if(o&&r){let e=o.map((e=>new window.FontFace(n,`url('${A}/cssfonts/${e}')`,r).load())),t=await Promise.any(e);window.document.fonts.add(t)}else{let e=new window.FontFace(n,`url('${A}/fonts/${s}')`);e.load().then((e=>{window.document.fonts.add(e)})).catch((e=>{console.log(e)})),await e.loaded}}t()})),style(e,A=""){let t=document.head.querySelector("#styles_comp_global_"+A);t||(t=document.createElement("style"),t.type="text/css",t.id="styles_comp_global_"+A,t.appendChild(document.createTextNode(e)),document.head.appendChild(t)),A||t.appendChild(document.createTextNode(e))}},$=class{async __initScript(){let{script:e}=this.__richConfig,A=this._config.prefix||"";if(!S.globalVar.async&&e){this.script=e,this._config&&this._config.script&&Object.entries(this._config.script).forEach((([e,A])=>{this.script[e]=A}));let t=Object.entries(this.script).filter((([e,A])=>"string"==typeof A)),i=t.shift();for(;i;)await L.script(i,A),i=t.shift()}}__initResource(){let{img:e,fonts:A,cssfonts:t,css:i,script:s}=this.__richConfig,n=this._config.prefix||"";A&&L.font(Object.values(A),n),t&&L.font(t,n),this.img={},this.fonts={},B(e,(([e,A])=>{this.img[e]=(n||"")+A})),B(A,(([e,A])=>{this.fonts[e]=A.file})),i&&Object.entries(this.css=i).filter((([e,A])=>"string"==typeof A)).forEach((e=>{L.css(e,n)})),this.script=s}},M=class{static init(){this.__LifeCycle={},f(this.setup)&&(this.__getDom=this.setup())}__callHook(e,A){return this.__LifeCycle[e]?this.__LifeCycle[e].reduce(((e,A)=>A(e)),A):A}};["create","mounted","update","dataChange","optsChange","destory"].forEach((e=>{[`onBefore${e=(e=>e.substring(0,1).toUpperCase()+e.substring(1))(e)}`,`onAfter${e}`].forEach((e=>{M.prototype[e]=function(A){f(A)&&(this.__LifeCycle[e]||(this.__LifeCycle[e]=[]),this.__LifeCycle[e].push(A))}}))}));var D=M,O=class{changeOptsToConfig(e=!0){if("complex"===this.type)return void this._componentInstances.forEach(((A,t)=>{A.changeOptsToConfig(e),this.updateConfig(A,t)}));if(!this.opts||!this._options.propertyPanel||"Array"!==Object.prototype.toString.call(this._options.propertyPanel).slice(8,-1))return;let A=t=>{if("group"===t.type)for(let e of t.children)A(e);else{if("string"!=typeof t.key||""===t.key)return;let A=t.key.split(".");A.length>=1&&A.shift();let i=this.opts,s=i,n="";for(n of A)if(s=i,i=i[n],void 0===i||isNaN(i)){i=void 0;break}(void 0!==i||!isNaN(i))&&(e?t.value=i:s[n]=t.value)}};for(let e of this._options.propertyPanel)A(e);e||this.setOption(this.opts)}changeConfigToOpts(){this.changeOptsToConfig(!1)}changeOptsToPropertyPanel(e){if("complex"===this.type)return void this._componentInstances.forEach(((e,A)=>{e.changeOptsToPropertyPanel(this.opts[A]),this.updateConfig(e,A)}));let A=this._options.propertyPanel||{},t=e||("echarts"===this.type?this.config:this.opts);function i(e,A,t){let s=A,n=t;"Object"===Object.prototype.toString.call(n[e]).slice(8,-1)?(n=n[e],s[e]&&s[e].children?s=s[e].children:s[e]&&s[e].default&&!s[e].children&&(s[e].default=n),Object.keys(n).forEach((e=>{i(e,s,n)}))):s[e]&&void 0!==s[e].default&&(s[e].default=n[e])}"Object"===Object.prototype.toString.call(t).slice(8,-1)?Object.keys(t).forEach((e=>{i(e,A,t)})):console.warn("opts需要是对象类型的数据")}changePropertyPanelToOpts(){if("complex"===this.type)return this._componentInstances.map(((e,A)=>{let t=e.changePropertyPanelToOpts();return this.updateConfig(e,A),t}));let e=this._options.propertyPanel||{},A="echarts"===this.type?this.config:this.opts;function t(e,A,i){let s=A,n=i;!s[e].default&&s[e].children&&n[e]?(n=n[e],s=s[e].children,Object.keys(s).forEach((e=>{t(e,s,n)}))):n.hasOwnProperty(e)&&(n[e]=s[e].default)}return Object.keys(e).forEach((i=>{t(i,e,A)})),this.setOption(A),A}changeProperty(e,A,t,i){this.setOption(t)}},N=o(l()),x={info:"background:#606060;color:#fff;",warn:"background:#E9A400;color:#fff;",error:"background:#EC3941;color:#fff;"};var H=new class{info(...e){this._recordLog("info",...e)}warn(...e){this._recordLog("warn",...e)}error(...e){this._recordLog("error",...e)}_recordLog(e,...A){var t;window.console[e](`%c [conch ${e}] %c ${function(){let e=new Date;return`${e.toLocaleDateString()} ${e.toLocaleTimeString()}`}()} `,...(t=e,[x[t],"background:#1375B2;color:#fff;"]),...A)}memory(){let{memory:e}=performance;if(e){let A=e=>e/1024/1024+"M",{jsHeapSizeLimit:t,totalJSHeapSize:i,usedJSHeapSize:s}=e;console.table({max:A(t),has:A(i),used:A(s)})}}},k=new _;_.init.call(k);var R,P,K=k,G=new WeakMap,V=class{static __richComp(e){let A=e.prototype,t=A.destroy;A.destroy=function(){this.__callHook("onBeforeDestory"),(f(t)?function(){this.__destroy(),t.call(this)}:this.__destroy).call(this),this.__callHook("onAfterDestory"),this._clearWaitAction(),this.$offAll()},A.render=A.__initRender;let i=A.setData;A.setData=function(e,...A){let t=this.__callHook("onBeforeDataChange",e);y(t)&&(e=t),i&&i.call(this,e,...A),this.__callHook("onAfterDataChange")};let s=A.setOption;A.setOption=function(e,...A){let t=this.__callHook("onBeforeOptsChange",e);y(t)&&(e=t),s&&s.call(this,e,...A),this.__callHook("onAfterOptsChange")}}static __use(e){!function(e,A){A.forEach((A=>{h(e.prototype,A.prototype)}))}(V,V.used=e)}constructor(e,A={}){for(A.prefix||(A.prefix="");!A.fromComplex&&e.hasChildNodes();)e.removeChild(e.firstChild);if(A.fromComplex&&A.select){let t=A.select[A._id];t&&(e.style.border=t)}this.log=H,this._config=A,this.root=K;let t=this._config.prefix;this._registerImg&&this._registerImg(t),this.parentDom=e,Object.assign(e.style,{transformOrigin:"0 0",display:"flex",flexDirection:"column"});let i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.boxSizing="border-box";let{key:s,width:n,height:r}=this.__richConfig;this.size={width:n,height:r},this._key=s,this.__setClassName(),Array.isArray(V.used)&&V.used.forEach((e=>e.init&&e.init.call(this))),this.__initResource(),e.appendChild(this.dom=i)}get instance(){return G.get(this)}set instance(e){e&&G.set(this,e)}show(){if(this.parent)return this.parent.show();this.parentDom.style.display="block"}hide(){if(this.parent)return this.parent.hidden();this.parentDom.style.display="none"}hidden(){return this.hide()}toJSON(){return{data:this.data,opts:"echarts"===this.type?this.config:this.opts,theme:this.theme,padding:this.padding,events:this.events}}__setClassName(){this.parentDom.classList.contains(this._key)||this.parentDom.classList.add(this._key)}async __initComp(){await Promise.resolve(),this.__callHook("onBeforeCreate"),N.globalVar.async?this.__initScript():await this.__initScript(),this.__initConfig(),this.__callHook("onAfterCreate"),this.created&&this.created(),this._isLoadingComp=!0,this.cb&&this.cb(),this.cb=null}__initConfig(){this._options&&(!this.data&&this._options.data&&(this.data=p(this._options.data)),!this.opts&&this._options.options&&(this.opts=p(this._options.options)));let{theme:e,padding:A,data:t,opts:i,events:s}=this._config.config||{};e&&(this.theme=e),A&&(this.padding=A),t&&(this.data=t),i&&("echarts"===this.type?this.config=i:this.opts=i)}__initRender(){return new Promise((e=>{let A=async()=>{try{this.__setClassName(),this.__updateTheme(),this.transformOptions&&this.transform(),this.__transform(),this.instance||this._instance?(this.__callHook("onBeforeUpdate"),this.__update(),this.__callHook("onAfterUpdate"),this.updated&&this.updated()):(this.__callHook("onBeforeMounted"),await this.__render(),this.__callHook("onAfterMounted"),this.mounted&&this.mounted())}catch(e){C({id:this._compId,instance:this,error:e})}finally{e()}};this._isLoadingComp?A():this.cb=A}))}},j=V;((e,t,i)=>{t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(j,"symbol"!=typeof(R="used")?R+"":R,P),j.__use([w,I,T,F,_,$,D,O]);var z=j;function Y(e,A){if(!1===e.enabled)return!0;switch(e.type){case"code":return function(e,A){return new Function("data",e)(A)}(e.filterCode,A);case"tree":return function(e,A){return J(e,(e=>J(e,(e=>function(e,A,t,i){let s=(e||{})[A];if(null==s||""===s)return!1;switch("eq"===t||"in"===t||"nin"===t?(s=s.toString(),i=i.toString()):(s*=1,i*=1),t){case"eq":return s===i;case"gt":return s>i;case"lt":return s<i;case"gte":return s>=i;case"lte":return s<=i;case"ne":return s!=i;case"in":return s.toString().includes(i.toString());case"nin":return!s.toString().includes(i.toString())}}(A,...e)))))}(e,A);default:return!0}}function J(e,A){let t=function(e){switch(e){case"OR":return Array.prototype.some;case"AND":return Array.prototype.every;default:return()=>!1}}(e.operator);return!e.expressions.length||t.call(e.expressions,A)}var W=class{constructor(e){this.instance=e||{},this.typeFnMapping={showOrHidden:this.__doShowOrHidden.bind(this),changeOptions:this.__doSetOptions.bind(this),callback:this.__doCallback.bind(this),secondFunction:this._doSecondFunction.bind(this),link:this.__doLink}}_registerType(e,A,t){if("function"!=typeof A)return;let i=t||this;this.typeFnMapping[e]=A.bind(i)}__run(e,A){for(let t,i=0;t=A[i];i++)e._waitAction(t.identified).done((async e=>{if(Y(t.condition,e)){this._beforeRun&&this._beforeRun({events:t,data:e});for(let A,i=0;A=t.actions[i];i++)await this.__runAction(A,e);this._afterRun&&this._afterRun({events:t,data:e})}}))}__runAction(e,A){let t=e.type;if(void 0!==t)return this.typeFnMapping[t]?this.typeFnMapping[t](e[t],A):void console.error(`事件动作${t}未注册`)}_query(e){return"function"!=typeof this.instance.query?null:Array.isArray(e)?e.map((e=>this.instance.query(e))):this.instance.query(e)}async __doShowOrHidden(e){let{showComps:A,hiddenComps:t,type:i}=e;return"group"===i&&(A=A.map((e=>e.split(","))).flat(),t=t.map((e=>e.split(","))).flat()),await Promise.all(t.map((async e=>{let A=this._query(e);A&&await A.hidden()}))),Promise.all(A.map((async e=>{let A=this._query(e);A&&await A.show()})))}__doSetOptions(e){let{comp:A,opts:t}=e,i=this._query(A);i&&i.setOption(t)}__doLink(e){!e.url||function(e){return!/(http|https):\/\/([\w.]+\/?)\S*/.test(e)}(e.url)||window.open(e.url)}__doCallback(){}_doSecondFunction(e){let{name:A,arg:t}=e;this.instance[A]&&this.instance[A](t)}},X=/\/s-static(\/[\w-]+)+\.(bmp|gif|ico|tif|png|jpg|jpeg|webp|svg|mp4|webm|mp3|wav)/gi,Z=({prefix:e,status:A})=>"component"===A?{js:`${e}/component-source`,def:`${e}/complex-group-def`}:{js:`${e}/component`,def:`${e}/complex-group-version-def`};function q(e,A){return e&&JSON.parse(JSON.stringify(e).replace(X,(e=>e.replace(/^(\/s-static)/,A))))}var ee=class extends z{constructor(e,A){super(e,A),this.__initComp()}async __initComp(){this.customEvent=new W(this),this.useResizeScale=!(e=>"boolean"==typeof e)(this.useResizeScale)||this.useResizeScale,this._componentInstances=[],this._options=[];let e=function(e,{prefix:A}){let t=d(e,"scene.option.style")||{},i=[],s=[],n=[],r=[],o=[],a=[],l=[],c=[],h=[],u=e.scene.children[0],p=u.children||[],g=e.userData,B=[...p];if(!1!==u.option.visible)for(;B.length;){let e=B.shift();if(e.children)!1!==e.option.visible&&B.push(...e.children);else if(!1!==e.option.visible&&"Container"===e.type){let t=g[e.option.id],u=t.name.substr(1);l.push(u),c.push(e.option.id),s.push(q(t.data,A)),n.push(q(t.opts,A)),r.push(q(t.theme,A)),a.push(t.padding),o.push(t.events);let d={title:e.option.name,id:u},p=e.option.style,B={width:p.width,height:p.height,top:p.top,left:p.left,backgroundColor:p.backgroundColor||"",rotate:p.rotate};i.push(B),p&&Object.assign(d,B),h.push(d)}}return{width:t.width||"",height:t.height||"",childStyle:i,datas:s,opts:n,component:l,container:c,simpleCompInfo:h,themes:r,paddings:a,events:o}}(await function(e,A){let t=e.indexOf("C")>-1?e.slice(1):e,i=Z(A).def;return new Promise((e=>{fetch(`${i}/${t}.def`).then((e=>e.json())).then((A=>{e(A)})).catch((e=>console.error("Request Failed",e)))}))}(this._compId,this._config),this._config);this.events=e.events||[],this.simpleCompInfo=e.simpleCompInfo,this.data=e.datas,this.opts=e.opts;let A=this.childStyle=e.childStyle,t=e.themes,i=e.paddings,s=e.container;(!this.size.width||!this.size.height)&&(this.size.width=e.width,this.size.height=e.height),this.parentDom.style.width=m(e.width),this.parentDom.style.height=m(e.height),this.dom.style.position="relative",this.resize();let n=Z(this._config).js,r="component"===this._config.status?"src":"";await Promise.all(e.component.map((e=>L.script([`C${e}`,`${n}/${e}${r}.js`])))),e.component.forEach(((e,n)=>{let r=`C${e}`,o=document.createElement("div"),a=document.createElement("div");if(o.appendChild(a),this.dom.appendChild(o),A[n]){let e=A[n];Object.assign(a.style,{width:m(e.width),height:m(e.height)}),Object.assign(o.style,{position:"absolute",top:m(e.top),left:m(e.left),width:m(e.width),height:m(e.height),transform:`rotate(${e.rotate||0}deg)`,backgroundColor:e.backgroundColor})}this._config.config={theme:t[n],padding:i[n],data:this.data[n],opts:this.opts[n],events:this.events[n]};try{let A=new window.conch[r](a,{fromComplex:!0,_id:e,_ctId:s[n],...this._config});A._getParent=()=>this,this._componentInstances.push(A),this._options.push(A._options)}catch(A){console.error(A),this.loadCompError({boundDom:o,graphDom:a,id:e,index:n})}})),this._config.config=null,await super.__initComp()}__render(){return Promise.all(this._componentInstances.map((async(e,A)=>{await e.render(),this.events[A]&&this.customEvent.__run(e,this.events[A])})))}__update(){this.eachInstance("__update")}__destroy(){this.eachInstance("destroy")}resize(){if(this.useResizeScale){let{width:e,height:A}=this.size,t=getComputedStyle(this.parentDom);this.parentDom.style.transform=`scale(${Math.min(parseInt(t.width)/e,parseInt(t.height)/A)})`,this.parentDom.style.width=m(e),this.parentDom.style.height=m(A)}}setData(e){this.eachInstance(((A,t)=>{let i=e[t];i&&A.setData(i)}))}setOption(e){this.eachInstance(((A,t)=>{let i=e[t];i&&A.setOption(i)}))}transform(){this.eachInstance("transform"),this.__transform()}__changeTitleDOM(e,A,t){super.__changeTitleDOM(e,A,t),this.__resizeParentHeight()}eachInstance(e){this._componentInstances.forEach(((A,t)=>{"string"==typeof e?this[e].call(A):e(A,t)}))}query(e){return e&&this._componentInstances.find((A=>A._config._id===e||A._config._ctId===e))}updateComponentStyle({width:e,height:A,backgroundColor:t,left:i,top:s,id:n,rotate:r}){let o=this.query(n);if(o){let n=o.dom.parentNode,a=n.parentNode;"number"==typeof e&&(n.style.width=a.style.width=m(e)),"number"==typeof A&&(n.style.height=a.style.height=m(A)),o.resize(),"number"==typeof r&&(a.style.transform=`rotate(${r}deg)`),"string"==typeof t&&(n.style.backgroundColor=t),"number"==typeof i&&(a.style.left=m(i)),"number"==typeof s&&(a.style.top=m(s))}}updateConfig(e,A){0===A&&(this._options=[]),this._options.push(e._options)}loadCompError(e){let{boundDom:A,graphDom:t,id:i,index:s}=e,n=this.childStyle[s];n&&(t.style.width=n.width,t.style.height=n.height,t.style.border="1px dashed red",A.style.position="absolute",A.style.top=n.top,A.style.left=n.left),t.innerHTML='<span style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); color: red">Error: 图表加载失败</span>'}},Ae=class extends z{constructor(e,A){super(e,A),this.__initComp()}__render(){this.instance=window.echarts.init(this.dom),this.__update()}__update(){this.instance.clear(),this.instance.setOption(this.opts)}__destroy(){this.instance&&window.echarts.dispose(this.instance)}resize(){this.instance&&this.instance.resize()}setOption(e){if(this.config&&"Object"===Object.prototype.toString.call(this.config).slice(8,-1))return this.config=e,void this.render();if(!this.instance)return;this.instance.setOption(e);let A={};Object.entries(this.instance._model._optionManager.mountOption()).forEach((([e,t])=>{if(null!=t){let i=JSON.stringify(t);if("{}"===i||"[]"===i)return;A[e]=t}})),this.opts=A}setData(e){if(this.config&&"object"==typeof this.config)return this.data=g(e,this.data),void this.render();if(e&&"object"==typeof e){let A=this.opts.series;if(Array.isArray(e)){if(0===e.length)return;let t;e[0].key&&e[0].value?(e=e.filter((e=>e.key&&e.value)),t=e=>A.find((A=>A.name===e))):t=(e,t)=>A[t],e.forEach((({key:e,value:A},i)=>{let s=t(e,i);s&&(s.data=A)}))}else Object.keys(e).forEach((t=>{let i=A.find((e=>e.name===t));i&&(i.data=e[t])}));this.data=g(e,this.data),this.render()}}transform(){this.opts=this.transformOptions()}},te=class extends z{static __richComp(e){let A=e.prototype;A.__getDom=A.render,super.__richComp(e)}constructor(e,A){window.conch.registerVue(A.Vue),super(e,A),this.__initComp()}__render(){let e=(e=>{if(!e)throw new Error("找不到 vue 环境");return e})(window.conch.Vue||window.Vue),A=performance.now(),t=this;this.instance=new e({el:this.dom,render:e=>{try{return this.catchRender(e,20,A)}catch(e){C({id:this._compId,instance:t,error:e})}}}),this.dom=this.instance.$el}catchRender(e,A,t){if(A<=0){let e="[conch error] 图表被重复渲染，请注意";throw console.error(e),new Error(e)}return performance.now()-t<20?A-=1:A=20,this.$createElement=e,this.__getDom(e,this.data,this.opts)}__update(){this.instance.$forceUpdate()}__destroy(){this.instance.$destroy()}resize(){this.useResizeScale&&(this.parentDom.style.width="100%",this.parentDom.style.height="100%")}setData(e,A){this.data=g(e,this.data),this.instance&&this.render()}setOption(e,A){this.opts=g(e,this.opts),this.instance&&this.render()}transform(){this.transformOptions()}__changeTitleDOM(e,A,t){super.__changeTitleDOM(e,A,t),this.__resizeParentHeight()}},ie={default:te,echarts:Ae,complex:ee},se=class extends z{static __richComp(e){let A=e.prototype;A.__getDom=A.render,A.render=A.__initRender;let t=A.destroy;A.destroy=function(){(f(t)?function(){this.__destroy(),t.call(this)}:this.__destroy).call(this)}}constructor(e,A={}){super(e,A),this.type=this.type||"default",window.conch.registerVue(this._config.Vue);let t=["setData","setOption"],i={};t=t.filter((e=>{let A="function"!=typeof this[e];return A&&(this[e]=function(A){i[e]=A}),A})),setTimeout((()=>{t.forEach((e=>{this[e]=null})),h(this,ie[this.type].prototype,!1),"complex"===this.type?ee.prototype.__initComp.call(this):this.__initComp(),Object.entries(i).forEach((([e,A])=>{this[e].call(this,A)}))}))}};function ne(e,A){if(!(this instanceof ne))return new ne(e,A);this.proto=e,this.target=A,this.methods=[],this.getters=[],this.setters=[],this.fluents=[]}ne.auto=function(e,A,t){for(var i=ne(e,t),s=Object.getOwnPropertyNames(A),n=0;n<s.length;n++){var r=s[n],o=Object.getOwnPropertyDescriptor(A,r);if(o.get&&i.getter(r),o.set&&i.setter(r),o.hasOwnProperty("value"))o.value instanceof Function?i.method(r):i.getter(r),o.writable&&i.setter(r)}},ne.prototype.method=function(e){var A=this.proto,t=this.target;return this.methods.push(e),A[e]=function(){return this[t][e].apply(this[t],arguments)},this},ne.prototype.access=function(e){return this.getter(e).setter(e)},ne.prototype.getter=function(e){var A=this.proto,t=this.target;return this.getters.push(e),A.__defineGetter__(e,(function(){return this[t][e]})),this},ne.prototype.setter=function(e){var A=this.proto,t=this.target;return this.setters.push(e),A.__defineSetter__(e,(function(A){return this[t][e]=A})),this},ne.prototype.fluent=function(e){var A=this.proto,t=this.target;return this.fluents.push(e),A[e]=function(A){return typeof A<"u"?(this[t][e]=A,this):this[t][e]},this};var re=ne,oe=["data","opts","config","parentDom","themes","themeIndex","type","useResizeScale","titleDom","subTitleDom","padding","theme","size","_config","_options","_isLoadingComp","_key","img","fonts","css","script","log"],ae=["setData","setOption","resize","render","$on","$once","$off","$emit","show","hide","transformOptions","getBlueprintNode","onExecute","onStop","query","updateComponentStyle","setTitle","openTitle","closeTitle","setSubTitle","openSubTitle","closeSubTitle","setCompBG","setPadding","setTheme","trigger"],le=new Set(["resize"]),ce=new Set(["dom","instance"]),he=new Set(["setData","setOption","setTheme"]),ue=class extends z{static __richComp(e){super.__richComp(e)}constructor(e,A){window.conch.registerVue(A.Vue),super(e,A),this.__initComp(),this.useResizeScale=!1,this.vmUseProtoMethods=new Set}__render(){let e=(e=>{if(!e)throw new Error("找不到 vue 环境");return e})(window.conch.Vue||window.Vue),A=this.__mergeVueInstData(),{data:t,mounted:i,...s}=this.vueInstConfig,n=this.__instanceKey,r="echarts"===this.type,o=this.__initChart.bind(this);this[n]=new e({el:this.dom,data:function(){return{...A}},mounted:this.__vueInstMounted(i,r&&o),...s});let a=this.render.bind(this);"echarts"===this.type?this[n].$watch("config",a):this[n].$watch("opts",a),this[n].$watch("theme",a),this[n].$watch("data",a),this[n].$watch("padding",a),this.dom=this[n].$el,this.__getMethodsFromProp(),this.render();let l=new re(this,n);for(let e in this[n])ce.has(e)||!he.has(e)&&!le.has(e)&&(f(this[n][e])?l.method(e):l.access(e))}__update(){let e=this.__instanceKey;this[e]?.$forceUpdate(),"echarts"===this.type&&this.__updateChart(this.opts),this.__transform()}__destroy(){let e=this.__instanceKey;this[e]?.$destroy()}resize(){let e="echarts"===this.type,A=!this.vmUseProtoMethods.has("resize");e?A?this._instance?.resize&&this._instance.resize():this.instance&&this.instance.resize():A?this.instance?.resize&&this.instance.resize():this.useResizeScale&&(this.parentDom.style.width="100%",this.parentDom.style.height="100%")}setData(e){let A=this.__instanceKey;this[A]?(this.data=g(e,this[A].data),this[A].data=this.data,this[A]&&this.render()):this.data=g(e,this.data)}setOption(e){let A=this.__instanceKey,t="echarts"===this.type;if(!this[A])return t?void(this.config=opts):void(this.opts=e);t?this.config&&"Object"===Object.prototype.toString.call(this.config).slice(8,-1)&&(this.config={...this[A].config,...e},this[A].config=this.config):(this.opts={...this[A].opts,...e},this[A].opts=this.opts),this[A]&&this.render()}setTheme(e){let A=this.__instanceKey;this[A]?(this.theme={...this[A].theme,...e},this[A].theme=this.theme,this.render()):this.theme=e}transform(){this.opts=this.transformOptions()}__changeTitleDOM(e,A,t){super.__changeTitleDOM(e,A,t),this.__resizeParentHeight()}__mergeVueInstData(){let e=oe,A={};for(let t in this){let i=f(this[t]);e.includes(t)&&!i&&(A[t]=this[t])}let{data:t}=this.vueInstConfig,i=f(t)?t():t,s={...i,...A,type:i?.type||"vueSFC"};Object.assign(this,s);let n="echarts"===s.type;return this.__instanceKey=(n?"_":"")+"instance",s}__initChart(e,A){if(1!==e.nodeType)throw new Error("echart 初始化缺少 element 节点");return this.opts=A,this.instance=window.echarts.init(e),this.__updateChart(A),this.instance}__updateChart(e){this.instance&&(this.instance.clear(),this.instance.setOption(e))}__vueInstMounted(e,A){let t=this.parent;return function(){if(A){let e;if(!this.transformOptions)throw new Error("echarts类组件需实现transformOptions方法");e=this.transformOptions(),this.instance||(this.instance=A(this.$refs.echarts||this.$el,e))}else this.instance=this;this.dom=this.$el,this.parent=t,e&&e.call(this)}}__getMethodsFromProp(){let e=this.__instanceKey;for(let A of ae)if(f(this[A]))if(y(this[e][A]))this[e][A]=this[A].bind(this),this.vmUseProtoMethods.add(A);else{if(he.has(A)){let t=this[e][A],i=function(...e){t.apply(this,e)};this[e][A]=i.bind(this[e])}le.has(A)||(this[A]=this[e][A].bind(this[e]))}}},de={Default:te,Complex:ee,Echarts:Ae,OldBase:se,VueSFC:ue},pe=o(l());console.log("compile version is "+pe.version),window.conch={version:pe.version,Vue:null,__globalVar:pe.globalVar,Base:de.OldBase,CustomEvent:W,...de,createCss:L.style,$on:K.$on.bind(K),$emit:K.$emit.bind(K),$off:K.$off.bind(K),install(e){this.Vue=e},register(e,A,t,i,s="default",n="1"){1===function(e,A){if("1.0.0"===e||"2"===e)return!0;let t=e.split("."),i=A.split("."),s=t.length,n=i.length,r=Math.min(s,n),o=0;for(;o<r;o++){let e=parseInt(t[o]),A=parseInt(i[o]);if(e>A)return 1;if(e<A)return-1}if(s>n){for(let e=o;e<s;e++)if(0!=parseInt(t[e]))return 1;return 0}if(s<n){for(let e=o;e<n;e++)if(0!=parseInt(i[e]))return-1;return 0}return 0}(n,pe.version)&&console.error(`当前组件${e}版本高于运行版本，需要升级组件运行环境`),i&&this.registerVue(i),t.script&&(this.__globalVar.scripts=Object.assign(this.__globalVar.scripts,t.script)),A.prototype.version=n,A.prototype.__richConfig=t,A.prototype._compId=e,A.__richComp(A,e,t),this[e]=A},registerVue(e){e&&(!this.Vue&&(this.Vue=e),!window.Vue&&(window.Vue=e))},async loadAllScript(){this.__globalVar.async=!0;let e=Object.entries(this.__globalVar.scripts).filter((([e,A])=>"string"==typeof A));await Promise.all(e.map((e=>L.script(e,prefix))))}}})(),function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function addEventListener(e,A,t,i,s){const{elements:n}=e.$events,r=t.bind(s);return n[A]?n[A].push({fn:t,_fn:r,context:s}):n[A]=[{fn:t,_fn:r,context:s}],e.$el.addEventListener(A,r,i),e}function removeEventListener(e,A,t,i,s){const{elements:n}=e.$events,r=n[A];if(r){const n=r.findIndex((e=>e.fn===t&&e.context===s));if(-1!==n){const t=r[n];r.splice(n,1),e.$el.removeEventListener(A,t._fn,i)}}return e}function on(e,A,t,i){const{events:s}=e.$events;return s[A]||(s[A]=[]),s[A].push({fn:t,context:i}),e}function once(e,A,t,i){return on(e,A,(function s(){off(e,A,s),t.apply(i||e,arguments)}),i)}function off(e,A,t,i){const{events:s}=e.$events,n=s[A];if(t){if(n){let e=n.length;for(;e--;){const A=n[e];if(A.fn===t&&A.context===i){n.splice(e,1);break}}}}else s[A]=null;return e}function emit(e,A,t){return[...e.$events.events[A]||[]].forEach((e=>{emitHandler(e.fn,e.context,t)})),e}function emitHandler(e,A,t){try{e.apply(A,t)}catch(e){console.error(e)}}async function syncEmit(e,A,t){const i=e.$events.events[A];if(i)for(let e=0,A=i.length;e<A;e++){const A=i[e];await syncEmitHandler(A.fn,A.context,t)}return this}async function syncEmitHandler(e,A,t){try{await e.apply(A,t)}catch(e){console.error(e)}}function getNextValidComp(e,A){const t=e.$next;return t?A.includes(t)?getNextValidComp(t,A):t:null}function arraySort(e,A){return[...e].sort(A)}async function groupInit(e,A=[],t={},i={}){const s=arraySort(A,((e,A)=>e.$ranking-A.$ranking)),n=s.map((e=>e.toJSON())),r={type:"Group",option:t,children:n},o=getNextValidComp(s.reduce(((e,A)=>e?e.$ranking>A.$ranking?A:e:A),null),s);return await e.init(A[0].$parent,r,{nextComp:o}),i.select&&e.select(!0),e}function getNodeOnlyAttr(e,A){let t=0;return function e(i){const s=""+i+t++;return document.querySelector(`[${s}=${A}]`)?e(s):s}(e)}function isNumber$1(e){return e===+e}function getAdapterType(e,A){switch(A?.thingType){case"Campus":return"CampusAdapter";case"LowCode":return"LowCodeAdapter";case"Map":return"MapAdapter";case"Topology":return"TopologyAdapter";default:return e.type}}function mergeDataFields(e,A){if(!A)return null;const t={};return e&&e.forEach((e=>{t[e.name]=e})),A.map((e=>{const A=t[e.name]||e;return{...e,value:A.value||A.name}}))}const deepClone$1=e=>{if(!e||"object"!=typeof e)return e;const A=e instanceof Array?[]:{};for(const t in e)A[t]=deepClone$1(e[t]);return A},isEmpty$1=e=>null==e,loadImg$1=e=>new Promise(((A,t)=>{const i=new Image;i.onload=e=>{A(e)},i.onerror=e=>{t(e)},i.src=e})),_toString=e=>Object.prototype.toString.call(e),isType$3=(e,A)=>Object.prototype.toString.call(e).includes(A),parseData$1=e=>{try{return JSON.parse(e)}catch(e){return console.error(e),{}}};function getUid(){const e=Math.random().toString(16);return e.substring(e.length-6)}class RestDataManager{constructor(e,A={}){this.parent=e,this.root=e.root,this.config=A,this.url=null,this.ws=null,this.waitQueueList=null,this.requestQueue=null,this.requestQueueMax=null,this.timer=null,this.pingTimer=null,this.reconnectTimer=null,this.reconnectTime=null,this.status=null}init(){return this.config.disable?console.warn("接数功能已关闭，无法使用"):(this.status=!0,this.requestQueue={},this.waitQueueList=[],this.url=this.config.websocketUrl,this.requestQueueMax=+this.config.restApiMaxQueue,this.reconnectTime=10,this.url?(this._initWs(),void this._initTime()):console.error("没有地址"))}_initWs(){const e=this.ws=new WebSocket(this.url);e.onopen=()=>{console.log("数据服务连接成功"),this._startPing(),this.reconnectTime=10,this.sendWaitQueue()},e.onmessage=e=>{if(this.root.$emit("getRestData",e.data),e.data+""=="423")return void this.root.$emit("license-invalid");if("ping"===e.data||"连接成功"===e.data)return;const A=parseData$1(e.data);if("object"==typeof A)for(const e in A)this._dataHandler(e,A[e])},e.onclose=A=>{this._wsExtract(A,e)},e.onerror=A=>{this._wsExtract(A,e)}}_wsExtract(e,A){console.error("链接接数中断",e),A.close(),this.clearQueue(),this._closePing(),this._reconnect()}_closeWs(){this._closeReconnect(),this._closePing(),this._closeTime(),this.ws&&(this.ws.close(),this.ws=null)}_reconnect(){this._closeReconnect(),console.log(`${this.reconnectTime}秒后重新链接接数功能`),this.reconnectTimer=setTimeout((()=>{this.reconnectTime+=10,this._closeWs(),this._initWs()}),1e3*this.reconnectTime)}_closeReconnect(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null)}_startPing(){this._closePing(),this.pingTimer=setInterval((()=>{this.ws.readyState===WebSocket.OPEN&&this.ws.send("ping")}),3e4)}_closePing(){this.pingTimer&&clearInterval(this.pingTimer),this.pingTimer=null}_initTime(){this._closeTime();const e=()=>{const e=Date.now(),A=this.requestQueue;for(const t in A){const i=A[t];e-i.time>i.timeout&&this._dataHandler(i.data[0].id,{type:"error",message:"链接已超时！"})}};this.timer=window.setInterval((()=>{e()}),1e3)}_closeTime(){this.timer&&(window.clearInterval(this.timer),this.timer=null)}_dataHandler(e,A){this.requestQueue[e]?.handler(A),delete this.requestQueue[e],this.sendWaitQueue()}send(e){this.root.$emit("setRestData",e.data),this.ws.send(JSON.stringify(e.data)),e.time=Date.now()}sendWaitQueue(){if(this.ws.readyState!==WebSocket.OPEN)return;let e=this.requestQueueMax-Object.values(this.requestQueue).length;e>this.waitQueueList.length&&(e=this.waitQueueList.length);let A=0;for(;A<e;){const e=this.waitQueueList.shift();this.requestQueue[e.data[0].id]=e,this.send(e),A++}}addQueue(e){this.waitQueueList.push(e),this.sendWaitQueue()}clearQueue(){const e=this.requestQueue||{};for(const A in e){e[A].handler({type:"error",message:"主动退出请求"})}this.requestQueue={}}clearWaitQueue(){(this.waitQueueList||[]).forEach((e=>e.handler({type:"error",message:"主动退出请求"}))),this.waitQueueList=[]}removeQueueById(e){const A=this.waitQueueList.findIndex((A=>A.id===e));~A&&this.waitQueueList.splice(A,1);const t=Object.entries(this.requestQueue).find((A=>A.id===e));t&&(t.handler({type:"error",message:"主动退出请求"}),delete this.requestQueue[t.data[0].id],this.sendWaitQueue())}getQueueByDataId(e){return this.waitQueueList.find((A=>A.data[0].id===e))}_getId(e){let A=`${e}-${getUid()}`;return this.getQueueByDataId(A)&&(A=this._getId()),A}getData(e,A,t){return new Promise((i=>{function s(e,A){return i({status:e,data:A})}if(!this.status||this.config.disable)return s(200,{type:"error",message:"接数功能已关闭，无法使用"});const n=e.parent.$parent.id;this.removeQueueById(n);const{header:r,body:o,level:a,method:l,url:c}=A;if(!c)return s(200,{type:"error",message:"url无效"});const h={id:n,dataItem:e,data:[{id:this._getId(e.parent.$parent.id),type:"rest",config:{header:r,level:a,body:o,method:l,url:c}}],time:null,timeout:+this.config.restApiTimeout,handler:e=>s(200,e),errorHandler:e=>s(0,e)};this.addQueue(h),t&&t((()=>{h.errorHandler({type:"error",message:"主动退出请求"})}))}))}clear(){this.clearQueue(),this.clearWaitQueue()}destroy(){this.status=!1,this.clear(),this._closeWs(),this.url=null,this.waitQueueList=null,this.requestQueue=null,this.requestQueueMax=null,this.reconnectTime=null}}let Filter$1=class{constructor(e,A={}){this.parent=e,this.root=e.root,this.dataManager=e.parent,this.options=deepClone$1(A),this.list=[],this.name=A.name,this.code=A.code,this.callbackArgs=deepClone$1(A.callbackArgs)}addUse(e){this.list.find((A=>A===e))||this.list.push(e)}removeUse(e){const A=this.list.findIndex((A=>A===e));if(~A){this.list.splice(A,1)[0].remove(this.name)}}updateName(e){this.name=e}updateData(e,A){this.code=e,this.callbackArgs=A,this.list.forEach((e=>{e.parent.refresh()}))}execute(e){return this.parent.execute(this,e)}get(){const{options:e,name:A,list:t}=this;return{options:deepClone$1(e),name:A,useCount:t.length}}clear(){[...this.list].forEach((e=>e.remove(this))),this.list=[]}destroy(){this.clear(),this.name=null,this.code=null,this.callbackArgs=null,this.list=null,this.options=null,this.dataManager=null,this.root=null,this.parent=null}};class FilterManager{constructor(e){this.parent=e,this.root=e.root,this.filterList=null,this.options=null}init(){this.filterList=[],this.options=null}addFilterList(e={}){this.options=e;const A=e.dataFilters||[];this.filterList=A.map((e=>new Filter$1(this,e))),this.filterList.forEach((e=>{this.root._update("data:filterAdd",e,null)}))}add(e={},A=null){let t=this.getFilterByName(e.name);return t||(t=new Filter$1(this,e),isNumber$1(A)?this.filterList.splice(A,0,t):this.filterList.push(t),this.root._update("data:filterAdd",t,null)),t}getFilterByName(e){return this.filterList.find((A=>A.name===e))}getFilterIndex(e){return this.filterList.findIndex((A=>A===e))}toJSON(){return this.filterList.map((e=>({name:e.name,code:e.code,callbackArgs:deepClone$1(e.callbackArgs)})))}updateName(e,A){return!(!e||!A||this.getFilterByName(A))&&(e.updateName(A),!0)}updateData(e,A,t=[]){return e.updateData(A,t),this}execute(e,A){const t={};let i;e.callbackArgs.forEach((e=>{t[e]=this.parent.filterArgs[e]}));try{i=new Function("data","callbackArgs",e.code)(deepClone$1(A),t)}catch(e){i=e.message}return i}test(e,A){return this.execute(e,A)}remove(e){e.destroy();const A=this.filterList.findIndex((A=>A===e));if(~A)return this.filterList.splice(A,1),this.root._update("data:filterRemove",null,{name:e.name,code:e.code,callbackArgs:deepClone$1(e.callbackArgs)}),e}clear(){[...this.filterList].forEach((e=>{e.destroy()})),this.filterList=[]}destroy(){this.clear(),this.options=null,this.filterList=null,this.root=null,this.parent=null}}class TimerManager{constructor(e){this.parent=e,this.dataList=null,this.timer=null,this.started=null}init(){this.dataList=[],this.stop()}_initTime(){this._destroyTime(),this.timer=window.setInterval((()=>{if(!this.started)return;this._getExpireData().forEach((e=>e.run().updateNow()))}),1e3)}_destroyTime(){this.timer&&(window.clearInterval(this.timer),this.timer=null)}start(){this.started=!0,this._initTime()}stop(){this.started=!1,this._destroyTime()}_getExpireData(){return this.dataList.filter((e=>e.getRefreshable()))}add(e){this.dataList.find((A=>A===e))||this.dataList.push(e)}remove(e){const A=this.dataList.findIndex((A=>A===e));~A&&this.dataList.splice(A,1)}clear(){const e=[...this.dataList];for(const A of e)A.destroy();this.dataList=[]}destroy(){this.clear(),this._destroyTime(),this.dataList=null,this.timer=null,this.started=null}}class DataManager{constructor(e,A={}){this.parent=e,this.root=e,this.config=A,this.timeManager=new TimerManager(this),this.restDataManager=new RestDataManager(this,A),this.filterManager=new FilterManager(this),this.started=null,this.dataList=null,this.filterArgs=null,this.root.$on("beforeCreate:Canvas",this.beforeCreateCanvas,this)}init(){return this.dataList=[],this.timeManager.init(),this.filterManager.init(),this.restDataManager.init(),this.filterArgs={},this}beforeCreateCanvas(e){return this.filterManager.addFilterList({dataFilters:deepClone$1(e.$options.kpOption?.dataFilters||[])}),this}_add(e){return this.dataList.find((A=>A===e))?console.warn("数据节点已经添加过了"):this.dataList.push(e),this}start(){if(this.started)console.warn("已经开始了");else{this.started=!0;const e=[];this.dataList.forEach((A=>{A.subscriber.subscriberList.length?e.push(A):A.start()})),e.forEach((e=>e.start())),this.timeManager.start()}return this}stop(){return this.started&&(this.started=!1,this.timeManager.stop()),this}remove(e){const A=this.dataList.findIndex((A=>A===e));return~A?this.dataList.splice(A,1):console.warn("没有数据节点需要删除"),this}clear(){return[...this.dataList].forEach((e=>e.destroy())),this.dataList=[],this.filterManager.clear(),this.timeManager.clear(),this.restDataManager.clear(),this.filterArgs={},this}toJSON(){const{dataList:e}=this,A={};for(const t in e){const i=e[t];A[t]=i.toJSON()}return A.global=this.filterManager.toJSON(),A}destroy(){return this.root.$off("beforeCreate:Canvas",this.beforeCreateCanvas,this),this.clear(),this.timeManager=null,this.restDataManager=null,this.filterManager=null,this.config=null,this.dataList=null,this.started=null,this.filterArgs=null,this}}class Mutual{constructor(e){this.ui=e,this.dataManager=e.$dataManager,this.conchEvent=null,this.callbackFields=null,this.init()}init(){this.callbackFields={},this.initConchCustomEvent(),this.ui.$options.isEdit||(this.ui.$on("mounted:Container",this.mountedContainer,this),this.ui.$on("mounted:Canvas",this.mountedCanvas,this),this.ui.$on("adapterCompleted",this.adapterCompleted,this))}initConchCustomEvent(){const e=this;class A extends window.conch.CustomEvent{_query(A){return e.getUiComp(A)}__doSetOptions(A){const{comp:t,opts:i}=A,s=e.getUiComp(t);s&&s.app.setOption(deepClone$1(i))}_afterRun(A){const{events:t,data:i}=A,s=t.actions.filter((e=>"callback"===e.type)).map((e=>{const{callback:A}=e;return{param:(i||{})[A.value],key:A.callback}}));e._doCallback(s)}}const t=this.conchEvent=new A;t._registerType("blueprintEvent",(e=>{this._doBlueprintEvent(e)})),t._registerType("thingJsCamera",(e=>{this._doThingJsCamera(e)})),t._registerType("secondFunction",((e,A)=>{this._doSecondFunction(e,A)}))}initFilterCallback(){this.dataManager.filterManager.filterList.forEach((e=>{e.callbackArgs.forEach((A=>{e.list.forEach((t=>{t.enabled&&t.filterList.find((A=>A.filter===e&&A.enabled))&&this._addCallbackFields(A,t.parent.parent)}))}))}))}_addCallbackFields(e,A){this.callbackFields[e]||(this.callbackFields[e]=[]),this.callbackFields[e].includes(A)||this.callbackFields[e].push(A)}mountedContainer(e){if("ConchAdapter"===e.adapter?.type){const A=e.adapter.events;this.conchEvent.__run(e.$uiApp,deepClone$1(A))}}mountedCanvas(){this.initFilterCallback()}adapterCompleted(e){const A=e.$data.dataSource;"restData"===A.dataType&&A.typeMap[A.dataType].options.callbackArgs?.forEach((A=>{this._addCallbackFields(A,e)}))}_getUiComp(e){return this.ui.$ui.query("#"+e)}getUiComp(e){let A;const t=[];if(Array.isArray(e))A=[],e.forEach((e=>{const i=this._getUiComp(e);i?A.push(i):t.push(e)}));else{const i=this._getUiComp(e);i?A=i:t.push(e)}return t.length&&console.error("画布中没有找到图表，编号为",t.join()),A}_doCallback(e){let A=[];for(const t of e){const{param:e,key:i}=t;this.dataManager.filterArgs[i]=e,A.push(...this.callbackFields[i]||[])}A=A.filter(((e,t)=>A.indexOf(e)===t)),A.forEach((e=>{e.$data.refresh()}))}_doBlueprintEvent(e){const A=this.ui.$bluePrint.blueprint,{name:t,arg:i}=e;A&&t&&A.triggerEvent(t,i)}_doThingJsCamera(e){const{uuid:A,position:t,target:i}=e,s=this.ui.$queryById(e.compId);s?.adapter&&(A?s.adapter.fly(A,t,i):s.adapter.earthFly(t,i))}_doSecondFunction(e,A){const{name:t,arg:i}=e,s=this.ui.$jsCode.kunpengApi;if(s[t])try{s[t](i,A)}catch(e){console.warn(` ${t} 这个代码二开的方法执行失败`,e)}else console.warn(`没有找到 ${t} 这个代码二开的方法`)}destroy(){this.ui.$off("mounted:Container",this.mountedContainer,this),this.ui.$off("mounted:Canvas",this.mountedCanvas,this),this.ui.$off("adapterCompleted",this.adapterCompleted,this),this.callbackFields=null,this.conchEvent=null,this.dataManager=null,this.ui=null}}const currentKpVersion=1;function transform$2(e,A={}){let t=deepClone$1(A);const i=A.kpVersion||0;if(i>currentKpVersion&&console.warn(`您使用的${i}版本的大屏文件高于当前版本${currentKpVersion}；如果遇到功能丢失或者渲染异常，请联系管理员升级。`),!Reflect.has(t,"version")&&"Canvas"===t.type)try{t=e.sprayToUI(t)}catch(e){console.warn("定义文件转换失败")}return t.kpVersion&&1!==t.kpVersion||(t=transformSceneDefTo1(t)),t}function transformSceneDefTo1(e){const A=deepClone$1(e),t={};return function e(A){const{option:i,children:s}=A;t[i.id]=A,s&&s.forEach((A=>{e(A)}))}(A.scene),transform1AnimationNullData(A,t),transform1DefaultContainer(A,t),transform1Events(A),transform1UserData(A),transform1KpUserData(A),A}function transform1AnimationNullData(e,A){Object.values(A).forEach((e=>{const A=e.option.animation;A&&(A.enter&&null===A.enter[0]&&delete A.enter,A.leave&&null===A.leave[0]&&delete A.leave)}))}function transform1DefaultContainer(e,A){Object.entries(e.kpUserData).filter((e=>e[1].adapter?.thingType)).forEach((([e])=>{A[e]&&(A[e].type="DefaultContainer")}))}function transform1Events(e){Object.entries(e.userData).forEach((([A,t])=>{t.events||(e.kpUserData[A]?.adapter?.events?t.events=e.kpUserData[A]?.adapter?.events:t.events=[]),t.events.forEach((e=>{e&&e.actions&&(e.actions=e.actions.map(transformEventAction))}))}))}function transform1UserData(e){Object.entries(e.userData).forEach((([A,t])=>{transform1UserDataItem(t,e.kpUserData[A]?.adapter)}))}function transform1UserDataItem(e,A){if(Reflect.has(e,"data")){const A=e.data;A?.source&&A.dataType&&Reflect.has(A,"close")&&Reflect.has(A,"time")&&Reflect.has(A.source,"staticData")&&(e.data=A.source.staticData)}else A?.data?.source&&(e.data=A.data.source.staticData);!Reflect.has(e,"opts")&&Reflect.has(A,"opts")&&(e.opts=A.opts),!Reflect.has(e,"events")&&Reflect.has(A,"events")&&(e.events=A.events),!Reflect.has(e,"padding")&&Reflect.has(A,"padding")&&(e.padding=A.padding),!Reflect.has(e,"theme")&&Reflect.has(A,"theme")&&(e.theme=A.theme)}function transform1KpUserData(e){Object.entries(e.kpUserData).forEach((([e,A])=>{A.adapter&&!Reflect.has(A.adapter,"kpData")&&A.adapter.data&&Reflect.has(A.adapter.data,"source")&&Reflect.has(A.adapter.data.source,"staticData")&&Reflect.has(A.adapter.data,"dataType")&&Reflect.has(A.adapter.data,"close")&&Reflect.has(A.adapter.data,"time")&&(A.adapter.kpData=A.adapter.data)}))}function transformEventAction(e){const{type:A,name:t}=e;if("chart"===A||"layer"===A){const t=e[A];return t?"show"===t.action?{type:"showOrHidden",showOrHidden:{type:e.type,showComps:t.comps,hiddenComps:[]}}:"hidden"===t.action?{type:"showOrHidden",showOrHidden:{type:e.type,showComps:[],hiddenComps:t.comps}}:"changeOptions"===t.action?{type:"changeOptions",changeOptions:{comp:t.comps[0],opts:t.options}}:{}:{}}return{name:t,type:A,[A]:e[A]}}function transformKpOptionDef(e){const A=deepClone$1(e),t=A.kpUserData,i=A.userData;return function e(A){const{option:s,children:n}=A;s.adapter&&(s.adapter=i[s.id]),A.kpOption=t[s.id],n&&n.forEach((A=>{e(A)}))}(A.scene),A}class JsCode{constructor(e){this.ui=e,this.kunpengApi={}}run(e){if(e&&e.trim())try{new Function("ui",`${e}`).bind(this.kunpengApi)(this.ui.$ui)}catch(e){console.error("代码二开执行错误",e)}}}const icon$3="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjE0cHgiIGhlaWdodD0iMTVweCIgdmlld0JveD0iMCAwIDE0IDE1IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPg0KICAgIDx0aXRsZT7liIfniYc8L3RpdGxlPg0KICAgIDxnIGlkPSLmlbDmja4v5Lqk5LqS6Z2i5p2/77yIMzMwLea3se+8iSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+DQogICAgICAgIDxnIGlkPSLok53lm77oioLngrkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC04MDIuMDAwMDAwLCAtNjIuMDAwMDAwKSI+DQogICAgICAgICAgICA8ZyBpZD0i57yW57uELTPlpIfku70tMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzkyLjAwMDAwMCwgNTcuNTAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi4wMDAwMDAsIDAuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgICAgIDxnIGlkPSJpY29uX+iTneWbvuiEmuacrCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOC4wMDAwMDAsIDUuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiB4PSIwLjMxNDA5NzgxOCIgeT0iMC4zMTQwOTc4MTgiIHdpZHRoPSIxMy4zNzE4MDQ0IiBoZWlnaHQ9IjEzLjM3MTgwNDQiPjwvcmVjdD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMy4yMDY3NTE5LDguMzY5NzgwOTcgTDEzLjIwMTA3NTUsOC4zNjgzNjU2OSBMMTMuMTg4NTA0Miw4LjQzMjQyNDA0IEMxMy4xMTg1OTg4LDguNzU0NTkxMTEgMTIuOTU3Mzc1OCw5LjE5NzE0MTA5IDEyLjcwNDgzNTEsOS43NjAwNzQwNyBMMTAuOTI1MDYzMyw3LjE3NTAxMjQ1IEwxMi4zNzk3NjgyLDcuMjE1MDgwOTggQzEyLjU2NTAzMDgsNC42Njg3OTkzNyAxMC44OTk1NTU2LDIuMjgyMDY2ODEgOC4zMzc3ODc2MywxLjY0MzM0NjMgQzUuOTUxMjg0OTMsMS4wNDgzMjQzNSAzLjQ5MDc0NTAyLDIuMTU5NDMyOTkgMi4zNDIwNzk4Nyw0LjI4MDE1MDAyIEwyLjI0Njg2Nzk0LDQuNDY0MzgyMDQgTDEuMzQ3MTc0NDQsNC4wMjEyODk5NiBDMi42NTc5MDgxLDEuMzU5ODU5OTkgNS42NjUzMTgxMSwtMC4wNTY1NjI0NzA3IDguNTgwNDA3NTQsMC42NzAyNTA5NTUgQzExLjkxNzM2NDYsMS41MDIyNDc4IDEzLjk3MzY0OTUsNC44MzE4OTk2MSAxMy4yNTMzMTU5LDguMTY5NTMzMyBMMTMuMjA2NzUxOSw4LjM2OTc4MDk3IFoiIGlkPSLlvaLnirYiIGZpbGw9IiNGRkZGRkYiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEyLjQ2MjY1NjIsMTIuMTI4OTQzOCBMMTIuNDU2OTc5OCwxMi4xMjc1Mjg1IEwxMi40NDQ0MDg1LDEyLjE5MTU4NjggQzEyLjM3NDUwMzEsMTIuNTEzNzUzOSAxMi4yMTMyODAxLDEyLjk1NjMwMzkgMTEuOTYwNzM5NCwxMy41MTkyMzY5IEwxMC4xODA5Njc2LDEwLjkzNDE3NTIgTDExLjYzNTY3MjUsMTAuOTc0MjQzOCBDMTEuODIwOTM1MSw4LjQyNzk2MjE2IDEwLjE1NTQ1OTksNi4wNDEyMjk2IDcuNTkzNjkxOTQsNS40MDI1MDkxIEM1LjIwNzE4OTI0LDQuODA3NDg3MTQgMi43NDY2NDkzMyw1LjkxODU5NTc4IDEuNTk3OTg0MTgsOC4wMzkzMTI4MiBMMS41MDI3NzIyNSw4LjIyMzU0NDgzIEwwLjYwMzA3ODc1MSw3Ljc4MDQ1Mjc1IEMxLjkxMzgxMjQxLDUuMTE5MDIyNzggNC45MjEyMjI0MiwzLjcwMjYwMDMyIDcuODM2MzExODUsNC40Mjk0MTM3NSBDMTEuMTczMjY4OSw1LjI2MTQxMDU5IDEzLjIyOTU1MzgsOC41OTEwNjI0MSAxMi41MDkyMjAyLDExLjkyODY5NjEgTDEyLjQ2MjY1NjIsMTIuMTI4OTQzOCBaIiBpZD0i5b2i54q25aSH5Lu9IiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuNjI3OTUyLCA4Ljg3OTU4MSkgc2NhbGUoLTEsIC0xKSB0cmFuc2xhdGUoLTYuNjI3OTUyLCAtOC44Nzk1ODEpICI+PC9wYXRoPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTUuNjY5MDI0Myw3LjM1MDUyMzEgTDUuNjY5MDI0Myw3LjgzNDYwMjA1IEw5Ljc0ODA0MDIxLDcuODM0NjAyMDUgTDkuNzQ4MDQwMjEsOC44MzQ2MDIwNSBMNS42NjkwMjQzLDguODM0NjAyMDUgTDUuNjY5MDI0Myw5LjE3NzcyNzkzIEw0LjI1MTk1OTc5LDguMjY0MTI1NTEgTDUuNjY5MDI0Myw3LjM1MDUyMzEgWiBNOC4zMzA5NzU3LDQuODIyMjcyMDcgTDkuNzQ4MDQwMjEsNS43MzU4NzQ0OSBMOC4zMzA5NzU3LDYuNjQ5NDc2OSBMOC4zMzA5NzU3LDYuMzA2MzUxMDMgTDQuMjUxOTU5NzksNi4zMDYzNTEwMyBMNC4yNTE5NTk3OSw1LjMwNjM1MTAzIEw4LjMzMDk3NTcsNS4zMDYzNTEwMyBMOC4zMzA5NzU3LDQuODIyMjcyMDcgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4=";function createDataProcessNode(){const{BaseNode:e}=getBlueprintConfig();return class A extends e{static config={icon:icon$3,name:"DataProcess",inputs:[{name:"code",type:"string",visible:!1,value:"return ''"},{name:"argLength",type:"number",visible:!1}],outputs:[{name:"result",type:"unknown"}],dynamic:{inputOrOutput:"input",type:"any",label:"数据 [index]",length:1}};isDynamicInputs(){return!0}static isDynamicInput=e=>new RegExp(`^${this.config.name}.{2}\\d+$`,"i").test(e);static getDynamicInputIndex=e=>parseInt(e.substring(this.config.name.length+2));static getArgNameByIndex=e=>`data${e+1}`;onExecute(e,t,i){const{code:s="return => arg1"}=t,n=Object.keys(t).reduce(((e,i)=>{if(A.isDynamicInput(i)){e[A.getDynamicInputIndex(i)]=t[i]}return e}),[]),r=t.argLength||1,o=`function (${new Array(r).fill("").map(((e,t)=>A.getArgNameByIndex(t))).join(",")}){${s}}`;try{const e=new Function("return "+o)();i.result=e(...n)}catch(e){console.warn(`（${this._execName}）蓝图执行错误`,e),i.result={type:"error",message:"执行错误"}}}}}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function listCacheClear$1(){this.__data__=[],this.size=0}var _listCacheClear=listCacheClear$1;function eq$3(e,A){return e===A||e!=e&&A!=A}var eq_1=eq$3,eq$2=eq_1;function assocIndexOf$4(e,A){for(var t=e.length;t--;)if(eq$2(e[t][0],A))return t;return-1}var _assocIndexOf=assocIndexOf$4,assocIndexOf$3=_assocIndexOf,arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete$1(e){var A=this.__data__,t=assocIndexOf$3(A,e);return!(t<0)&&(t==A.length-1?A.pop():splice.call(A,t,1),--this.size,!0)}var _listCacheDelete=listCacheDelete$1,assocIndexOf$2=_assocIndexOf;function listCacheGet$1(e){var A=this.__data__,t=assocIndexOf$2(A,e);return t<0?void 0:A[t][1]}var _listCacheGet=listCacheGet$1,assocIndexOf$1=_assocIndexOf;function listCacheHas$1(e){return assocIndexOf$1(this.__data__,e)>-1}var _listCacheHas=listCacheHas$1,assocIndexOf=_assocIndexOf;function listCacheSet$1(e,A){var t=this.__data__,i=assocIndexOf(t,e);return i<0?(++this.size,t.push([e,A])):t[i][1]=A,this}var _listCacheSet=listCacheSet$1,listCacheClear=_listCacheClear,listCacheDelete=_listCacheDelete,listCacheGet=_listCacheGet,listCacheHas=_listCacheHas,listCacheSet=_listCacheSet;function ListCache$4(e){var A=-1,t=null==e?0:e.length;for(this.clear();++A<t;){var i=e[A];this.set(i[0],i[1])}}ListCache$4.prototype.clear=listCacheClear,ListCache$4.prototype.delete=listCacheDelete,ListCache$4.prototype.get=listCacheGet,ListCache$4.prototype.has=listCacheHas,ListCache$4.prototype.set=listCacheSet;var _ListCache=ListCache$4,ListCache$3=_ListCache;function stackClear$1(){this.__data__=new ListCache$3,this.size=0}var _stackClear=stackClear$1;function stackDelete$1(e){var A=this.__data__,t=A.delete(e);return this.size=A.size,t}var _stackDelete=stackDelete$1;function stackGet$1(e){return this.__data__.get(e)}var _stackGet=stackGet$1;function stackHas$1(e){return this.__data__.has(e)}var _stackHas=stackHas$1,freeGlobal$1="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal$1,freeGlobal=_freeGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root$8=freeGlobal||freeSelf||Function("return this")(),_root=root$8,root$7=_root,Symbol$5=root$7.Symbol,_Symbol=Symbol$5,Symbol$4=_Symbol,objectProto$e=Object.prototype,hasOwnProperty$b=objectProto$e.hasOwnProperty,nativeObjectToString$1=objectProto$e.toString,symToStringTag$1=Symbol$4?Symbol$4.toStringTag:void 0;function getRawTag$1(e){var A=hasOwnProperty$b.call(e,symToStringTag$1),t=e[symToStringTag$1];try{e[symToStringTag$1]=void 0;var i=!0}catch(e){}var s=nativeObjectToString$1.call(e);return i&&(A?e[symToStringTag$1]=t:delete e[symToStringTag$1]),s}var _getRawTag=getRawTag$1,objectProto$d=Object.prototype,nativeObjectToString=objectProto$d.toString;function objectToString$1(e){return nativeObjectToString.call(e)}var _objectToString=objectToString$1,Symbol$3=_Symbol,getRawTag=_getRawTag,objectToString=_objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$3?Symbol$3.toStringTag:void 0;function baseGetTag$4(e){return null==e?void 0===e?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(e)?getRawTag(e):objectToString(e)}var _baseGetTag=baseGetTag$4;function isObject$5(e){var A=typeof e;return null!=e&&("object"==A||"function"==A)}var isObject_1=isObject$5,baseGetTag$3=_baseGetTag,isObject$4=isObject_1,asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$2(e){if(!isObject$4(e))return!1;var A=baseGetTag$3(e);return A==funcTag$2||A==genTag$1||A==asyncTag||A==proxyTag}var isFunction_1=isFunction$2,root$6=_root,coreJsData$1=root$6["__core-js_shared__"],_coreJsData=coreJsData$1,coreJsData=_coreJsData,maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""),uid?"Symbol(src)_1."+uid:""),uid;function isMasked$1(e){return!!maskSrcKey&&maskSrcKey in e}var _isMasked=isMasked$1,funcProto$1=Function.prototype,funcToString$1=funcProto$1.toString;function toSource$2(e){if(null!=e){try{return funcToString$1.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var _toSource=toSource$2,isFunction$1=isFunction_1,isMasked=_isMasked,isObject$3=isObject_1,toSource$1=_toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto$c=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$a=objectProto$c.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty$a).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative$1(e){return!(!isObject$3(e)||isMasked(e))&&(isFunction$1(e)?reIsNative:reIsHostCtor).test(toSource$1(e))}var _baseIsNative=baseIsNative$1;function getValue$1(e,A){return null==e?void 0:e[A]}var _getValue=getValue$1,baseIsNative=_baseIsNative,getValue=_getValue;function getNative$7(e,A){var t=getValue(e,A);return baseIsNative(t)?t:void 0}var _getNative=getNative$7,getNative$6=_getNative,root$5=_root,Map$4=getNative$6(root$5,"Map"),_Map=Map$4,getNative$5=_getNative,nativeCreate$4=getNative$5(Object,"create"),_nativeCreate=nativeCreate$4,nativeCreate$3=_nativeCreate;function hashClear$1(){this.__data__=nativeCreate$3?nativeCreate$3(null):{},this.size=0}var _hashClear=hashClear$1;function hashDelete$1(e){var A=this.has(e)&&delete this.__data__[e];return this.size-=A?1:0,A}var _hashDelete=hashDelete$1,nativeCreate$2=_nativeCreate,HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$b=Object.prototype,hasOwnProperty$9=objectProto$b.hasOwnProperty;function hashGet$1(e){var A=this.__data__;if(nativeCreate$2){var t=A[e];return t===HASH_UNDEFINED$2?void 0:t}return hasOwnProperty$9.call(A,e)?A[e]:void 0}var _hashGet=hashGet$1,nativeCreate$1=_nativeCreate,objectProto$a=Object.prototype,hasOwnProperty$8=objectProto$a.hasOwnProperty;function hashHas$1(e){var A=this.__data__;return nativeCreate$1?void 0!==A[e]:hasOwnProperty$8.call(A,e)}var _hashHas=hashHas$1,nativeCreate=_nativeCreate,HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet$1(e,A){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=nativeCreate&&void 0===A?HASH_UNDEFINED$1:A,this}var _hashSet=hashSet$1,hashClear=_hashClear,hashDelete=_hashDelete,hashGet=_hashGet,hashHas=_hashHas,hashSet=_hashSet;function Hash$1(e){var A=-1,t=null==e?0:e.length;for(this.clear();++A<t;){var i=e[A];this.set(i[0],i[1])}}Hash$1.prototype.clear=hashClear,Hash$1.prototype.delete=hashDelete,Hash$1.prototype.get=hashGet,Hash$1.prototype.has=hashHas,Hash$1.prototype.set=hashSet;var _Hash=Hash$1,Hash=_Hash,ListCache$2=_ListCache,Map$3=_Map;function mapCacheClear$1(){this.size=0,this.__data__={hash:new Hash,map:new(Map$3||ListCache$2),string:new Hash}}var _mapCacheClear=mapCacheClear$1;function isKeyable$1(e){var A=typeof e;return"string"==A||"number"==A||"symbol"==A||"boolean"==A?"__proto__"!==e:null===e}var _isKeyable=isKeyable$1,isKeyable=_isKeyable;function getMapData$4(e,A){var t=e.__data__;return isKeyable(A)?t["string"==typeof A?"string":"hash"]:t.map}var _getMapData=getMapData$4,getMapData$3=_getMapData;function mapCacheDelete$1(e){var A=getMapData$3(this,e).delete(e);return this.size-=A?1:0,A}var _mapCacheDelete=mapCacheDelete$1,getMapData$2=_getMapData;function mapCacheGet$1(e){return getMapData$2(this,e).get(e)}var _mapCacheGet=mapCacheGet$1,getMapData$1=_getMapData;function mapCacheHas$1(e){return getMapData$1(this,e).has(e)}var _mapCacheHas=mapCacheHas$1,getMapData=_getMapData;function mapCacheSet$1(e,A){var t=getMapData(this,e),i=t.size;return t.set(e,A),this.size+=t.size==i?0:1,this}var _mapCacheSet=mapCacheSet$1,mapCacheClear=_mapCacheClear,mapCacheDelete=_mapCacheDelete,mapCacheGet=_mapCacheGet,mapCacheHas=_mapCacheHas,mapCacheSet=_mapCacheSet;function MapCache$2(e){var A=-1,t=null==e?0:e.length;for(this.clear();++A<t;){var i=e[A];this.set(i[0],i[1])}}MapCache$2.prototype.clear=mapCacheClear,MapCache$2.prototype.delete=mapCacheDelete,MapCache$2.prototype.get=mapCacheGet,MapCache$2.prototype.has=mapCacheHas,MapCache$2.prototype.set=mapCacheSet;var _MapCache=MapCache$2,ListCache$1=_ListCache,Map$2=_Map,MapCache$1=_MapCache,LARGE_ARRAY_SIZE=200;function stackSet$1(e,A){var t=this.__data__;if(t instanceof ListCache$1){var i=t.__data__;if(!Map$2||i.length<LARGE_ARRAY_SIZE-1)return i.push([e,A]),this.size=++t.size,this;t=this.__data__=new MapCache$1(i)}return t.set(e,A),this.size=t.size,this}var _stackSet=stackSet$1,ListCache=_ListCache,stackClear=_stackClear,stackDelete=_stackDelete,stackGet=_stackGet,stackHas=_stackHas,stackSet=_stackSet;function Stack$3(e){var A=this.__data__=new ListCache(e);this.size=A.size}Stack$3.prototype.clear=stackClear,Stack$3.prototype.delete=stackDelete,Stack$3.prototype.get=stackGet,Stack$3.prototype.has=stackHas,Stack$3.prototype.set=stackSet;var _Stack=Stack$3;function arrayEach$1(e,A){for(var t=-1,i=null==e?0:e.length;++t<i&&!1!==A(e[t],t,e););return e}var _arrayEach=arrayEach$1,getNative$4=_getNative,defineProperty$1=function(){try{var e=getNative$4(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),_defineProperty=defineProperty$1,defineProperty=_defineProperty;function baseAssignValue$2(e,A,t){"__proto__"==A&&defineProperty?defineProperty(e,A,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[A]=t}var _baseAssignValue=baseAssignValue$2,baseAssignValue$1=_baseAssignValue,eq$1=eq_1,objectProto$9=Object.prototype,hasOwnProperty$7=objectProto$9.hasOwnProperty;function assignValue$2(e,A,t){var i=e[A];hasOwnProperty$7.call(e,A)&&eq$1(i,t)&&(void 0!==t||A in e)||baseAssignValue$1(e,A,t)}var _assignValue=assignValue$2,assignValue$1=_assignValue,baseAssignValue=_baseAssignValue;function copyObject$4(e,A,t,i){var s=!t;t||(t={});for(var n=-1,r=A.length;++n<r;){var o=A[n],a=i?i(t[o],e[o],o,t,e):void 0;void 0===a&&(a=e[o]),s?baseAssignValue(t,o,a):assignValue$1(t,o,a)}return t}var _copyObject=copyObject$4;function baseTimes$1(e,A){for(var t=-1,i=Array(e);++t<e;)i[t]=A(t);return i}var _baseTimes=baseTimes$1;function isObjectLike$6(e){return null!=e&&"object"==typeof e}var isObjectLike_1=isObjectLike$6,baseGetTag$2=_baseGetTag,isObjectLike$5=isObjectLike_1,argsTag$3="[object Arguments]";function baseIsArguments$1(e){return isObjectLike$5(e)&&baseGetTag$2(e)==argsTag$3}var _baseIsArguments=baseIsArguments$1,baseIsArguments=_baseIsArguments,isObjectLike$4=isObjectLike_1,objectProto$8=Object.prototype,hasOwnProperty$6=objectProto$8.hasOwnProperty,propertyIsEnumerable$1=objectProto$8.propertyIsEnumerable,isArguments$1=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike$4(e)&&hasOwnProperty$6.call(e,"callee")&&!propertyIsEnumerable$1.call(e,"callee")},isArguments_1=isArguments$1,isArray$5=Array.isArray,isArray_1=isArray$5,isBufferExports={},isBuffer$3={get exports(){return isBufferExports},set exports(e){isBufferExports=e}};function stubFalse(){return!1}var stubFalse_1=stubFalse;!function(e,A){var t=_root,i=stubFalse_1,s=A&&!A.nodeType&&A,n=s&&e&&!e.nodeType&&e,r=n&&n.exports===s?t.Buffer:void 0,o=(r?r.isBuffer:void 0)||i;e.exports=o}(isBuffer$3,isBufferExports);var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex$1(e,A){var t=typeof e;return!!(A=null==A?MAX_SAFE_INTEGER$1:A)&&("number"==t||"symbol"!=t&&reIsUint.test(e))&&e>-1&&e%1==0&&e<A}var _isIndex=isIndex$1,MAX_SAFE_INTEGER=9007199254740991;function isLength$3(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER}var isLength_1=isLength$3,baseGetTag$1=_baseGetTag,isLength$2=isLength_1,isObjectLike$3=isObjectLike_1,argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1="[object Function]",mapTag$5="[object Map]",numberTag$3="[object Number]",objectTag$3="[object Object]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray$1(e){return isObjectLike$3(e)&&isLength$2(e.length)&&!!typedArrayTags[baseGetTag$1(e)]}typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0,typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$3]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$2]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$5]=typedArrayTags[numberTag$3]=typedArrayTags[objectTag$3]=typedArrayTags[regexpTag$3]=typedArrayTags[setTag$5]=typedArrayTags[stringTag$3]=typedArrayTags[weakMapTag$2]=!1;var _baseIsTypedArray=baseIsTypedArray$1;function baseUnary$3(e){return function(A){return e(A)}}var _baseUnary=baseUnary$3,_nodeUtilExports={},_nodeUtil={get exports(){return _nodeUtilExports},set exports(e){_nodeUtilExports=e}};!function(e,A){var t=_freeGlobal,i=A&&!A.nodeType&&A,s=i&&e&&!e.nodeType&&e,n=s&&s.exports===i&&t.process,r=function(){try{var e=s&&s.require&&s.require("util").types;return e||n&&n.binding&&n.binding("util")}catch(e){}}();e.exports=r}(_nodeUtil,_nodeUtilExports);var baseIsTypedArray=_baseIsTypedArray,baseUnary$2=_baseUnary,nodeUtil$2=_nodeUtilExports,nodeIsTypedArray=nodeUtil$2&&nodeUtil$2.isTypedArray,isTypedArray$2=nodeIsTypedArray?baseUnary$2(nodeIsTypedArray):baseIsTypedArray,isTypedArray_1=isTypedArray$2,baseTimes=_baseTimes,isArguments=isArguments_1,isArray$4=isArray_1,isBuffer$2=isBufferExports,isIndex=_isIndex,isTypedArray$1=isTypedArray_1,objectProto$7=Object.prototype,hasOwnProperty$5=objectProto$7.hasOwnProperty;function arrayLikeKeys$2(e,A){var t=isArray$4(e),i=!t&&isArguments(e),s=!t&&!i&&isBuffer$2(e),n=!t&&!i&&!s&&isTypedArray$1(e),r=t||i||s||n,o=r?baseTimes(e.length,String):[],a=o.length;for(var l in e)!A&&!hasOwnProperty$5.call(e,l)||r&&("length"==l||s&&("offset"==l||"parent"==l)||n&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||isIndex(l,a))||o.push(l);return o}var _arrayLikeKeys=arrayLikeKeys$2,objectProto$6=Object.prototype;function isPrototype$3(e){var A=e&&e.constructor;return e===("function"==typeof A&&A.prototype||objectProto$6)}var _isPrototype=isPrototype$3;function overArg$2(e,A){return function(t){return e(A(t))}}var _overArg=overArg$2,overArg$1=_overArg,nativeKeys$1=overArg$1(Object.keys,Object),_nativeKeys=nativeKeys$1,isPrototype$2=_isPrototype,nativeKeys=_nativeKeys,objectProto$5=Object.prototype,hasOwnProperty$4=objectProto$5.hasOwnProperty;function baseKeys$1(e){if(!isPrototype$2(e))return nativeKeys(e);var A=[];for(var t in Object(e))hasOwnProperty$4.call(e,t)&&"constructor"!=t&&A.push(t);return A}var _baseKeys=baseKeys$1,isFunction=isFunction_1,isLength$1=isLength_1;function isArrayLike$2(e){return null!=e&&isLength$1(e.length)&&!isFunction(e)}var isArrayLike_1=isArrayLike$2,arrayLikeKeys$1=_arrayLikeKeys,baseKeys=_baseKeys,isArrayLike$1=isArrayLike_1;function keys$3(e){return isArrayLike$1(e)?arrayLikeKeys$1(e):baseKeys(e)}var keys_1=keys$3,copyObject$3=_copyObject,keys$2=keys_1;function baseAssign$1(e,A){return e&&copyObject$3(A,keys$2(A),e)}var _baseAssign=baseAssign$1;function nativeKeysIn$1(e){var A=[];if(null!=e)for(var t in Object(e))A.push(t);return A}var _nativeKeysIn=nativeKeysIn$1,isObject$2=isObject_1,isPrototype$1=_isPrototype,nativeKeysIn=_nativeKeysIn,objectProto$4=Object.prototype,hasOwnProperty$3=objectProto$4.hasOwnProperty;function baseKeysIn$1(e){if(!isObject$2(e))return nativeKeysIn(e);var A=isPrototype$1(e),t=[];for(var i in e)("constructor"!=i||!A&&hasOwnProperty$3.call(e,i))&&t.push(i);return t}var _baseKeysIn=baseKeysIn$1,arrayLikeKeys=_arrayLikeKeys,baseKeysIn=_baseKeysIn,isArrayLike=isArrayLike_1;function keysIn$3(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}var keysIn_1=keysIn$3,copyObject$2=_copyObject,keysIn$2=keysIn_1;function baseAssignIn$1(e,A){return e&&copyObject$2(A,keysIn$2(A),e)}var _baseAssignIn=baseAssignIn$1,_cloneBufferExports={},_cloneBuffer={get exports(){return _cloneBufferExports},set exports(e){_cloneBufferExports=e}};function copyArray$1(e,A){var t=-1,i=e.length;for(A||(A=Array(i));++t<i;)A[t]=e[t];return A}!function(e,A){var t=_root,i=A&&!A.nodeType&&A,s=i&&e&&!e.nodeType&&e,n=s&&s.exports===i?t.Buffer:void 0,r=n?n.allocUnsafe:void 0;e.exports=function(e,A){if(A)return e.slice();var t=e.length,i=r?r(t):new e.constructor(t);return e.copy(i),i}}(_cloneBuffer,_cloneBufferExports);var _copyArray=copyArray$1;function arrayFilter$1(e,A){for(var t=-1,i=null==e?0:e.length,s=0,n=[];++t<i;){var r=e[t];A(r,t,e)&&(n[s++]=r)}return n}var _arrayFilter=arrayFilter$1;function stubArray$2(){return[]}var stubArray_1=stubArray$2,arrayFilter=_arrayFilter,stubArray$1=stubArray_1,objectProto$3=Object.prototype,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols$3=nativeGetSymbols$1?function(e){return null==e?[]:(e=Object(e),arrayFilter(nativeGetSymbols$1(e),(function(A){return propertyIsEnumerable.call(e,A)})))}:stubArray$1,_getSymbols=getSymbols$3,copyObject$1=_copyObject,getSymbols$2=_getSymbols;function copySymbols$1(e,A){return copyObject$1(e,getSymbols$2(e),A)}var _copySymbols=copySymbols$1;function arrayPush$2(e,A){for(var t=-1,i=A.length,s=e.length;++t<i;)e[s+t]=A[t];return e}var _arrayPush=arrayPush$2,overArg=_overArg,getPrototype$2=overArg(Object.getPrototypeOf,Object),_getPrototype=getPrototype$2,arrayPush$1=_arrayPush,getPrototype$1=_getPrototype,getSymbols$1=_getSymbols,stubArray=stubArray_1,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn$2=nativeGetSymbols?function(e){for(var A=[];e;)arrayPush$1(A,getSymbols$1(e)),e=getPrototype$1(e);return A}:stubArray,_getSymbolsIn=getSymbolsIn$2,copyObject=_copyObject,getSymbolsIn$1=_getSymbolsIn;function copySymbolsIn$1(e,A){return copyObject(e,getSymbolsIn$1(e),A)}var _copySymbolsIn=copySymbolsIn$1,arrayPush=_arrayPush,isArray$3=isArray_1;function baseGetAllKeys$2(e,A,t){var i=A(e);return isArray$3(e)?i:arrayPush(i,t(e))}var _baseGetAllKeys=baseGetAllKeys$2,baseGetAllKeys$1=_baseGetAllKeys,getSymbols=_getSymbols,keys$1=keys_1;function getAllKeys$2(e){return baseGetAllKeys$1(e,keys$1,getSymbols)}var _getAllKeys=getAllKeys$2,baseGetAllKeys=_baseGetAllKeys,getSymbolsIn=_getSymbolsIn,keysIn$1=keysIn_1;function getAllKeysIn$1(e){return baseGetAllKeys(e,keysIn$1,getSymbolsIn)}var _getAllKeysIn=getAllKeysIn$1,getNative$3=_getNative,root$4=_root,DataView$1=getNative$3(root$4,"DataView"),_DataView=DataView$1,getNative$2=_getNative,root$3=_root,Promise$2=getNative$2(root$3,"Promise"),_Promise=Promise$2,getNative$1=_getNative,root$2=_root,Set$2=getNative$1(root$2,"Set"),_Set=Set$2,getNative=_getNative,root$1=_root,WeakMap$2=getNative(root$1,"WeakMap"),_WeakMap=WeakMap$2,DataView=_DataView,Map$1=_Map,Promise$1=_Promise,Set$1=_Set,WeakMap$1=_WeakMap,baseGetTag=_baseGetTag,toSource=_toSource,mapTag$4="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$4="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap$1),getTag$4=baseGetTag;(DataView&&getTag$4(new DataView(new ArrayBuffer(1)))!=dataViewTag$3||Map$1&&getTag$4(new Map$1)!=mapTag$4||Promise$1&&getTag$4(Promise$1.resolve())!=promiseTag||Set$1&&getTag$4(new Set$1)!=setTag$4||WeakMap$1&&getTag$4(new WeakMap$1)!=weakMapTag$1)&&(getTag$4=function(e){var A=baseGetTag(e),t=A==objectTag$2?e.constructor:void 0,i=t?toSource(t):"";if(i)switch(i){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$4;case promiseCtorString:return promiseTag;case setCtorString:return setTag$4;case weakMapCtorString:return weakMapTag$1}return A});var _getTag=getTag$4,objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function initCloneArray$1(e){var A=e.length,t=new e.constructor(A);return A&&"string"==typeof e[0]&&hasOwnProperty$2.call(e,"index")&&(t.index=e.index,t.input=e.input),t}var _initCloneArray=initCloneArray$1,root=_root,Uint8Array$3=root.Uint8Array,_Uint8Array=Uint8Array$3,Uint8Array$2=_Uint8Array;function cloneArrayBuffer$3(e){var A=new e.constructor(e.byteLength);return new Uint8Array$2(A).set(new Uint8Array$2(e)),A}var _cloneArrayBuffer=cloneArrayBuffer$3,cloneArrayBuffer$2=_cloneArrayBuffer;function cloneDataView$1(e,A){var t=A?cloneArrayBuffer$2(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}var _cloneDataView=cloneDataView$1,reFlags=/\w*$/;function cloneRegExp$1(e){var A=new e.constructor(e.source,reFlags.exec(e));return A.lastIndex=e.lastIndex,A}var _cloneRegExp=cloneRegExp$1,Symbol$2=_Symbol,symbolProto$1=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol$1(e){return symbolValueOf$1?Object(symbolValueOf$1.call(e)):{}}var _cloneSymbol=cloneSymbol$1,cloneArrayBuffer$1=_cloneArrayBuffer;function cloneTypedArray$1(e,A){var t=A?cloneArrayBuffer$1(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}var _cloneTypedArray=cloneTypedArray$1,cloneArrayBuffer=_cloneArrayBuffer,cloneDataView=_cloneDataView,cloneRegExp=_cloneRegExp,cloneSymbol=_cloneSymbol,cloneTypedArray=_cloneTypedArray,boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$3="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag$1(e,A,t){var i=e.constructor;switch(A){case arrayBufferTag$2:return cloneArrayBuffer(e);case boolTag$2:case dateTag$2:return new i(+e);case dataViewTag$2:return cloneDataView(e,t);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(e,t);case mapTag$3:return new i;case numberTag$2:case stringTag$2:return new i(e);case regexpTag$2:return cloneRegExp(e);case setTag$3:return new i;case symbolTag$2:return cloneSymbol(e)}}var _initCloneByTag=initCloneByTag$1,isObject$1=isObject_1,objectCreate=Object.create,baseCreate$1=function(){function e(){}return function(A){if(!isObject$1(A))return{};if(objectCreate)return objectCreate(A);e.prototype=A;var t=new e;return e.prototype=void 0,t}}(),_baseCreate=baseCreate$1,baseCreate=_baseCreate,getPrototype=_getPrototype,isPrototype=_isPrototype;function initCloneObject$1(e){return"function"!=typeof e.constructor||isPrototype(e)?{}:baseCreate(getPrototype(e))}var _initCloneObject=initCloneObject$1,getTag$3=_getTag,isObjectLike$2=isObjectLike_1,mapTag$2="[object Map]";function baseIsMap$1(e){return isObjectLike$2(e)&&getTag$3(e)==mapTag$2}var _baseIsMap=baseIsMap$1,baseIsMap=_baseIsMap,baseUnary$1=_baseUnary,nodeUtil$1=_nodeUtilExports,nodeIsMap=nodeUtil$1&&nodeUtil$1.isMap,isMap$1=nodeIsMap?baseUnary$1(nodeIsMap):baseIsMap,isMap_1=isMap$1,getTag$2=_getTag,isObjectLike$1=isObjectLike_1,setTag$2="[object Set]";function baseIsSet$1(e){return isObjectLike$1(e)&&getTag$2(e)==setTag$2}var _baseIsSet=baseIsSet$1,baseIsSet=_baseIsSet,baseUnary=_baseUnary,nodeUtil=_nodeUtilExports,nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet$1=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,isSet_1=isSet$1,Stack$2=_Stack,arrayEach=_arrayEach,assignValue=_assignValue,baseAssign=_baseAssign,baseAssignIn=_baseAssignIn,cloneBuffer=_cloneBufferExports,copyArray=_copyArray,copySymbols=_copySymbols,copySymbolsIn=_copySymbolsIn,getAllKeys$1=_getAllKeys,getAllKeysIn=_getAllKeysIn,getTag$1=_getTag,initCloneArray=_initCloneArray,initCloneByTag=_initCloneByTag,initCloneObject=_initCloneObject,isArray$2=isArray_1,isBuffer$1=isBufferExports,isMap=isMap_1,isObject=isObject_1,isSet=isSet_1,keys=keys_1,keysIn=keysIn_1,CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$1=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$1="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};function baseClone$1(e,A,t,i,s,n){var r,o=A&CLONE_DEEP_FLAG$1,a=A&CLONE_FLAT_FLAG,l=A&CLONE_SYMBOLS_FLAG$1;if(t&&(r=s?t(e,i,s,n):t(e)),void 0!==r)return r;if(!isObject(e))return e;var c=isArray$2(e);if(c){if(r=initCloneArray(e),!o)return copyArray(e,r)}else{var h=getTag$1(e),u=h==funcTag||h==genTag;if(isBuffer$1(e))return cloneBuffer(e,o);if(h==objectTag$1||h==argsTag$1||u&&!s){if(r=a||u?{}:initCloneObject(e),!o)return a?copySymbolsIn(e,baseAssignIn(r,e)):copySymbols(e,baseAssign(r,e))}else{if(!cloneableTags[h])return s?e:{};r=initCloneByTag(e,h,o)}}n||(n=new Stack$2);var d=n.get(e);if(d)return d;n.set(e,r),isSet(e)?e.forEach((function(i){r.add(baseClone$1(i,A,t,i,e,n))})):isMap(e)&&e.forEach((function(i,s){r.set(s,baseClone$1(i,A,t,s,e,n))}));var p=c?void 0:(l?a?getAllKeysIn:getAllKeys$1:a?keysIn:keys)(e);return arrayEach(p||e,(function(i,s){p&&(i=e[s=i]),assignValue(r,s,baseClone$1(i,A,t,s,e,n))})),r}cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$1]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$1]=cloneableTags[setTag$1]=cloneableTags[stringTag$1]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;var _baseClone=baseClone$1,baseClone=_baseClone,CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeepWith(e,A){return baseClone(e,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG,A="function"==typeof A?A:void 0)}var cloneDeepWith_1=cloneDeepWith;function createTimerNode(){const{BaseNode:e}=getBlueprintConfig();return class extends e{static config={name:"Timer",data:[{name:"interval",type:"number",value:3e3}],outputs:[{name:"next",type:"callback"}]};isEntrance(){return!0}onStop(){this._timer&&(clearInterval(this._timer),this._timer=null)}onExecute(e,A,t){const i=e.interval;i&&(this._timer=setInterval((()=>{this.run("next")}),i))}}}function createGetItemFromArray(){const{BaseNode:e}=getBlueprintConfig();return class extends e{static config={name:"GetItemFromArray",inputs:[{name:"array",type:"array"},{name:"index",type:"number"}],outputs:[{name:"data",type:"conch"}]};onExecute(e,A,t){t.data=A.array?A.array[parseInt(A.index)]:void 0}}}function createForEachLoopNode(){const{BaseNode:e}=getBlueprintConfig();return class extends e{static config={name:"ForEachLoop",inputs:[{name:"exec",type:"exec"},{name:"array",type:"array"}],outputs:[{name:"loop",type:"callback"},{name:"element",type:"unknown"},{name:"index",type:"number"},{name:"completed",type:"callback"}]};onExecute(e,A,t){const i=A.array||[];for(let e=0;e<i.length;e++)t.element=i[e],t.index=e,this.run("loop",t);this.run("callback",t)}}}function createVisibilityNode(){const{BaseNode:e}=getBlueprintConfig();return class extends e{static config={name:"Visibility",inputs:[{name:"show",type:"exec"},{name:"hide",type:"exec"},{name:"visibleToggle",type:"exec"},{name:"conch",type:["conch","layer"]}],outputs:[{name:"next",type:"callback"}]};async onExecute(e,A,t){const i=A.conch;i?"show"===this.curExecName?await i.$uiComp.show():"hide"===this.curExecName?await i.$uiComp.hidden():"visibleToggle"===this.curExecName&&(i.visible?await i.$uiComp.hidden():await i.$uiComp.show()):console.warn("蓝图：动画显隐没有目标无法执行"),this.run("next")}}}const head=document.head,loadFont=async(e,A)=>{if(Array.from(window.document.fonts.values()).filter((A=>A.family===e))[0])return;const t=new window.FontFace(e,A);await t.load(),window.document.fonts.add(t)},loadScript=(e,A,t)=>new Promise(((i,s)=>{if(!A&&!t)return s(new Error("script url or content is empty"));const n="script"+e;let r=head.querySelector("#"+n);if(r){if(!r.errorFlag)return i(r);r.remove()}r=document.createElement("script"),r.id=n,r.onload=function(e){i(e)},r.onerror=function(e){s(e),r.errorFlag=!0},A?r.src=A:(r.appendChild(document.createTextNode(t)),i(r)),head.appendChild(r)}));function getUrl$1(e,A={}){if(A.prefix){const t=typeof A.prefix;if("string"===t)return A.prefix+e;if("function"===t)return A.prefix(e)}return e}async function loadResources(e={},A={}){const{component:t,img:i,fonts:s}=e,n=[],r=[],o=[];if(Array.isArray(t))for(const e of t)n.push(loadScript(e,getUrl$1(`/s-static/component/${e}.js`,A)).catch((A=>{r.push(e),console.error(e+" 组件资源加载失败",A)})));if(i)for(const e in i)n.push(loadImg(getUrl$1(i[e],A)).catch((A=>{o.push(e),console.error(i[e]+" 图片资源加载失败",A)})));if(s)for(const e in s)loadFont(e,`url(${getUrl$1("/s-static/fonts/"+s[e],A)})`).catch((A=>{console.error("字体加载失败",e,A)}));return await Promise.all(n),r.length+o.length&&{errorComponentList:r,errorImgList:o}}const isEmpty=e=>null==e,loadImg=e=>new Promise(((A,t)=>{const i=new Image;i.onload=e=>{A(e)},i.onerror=e=>{t(e)},i.src=e})),isType$2=(e,A)=>Object.prototype.toString.call(e).includes(A),deepClone=e=>{if(!e||"object"!=typeof e)return e;const A=e instanceof Array?[]:{};for(const t in e)A[t]=deepClone(e[t]);return A};navigator.userAgent.includes("Mac OS X");var globalOptions={main:{},tool:{left:[],center:[],right:[]},menu:{configList:[]},keyMap:{},bottom:{fileListVisible:!0,expandVisible:!0},handle:{enableContextMenu:!0,enableRulerToolTip:!0,enableBluePrint:!0,enableCodeEditor:!0,enableTwin:!0,enableDataCallback:!0,enableLayer:!0,enableArtifactResource:!1,enableStaticData:!1,enableChartResource:!0,enableSchemeSelection:!0,enableRollPolling:!1,enableAdapterVersionAndWiki:!0,enableTwinCoat:!0,enableUserColor:!0,enableQuickTip:!0,enableTutorialDocument:!0,enableWatermark:!1}};const defaultUiOptions={style:{width:1920,height:1080,backgroundColor:"rgba(40, 42, 46, 1)",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundSize:"100% 100%"}},defaultUiConfig={notSelectLayer:!0,theme:{ui:{background:"url(/kunpeng/static/img/canvas-bg.svg?v=1)"},ruler:{color:"#121314",width:21,lineStyle:{color:"#FF4D4F",width:1},tick:{textColor:"rgba(255, 255, 255, 0.3)",lineWidth:1,lineColor:"rgba(255, 255, 255, 0.16)"},iconColor:"",border:"none",icon:{borderColor:"transparent"}},alignmentLines:{color:"#FF4D4F",width:1,distanceStyle:{color:"#FF4D4F",width:1}},watermark:{defaultAdd:!1,src:""}},inStack:!1};function getUiConfig(e){return e&&(defaultUiConfig.theme.ui.background="transparent"),defaultUiConfig.theme.watermark.defaultAdd=globalOptions.handle.enableWatermark,defaultUiConfig}defaultUiOptions.style.backgroundColor;const easingList=[{name:"匀速",key:"linear"},{name:"慢速结束",key:"easeOut"}],easingMapName=easingList.map((e=>e.name));function createTranslateNode(){const{BaseNode:e}=getBlueprintConfig();return class extends e{static config={name:"Translate",inputs:[{name:"exec",type:"exec"},{name:"conch",type:"conch"},{name:"x",type:"number"},{name:"y",type:"number"},{name:"easing",type:"select",value:easingMapName},{name:"duration",type:"number",value:1e3},{name:"delay",type:"number",value:0}],outputs:[{name:"next",type:"callback"}]};onExecute(e,A,t){const i=A.conch,s={translate:[+A.x||0,+A.y||0]},n=easingList.filter((e=>e.name===A.easing))[0];n&&Object.assign(A,{easing:n.key}),i?i.$ui.animation.run({target:i.$uiComp,animation:s,...A},(()=>{this.run("next")})):(console.warn("蓝图：动画移动没有目标无法执行"),this.run("next"))}}}function createLayersCarouselNode(){const{BaseNode:e}=getBlueprintConfig();return class extends e{static config={name:"LayersCarousel",inputs:[{name:"start",type:"exec"},{name:"stop",type:"exec"},{name:"interval",type:"number",value:1e3},{name:"layers",type:"array"}],outputs:[]};onExecute(e,A,t){const i=parseInt(A.interval),s=A.layers||[];"start"===this.curExecName?(clearInterval(this.inervalId),this.inervalId=setInterval((()=>{this.index=treatment.initializeIndex(this.index);for(let e=0;e<s.length;e++){const A=treatment.getVisibleName(e,this.index);s[e][A]()}this.index=treatment.getIndex(this.index,s.length)}),treatment.getInterval(i))):"stop"===this.curExecName&&clearInterval(this.inervalId)}}}const treatment={initializeIndex:e=>e??0,getIndex:(e,A)=>e>=A-1?0:e+1,getInterval:e=>Number.isNaN(e)?1e3:e,getVisibleName:(e,A)=>e===A?"show":"hidden"};var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd$1(e){return this.__data__.set(e,HASH_UNDEFINED),this}var _setCacheAdd=setCacheAdd$1;function setCacheHas$1(e){return this.__data__.has(e)}var _setCacheHas=setCacheHas$1,MapCache=_MapCache,setCacheAdd=_setCacheAdd,setCacheHas=_setCacheHas;function SetCache$1(e){var A=-1,t=null==e?0:e.length;for(this.__data__=new MapCache;++A<t;)this.add(e[A])}SetCache$1.prototype.add=SetCache$1.prototype.push=setCacheAdd,SetCache$1.prototype.has=setCacheHas;var _SetCache=SetCache$1;function arraySome$1(e,A){for(var t=-1,i=null==e?0:e.length;++t<i;)if(A(e[t],t,e))return!0;return!1}var _arraySome=arraySome$1;function cacheHas$1(e,A){return e.has(A)}var _cacheHas=cacheHas$1,SetCache=_SetCache,arraySome=_arraySome,cacheHas=_cacheHas,COMPARE_PARTIAL_FLAG$3=1,COMPARE_UNORDERED_FLAG$1=2;function equalArrays$2(e,A,t,i,s,n){var r=t&COMPARE_PARTIAL_FLAG$3,o=e.length,a=A.length;if(o!=a&&!(r&&a>o))return!1;var l=n.get(e),c=n.get(A);if(l&&c)return l==A&&c==e;var h=-1,u=!0,d=t&COMPARE_UNORDERED_FLAG$1?new SetCache:void 0;for(n.set(e,A),n.set(A,e);++h<o;){var p=e[h],g=A[h];if(i)var B=r?i(g,p,h,A,e,n):i(p,g,h,e,A,n);if(void 0!==B){if(B)continue;u=!1;break}if(d){if(!arraySome(A,(function(e,A){if(!cacheHas(d,A)&&(p===e||s(p,e,t,i,n)))return d.push(A)}))){u=!1;break}}else if(p!==g&&!s(p,g,t,i,n)){u=!1;break}}return n.delete(e),n.delete(A),u}var _equalArrays=equalArrays$2;function mapToArray$1(e){var A=-1,t=Array(e.size);return e.forEach((function(e,i){t[++A]=[i,e]})),t}var _mapToArray=mapToArray$1;function setToArray$1(e){var A=-1,t=Array(e.size);return e.forEach((function(e){t[++A]=e})),t}var _setToArray=setToArray$1,Symbol$1=_Symbol,Uint8Array$1=_Uint8Array,eq=eq_1,equalArrays$1=_equalArrays,mapToArray=_mapToArray,setToArray=_setToArray,COMPARE_PARTIAL_FLAG$2=1,COMPARE_UNORDERED_FLAG=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag$1(e,A,t,i,s,n,r){switch(t){case dataViewTag:if(e.byteLength!=A.byteLength||e.byteOffset!=A.byteOffset)return!1;e=e.buffer,A=A.buffer;case arrayBufferTag:return!(e.byteLength!=A.byteLength||!n(new Uint8Array$1(e),new Uint8Array$1(A)));case boolTag:case dateTag:case numberTag:return eq(+e,+A);case errorTag:return e.name==A.name&&e.message==A.message;case regexpTag:case stringTag:return e==A+"";case mapTag:var o=mapToArray;case setTag:var a=i&COMPARE_PARTIAL_FLAG$2;if(o||(o=setToArray),e.size!=A.size&&!a)return!1;var l=r.get(e);if(l)return l==A;i|=COMPARE_UNORDERED_FLAG,r.set(e,A);var c=equalArrays$1(o(e),o(A),i,s,n,r);return r.delete(e),c;case symbolTag:if(symbolValueOf)return symbolValueOf.call(e)==symbolValueOf.call(A)}return!1}var _equalByTag=equalByTag$1,getAllKeys=_getAllKeys,COMPARE_PARTIAL_FLAG$1=1,objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty;function equalObjects$1(e,A,t,i,s,n){var r=t&COMPARE_PARTIAL_FLAG$1,o=getAllKeys(e),a=o.length;if(a!=getAllKeys(A).length&&!r)return!1;for(var l=a;l--;){var c=o[l];if(!(r?c in A:hasOwnProperty$1.call(A,c)))return!1}var h=n.get(e),u=n.get(A);if(h&&u)return h==A&&u==e;var d=!0;n.set(e,A),n.set(A,e);for(var p=r;++l<a;){var g=e[c=o[l]],B=A[c];if(i)var m=r?i(B,g,c,A,e,n):i(g,B,c,e,A,n);if(!(void 0===m?g===B||s(g,B,t,i,n):m)){d=!1;break}p||(p="constructor"==c)}if(d&&!p){var f=e.constructor,y=A.constructor;f==y||!("constructor"in e)||!("constructor"in A)||"function"==typeof f&&f instanceof f&&"function"==typeof y&&y instanceof y||(d=!1)}return n.delete(e),n.delete(A),d}var _equalObjects=equalObjects$1,Stack$1=_Stack,equalArrays=_equalArrays,equalByTag=_equalByTag,equalObjects=_equalObjects,getTag=_getTag,isArray$1=isArray_1,isBuffer=isBufferExports,isTypedArray=isTypedArray_1,COMPARE_PARTIAL_FLAG=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;function baseIsEqualDeep$1(e,A,t,i,s,n){var r=isArray$1(e),o=isArray$1(A),a=r?arrayTag:getTag(e),l=o?arrayTag:getTag(A),c=(a=a==argsTag?objectTag:a)==objectTag,h=(l=l==argsTag?objectTag:l)==objectTag,u=a==l;if(u&&isBuffer(e)){if(!isBuffer(A))return!1;r=!0,c=!1}if(u&&!c)return n||(n=new Stack$1),r||isTypedArray(e)?equalArrays(e,A,t,i,s,n):equalByTag(e,A,a,t,i,s,n);if(!(t&COMPARE_PARTIAL_FLAG)){var d=c&&hasOwnProperty.call(e,"__wrapped__"),p=h&&hasOwnProperty.call(A,"__wrapped__");if(d||p){var g=d?e.value():e,B=p?A.value():A;return n||(n=new Stack$1),s(g,B,t,i,n)}}return!!u&&(n||(n=new Stack$1),equalObjects(e,A,t,i,s,n))}var _baseIsEqualDeep=baseIsEqualDeep$1,baseIsEqualDeep=_baseIsEqualDeep,isObjectLike=isObjectLike_1;function baseIsEqual$1(e,A,t,i,s){return e===A||(null==e||null==A||!isObjectLike(e)&&!isObjectLike(A)?e!=e&&A!=A:baseIsEqualDeep(e,A,t,i,baseIsEqual$1,s))}var _baseIsEqual=baseIsEqual$1,baseIsEqual=_baseIsEqual;function isEqual(e,A){return baseIsEqual(e,A)}var isEqual_1=isEqual;function createDeepEqualToNode(){const{BaseNode:e}=getBlueprintConfig();return class extends e{static config={name:"DeepEqualTo",inputs:[{name:"A",type:"any"},{name:"B",type:"any"}],outputs:[{name:"result",type:"boolean"}]};onExecute(e,A,t){"string"==typeof A.A||"string"==typeof A.B?t.result=String(A.A)===String(A.B):t.result=isEqual_1(A.A,A.B)}}}function createGreaterThanOrEqualToNode(){const{BaseNode:e}=getBlueprintConfig();return class extends e{static config={name:"GreaterThanOrEqualTo",inputs:[{name:"A",type:"number",value:0},{name:"B",type:"number",value:0}],outputs:[{name:"result",type:"boolean"}]};onExecute(e,A,t){t.result=A.A>=A.B}}}function createLessThanOrEqualToNode(){const{BaseNode:e}=getBlueprintConfig();return class extends e{static config={name:"LessThanOrEqualTo",inputs:[{name:"A",type:"number",value:0},{name:"B",type:"number",value:0}],outputs:[{name:"result",type:"boolean"}]};onExecute(e,A,t){t.result=A.A<=A.B}}}class BlueprintNodes{constructor(e){this.BlueprintModules=e,this.conchNodes=[],this.layerNodes=[],this.animationNodeList=[createVisibilityNode(),createTranslateNode(),createLayersCarouselNode()],this.folderStructure={children:[{foldername:"动画",nodes:this.animationNodeList},{foldername:"图层",nodes:this.layerNodes},{foldername:"图表",nodes:this.conchNodes},{foldername:"工具",nodes:[createDataProcessNode(),this.BlueprintModules.ArrayNode,this.BlueprintModules.PrintNode,createGetItemFromArray(),createForEachLoopNode()],children:[{foldername:"流程控制",nodes:[this.BlueprintModules.BeginNode,this.BlueprintModules.BranchNode,this.BlueprintModules.SequenceNode,createTimerNode()]},{foldername:"判断",nodes:[createDeepEqualToNode(),createGreaterThanOrEqualToNode(),createLessThanOrEqualToNode()]}]}]},this.styleStructure=[{style:{headerColor:"rgba(63, 167, 88, .9)",bodyColor:"rgba(41, 44, 47, 0.9)"},nodes:this._getNodesFormFolder(this.folderStructure.children[0])},{style:{headerColor:"rgba(198, 140, 65, 1)",bodyColor:"rgba(41, 44, 47, 0.9)"},nodes:this.layerNodes},{style:{headerColor:"rgba(48, 103, 205, .9)",bodyColor:"rgba(41, 44, 47, 0.9)"},nodes:this.conchNodes},{style:{headerColor:"rgba(58, 165, 167, .9)",bodyColor:"rgba(41, 44, 47, 0.9)"},nodes:this._getNodesFormFolder(this.folderStructure.children[3])}]}_getNodesFormFolder(e){const A=[],t=[e];for(;t.length;){const e=t.shift();e.nodes&&A.push(...e.nodes),e.children&&t.push(...e.children)}return A}_getStyleAndFolderData(){const e=e=>{if("function"==typeof e&&e.prototype instanceof this.BlueprintModules.BaseNode)return e.config.name},A=cloneDeepWith_1(this.folderStructure,e),t=cloneDeepWith_1(this.styleStructure,e),i=this.conchNodes.filter((e=>e.config.__conchData)).map((e=>e.config.name));return t.push({style:{headerColor:"rgba(108, 81, 184, .9)",bodyColor:"rgba(41, 44, 47, 0.9)"},nodes:i}),{folder:A,style:t}}getStyleAndFolderData(){return this._getStyleAndFolderData()}addLayerNode(e){this.animationNodeList.push(e)}addConchNodes(...e){return this.conchNodes.push(...e),this.conchNodes.sort(),this._getStyleAndFolderData()}removeConchNode(e){const A=this.conchNodes.findIndex((A=>A.config.name===e));return this.conchNodes.splice(A,1),this._getStyleAndFolderData()}addLayerNodes(...e){return this.layerNodes.push(...e),this.layerNodes.sort(),this._getStyleAndFolderData()}removeLayerNode(e){const A=this.layerNodes.findIndex((A=>A.config.name===e));return this.layerNodes.splice(A,1),this._getStyleAndFolderData()}getAllNodes(){return this._getNodesFormFolder(this.folderStructure)}}const icon$2="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgdHJhbnNmb3JtPSJzY2FsZSguOSkiIHdpZHRoPSIxNHB4IiBoZWlnaHQ9IjE1cHgiIHZpZXdCb3g9IjAgMCAxNCAxNSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4NCiAgICA8dGl0bGU+5YiH54mHPC90aXRsZT4NCiAgICA8ZyBpZD0i5pWw5o2uL+S6pOS6kumdouadv++8iDMzMC3mt7HvvIkiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPg0KICAgICAgICA8ZyBpZD0i6JOd5Zu+6IqC54K5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNTIuMDAwMDAwLCAtNDQuMDAwMDAwKSI+DQogICAgICAgICAgICA8ZyBpZD0i57yW57uELTIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQyLjAwMDAwMCwgMzkuNTAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Iue8lue7hCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi4wMDAwMDAsIDAuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDguMDAwMDAwLCA1LjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgeD0iMCIgeT0iMCIgd2lkdGg9IjE0IiBoZWlnaHQ9IjE0Ij48L3JlY3Q+DQogICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMS45MTc5NDcxLDEuNzUgTDEuOTE3OTQ3MSwxMC45Mzc1IEMxLjkxNzk0NzEsMTEuMzM4OTY4NiAyLjIxODM2NjY4LDExLjY3MDI3MDMgMi42MDY2NjQ3OCwxMS43MTg4NjQyIEwyLjcwNTQ0NzEsMTEuNzI1IEwxMy4xMjUsMTEuNzI1IEwxMy4xMjUsMTIuNzc1IEwyLjcwNTQ0NzEsMTIuNzc1IEMxLjczNDc0NjYyLDEyLjc3NSAwLjkzOTg0NzQ0LDEyLjAyMjMwNTIgMC44NzI1NjA3NDIsMTEuMDY4NzI2NyBMMC44Njc5NDcxMDIsMTAuOTM3NSBMMC44Njc5NDcxMDIsMS43NSBMMS45MTc5NDcxLDEuNzUgWiBNNS4xNjI1LDYuNTYyNSBMNS4xNjI1LDEwLjA2MjUgTDQuMTEyNSwxMC4wNjI1IEw0LjExMjUsNi41NjI1IEw1LjE2MjUsNi41NjI1IFogTTEyLjE2MjUsMi4xODc1IEwxMi4xNjI1LDEwLjA2MjUgTDExLjExMjUsMTAuMDYyNSBMMTEuMTEyNSwyLjE4NzUgTDEyLjE2MjUsMi4xODc1IFogTTguNjYyNSw0Ljc5NTEwMTQgTDguNjYyNSwxMC4wNjI1IEw3LjYxMjUsMTAuMDYyNSBMNy42MTI1LDQuNzk1MTAxNCBMOC42NjI1LDQuNzk1MTAxNCBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4NCiAgICAgICAgICAgICAgICAgICAgPC9nPg0KICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgIDwvZz4NCiAgICAgICAgPC9nPg0KICAgIDwvZz4NCjwvc3ZnPg==";function createConchNodeFromContainer(e){const A={},t=e.id,i=e.adapter.version,{actions:s=[]}=e.$uiApp?._options||{};s.forEach((({identified:e,label:i})=>{A[t+"/"+e]=i||e,A[`${t}/${e}.arg`]=`${i||e}数据`}));const n=createConchNode(e,t,i,s);return{local:A,node:n}}function createConchNode(e,A,t,i=[]){const{BaseNode:s}=getBlueprintConfig(),n=e.$uiApp,r=!isEmpty(n?.data),o=["data","updateData"],a={__conchChart:!0,icon:icon$2,name:A,version:t,inputs:[{name:"updateData",type:"exec",advanced:!0},{name:"data",type:"array",advanced:!0},{name:"updateOpts",type:"exec",advanced:!0},{name:"opts",type:"object",visible:!1}],outputs:[{name:"self",type:"conch"},{name:"data",type:"array",advanced:!0}]};return r||(a.inputs=a.inputs.filter((e=>!o.includes(e.name))),a.outputs=a.outputs.filter((e=>!o.includes(e.name)))),i.forEach((({identified:e})=>{a.outputs.push({name:e,type:"callback",advanced:!0}),a.outputs.push({name:e+".arg",type:"unknown",advanced:!0})})),class extends s{static config=a;isEntrance(){return!0}onStop(){super.onStop(),n._clearWaitAction()}onExecute(A,t,s){s.self=e,s.data=n.data,this.curExecName||i.forEach((({identified:e})=>{n._waitAction(e).done((A=>{s[e+".arg"]=A,this.run(e,s)}))})),"updateData"===this.curExecName&&t.data?(n.setData(t.data),s.data=t.data):"updateOpts"===this.curExecName&&t.opts&&n.setOption(t.opts)}}}const icon$1="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjE0cHgiIGhlaWdodD0iMTVweCIgdmlld0JveD0iMCAwIDE0IDE1IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPg0KICAgIDx0aXRsZT7liIfniYc8L3RpdGxlPg0KICAgIDxnIGlkPSLmlbDmja4v5Lqk5LqS6Z2i5p2/77yIMzMwLea3se+8iSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+DQogICAgICAgIDxnIGlkPSLok53lm77oioLngrkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01MC4wMDAwMDAsIC0xODQuMDAwMDAwKSI+DQogICAgICAgICAgICA8ZyBpZD0i57yW57uE5aSH5Lu9IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0Mi4wMDAwMDAsIDE3OS41MDAwMDApIj4NCiAgICAgICAgICAgICAgICA8ZyBpZD0iaWNvbl/ok53lm77ohJrmnKwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDguMDAwMDAwLCA1LjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiB4PSIwLjMxNDA5NzgxOCIgeT0iMC4zMTQwOTc4MTgiIHdpZHRoPSIxMy4zNzE4MDQ0IiBoZWlnaHQ9IjEzLjM3MTgwNDQiPjwvcmVjdD4NCiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEzLjIwNjc1MTksOC4zNjk3ODA5NyBMMTMuMjAxMDc1NSw4LjM2ODM2NTY5IEwxMy4xODg1MDQyLDguNDMyNDI0MDQgQzEzLjExODU5ODgsOC43NTQ1OTExMSAxMi45NTczNzU4LDkuMTk3MTQxMDkgMTIuNzA0ODM1MSw5Ljc2MDA3NDA3IEwxMC45MjUwNjMzLDcuMTc1MDEyNDUgTDEyLjM3OTc2ODIsNy4yMTUwODA5OCBDMTIuNTY1MDMwOCw0LjY2ODc5OTM3IDEwLjg5OTU1NTYsMi4yODIwNjY4MSA4LjMzNzc4NzYzLDEuNjQzMzQ2MyBDNS45NTEyODQ5MywxLjA0ODMyNDM1IDMuNDkwNzQ1MDIsMi4xNTk0MzI5OSAyLjM0MjA3OTg3LDQuMjgwMTUwMDIgTDIuMjQ2ODY3OTQsNC40NjQzODIwNCBMMS4zNDcxNzQ0NCw0LjAyMTI4OTk2IEMyLjY1NzkwODEsMS4zNTk4NTk5OSA1LjY2NTMxODExLC0wLjA1NjU2MjQ3MDcgOC41ODA0MDc1NCwwLjY3MDI1MDk1NSBDMTEuOTE3MzY0NiwxLjUwMjI0NzggMTMuOTczNjQ5NSw0LjgzMTg5OTYxIDEzLjI1MzMxNTksOC4xNjk1MzMzIEwxMy4yMDY3NTE5LDguMzY5NzgwOTcgWiIgaWQ9IuW9oueKtiIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+DQogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMi40NjI2NTYyLDEyLjEyODk0MzggTDEyLjQ1Njk3OTgsMTIuMTI3NTI4NSBMMTIuNDQ0NDA4NSwxMi4xOTE1ODY4IEMxMi4zNzQ1MDMxLDEyLjUxMzc1MzkgMTIuMjEzMjgwMSwxMi45NTYzMDM5IDExLjk2MDczOTQsMTMuNTE5MjM2OSBMMTAuMTgwOTY3NiwxMC45MzQxNzUyIEwxMS42MzU2NzI1LDEwLjk3NDI0MzggQzExLjgyMDkzNTEsOC40Mjc5NjIxNiAxMC4xNTU0NTk5LDYuMDQxMjI5NiA3LjU5MzY5MTk0LDUuNDAyNTA5MSBDNS4yMDcxODkyNCw0LjgwNzQ4NzE0IDIuNzQ2NjQ5MzMsNS45MTg1OTU3OCAxLjU5Nzk4NDE4LDguMDM5MzEyODIgTDEuNTAyNzcyMjUsOC4yMjM1NDQ4MyBMMC42MDMwNzg3NTEsNy43ODA0NTI3NSBDMS45MTM4MTI0MSw1LjExOTAyMjc4IDQuOTIxMjIyNDIsMy43MDI2MDAzMiA3LjgzNjMxMTg1LDQuNDI5NDEzNzUgQzExLjE3MzI2ODksNS4yNjE0MTA1OSAxMy4yMjk1NTM4LDguNTkxMDYyNDEgMTIuNTA5MjIwMiwxMS45Mjg2OTYxIEwxMi40NjI2NTYyLDEyLjEyODk0MzggWiIgaWQ9IuW9oueKtuWkh+S7vSIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2LjYyNzk1MiwgOC44Nzk1ODEpIHNjYWxlKC0xLCAtMSkgdHJhbnNsYXRlKC02LjYyNzk1MiwgLTguODc5NTgxKSAiPjwvcGF0aD4NCiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTUuNjY5MDI0Myw3LjM1MDUyMzEgTDUuNjY5MDI0Myw3LjgzNDYwMjA1IEw5Ljc0ODA0MDIxLDcuODM0NjAyMDUgTDkuNzQ4MDQwMjEsOC44MzQ2MDIwNSBMNS42NjkwMjQzLDguODM0NjAyMDUgTDUuNjY5MDI0Myw5LjE3NzcyNzkzIEw0LjI1MTk1OTc5LDguMjY0MTI1NTEgTDUuNjY5MDI0Myw3LjM1MDUyMzEgWiBNOC4zMzA5NzU3LDQuODIyMjcyMDcgTDkuNzQ4MDQwMjEsNS43MzU4NzQ0OSBMOC4zMzA5NzU3LDYuNjQ5NDc2OSBMOC4zMzA5NzU3LDYuMzA2MzUxMDMgTDQuMjUxOTU5NzksNi4zMDYzNTEwMyBMNC4yNTE5NTk3OSw1LjMwNjM1MTAzIEw4LjMzMDk3NTcsNS4zMDYzNTEwMyBMOC4zMzA5NzU3LDQuODIyMjcyMDcgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+DQogICAgICAgICAgICAgICAgPC9nPg0KICAgICAgICAgICAgPC9nPg0KICAgICAgICA8L2c+DQogICAgPC9nPg0KPC9zdmc+";function createDataReceiverNodeFromContainer(e){const{BaseNode:A}=getBlueprintConfig(),t=e.id;return{node:class extends A{static config={__conchData:!0,icon:icon$1,name:t,inputs:[],outputs:[{name:"data",type:"array"}]};onExecute(A,t,i){i.data=e.$uiApp.data}}}}function getConchNodes(e=[]){const A=[],t={dataUpdate:"数据更新",updateData:"更新数据",updateOpts:"更新配置项",dataChanged:"请求完成或数据变化",opts:"配置项",data:"数据",self:"实例"};for(const i of e)if(i.adapter){const{node:e,local:s}=createChartNode(i);A.push(e),Object.assign(t,s)}return{nodes:A,locals:t}}function createChartNode(e){const A={};A[e.id]=e.name;const{node:t,local:i={}}=isDataComponent(e)?createDataReceiverNodeFromContainer(e):createConchNodeFromContainer(e);return{local:{...A,...i},node:t}}function isDataComponent(e){return e.adapter.$dataAdapter}function createLayersNode(e=[]){const{BaseNode:A}=getBlueprintConfig(),t={},i=[];e.forEach((e=>{const{name:A}=e;t[A]=e,i.push(A)}));return{node:class extends A{static config={name:"Layers",inputs:[{name:"switch",type:"exec"},{name:"layer",type:"select",value:i}],outputs:[{name:"next",type:"exec"}]};onExecute(e,A,i){t[A.layer].select()}}}}const icon="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjE0cHgiIGhlaWdodD0iMTVweCIgdmlld0JveD0iMCAwIDE0IDE1IiB2ZXJzaW9uPSIxLjEiIHRyYW5zZm9ybT0ic2NhbGUoLjg4KSI+DQogIDx0aXRsZT5pY29uX+WbvuWxgjwvdGl0bGU+DQogIDxnIGlkPSLmlbDmja4v5Lqk5LqS6Z2i5p2/77yIMzMwLea3se+8iSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+DQogICAgPGcgaWQ9IuiTneWbvuiKgueCuSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTQyNi4wMDAwMDAsIC0xODQuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4NCiAgICAgIDxnIGlkPSLnvJbnu4QtNOWkh+S7vSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDE2LjAwMDAwMCwgMTc5LjUwMDAwMCkiPg0KICAgICAgICA8ZyBpZD0i57yW57uE5aSH5Lu9LTMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIuMDAwMDAwLCAwLjAwMDAwMCkiPg0KICAgICAgICAgIDxnIGlkPSJpY29uX+WbvuWxgiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOC4wMDAwMDAsIDUuMDAwMDAwKSI+DQogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjMDAwMDAwIiBvcGFjaXR5PSIwIiB4PSIwIiB5PSIwIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPjwvcmVjdD4NCiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xLjIwMTM3NSw5LjMxNjYwOTIyIEw2LjQzMzc2NjcyLDEyLjE1NTUyMDIgQzYuNzQ1NTkyMDcsMTIuMzI0Njc3NSA3LjExNjM3OTgxLDEyLjM0NDQ2MyA3LjQ0MzU4NTc3LDEyLjIxMDgwOTUgTDcuNTU5MDEwOTUsMTIuMTU2MDY0MyBMMTIuNzUzMTI1LDkuMzE3NDg0MjIgTDEzLjI5ODI1LDEwLjMxNTg1OTIgTDguMTA4NzYxMjgsMTMuMTUyMDY1MiBDNy40Njk0MTUyNiwxMy41MDEzNjk1IDYuNzAzNzczNCwxMy41Mjk0OTcgNi4wNDE3MDc5NCwxMy4yMzAwMzU3IEw1Ljg4ODU2NTgxLDEzLjE1MzkxOTkgTDAuNjU4ODc1LDEwLjMxNjczNDIgTDEuMjAxMzc1LDkuMzE2NjA5MjIgWiBNMS4yMDEzNzUsNi41MDg3MzQyMiBMNi40MzM3NjY3Miw5LjM0ODM4Njk2IEM2Ljc0NTU5MjA3LDkuNTE3NTQ0MzMgNy4xMTYzNzk4MSw5LjUzNzMyOTgzIDcuNDQzNTg1NzcsOS40MDM2NzYzNCBMNy41NTkwMTA5NSw5LjM0ODkzMTA3IEwxMi43NTMxMjUsNi41MTA0ODQyMiBMMTMuMjk4MjUsNy41MDg4NTkyMiBMOC4xMDg3NjEyOCwxMC4zNDQ5MzIgQzcuNDY5NDE1MjYsMTAuNjk0MjM2MyA2LjcwMzc3MzQsMTAuNzIyMzYzOCA2LjA0MTcwNzk0LDEwLjQyMjkwMjUgTDUuODg4NTY1ODEsMTAuMzQ2Nzg2NyBMMC42NTgsNy41MDg4NTkyMiBMMS4yMDEzNzUsNi41MDg3MzQyMiBaIE03Ljg1NTE3MDUxLDAuNjc3NTkzNzcyIEw3Ljk4NTM0MjQzLDAuNzQ0NDQ1OTI3IEwxMi41Mzc4MjYsMy4zMDM0NzU4OCBMMTIuNjI1Nzc5NiwzLjM1OTQwNjkgQzEyLjk4OTIzMDIsMy42MTk0NzU1NyAxMy4xMjA3Nzk2LDQuMTAyMTc3NCAxMi45NDA3NDI0LDQuNTE1ODQ1MTYgTDEyLjg5MzYyOCw0LjYwOTk0ODc0IEwxMi44MjE0MjEsNC43MTkwNDc0MiBDMTIuNzY4NjE5Niw0Ljc4ODI0NTE4IDEyLjcwNjc3MzQsNC44NTAwOTEzNiAxMi42Mzc1NzU2LDQuOTAyODkyOCBMMTIuNTI4NDc2OSw0Ljk3NTA5OTc3IEw3Ljk0ODk2NzQ5LDcuNTgxOTA1MTggTDcuODE4MDUwMzYsNy42NTAxNDUwOSBDNy4yODcwNzE0NSw3LjkwMjM1NzE0IDYuNjczMDU2OTMsNy45MDU1NzU2NyA2LjE0NDgyOTQ5LDcuNjU4OTg2MjYgTDYuMDE0NjU3NTcsNy41OTIxMzQxMSBMMS40NjIxNzM5OSw1LjAzMzEwNDE2IEwxLjM3NDIyMDQ1LDQuOTc3MTczMTQgQzAuOTgyODEyMDg1LDQuNjk3MDk5MTkgMC44NjAzNTQyMTMsNC4xNTg4MjM0NiAxLjEwNjM3MjAyLDMuNzI2NjMxMyBDMS4xNzEzNzIxNSwzLjYxMjQ0MjIxIDEuMjU4NjI3NzMsMy41MTI4ODk0IDEuMzYyNDI0MzcsMy40MzM2ODcyMyBMMS40NzE1MjMwNSwzLjM2MTQ4MDI2IEw2LjA1MTAzMjUxLDAuNzU0Njc0ODUgTDYuMTgxOTQ5NjQsMC42ODY0MzQ5NDQgQzYuNzEyOTI4NTUsMC40MzQyMjI4OTQgNy4zMjY5NDMwNywwLjQzMTAwNDM2OCA3Ljg1NTE3MDUxLDAuNjc3NTkzNzcyIFogTTYuNzU4OTQyMDcsMS41ODE1ODExOCBMNi42NjcyODIzMiwxLjYxNzUzNzYxIEw2LjU3MDQ2Njk4LDEuNjY3MTkyMTYgTDIuMTIxMDg2NDQsNC4xOTg5MjU5MyBMNi41MjkxNjU3OCw2LjY3NjgzMDE3IEM2Ljc1MjU5NDQ5LDYuODAyNDIzMzIgNy4wMTk5NjE0Nyw2LjgyNTU2ODcxIDcuMjQxMDU3OTMsNi43NTQ5OTg4NSBMNy4zMzI3MTc2OCw2LjcxOTA0MjQyIEw3LjQyOTUzMzAyLDYuNjY5Mzg3ODggTDExLjg3ODg5NDksNC4xMzY0MzUzNyBMNy40NzA4MzQyMiwxLjY1OTc0OTg2IEM3LjI0NzQwNTUxLDEuNTM0MTU2NzEgNi45ODAwMzg1MywxLjUxMTAxMTMyIDYuNzU4OTQyMDcsMS41ODE1ODExOCBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+DQogICAgICAgICAgPC9nPg0KICAgICAgICA8L2c+DQogICAgICA8L2c+DQogICAgPC9nPg0KICA8L2c+DQo8L3N2Zz4NCg==";function getLayerNodes(e){const A=[],t={self:"实例"};for(const i of e){const{node:e,local:s}=createLayerNode(i);A.push(e),Object.assign(t,s)}return{nodes:A,locals:t}}function createLayerNode(e){return{node:createLayerBlueprintNode(e),local:{[e.id]:e.name}}}function createLayerBlueprintNode(e){const{BaseNode:A}=getBlueprintConfig(),t={name:e.id,icon:icon,outputs:[{name:"self",type:"layer"}]};return class extends A{static config=t;isEntrance(){return!0}onExecute(A,t,i){i.self=e}}}const locals$1={Visibility:"显隐",Translate:"移动",Layers:"图层切换",Rotate:"旋转",GetData:"获取data",GetOpts:"获取配置",DataProcess:"数据处理",LayersCarousel:"图层轮播",conch:"目标",show:"显示",hide:"隐藏",toggle:"切换",visibleToggle:"显隐切换",duration:"时长",easing:"速率",delay:"延时",animationType:"动画类型",clicked:"点击",done:"完成",array:"数组",layers:"图层数组",stop:"停止"},locals={GreaterThanOrEqualTo:"A>=B",LessThanOrEqualTo:"A<=B",DeepEqualTo:"A==B","DeepEqualTo/result":"","GreaterThanOrEqualTo/result":"","LessThanOrEqualTo/result":"","StrictEqualTo/result":""},config={};function getBlueprintConfig(){return config}class BluePrintManager{constructor(e,A,t){this.ui=e,this.Blueprint=A,this.BlueprintModules=t,config.Blueprint=A,config.BlueprintModules=t,config.BaseNode=t?.BaseNode,this.blueprint=null,this.editor=null,this.nodeCollections=null,this._running=A&&t}init(){if(!this._running)return void console.warn("无法初始化蓝图，需要蓝图");this.blueprint=new this.Blueprint,this.nodeCollections=new BlueprintNodes(this.BlueprintModules);const{node:e}=createLayersNode();this.nodeCollections.addLayerNode(e),this.blueprint.registerNode(this.nodeCollections.getAllNodes()),this.ui.$options.isEdit&&(this.editor=this.blueprint.getEditor(),this.editor.loadLocalData({Print:"打印",String:"字符串",Begin:"开始",start:"开始",value:"值",exec:"执行",next:"下一步",result:"结果",Array:"数组",GetItemFromArray:"获取数组项",index:"索引",Sequence:"序列",sequenceInput:"",Timer:"定时器",interval:"每隔（毫秒）",Branch:"分支",condition:"条件",ForEachLoop:"迭代数组",element:"元素",loop:"迭代",completed:"迭代完成",...locals$1,...locals})),this.ui.$on("mounted:Canvas",this.mountedCanvasEvent,this),this.ui.$on("beforeDestroy:Canvas",this.beforeDestroyCanvasEvent,this)}mountedCanvasEvent(e){this.initNodes(e),this.updateLayer(),this.editor&&(this.ui.$on("adapterCompleted",this.chartCreate,this),this.ui.$on("beforeDestroyAdapter",this.chartDestroy,this),this.ui.$on("updatedAdapter",this.chartUpgrade,this),this.ui.$on("mounted:Layer",this.layerCreate,this),this.ui.$on("beforeDestroy:Layer",this.layerDestroy,this),this.ui.$on("update",this.updateEvent,this))}beforeDestroyCanvasEvent(e){this.editor&&(this.ui.$off("adapterCompleted",this.chartCreate,this),this.ui.$off("beforeDestroyAdapter",this.chartDestroy,this),this.ui.$off("updatedAdapter",this.chartUpgrade,this),this.ui.$off("mounted:Layer",this.layerCreate,this),this.ui.$off("beforeDestroy:Layer",this.layerDestroy,this),this.ui.$off("update",this.updateEvent,this)),this._destroyNodes(e)}initNodes(e){const A=e.containers,t=e.layers,{nodes:i,locals:s}=getConchNodes(A),{nodes:n,locals:r}=getLayerNodes(t),{style:o,folder:a}=this.nodeCollections.addConchNodes(...i),{folder:l,style:c}=this.nodeCollections.addLayerNodes(...n);this.blueprint.registerNode([...i,...n]),this.editor&&(this.editor.loadStyle([...o,...c]),this.editor.loadFolder({...a,...l}),this.editor.loadLocalData({...s,...r}))}_destroyNodes(e){const A=e.containers,t=e.layers;if(A.forEach((e=>{this.blueprint.unregisterNode(e.id),this.nodeCollections.removeConchNode(e.id)})),t.forEach((e=>{this.blueprint.unregisterNode(e.id),this.nodeCollections.removeLayerNode(e.id)})),this.editor){const{folder:e,style:A}=this.nodeCollections.getStyleAndFolderData();this.editor.loadStyle(A),this.editor.loadFolder(e)}}chartCreate(e){e&&this.createBlueprintNode({comp:e.$parent,createFn:createChartNode,addFn:"addConchNodes"})}chartUpgrade(e){const A=createChartNode(e);if(A){const{node:e,local:t}=A;this.blueprint.updateNode(e),this.editor.loadLocalData(t)}}chartDestroy(e){this.destroyBlueprintNode({comp:e.$parent,fn:"removeConchNode"})}addToBluePrint(e){this.editor.addNode(e.id)}addLayerToBluePrint(e){this.editor.addNode(e.id)}updateLayer(){const e=createLayersNode(this.ui.$canvas.children);e&&this.blueprint.updateNode(e.node)}layerCreate(e){this.createBlueprintNode({comp:e,createFn:createLayerNode,addFn:"addLayerNodes"}),this.updateLayer()}containerChangeName(e,A){this.editor.loadLocalData({[e.id]:A})}layerChangeName(e,A){this.editor.loadLocalData({[e.id]:A}),this.updateLayer()}updateEvent(e,A,t){if("name"===A)switch(e.type){case"Container":this.containerChangeName(e,t);break;case"Layer":this.layerChangeName(e,t)}}layerDestroy(e){this.destroyBlueprintNode({comp:e,fn:"removeLayerNode"}),this.updateLayer()}createBlueprintNode(e){const{createFn:A,addFn:t,comp:i}=e,s=A(i);if(s){const{node:e,local:A}=s;this.blueprint.registerNode(e),this.editor.loadLocalData(A);const{folder:i,style:n}=this.nodeCollections[t](e);this.editor.loadStyle(n),this.editor.loadFolder(i)}}destroyBlueprintNode(e){const{fn:A,comp:t}=e;this.blueprint.unregisterNode(t.id);const{folder:i,style:s}=this.nodeCollections[A](t.id);this.editor.loadStyle(s),this.editor.loadFolder(i)}run(e){if(this._running&&e)try{const A=JSON.parse(e);A&&Object.keys(A).length&&this.blueprint.run(A)}catch(e){console.error("蓝图运行异常",e)}}toJSON(){return this.editor.toJson()}}const baseType=Math.random().toString(36).substr(-8);let baseId=Math.round(100*Math.random());function getUID(e="ui"){return e=e+"-"+(baseType+baseId),baseId++,e}function getElement(e){return!!e&&(e instanceof HTMLElement?e:document.querySelector(e))}function createElement(e="div"){return document.createElement(e)}function createElementWithAttr(e="div",A={},t={}){var i,s,n=document.createElement(e),r=(e=Object.keys(A),Object.keys(t));for(i of e)n.style[i]=A[i];for(s of r)n.dataset[s]=t[s];return n}function mount(e,A,t){var i="before"===t||"after"===t?A.el:A.contentEl;unmount(e),mountElement(e.el,i||A.el,t),e._isMounted=!0}function mountElement(e,A,t){"before"===t?A.parentNode.insertBefore(e,A):"after"===t?(t=A.nextSibling)?mountElement(e,t,"before"):mountElement(e,A.parentNode):A.appendChild(e)}function unmount(e){e.el&&e.el.parentNode&&e.el.parentNode.removeChild(e.el),e._isMounted=!1}function updateStyle(e){var A=e.style.getDirtyStyleList();return A.forEach((A=>{e.el.style[A.name]=A.value})),A}const LAYOUT_MAP={UI:"UI",CANVAS:"Canvas",LAYER:"Layer",GROUP:"Group",CONTAINER:"Container",DEFAULTCONTAINER:"DefaultContainer"},defaultConfig={[LAYOUT_MAP.UI]:{type:LAYOUT_MAP.UI,theme:{ui:{background:"#fff"},mask:{background:"transparent",opacity:1,defaultContainer:{}},ruler:{border:"1px solid #000000",color:"#565656",width:21,lineStyle:{color:"#EAB2B3",activeColor:"#ED9692",width:1},tick:{textFont:"9px sans-serif",textColor:"#fff",lineWidth:1,lineColor:"#fff",lineLong:16,lineShort:4},iconColor:"#c1c1c1",icon:{color:"#c1c1c1",borderStyle:"solid",borderWidth:"0px 0px 1px 0px",borderColor:"#000000"}},alignmentLines:{color:"#ff3366",width:1,distanceStyle:{color:"#CCFF99",width:1}},bound:{rectColor:"#007AFF",rectStyle:"solid",handleColor:"#007AFF",labelColor:"#FFFFFF",labelBackground:"#007AFF",container:{},group:{},layer:{},multSelect:{}}}},[LAYOUT_MAP.CANVAS]:{type:LAYOUT_MAP.CANVAS,inStack:!0,isLock:!0},[LAYOUT_MAP.LAYER]:{type:LAYOUT_MAP.LAYER,inStack:!0,isLock:!0},[LAYOUT_MAP.GROUP]:{type:LAYOUT_MAP.GROUP,inStack:!0,isLock:!1},[LAYOUT_MAP.CONTAINER]:{type:LAYOUT_MAP.CONTAINER,inStack:!0,isLock:!1}},defaultOption={[LAYOUT_MAP.CANVAS]:{baseOption:{ignoreRendering:!1,style:{position:"relative",width:1920,height:1080,backgroundColor:"black",transformOrigin:"0 0"}}},[LAYOUT_MAP.LAYER]:{baseOption:{ignoreRendering:!1,style:{position:"absolute",top:0,left:0,width:1e3,height:1e3}}},[LAYOUT_MAP.GROUP]:{baseOption:{}},[LAYOUT_MAP.CONTAINER]:{baseOption:{ignoreRendering:!1,penetrateOnplay:!1,style:{position:"absolute",top:30,left:30,width:200,height:200}}}},COMMAND_TYPE={MOVE:"Move",STYLE:"Style",ATTRIBUTE:"Attribute",CREATEGROUP:"CreateGroup",UNGROUP:"UnGroup",UNGRAPHOBJECT:"UnGraphObject",CREATEGRAPHOBJECT:"CreateGraphObject",UNGRAPGOBJECT:"UnGraphObject",DRAG:"Drag",ALIGN:"Align",ROTATE:"Rotate"},CANVAS_SCALE_MODE={SCROLL:0,SCALEALL:1,SCALEWIDTH:2,SCALEHEIGHT:3},CANVAS_MODE={PLAY:0,EDIT:1},MASK_STYLE={position:"absolute",top:0,left:0,width:"100%",height:"100%"},CURSOR_STYLE=["ns-resize","ns-resize","ew-resize","ew-resize","nwse-resize","nesw-resize","nesw-resize","nwse-resize"],TRANSITIONTYPE={ENTER:"enter",LEAVE:"leave"},EVENT_KEY={DOWN:"down",MOVE:"move",UP:"up"},EVENT_CHECK={CANDOWN:"canDown",CANMOVE:"canMove",CANUP:"canUp",ISSTOP:"isStopPropagation",ISPREVENT:"isPreventDefault"};function confirmArr(e){return Array.isArray(e)&&0<e.length}function isType$1(e,A){return Object.prototype.toString.call(e).includes(A)}function isDef(e){return null!=e}function isUnDef(e){return null==e}function isNumber(e){return"number"==typeof e&&!isNaN(e)}function hasOwn(e,A){return Reflect.has(e,A)}function isPlainObject(e){return isType$1(e,"Object")}function merge(...e){let A=e.shift();isPlainObject(A)||(A={});for(const t of e)if(isPlainObject(t))for(const e in t)t.hasOwnProperty(e)&&(A[e]=mergeCore(A[e],clone(t[e])));return A}function mergeCore(e,A){if(!isPlainObject(e)||!isPlainObject(A))return A;for(const t in A)A.hasOwnProperty(t)&&(e[t]=mergeCore(e[t],A[t]));return e}function findIndex(e,A){return e.findIndex((e=>e.data===A))}function find(e,A){for(const t of e)if(t.source===A)return t;return null}function clone(e,A){if(!isPlainObject(e))return e;A=A||[];var t=Array.isArray(e)?[]:{},i=find(A,e);if(i)return i.target;A.push({source:e,target:t});for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(isPlainObject(e[i])?t[i]=clone(e[i],A):t[i]=e[i]);return t}function initialCapital(e){return e.charAt(0).toUpperCase()+e.slice(1)}const isMac=-1<window.navigator.userAgent.indexOf("Mac OS X");function getSvg(e,A,t){return isDef(A)&&isDef(t)?`url(data:image/svg+xml;base64,${btoa(decodeURIComponent(encodeURIComponent(e)))}\n    ) ${A} ${t},default`:`url(data:image/svg+xml;base64,${btoa(decodeURIComponent(encodeURIComponent(e)))}\n    )`}function checkMouseBtnType(e,A){switch(A){case"left":return 1===e.buttons;case"right":return 2===e.buttons;case"center":return 4===e.buttons}}function getMouseBtnType(e){switch(isType$1(e,"Number")?e:e.buttons){case 1:return"left";case 2:return"right";case 4:return"center";case 0:return""}}function checkRegExp(e,A){return!isUnDef(e)&&!isUnDef(A)&&new RegExp(e).test(A)}const dateStyle={info:"background:#606060;color:#fff;",warn:"background:#E9A400;color:#fff;",error:"background:#EC3941;color:#fff;"};function logStyle(e){return[dateStyle[e],"background:#1375B2;color:#fff;"]}function date(){var e=new Date;return e.toLocaleDateString()+" "+e.toLocaleTimeString()}class Log$1{info(...e){this._recordLog("info",...e)}warn(...e){this._recordLog("warn",...e)}error(...e){this._recordLog("error",...e)}_recordLog(e,...A){window.console[e](`%c [THING.UI ${e}] %c ${date()} `,...logStyle(e),...A)}memory(){var e,A,t,i=performance.memory;i&&(e=e=>e/1024/1024+"M",({jsHeapSizeLimit:i,totalJSHeapSize:A,usedJSHeapSize:t}=i),console.table({max:e(i),has:e(A),used:e(t)}))}}var log=new Log$1;const _getType=e=>"ui"===(e=e.toLowerCase())?e:e+"s",displayables=new Map;class Data{constructor(){this.init(),this.nameMapping=new Map}init(){Object.keys(LAYOUT_MAP).forEach((e=>{displayables.set(_getType(e),new Set)}))}add(e){var A=_getType(e.type);displayables.get(A).add(e),this.setName(e)}remove(e){var A=_getType(e.type);(A=displayables.get(A)).size&&(A.has(e)&&A.delete(e),e.name)&&(A=this.getByName(e.name)).splice(A.indexOf(e),1)}setName(e){var A=e.name;A&&(this.nameMapping.has(A)||this.nameMapping.set(A,[]),(A=this.nameMapping.get(e.name)).find((A=>A.id===e.id))||A.push(e))}clear(){this.nameMapping.clear(),this.init()}getByName(e){return this.nameMapping.get(e)}getByType(e){return displayables.get(e)}}class Node$1{constructor(e){this.data=e,this.parent=null,this.children=[]}}const idMapping=new Map;class Tree{constructor(){return this._root=null,this.idMapping=idMapping,Tree.instance||(Tree.instance=this),Tree.instance}add(e,A){var t=new Node$1(e);idMapping.set(e.id,t),null===this._root?this._root=t:(e=this.getNodeById(A.id),(t.parent=e).children.push(t))}remove(e){var A=this.getNodeById(e.parent.id),t=findIndex(A.children,e);if(t<0)throw new Error("要删除节点不存在");return A.children.splice(t,1),idMapping.delete(e.id),!0}edit(e,A){var t=this.getNodeById(A.parent.id),i=findIndex(t.children,A);switch(e){case"prev":return i<=0?null:t.children[i-1];case"next":return i<0||t.children.length===i+1?null:t.children[i+1];default:throw new Error("此操作无效")}}move(e,A,t){var i=this.getNodeById(A.parent.id);let s=null;var n=this.getNodeById(e.parent.id),r=findIndex(n.children,e),o=this.getNodeById(e.id);switch(t){case"before":n.children.splice(r,1),o.data.parent=i.data,o.parent=i,s=findIndex(i.children,A),i.children.splice(s,0,o);break;case"after":n.children.splice(r,1),o.data.parent=i.data,o.parent=i,s=findIndex(i.children,A),i.children.splice(s+1,0,o);break;default:var a=this.getNodeById(A.id);n.children.splice(r,1),o.data.parent=a.data,(o.parent=a).children.push(o)}}clear(){this._root=null,idMapping.clear()}hasNodeById(e){return idMapping.has(e)}getNodeById(e){return idMapping.get(e)}}class DB{constructor(){this.data=new Data,this.tree=new Tree,this.selects=new Set}}var db=new DB;const stacks=new WeakMap;class Stack{constructor(){return stacks.set(this,[]),Stack.instance||(Stack.instance=this),Stack.instance}push(e){this.get().push(e)}pop(){return this.get().pop()}shift(){this.get().shift()}peek(){var e=this.get();return e[e.length-1]}size(){return this.get().length||0}isEmpty(){return!this.size()}clear(){stacks.set(this,[])}print(){return Array.from(this.get().values())}get(){return stacks.get(this)}set(e){stacks.set(this,e)}}const printStackLog$5=localStorage.getItem("printStackLog"),Attribute=e=>{const A=e[0];let t=e[1];return{type:"Attribute",redo(e,i){t=attr("Redo",t,A),e&&e.apply(i,[t])},undo(e,i){t=attr("Undo",t,A),e&&e.apply(i,[t])}}};function attr(e,A,t){return printStackLog$5&&log.info(`[${e} Attribute]: ${t.id}撤销`+("show"===A?"“隐藏”":"“显示”")),"show"===A?(t.visible=!1,t._setVisible(!1),selector.clear(),"hidden"):(t.visible=!0,t._setVisible(!0),selector.select(t),"show")}const printStackLog$4=localStorage.getItem("printStackLog"),Drag=e=>{const A=selector.getContainers(),t=selector.getSelectElements(),i=A.map((e=>e.bound.record)),s=[];return{type:"Drag",redo(e){printStackLog$4&&log.info(`[Redo Drag]: ${A.map((e=>e.id))}恢复“拖拽”`),selector.select(t),A.forEach(((e,A)=>{e.setBound(s[A])})),selector.select(t),e&&e(this.type,t,A)},undo(e){printStackLog$4&&log.info(`[Undo Drag]: ${A.map((e=>e.id))}撤销“拖拽”`),selector.select(t),A.forEach(((e,A)=>{s[A]=clone(e.bound),e.setBound(i[A])})),selector.select(t),e&&e(this.type,t,A)}}},printStackLog$3=localStorage.getItem("printStackLog"),Align$1=e=>{const A=e[0].map((e=>"Group"===e.type?e.containers:e)).flat(1/0),t=A.map((e=>e.bound.record)),i=[];return{type:"Align",redo(e){printStackLog$3&&log.info(`[Redo Align]: ${A.map((e=>e.id))}恢复“对齐”`),A.forEach(((e,A)=>{e.setBound(i[A])})),e&&e(this.type,A)},undo(e){printStackLog$3&&log.info(`[Undo Align]: ${A.map((e=>e.id))}撤销“对齐”`),A.forEach(((e,A)=>{i[A]=clone(e.bound),e.setBound(t[A])})),e&&e(this.type,A)}}},printStackLog$2=localStorage.getItem("printStackLog"),Rotate=e=>{const A=e[0].map((e=>"Group"===e.type?e.containers:e)).flat(1/0),t=A.map((e=>e.bound.record)),i=[];return{type:"Rotate",redo(e){printStackLog$2&&log.info(`[Redo Rotate]: ${A.map((e=>e.id))}恢复“旋转”`),A.forEach(((e,A)=>{e.setBound(i[A])})),selector.select(A),e&&e(this.type,A)},undo(e){printStackLog$2&&log.info(`[Undo Rotate]: ${A.map((e=>e.id))}撤销“旋转”`),A.forEach(((e,A)=>{i[A]=clone(e.bound),e.setBound(t[A])})),selector.select(A),e&&e(this.type,A)}}},printStackLog$1=localStorage.getItem("printStackLog"),cache={[COMMAND_TYPE.CREATEGRAPHOBJECT]:"",[COMMAND_TYPE.UNGRAPHOBJECT]:"",[COMMAND_TYPE.MOVE]:"",[COMMAND_TYPE.STYLE]:"",[COMMAND_TYPE.ATTRIBUTE]:Attribute,[COMMAND_TYPE.CREATEGROUP]:"",[COMMAND_TYPE.UNGROUP]:"",[COMMAND_TYPE.DRAG]:Drag,[COMMAND_TYPE.ALIGN]:Align$1,[COMMAND_TYPE.ROTATE]:Rotate};class GenerateExecution{constructor(){this.commands=null,this.cache=cache,this.init()}init(){this.commands=this.initCommands()}initCommands(){const e={};return Object.values(COMMAND_TYPE).forEach((A=>{e[A]=commandFn(A)})),e}addCommandType(e){var A;return!(!e||!isType$1(e,"String")||(A=e.toUpperCase(),!isUnDef(COMMAND_TYPE[A]))||(COMMAND_TYPE[A]=e,this.cache[e]="",this.commands[e]=commandFn(e),0))}}function commandFn(e){return A=>{if(isUnDef(cache[e]))throw Error(`[Error UndoRedo]: ${e}操作类型未定义`);if(""!==cache[e])return cache[e](A);{A[0]=A[0]||{};const{undo:t,redo:i,param:s}=A[0];return{type:e,redo(A,t){printStackLog$1&&log.info(`[Redo ${e}]`),i&&i(...s),A&&A.apply(t,[e,...s])},undo(A,i){printStackLog$1&&log.info(`[Undo ${e}]`),t&&t(...s),A&&A.apply(i,[e,...s])},destroy(){s&&s[0]&&s[0]._destroyTruthy&&s[0]._destroyTruthy()}}}}}var generateExecution=new GenerateExecution;const printStackLog=localStorage.getItem("printStackLog");let Command$1=class{constructor(){this.stack=new Stack,this.position=-1,this.maximum=100,this.commands=generateExecution.commands}setMaximum(e){return!(!isType$1(e,"Number")||e===this.maximum||(this.maximum=e,0))}execute(e,...A){var t,i;return!!this.commands[e]&&!!(t=this.commands[e](A))&&(-1<=this.position&&this.position<this.stack.size()-1&&this._clearRedo(),this.stack.size()>=this.maximum&&("UnGraphObject"!==(i=this.stack.get()[0]).type&&"UnGroup"!==i.type||i.destroy(),this.stack.shift(),this.position--),t.store=this.store,this.stack.push(t),this.position++,printStackLog&&log.info(`[execute ${e}]`,-1<e.indexOf("Create")?A[0].id||A[0].param[0].id:A),!0)}undo(e,A){return 0<=this.position&&(this.get().undo(e,A),this.position--,!0)}redo(e,A){return this.position<this.stack.size()-1&&(this.position++,this.get().redo(e,A),!0)}canRedo(){return this.position<this.stack.size()-1}canUndo(){return 0<=this.position}clear(){this.stack.clear(),this.position=-1}get(){return this.stack.get()[this.position]}_clearRedo(){var e=this.stack.get().slice(0,this.position+1);for(const e of this.stack.get().slice(this.position-this.stack.size()+1).reverse())"CreateGraphObject"!==e.type&&"CreateGroup"!==e.type||e.destroy();this.stack.set(e)}};var command=new Command$1;function mergeOption(e,A={},t={}){return merge({},defaultOption[e],{config:defaultConfig[e]},{baseOption:A,config:t})}function _applyMixin(e,A){A=A.prototype||A,Object.getOwnPropertyNames(A).forEach((t=>{"constructor"!==t&&(e.prototype[t]=A[t])}))}function applyMixins(e,A){Array.isArray(A)?A.forEach((A=>{_applyMixin(e,A)})):_applyMixin(e,A)}class LayoutManager{constructor(){this.layoutMap=new Map}register(e,A){return 2!==arguments.length?console.warn("注册需要的参数不对"):this.layoutMap.has(e)?console.warn(e+" 已经存在，无法注册"):(this.layoutMap.set(e,A),!0)}mixin(e,A){this.layoutMap.forEach(((t,i)=>{i.toUpperCase()===e.toUpperCase()&&applyMixins(t,A)}))}createLayout(e,A,t,i={}){if(this.layoutMap.has(A))return A===LAYOUT_MAP.GROUP&&(i.isAlone=!0),this.layoutMap.get(A).factoryConfig(e,t,i);throw new Error(A+" 还未注册，需要先注册后才能使用")}parseLayout(e,A,t){const i=this.createLayout(e,A.type,A.option,t);return A.children&&A.children.forEach((e=>{this.parseLayout(i,e,{inStack:!1})})),i}checkLayoutType(e,A){return isType$1(A,"Array")?A.some((A=>!isUnDef(A=this.layoutMap.get(A))&&e instanceof A)):!isUnDef(A=this.layoutMap.get(A))&&e instanceof A}}var layoutManager=new LayoutManager;class Hook{constructor(e,A){this.instance=e,this.hooks=A;for(const e of this.hooks)this[e+"List"]=[]}tap(e,A){return!!this.getIncludes(e)&&("function"==typeof A&&(this[e+"List"]||(this[e+"List"]=[]),this[e+"List"].push(A.bind(this.instance,{instance:this.instance}))),!0)}call(e,...A){if(!this.getIncludes(e))return log.warn(e+" hook has not been registered"),!1;for(const t of this[e+"List"])try{t(...A)}catch(A){log.error(`Error in ${e} hook:`,A)}return!0}register(e,A){if("object"==typeof e&&null!==e)for(const A in e)this.register(A,e[A]);this.getIncludes(e)?log.warn(e+" hook has been registered"):this.hooks.push(e),this.tap(e,A)}unregister(e){var A=this.getIndexOf(e);if(-1===A)throw new Error("this hook has been registered");delete this[e+"List"],this.hook.splice(A,1)}destroy(){this.hooks.forEach((e=>delete this[e+"List"])),this.hooks=[]}getIncludes(e){return!!this.hooks.includes(e)}getIndexOf(e){return this.hooks.indexOf(e)}}const allowTypes=["ui","canvas","layer","group","container"];let Module$1=class{constructor(e){this.instance=e,this.cache={},Object.entries(e).forEach((([e,A])=>{allowTypes.includes(e)&&(this.cache[e]||(this.cache[e]={}),Object.entries(A).forEach((([A,t])=>{if("function"==typeof t){let i=this.cache[e][A];i||(this.cache[e][A]=i=new Set),i.add(t)}})))}))}inject(e,A){const t=this.cache[A.toLowerCase()];t&&Object.keys(t).forEach((A=>{t[A].forEach((t=>{e.tap(A,t)}))}))}},ModuleManager$1=class{constructor(){this.modules=new Map}mixin(e){Object.entries(e).forEach((([e,A])=>{allowTypes.includes(e)&&layoutManager.mixin(e,A)}))}register(e){if(!this.modules.has(e)){let A=e;"function"==typeof(A="function"==typeof e?e(UI):A).setup&&(A.setup(UI),delete A.setup),this.modules.set(e,new Module$1(A))}}remove(e){this.modules.delete(e)}inject(e,A){this.modules.forEach((t=>t.inject(e,A)))}};var mm=new ModuleManager$1;const hooks=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeToJSON","beforeDestroy","destroyed","beforeParseJSON","afterParseJSON"];function createLifeCycle(e){var A=new Hook(e,hooks);return mm.inject(A,e.type||e.constructor.name),A}const commandAPI={create(e,A,t=!1){commandAPI._create(e,A),t&&store$1$1.execute(COMMAND_TYPE.CREATEGROUP,{undo:commandAPI._unCreate,redo:commandAPI._create,param:[e,A]})},destroy(e){var A=store$1$1.getAllElementsByEL(e);commandAPI._destroy(e,A),store$1$1.execute(COMMAND_TYPE.UNGROUP,{undo:commandAPI._undestroy,redo:commandAPI._destroy,param:[e,A]})},dismiss(e){var A=e.children;commandAPI._dismiss(e,A),store$1$1.execute(COMMAND_TYPE.UNGROUP,{undo:commandAPI._undismiss,redo:commandAPI._dismiss,param:[e,A]})},graph(e,A=!1){A&&store$1$1.execute(COMMAND_TYPE.CREATEGRAPHOBJECT,{undo:commandAPI._unGraph,redo:commandAPI._graph,param:[e]}),commandAPI._graph_init(e)},unGraph(e){var A=store$1$1.getAllElementsByEL(e);commandAPI._unGraph(e,A),store$1$1.execute(COMMAND_TYPE.UNGRAPHOBJECT,{undo:commandAPI._graph,redo:commandAPI._unGraph,param:[e,A]})},move(e,A,t){commandAPI._move(e,A,t),store$1$1.execute(COMMAND_TYPE.MOVE,{undo:commandAPI._moveBack,redo:commandAPI._move,param:[e,A,t]})},drag(e){store$1$1.execute(COMMAND_TYPE.DRAG,e)},align(e){store$1$1.execute(COMMAND_TYPE.ALIGN,e)},rotate(e){store$1$1.execute(COMMAND_TYPE.ROTATE,e)},attribute(e,A){store$1$1.execute(COMMAND_TYPE.ATTRIBUTE,e,A)},_create(e,A){store$1$1.init(e),store$1$1._move(e,A[0],"before"),A.forEach((A=>moveToTarget$1(A,e)))},_unCreate(e,A){store$1$1._moveBack(A),store$1$1._remove(e),selector.clear()},_graph(e,A){store$1$1.init(e),A&&A.forEach((e=>store$1$1.init(e))),e.doMount()},_graph_init(e){store$1$1.init(e),e.initMount()},_unGraph(e,A){e.doUnmount(),store$1$1._remove(e),A&&store$1$1._removeData(A)},_destroy(e,A){selector.clear(),e.unmount(),store$1$1._remove(e),A&&store$1$1._removeData(A)},_undestroy(e,A){store$1$1._removeback(e),A.forEach((e=>store$1$1.init(e))),e.mount(),selector.select(e)},_dismiss(e,A){store$1$1._move(A,e,"before"),store$1$1._remove(e),A.forEach((e=>e._setVisible(e.visible))),selector.clear()},_undismiss(e,A){store$1$1._removeback(e),store$1$1._moveBack(A),selector.select(e)},_move(e,A,t){moveToTarget$1(e,A,t)},_moveBack(e){store$1$1._moveBack(e)}},{ENTER:ENTER$2,LEAVE:LEAVE$2}=TRANSITIONTYPE;class TransAnimation{constructor(){this.ui=null,this.target=null,this.type="",this.resolve=null,this.animations=new Map}get root(){return this.ui}set root(e){this.ui||(this.ui=e)}execute(e,A,t=null){if(!this.root.isPlayMode()||!A||!A.length)return!1;let i=!1;if(A&&A.length){t&&this.root.animation._registerCallback(t,e);try{A.forEach((A=>{A.reduce(((A,t)=>A.run(t,null,e)),this.root.animation)})),i=!0}catch(A){i=!1,console.error(A)}}return i}dispense(e,A,t){switch(this.target=e,this.type=A,this.resolve=t,A){case ENTER$2:this.show();break;case LEAVE$2:this.hidden()}}async show(){var{target:e,type:A,resolve:t}=this;checkLayoutType(e,LAYOUT_MAP.CONTAINER)?this.beforeExecute(e,A,t)()||(e._setVisible(!0),t(e)):(checkLayoutType(e,LAYOUT_MAP.GROUP)||checkLayoutType(e,LAYOUT_MAP.LAYER))&&(e._setVisible(!0),this.root.isPlayMode()&&await Promise.all(this.getPromiseList(e,A)),t(e))}async hidden(){var{target:e,type:A,resolve:t}=this;checkLayoutType(e,LAYOUT_MAP.CONTAINER)?this.beforeExecute(e,A,t)()||(e.visible=!1,e._setVisible(!1),t(e)):(checkLayoutType(e,LAYOUT_MAP.GROUP)||checkLayoutType(e,LAYOUT_MAP.LAYER))&&(this.root.isPlayMode()?(await Promise.all(this.getPromiseList(e,A)),e.visible=!1,e._setVisible(!1),e._showCts.forEach((e=>e.setVisible(!0)))):(e.visible=!1,e._setVisible(!1)),t(e))}beforeExecute(e,A,t){if(!this.root.isPlayMode())return new Function("","return false");this.root.animation._end(e);var i=this.animations.get(e);return i?(i=i.animation[A],this.execute.bind(this,e,i,e._animationEndCb.bind(e,t))):new Function("","return false")}convert(e,A){if(A=A||e,checkLayoutType(e.parent,LAYOUT_MAP.GROUP))return this.convert(e.parent,A);if(checkLayoutType(e,LAYOUT_MAP.GROUP)){if(e.animation&&Object.keys(e.animation).length)return e.animation}else if(A.animation&&Object.keys(A.animation).length)return A.animation;return null}getPromiseList(e,A){return e.containers?e.containers.map((async t=>{if(this.getCtVisible(t))return A===LEAVE$2&&e._showCts&&e._showCts.push(t),await this.asyncExecute(t,A)})):[]}asyncExecute(e,A){return new Promise((t=>{this.beforeExecute(e,A,t)()||t(this)}))}getCtVisible(e,A){return A=A||e,checkLayoutType(e.parent,LAYOUT_MAP.GROUP)?!!e.parent.visible&&this.getCtVisible(e.parent,A):A.visible}clear(){this.animations.clear()}}var transAnimation=new TransAnimation;const{ENTER:ENTER$1,LEAVE:LEAVE$1}=TRANSITIONTYPE;class Displayable{constructor(e,A){if(!e)throw new Error("parent 参数不能为空");this.type=A.config.type,this.lifeCycle=createLifeCycle(this),this.lifeCycle.call("beforeCreate"),this.parent=e,this.config=A.config,this.options=A.baseOption,this.id=null,this.root=store$1$1.getUI(),this.visible=null,this.isLock=null,this.selectLock=null,this.animation=A.baseOption.animation||null,this._name=null}get isSelected(){return store$1$1.getSelectElements().includes(this)}get children(){return store$1$1.getChildren(this)}get lock(){return!!this.isLock}set lock(e){e!==this.isLock&&(this.isLock=e,this._changeLock())}get name(){return this._name}set name(e){this._name=""+e,store$1$1.setName(this)}init(){var e=this.options;if(e.id){if(store$1$1.getElementById(e.id))throw new Error(e.id+" 编号已经被使用");this.id=e.id}else this.id=getId(this.type.toLowerCase()||"ui");this.name=e.name||"",this.visible=!hasOwn(e,"visible")||e.visible,this.isLock=(hasOwn(e,"isLock")?e:this.config).isLock,this.selectLock=!1,this.lifeCycle.call("created")}setAnimation(e,A){[ENTER$1,LEAVE$1].includes(e)&&(this.animation={...this.animation},this.animation[e]=A,this._updateAnimation(e))}show(){return new Promise((e=>{this.root.emit("beforeShow",this),this.visible=!0,transAnimation.dispense(this,ENTER$1,e),commandAPI.attribute(this,"show"),this.root.emit("afterShow",this)}))}hidden(){return new Promise((e=>{this.root.emit("beforeHidden",this),this.unselect(),transAnimation.dispense(this,LEAVE$1,e),commandAPI.attribute(this,"hidden"),this.root.emit("afterHidden",this)}))}update(){}prev(){return store$1$1.prev(this)}next(){return store$1$1.next(this)}select(){return!this.selectLock&&!this.isSelected&&this.root.selector.select(this)}unselect(){return!(this.selectLock||!this.isSelected)&&this.root.selector.unselect(this)}zIndexUp(){this.style.zIndex=1}zIndexDown(){this.style.zIndex=""}toJSON(){var e=this.type,A={id:this.id,name:this.name,isLock:this.isLock,visible:this.visible},t=(isDef(this.penetrateOnplay)&&(A.penetrateOnplay=this.penetrateOnplay),isDef(this.ignoreRendering)&&(A.ignoreRendering=this.ignoreRendering),isDef(this.animation)&&(A.animation=this.animation),this.children.map((e=>e.toJSON())));this.style&&(A.style=this.style.getValue(),delete A.style.display,delete A.style.zIndex),this.adapter&&isType$1(this.adapter.toJSON,"Function")&&(A.adapter=this.adapter.toJSON()),e={type:e,option:A};return t&&(e.children=t),this.lifeCycle.call("beforeToJSON",e),e}destroy(){this.unselect()}_destroyTruthy(){this.lifeCycle.call("beforeDestroy");for(const e of this.children)e._destroyTruthy();return this.unselect(),this._destroyEvent(),store$1$1.getElementById(this.id)===this&&store$1$1._remove(this),this._clearCache(this),!0}_clearCache(e){unmount(e),e.el&&(e.el=null),e.parent=null,e.style&&e.style.destroy(),this.lifeCycle.call("destroyed"),e.lifeCycle.destroy()}_updateAnimation(e){var A=transAnimation.animations.get(this);if(A){const t=transAnimation.convert(this);A.animation=t,A.run[e]=()=>{transAnimation.execute(this,t[e])}}}_changeLock(){this.root&&(this.isLock?this.root._setOperatHandlerDisplay({resize:!1,rotate:!1}):this.root._setOperatHandlerDisplay({resize:!0,rotate:!0}))}_initEvent(){}_destroyEvent(){}}function getId(e){var A=getUID(e);return store$1$1.getElementById(A)?getId(e):A}function checkLayoutType(e,A){return layoutManager.checkLayoutType(e,A)}function recordBound(e=[]){e.forEach((e=>{checkLayoutType(e,LAYOUT_MAP.GROUP)?recordBound(e.children):e.bound.record=e.bound.plain()}))}function getParentLayer(e){return e instanceof Displayable?checkLayoutType(e,LAYOUT_MAP.LAYER)?e:getParentLayer(e.parent):null}function getElementParent(e){return checkLayoutType(e,LAYOUT_MAP.GROUP)?getElementParent(e.parent):e}function getParentGroupOptionList(e,A){let t=[];return checkLayoutType(e,LAYOUT_MAP.GROUP)&&t.push(e[A]),checkLayoutType(e.parent,LAYOUT_MAP.GROUP)?t.concat(getParentGroupOptionList(e.parent,A)):t}function setContainerDisplay(e){return e.visible&&getParentGroupOptionList(e.parent,"visible").every((e=>!!e))}function sortLayerChildren(e){if(e.length<2)return e;const A=getLayerFlatChildren(getParentLayer(e[0]));return e.sort(((e,t)=>A.indexOf(e)-A.indexOf(t)))}function getLayerFlatChildren(e){const A=[];return function e(t){t.children&&t.children.forEach((t=>{A.push(t),e(t)}))}(e),A}function moveToTarget$1(e,A,t){if(t&&"before"!==t&&"after"!==t)return log.warn("type 参数异常");if(!(A instanceof Displayable))throw Error(`目标类型错误: ${A}不是一个可视化元素的实例`);let i=e,s=A,n=t;var r;checkLayoutType(A,LAYOUT_MAP.GROUP)&&(r=findInsertPosition(A,t),s=r[0],n=r[1]),i=isType$1(i=checkLayoutType(e,LAYOUT_MAP.GROUP)?"after"===n?e.containers.slice(0).reverse():e.containers:i,"Array")?i:[i],(e=isType$1(e,"Array")?e:[e]).forEach((e=>{store$1$1._move(e,A,t)})),i.forEach((e=>{e._setVisible(e.visible),e.id!==s.id&&(mount(e,{el:!n&&checkLayoutType(s,LAYOUT_MAP.LAYER)?s.contentEl:s.el},n),checkLayoutType(e,LAYOUT_MAP.CONTAINER))&&e.updateLocation()}))}function checkLock(e=[]){return e.every((e=>e.isLock))}function getRootGroup(e){return checkLayoutType(e.parent,LAYOUT_MAP.GROUP)?getRootGroup(e.parent):e}function getLayerParentId(e){return checkLayoutType(e.parent,LAYOUT_MAP.LAYER)?e.parent.id:checkLayoutType(e.parent,LAYOUT_MAP.GROUP)?getLayerParentId(e.parent):e.id}function findInsertPosition(e,A){var t=e.containers,i=e.next();let s,n;if(t.length)switch(n=A){case"before":s=t.slice(0)[0];break;case"after":s=t.slice(-1)[0];break;default:s=t.slice(-1)[0],n="after"}else if(i){if(checkLayoutType(i,LAYOUT_MAP.GROUP))return findInsertPosition(i,"before");s=i,n="before"}else s=e.getParentLayer(),n="";return[s,n]}function rotateIcon(){return getSvg('<svg width="16px" height="16px" viewBox="0 0 17 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <title>toolbar_xz</title>\n    <defs>\n        <filter id="filter-1">\n            <feColorMatrix in="SourceGraphic" type="matrix" values="0 0 0 0 0.043137 0 0 0 0 0.443137 0 0 0 0 0.901961 0 0 0 1.000000 0"></feColorMatrix>\n        </filter>\n    </defs>\n    <g id="editor" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="title-close" transform="translate(-1303.000000, -410.000000)">\n            <g transform="translate(1302.998014, 409.998014)" id="toolbar_xz">\n                <rect id="rect" x="0.0148202467" y="0.00198554907" width="16" height="16"></rect>\n                <path d="M15.7293922,5.93143319 C16.285859,8.00819582 15.983898,10.1769077 14.9301888,12.0019855 C14.6684184,12.455385 14.363472,12.8814174 14.0201308,13.2740063 L15.7086046,12.8194026 L16.0585571,14.1254431 L12.7934557,15.0003244 C12.4688679,15.0872975 12.1361367,14.9226324 12.0023882,14.6259135 L11.9654592,14.5222804 L11.0905779,11.257179 L12.3966185,10.9072265 L12.840996,12.561793 C13.19294,12.187523 13.5012471,11.7727599 13.7592249,11.3259292 C14.6354102,9.80833161 14.8860513,8.00820448 14.4233516,6.2813857 C13.4730905,2.73496316 9.82780824,0.630358437 6.2813857,1.58061949 C2.73496316,2.53088055 0.630358435,6.17616286 1.58061949,9.7225854 C1.80974321,10.5776868 2.19919885,11.3636877 2.72612438,12.0498464 C3.25774419,12.7421177 3.9219886,13.3227173 4.67804189,13.7592248 C5.33958849,14.1411689 6.06152982,14.407079 6.81138501,14.5441342 L7.13436583,14.5949458 L6.95736646,15.9354232 C5.91550503,15.7978537 4.91108799,15.4550593 4.00198558,14.9301887 C3.09288309,14.4053182 2.29380597,13.7068647 1.65373654,12.873371 C1.01902772,12.0468578 0.549907173,11.1000769 0.274578937,10.0725379 C-0.868955554,5.80480909 1.66370439,1.41811342 5.93143319,0.274578939 C10.199162,-0.868955553 14.5858577,1.66370437 15.7293922,5.93143319 Z" id="shapes-combine" fill="#007aff" fill-rule="nonzero"></path>\n            </g>\n        </g>\n    </g>\n</svg>')}function isMultiSelect(){var e=selector.getSelectElements();return e&&1<e.length}class Storage{init(e){db.tree.add(e,e.parent),db.data.add(e)}execute(e,...A){command.execute(e,...A)}_get(e){let A;switch(e){case"tree":A=db.tree;break;case"stack":A=command.stack.get()}return A}_removeData(e){(Array.isArray(e)?e:[e]).forEach((e=>db.data.remove(e)))}_remove(e){(Array.isArray(e)?e:[e]).forEach((e=>{e.sublingNode=e.sublingNode||[],e.sublingNode.push(e.next()),db.tree.remove(e),db.data.remove(e)}))}_removeback(e){db.tree.add(e,e.parent),db.data.add(e);var A=e.sublingNode&&e.sublingNode.pop();A&&db.tree.move(e,A,"before")}_move(e,A,t){(e=isType$1(e,"Array")?e:[e]).forEach((e=>{this.moveBack||(e.sublingNode=e.sublingNode||[],e.fromNode=e.fromNode||[],e.sublingNode.push(e.next()),e.fromNode.push(e.parent)),db.tree.move(e,A,t)}))}_moveBack(e){(e=isType$1(e,"Array")?e:[e]).slice(0).reverse().forEach((e=>{var A=e.sublingNode.pop(),t=e.fromNode.pop();this.moveBack=!0,e.sublingNode&&A?moveToTarget$1(e,A,"before"):moveToTarget$1(e,t),this.moveBack=!1}))}prev(e){return db.tree.edit("prev",e)?db.tree.edit("prev",e).data:null}next(e){return db.tree.edit("next",e)?db.tree.edit("next",e).data:null}getUI(){return Array.from(db.data.getByType("ui"))[0]}getCanvas(){return Array.from(db.data.getByType("canvass"))}getLayers(){return Array.from(db.data.getByType("layers"))}getGroups(){return Array.from(db.data.getByType("groups"))}getContainers(){return Array.from(db.data.getByType("containers"))}getElementById(e){return this.hasElementById(e)?db.tree.getNodeById(e).data:null}hasElementById(e){return db.tree.hasNodeById(e)}getElementsByName(e){return db.data.getByName(e)}getAllElements(){return[...this.getLayers(),...this.getGroups(),...this.getContainers()]}getChildren(e){return this.hasElementById(e.id)?db.tree.getNodeById(e.id).children.map((e=>e.data)):[]}deepListByType(e,A,t=[]){return e.forEach((e=>{A&&e.type!==LAYOUT_MAP[A]||t.push(e),(e=this.getChildren(e))&&e.length&&this.deepListByType(e,A,t)})),t}getContainersByEl(e){return this.deepListByType(this.getChildren(e),"CONTAINER")}getGroupsByEL(e){return this.deepListByType(this.getChildren(e),"GROUP")}getAllElementsByEL(e){return this.deepListByType(this.getChildren(e))}select(e){this.isSelect(e)||db.selects.add(e)}unSelect(e){this.isSelect(e)&&db.selects.delete(e)}getSelectElements(){return Array.from(db.selects)}getSelectCtGroups(){return Array.from(db.selects).filter((e=>checkLayoutType(e,LAYOUT_MAP.CONTAINER)||checkLayoutType(e,LAYOUT_MAP.GROUP)))}isSelect(e){return db.selects.has(e)}setName(e){db.data.setName(e)}destroy(){db.tree.clear(),db.data.clear(),this.clearStack(),this.clearSelect()}clearStack(){command.stack.clear(),command.position=-1}clearSelect(){db.selects.clear()}}const store$1=new Storage;command.store=store$1;var store$1$1=store$1;class BoundingRect{constructor(e,A,t=0,i=0,s={left:0,top:0},n=0){this.top=isNumber(A)?A:0,this.left=isNumber(e)?e:0,this.width=t,this.height=i,this.offset=s,this.angle=n,this.record=this.plain()}static create(e,A,t){return new BoundingRect(e.left,e.top,e.width,e.height,A,t)}clone(){return new BoundingRect(this.left,this.top,this.width,this.height,this.offset,this.angle)}setData(e){Object.keys(e).forEach((A=>{var t=e[A];this.hasOwnProperty(A)&&isNumber(t)&&(this[A]=Math.round(t))}))}union(e,A){var t,i,s,n;e instanceof BoundingRect&&(({top:t,left:i,right:s,bottom:n}=A?this.plainReal():this.plain()),A=A?e.plainReal():e.plain(),0===t&&0===i&&0===s&&0===n?this.setData(A):(this.top=Math.min(A.top,t),this.left=Math.min(A.left,i),this.width=Math.max(A.right,s)-this.left,this.height=Math.max(A.bottom,n)-this.top,this.angle=0))}setOffset(e,A){isNumber(e)||(e=0),isNumber(A)||(A=0),this.offset={left:e,top:A}}plain(){return{top:this.top,left:this.left,right:this.left+this.width,bottom:this.top+this.height,width:this.width,height:this.height,angle:this.angle}}plainReal(){var e,A=isNumber((e=this.offset).top)?this.top+e.top:0;return{top:A,left:e=isNumber(e.left)?this.left+e.left:0,right:e+this.width,bottom:A+this.height,width:this.width,height:this.height,angle:this.angle}}}let Group$1=class e extends Displayable{static factory(A,t){return new e(A,t)}static factoryConfig(A,t,i){return new e(A,t,i)}constructor(e,A,t={}){if(t.isAlone){if(!e||!checkLayoutType(e,[LAYOUT_MAP.LAYER,LAYOUT_MAP.GROUP]))throw new Error("编组创建的参数必须是图层或者编组");super(e,mergeOption(LAYOUT_MAP.GROUP,A,t)),this.init(),store$1$1.init(this)}else{if(!(e=isType$1(e,"Array")?e:e?[e]:[]).length)throw new Error("编组创建的参数必须有值");let i=null,s=null;for(const A of e=Array.from(new Set(e))){if(!checkLayoutType(A,[LAYOUT_MAP.GROUP,LAYOUT_MAP.CONTAINER]))throw new Error("编组对象必须是编组或者容器");if(null===i)i=A.parent.id,s=A.id;else if(A.parent.id!==i)throw new Error(`不允许元素跨层级编组：${A.id}和${s}不在同一级`)}super((e=sortLayerChildren(e))[0].parent,mergeOption(LAYOUT_MAP.GROUP,A,t)),this.init(),commandAPI.create(this,e,this.config.inStack)}}get bound(){var{left:e,top:A}=this.getParentLayer().bound;return unionBound(this.children,{x:e,y:A})}get groups(){return store$1$1.getGroupsByEL(this)}get containers(){return store$1$1.getContainersByEl(this)}init(){super.init(),this._showCts=[]}mount(){if(this.parent){let A=this.parent,t=null;var e;checkLayoutType(A,LAYOUT_MAP.GROUP)&&((e=this.next())?(A=e,t="before"):A=getElementParent(A)),this.lifeCycle.call("beforeMount"),this._isMounted=!0,this.groups.forEach((e=>e._isMounted=!0)),this.containers.forEach((e=>{e.isMounted&&mount(e,A,t)})),this.lifeCycle.call("mounted")}}unmount(){this._isMounted=!1,this.groups.forEach((e=>e._isMounted=!1)),this.containers.forEach((e=>{unmount(e)}))}add(e){if(!(e=isType$1(e,"Array")?e:e?[e]:[]).length)return!1;for(const A of e=Array.from(new Set(e)))if(!checkLayoutType(A,[LAYOUT_MAP.GROUP,LAYOUT_MAP.CONTAINER])||A.parent===this||A===this)throw new Error("target 参数必须是同一个图层的其他编组或者容器，并且父节点不能是自己");return commandAPI.move(e,this),!0}moveToTarget(e,A){return A||checkLayoutType(e,[LAYOUT_MAP.LAYER,LAYOUT_MAP.GROUP])||e===this?A&&!checkLayoutType(e,[LAYOUT_MAP.CONTAINER,LAYOUT_MAP.GROUP])&&e!==this?log.warn("编组只能移动到容器或者其他编组旁边"):(commandAPI.move(this,e,A),this.root.operation.repaint(),!0):log.warn("编组只能移动到图层或者其他编组里面")}zIndexUp(){this.containers.forEach((e=>{e.style.zIndex=1}))}zIndexDown(){this.containers.forEach((e=>{e.style.zIndex=""}))}show(){return this.visible?Promise.resolve(this):super.show()}hidden(){return this.visible?super.hidden():Promise.resolve(this)}move(e,A){this.containers.forEach((t=>t.move(e,A)))}getParentLayer(){return getParentLayer(this.parent)}destroy(){this.lifeCycle.call("beforeDestroy"),commandAPI.destroy(this),this.lifeCycle.call("destroyed")}dismiss(){commandAPI.dismiss(this)}_setVisible(){this.containers.forEach((e=>e._setVisible()))}};function unionBound(e,A){const t=new BoundingRect;return t.setOffset(A.x,A.y),e.length&&e.forEach((e=>t.union(e.bound))),t.angle=0,t}class Selector{constructor(){this.isMultSelect=!1,this.selectLayerId=""}get root(){return store$1$1.getUI()}get last(){var e=this.getSelectElements(),A=e.length;return e.length?e[A-1]:null}select(e){if(!this.root||!e)return!1;e=isType$1(e,"Array")?e:[e];let A,t,i="";e.forEach((e=>{t=e.root.config.notSelectLayer,e.type===LAYOUT_MAP.LAYER?(i=LAYOUT_MAP.LAYER,A=e.id):e.type!==LAYOUT_MAP.CONTAINER&&e.type!==LAYOUT_MAP.GROUP||(A=getParentLayer(e).id)})),this.selectLayerId&&A!==this.selectLayerId&&(s=db.tree.getNodeById(this.selectLayerId))&&(!t||i)&&s.data.zIndexDown(),this.selectLayerId=A,this.isMultSelect||this.clear();var s=e.filter((e=>{if(e.type!==LAYOUT_MAP.LAYER||!t)return store$1$1.select(e),e.zDown||e.zIndexUp(),!0;e.zDown||e.zIndexUp()}));return e.length&&(this.root.emit("select",s),this.root.emit("selectElements",this.getSelectElements())),!0}unselect(e){return!!this.root&&((e=isType$1(e,"Array")?e:[e]).forEach((e=>{store$1$1.unSelect(e)})),this.zIndexDown(e),this.root.emit("unselect",e),this.root.emit("selectElements",this.getSelectElements()),!0)}zIndexDown(e){e.forEach((e=>{e.type===LAYOUT_MAP.LAYER&&this.selectLayerId===e.id||e.zIndexDown()}))}clear(){var e=this.getSelectElements();e.forEach((e=>e.zIndexDown())),store$1$1.clearSelect(),this.root.emit("unselect",e)}delete(e){(e=switchElements.call(this,e))&&(e.forEach((e=>{store$1$1.unSelect(e),e.destroy()})),this.root.emit("delete"))}getSelectElements(){return store$1$1.getSelectElements()}getContainers(){return unrepeatContainers(this.getSelectElements())}getGroups(){return unrepeatGroups(this.getSelectElements())}getLayers(){return this.getSelectElements().filter((e=>checkLayoutType(e,LAYOUT_MAP.LAYER)))}enableMultSelect(){this.isMultSelect=!0}disableMultSelect(){this.isMultSelect=!1}move(e,A){this.getContainers().forEach((t=>t.move(e,A)))}createGroup(e){return(e=switchElements.call(this,e))?(e=new Group$1(e),this.clear(),store$1$1.select(e),this.root.emit("select",e),e):null}cancelGroup(e){(e=switchElements.call(this,e))&&e.forEach((e=>{checkLayoutType(e,LAYOUT_MAP.GROUP)&&(e.zIndexDown(),e.dismiss())}))}}function unrepeatContainers(e=[],A=[]){return e.forEach((e=>{checkLayoutType(e,LAYOUT_MAP.CONTAINER)&&!A.includes(e)&&A.push(e),checkLayoutType(e,LAYOUT_MAP.GROUP)&&unrepeatContainers(store$1$1.getContainersByEl(e),A)})),A}function unrepeatGroups(e=[],A=[]){return e.forEach((e=>{checkLayoutType(e,LAYOUT_MAP.GROUP)&&(A.includes(e)||A.push(e),unrepeatGroups(store$1$1.getGroupsByEL(e),A))})),A}function switchElements(e){var A;return isUnDef(e)?(A=this.getSelectElements()).length?A:null:isType$1(e,"Array")?void 0:[e]}var selector=new Selector;const ALPHA=3;class TextEditor{constructor(){this.target=null,this.isInEdit=!1,this.isOutEdit=!1,this._textEditAbout=null,this._handlerState=null,this._textBUStyle=Object.create(null),this._blur=null,this._leave=null}openTextEdit(e){e.textEditState=!0}closeTextEdit(e){e.textEditState=!1}readyTextEdit(e,A){e.textEditState&&!this.isInEdit&&(this.target=e,this._textEditAbout=Object.create(null),this._textEditAbout.contentValue=A)}enterTextEdit(e){var A;isUnDef(e=this._checkBeforeEdit(e))||(e.maskEl.style.display="none",(A=e.app.dom)&&(this.matchDom(A,e),this.isInEdit)&&(e.root.emit("inTextEdit"),e.root.closeRegionSelect(),this._handlerState=e.root.getOperatHandlerDisState(),e.root._setOperatHandlerDisplay({resize:!1,rotate:!1,sizeLabel:!1},!0)))}matchDom(e,A){Array.from(e.children).forEach((e=>{var t;this.isInEdit||(e.children&&e.children.length?this.matchDom(e,A):isDef(e.textContent)&&this._textEditAbout&&e.textContent.trim()===this._textEditAbout.contentValue.trim()&&(t=e.cloneNode(!0),e.parentElement.appendChild(t),this._blur=blur.bind(this),this._leave=leave$1.bind(this,t),A.el.addEventListener("mouseleave",this._leave),this.setTextAboutStyle(t,e,A),t.setAttribute("contenteditable",!0),this._textEditAbout.selfEl=e,((this._textEditAbout.cloneEl=t).firstChild?setRange:setEmptyRange)(t),this.isInEdit=!0))}))}setTextAboutStyle(e,A,t){let i;this._textBUStyle.textStyle={display:A.style.display||"","-webkit-line-clamp":A.style["-webkit-line-clamp"]||"","-webkit-box-orient":A.style["-webkit-box-orient"]||""},Object.assign(A.style,{display:"none"}),A=e.parentElement,this._textBUStyle.parentStyle={whiteSpace:A.style.whiteSpace||"",textOverflow:A.style.textOverflow||"",overflow:A.style.overflow||"",wordBreak:A.style.wordBreak||""},Object.assign(A.style,{whiteSpace:"unset",textOverflow:"unset",overflow:"unset",wordBreak:"break-word"});A=e.style.color;var{maxHeight:A,maxWidth:t}=(i=A&&"transparent"!==A&&"0"!==getRgbaNum(A,ALPHA)?"auto":"white",getMaxHW(t));Object.assign(e.style,{whiteSpace:"pre-wrap",textOverflow:"unset",overflow:"hidden",wordBreak:"break-word",outline:"none",pointerEvents:"all",cursor:"text",animation:"",caretColor:i,"-webkit-line-clamp":"",padding:"0 2px",maxHeight:A+"px",maxWidth:t+"px",minWidth:"2px"})}exitTextEdit(){var e,A,t,i=this._checkAfterEdit();isUnDef(i)?this.isOutEdit=!1:(i.root.openRegionSelect(),({resizeDis:A,rotateDis:t,sizeLabelDis:e}=this._handlerState),i.root._setOperatHandlerDisplay({resize:A,rotate:t,sizeLabel:e},!1),this.resetStyle(i),(A=this._textEditAbout.cloneEl)&&(t=getTextContent(A),A.removeEventListener("blur",this._blur),i.el.removeEventListener("mouseleave",this._leave),A.remove(),i.root.emit("afterTextEdit",t,i)),this.reset())}resetStyle(e){e.maskEl.style.display="",e=this._textEditAbout.selfEl,this._textBUStyle.textStyle&&Object.assign(e.style,this._textBUStyle.textStyle),this._textBUStyle.parentStyle&&Object.assign(e.parentElement.style,this._textBUStyle.parentStyle)}reset(){this.target=null,this.isInEdit=!1,this.isOutEdit=!1,this._textEditAbout=null,this._handlerState=null,this._blur=null,this._leave=null,this._textBUStyle=Object.create(null)}_checkBeforeEdit(e){var A=selector.getSelectElements();return 1<A.length?null:(e&&e.select(),(e=e||this.target||A[0])&&e.textEditState&&!this.isInEdit&&e.isSelected?(e.root.emit("beforeTextEdit",e),e):null)}_checkAfterEdit(){if(this.isOutEdit)return null;this.isOutEdit=!0;var e=this.target;return e&&e.textEditState&&this.isInEdit?e:null}}var textEditor=new TextEditor;function getTextContent(e){let A="";var t=e.childNodes;for(let e,i=0;e=t&&t[i];i++)3===e.nodeType?A+=getTextValue(e):1===e.nodeType?A+=getDivValue(e):A+=e.innerText;return A.endsWith("\n")&&"\n\n"!==A.slice(-2)?A.slice(0,A.length-1):A}function getTextValue(e){var A=e.nodeValue;return A?e.nextSibling&&3!==e.nextSibling.nodeType?A+"\n":A:""}function getDivValue(e){var A=e.innerText;return A?A.endsWith("\n")&&!e.nextSibling?A.slice(0,A.length-1):A.endsWith("\n")||!e.nextSibling?A:A+"\n":""}function setEmptyRange(e){e.style.width||(e.style.minWidth="2px"),e.innerHTML="&nbsp",setRange(e),e.innerHTML=""}function setRange(e){var A=document.createRange();(e=(A.selectNodeContents(e),document.getSelection())).removeAllRanges(),e.addRange(A)}function blur(){this.exitTextEdit()}function leave$1(e){e.addEventListener("blur",this._blur)}function getRgbaNum(e,A){return/^rgba\(/.test(e)?e.match(/(\d(\.\d+)?)+/g)[A]:null}function getMaxHW(e){var A=e.root.canvas.getZoom(),{top:t,left:i,width:s,height:n}=e.bound.plainReal(),{width:r,height:o}=e.root.bound,r=r/A,o=o/A,{top:a,left:l}=e.root.el.getBoundingClientRect(),{top:e,left:c}=e.root.canvas.el.getBoundingClientRect(),a=(e=(e-a)/A+t,(c-l)/A+i);return{maxHeight:0<o-e?Math.floor(o-e):n,maxWidth:0<r-a?Math.floor(r-a):s}}class NextTick{constructor(){this.microCaches=[],this.pending=!1}_flushMicroQueue(){for(this.pending=!1;this.microCaches.length;)this.microCaches.shift()()}call(e,A){let t;return this.microCaches.push((()=>{try{e?e.call(A):t(A)}catch(e){log.warn(e)}})),this.pending||(this.pending=!0,Promise.resolve().then(this._flushMicroQueue.bind(this))),e?t:new Promise((e=>{t=e}))}}var nextTick=new NextTick;class EventEmitter{constructor(){this.eventTypes={},this.eventFns={}}on(e,A,t=this){return this.hasType(e)||(this.eventTypes[e]=e,this.eventFns[e]=[]),this.eventFns[e].push([A,t]),this}once(e,A,t){const i=(...s)=>{this.off(e,i),A.apply(t,s)};return i.fn=A,this.on(e,i),this}off(e,A,t){if(e||A){if(this.hasType(e))if(A){var i,s,n=this.eventFns[e];let r=n.length;for(;-1<r;)n[r]?([i,s]=n[r],i!==A&&i.fn!==A||t&&s!==t||n.splice(r,1),r--):r--}else this.eventFns[e]=[]}else this.destroyEvents();return this}emit(e,...A){if(this.hasType(e)&&(e=this.eventFns[e])&&e.length)for(const s of[...e]){var[t,i]=s;t.apply(i,A)}return this}destroyEvents(){this.eventTypes={},this.eventFns={}}hasType(e){return this.eventTypes[e]===e}}class ElementMove{constructor(e,A){this.instance=e,this.mouseMoveInfo=A}elementMove(){var{left:e,top:A}=this.instance.bound.record;this.instance.setBound({left:e+this.mouseMoveInfo.x,top:A+this.mouseMoveInfo.y})}}class GraphEvent{constructor(){this.instance=null,this.target=null}init(e){this.instance=e,this.moveModule=new ElementMove}mouseOverEvent(e){(e=getRootGroup(e)).isSelected||this.instance.emit("graphMouseover",e.bound.plainReal(),e)}mouseMoveEvent(e,A){e.isSelected||(checkLayoutType(getRootGroup(e),LAYOUT_MAP.GROUP)&&(A.ctrlKey||A.metaKey)?e.showPreSelector():e.hiddenPreSelector())}mouseOutEvent(e){e.hiddenPreSelector(),this.instance.emit("graphMouseout")}}var graphEvent=new GraphEvent;class Sequence{constructor(){this.totalTick=[],this.totalCallbacks=[],this.callbacks=[],this.ticks=[],this._ticks=[],this._tier=0,this._callback=null,this._ranTicks=[]}addTicks(e,A,t){confirmArr(e)&&(this._ticks=e,this._tier=A,this._callback=t,this.add())}add(){this.ticks.length?this.handleRunningTicks():this.handleTotalTick()}handleRunningTicks(){var{_ticks:e,_tier:A,_callback:t}=this;1===A||this.isEveryInfinite(e)?(this.ticks.push(e),this.callbacks.push(t),this.totalTick.push([]),this.totalCallbacks.push([])):1<A&&this.handleTotalTick()}handleTotalTick(){var{_ticks:e,_tier:A,_callback:t}=this;1===A?(this.totalTick.push([e]),this.totalCallbacks.push([t])):this.totalTick.length&&(this.totalTick[this.totalTick.length-1].push(e),this.totalCallbacks[this.totalCallbacks.length-1].push(t))}isFinish(){return this.totalTick.flat().length<1&&this.ticks.flat().filter((e=>isDef(e))).length<1}getCurrentTicks(){var e=this.isEveryInfinite(),A=this.getRunEndTicks();return(!this.ticks.length||A.length||e)&&this.totalTick.length&&(this.ticks.length?A.forEach((e=>{this.totalTick[e]&&(this.ticks[e]=this.totalTick[e].shift(),this.callbacks[e]=this.totalCallbacks[e].shift())})):this.totalTick.forEach(((e,A)=>{this.ticks.push(e.shift()),this.totalCallbacks[A]&&this.callbacks.push(this.totalCallbacks[A].shift())}))),this.ticks}isEveryInfinite(e){return(e=e||this.ticks.flat().filter((e=>isDef(e)))).length&&e.every((e=>e.infinite))}getRunEndTicks(){const e=[];return this.ticks.forEach(((A,t)=>{A&&A.every((e=>isUnDef(e)))&&e.push(t)})),e}endAnimation(){this.ticks.forEach((e=>{e&&e.forEach((e=>{isDef(e)&&e._after(!0)}))})),this._ranTicks.forEach((e=>{e._after(!0)})),this.totalTick=[],this.ticks=[],this.totalCallbacks=[],this.callbacks=[],this._ranTicks=[],this._ticks=[],this._tier=0,this._callback=null}_recordRanTick(e){this._ranTicks.push(e)}_endAnimation(e){this.ticks.forEach((A=>{A&&A.forEach((A=>{isDef(A)&&A.target.id===e.id&&A._after(!0)}))})),this._ranTicks.forEach((A=>{A.target.id===e.id&&A._after(!0)})),this.totalTick=this.totalTick.filter((A=>A[0]&&A[0][0].target.id!==e.id)),this.ticks=this.ticks.filter((A=>A&&A[0]&&A[0].target.id!==e.id)),this._ranTicks=[]}}const DEFAULTLIST={fromTop:({t:e,c:A,r:t})=>(t=isType$1(t,"Array")?t[1]:t,{translate:[0,(e.bottom-A.top)/t]}),fromLeft:({t:e,c:A,r:t})=>(t=isType$1(t,"Array")?t[0]:t,{translate:[(e.right-A.left)/t,0]}),fromRight:({t:e,c:A,r:t})=>(t=isType$1(t,"Array")?t[0]:t,{translate:[(-A.right+e.left)/t,0]}),fromBottom:({t:e,c:A,r:t})=>(t=isType$1(t,"Array")?t[1]:t,{translate:[0,(-A.bottom+e.top)/t]}),toTop:({t:e,c:A,r:t})=>(t=isType$1(t,"Array")?t[1]:t,{translate:[0,(-e.bottom+A.top)/t]}),toLeft:({t:e,c:A,r:t})=>(t=isType$1(t,"Array")?t[0]:t,{translate:[(-e.right+A.left)/t,0]}),toRight:({t:e,c:A,r:t})=>(t=isType$1(t,"Array")?t[0]:t,{translate:[(A.right-e.left)/t,0]}),toBottom:({t:e,c:A,r:t})=>(t=isType$1(t,"Array")?t[1]:t,{translate:[0,(A.bottom-e.top)/t]})},DEFAULTFLYLIST={fromFlyTop:({t:e,c:A,r:t})=>(t=isType$1(t,"Array")?t[1]:t,{translate:[0,(e.bottom-A.top)/t]}),fromFlyLeft:({t:e,c:A,r:t})=>(t=isType$1(t,"Array")?t[0]:t,{translate:[(e.right-A.left)/t,0]}),fromFlyRight:({t:e,c:A,r:t})=>(t=isType$1(t,"Array")?t[0]:t,{translate:[(-A.right+e.left)/t,0]}),fromFlyBottom:({t:e,c:A,r:t})=>(t=isType$1(t,"Array")?t[1]:t,{translate:[0,(-A.bottom+e.top)/t]}),toFlyTop:({b:e,r:A})=>(isType$1(A,"Array")&&A[1],{translate:[0,-e.height]}),toFlyLeft:({b:e,r:A})=>(isType$1(A,"Array")&&A[0],{translate:[-e.width,0]}),toFlyRight:({b:e,r:A})=>(isType$1(A,"Array")&&A[0],{translate:[e.width,0]}),toFlyBottom:({b:e,r:A})=>(isType$1(A,"Array")&&A[1],{translate:[0,e.height]})},scaleInFn=({s:e})=>({scale:e}),DEFAULTSCALELIST={fromZoomInVer:scaleInFn,fromZoomInHor:scaleInFn,fromZoomIn:scaleInFn,fromZoomOutVer:scaleInFn,fromZoomOutHor:scaleInFn,fromZoomOut:scaleInFn,toZoomInVer:({s:e})=>({scale:[e[0],1.5*e[1]]}),toZoomInHor:({s:e})=>({scale:[1.5*e[0],e[1]]}),toZoomIn:({s:e})=>({scale:[1.5*e[0],1.5*e[1]]}),toZoomOutVer:({s:e})=>({scale:[e[0],.5*e[1]]}),toZoomOutHor:({s:e})=>({scale:[.5*e[0],e[1]]}),toZoomOut:({s:e})=>({scale:[.5*e[0],.5*e[1]]})},DEFAULTFADELIST={fadeOut:e=>({opacity:0}),fadeIn:e=>({opacity:e.style.opacity||1})},ANIMATELIST={...DEFAULTLIST,...DEFAULTFLYLIST,...DEFAULTSCALELIST,...DEFAULTFADELIST};class SceneTransition{constructor(){this.param={},this.typeCache=null,this.defaultTypes=Object.keys(DEFAULTLIST).concat(Object.keys(DEFAULTFLYLIST)).concat(Object.keys(DEFAULTSCALELIST)).concat(Object.keys(DEFAULTFADELIST))}animator(e){return this._dealAnimation(e),{...e,animation:this.param,typeCache:this.typeCache}}registAnimation({name:e,animation:A}){return this._isDefaultType(e)||["fadeIn","fadeOut"].includes(e)?(log.warn(`Warn Animation: custom type '${e}' can not be one of ${this.defaultTypes},fadeIn,fadeOut`),!1):(isType$1(e,"String")&&isType$1(A,"Function")&&(ANIMATELIST[e]=A),!0)}_getTranslate(e,A){var t,i;return checkRegExp("^toFly.*$",A)?this._getFlyToExecution(e,A):checkRegExp("^(fromZoom)|(toZoom).*$",A)?this._getZoomExecution(e,A):checkRegExp("^fade.*$",A)?this._getFadeExecution(e,A):(t=e.el.getBoundingClientRect(),i=e.root.canvas.el.getBoundingClientRect(),e=e.root.canvas.getZoom(!0),ANIMATELIST[A]({t:t,c:i,r:e}))}_getFlyToExecution(e,A){var t=e.bound;e=e.root.canvas.getZoom(!0);return ANIMATELIST[A]({b:t,r:e})}_getZoomExecution(e,A){return e=e.style.scale||[1,1],ANIMATELIST[A]({s:e})}_getFadeExecution(e,A){return ANIMATELIST[A](e)}_dealAnimation(e){var{target:A,animation:t}=e;if(isType$1(t,"Array"))return t.map((A=>{this._dealAnimation({...e,animation:A})})),!0;if(isType$1(t,"Object")&&(this._isDefaultType(t.type)?this.param={...this.param,...t.animation}:this.param={...this.param,...t}),this._isDefaultType(t))return this.param={...this.param,...this._getTranslate(A,t)},this.typeCache=t,!0;if(Object.keys(ANIMATELIST).includes(t)){try{isType$1(ANIMATELIST[t](A),"Object")&&(this.param={...this.param,...ANIMATELIST[t](A)})}catch(A){log.error(A)}return!0}return isType$1(t,"String")&&!Object.keys(ANIMATELIST).includes(t)&&log.warn(`Warn Animation: '${t}' type has not been registered`),{}}_isDefaultType(e){return this.defaultTypes.includes(e)}}class Tick{constructor(e){this.typeCache=e.typeCache,this.type=e.type,this.value=e.endValue,this.target=e.target,this.callback=e.callback,this.duration=e.duration||0,this.delay=e.delay||0,this.infinite=e.infinite||!1,this.easingType=e.easing||"linear",this.animation=e.animation,this.startTime=0,this.endTime=0,this.doneTime=0,this.doingTime=0,this.startValue=null,this.currentValue=null,this.endValue=null,this.isResume=!1,this.stopped=!1,this.ended=!1,this.record={delay:this.delay},this.easing={linear:(e,A,t,i)=>t*(e/i)+A,easeOut:(e,A,t,i)=>-t*(Math.pow(e/i-1,4)-1)+A},this.defaultValue={translate:[0,0],scale:[1,1],skew:[0,0],opacity:1,rotate:0,rotateX:0,rotateY:0,rotateZ:0}}init(){if(!this.stopped){this.startTime=this.startTime||this._getNow();var e=this._getNow();if(e===this.startTime&&this._before(),this._getNow()-this.startTime<this.delay)return!0;if(!((this.endTime||this.startTime+this.duration+this.delay)<e))return this._run(),!0;this.ended=!0,this._after(),this.infinite&&(this.startTime=0,this.endTime=0,this.delay=this.record.delay,this.isResume=!1),this.callback&&isType$1(this.callback,"Function")&&this.callback(this.target)}return!1}pause(){this.stopped=!0,this.doneTime=this._getNow()-this.startTime-this.delay}resume(){return!(!this.stopped||(this.isResume=!0,this.record.delay=this.delay,this.delay=0,this.startTime=this._getNow(),this.endTime=this.duration-this.doneTime+this._getNow(),this.stopped=!1))}_before(){this.target.setVisible(!0);var e=this.typeCache;e&&(checkRegExp("^toZoom.*$",e)?this.target.style.transformOrigin="top left":checkRegExp("^(from)|(fadeIn).*$",e)&&("translate"===this.type&&(this._setFromFlyValue(),e=this._getValue(this.type),this.target.style.translate=[-this.value[0]+e[0],-this.value[1]+e[1]]),"scale"===this.type&&this._setFromZoomValue(),"opacity"===this.type)&&(this.target.style.opacity=0))}_after(e=!1){this.target.style[this.type]=this.endValue;var A=this.typeCache;A&&(checkRegExp("^fromZoom.*$",A)?this.target.style.transformOrigin="":checkRegExp("^(to)|(fadeOut).*$",A)&&(e||this.target.setVisible(!1),"translate"===this.type&&(this.target.style.translate=this.startValue),"opacity"===this.type&&(this.target.style.opacity=this.startValue),"scale"===this.type)&&(this.target.style.scale=this.startValue,this.target.style.transformOrigin=""))}_run(){if(!this.target)return!1;this.startValue=this.startValue||this._getValue(this.type),this.endValue=this.endValue||this._getEndValue(this.value);var e=this._getNow();return this.isResume?this.doingTime=e-this.startTime+this.doneTime:this.doingTime=e-this.startTime-this.delay,this.currentValue=isType$1(this.endValue,"Array")?this.endValue.map(((e,A)=>this.easing[this.easingType](this.doingTime,this.startValue[A],e-this.startValue[A],this.duration))):this.easing[this.easingType](this.doingTime,this.startValue,this.endValue-this.startValue,this.duration),this.target.style[this.type]=this.currentValue,!0}_getValue(e){var A=this.target.style[this.type];return isDef(A)?A:this.defaultValue[e]}_getEndValue(e){var A={"[object Array]":e,"[object String]":[Number(e),Number(e)],"[object Number]":[e,e]};let t=e;return["translate","scale","skew"].includes(this.type)&&(t=A[Object.prototype.toString.call(e)]),"translate"===this.type?t.map(((e,A)=>e+this.startValue[A])):t}_getNow(){return Date.now()}_setFromFlyValue(){if(checkRegExp("^fromFly.*$",this.typeCache)){var e=this.target.style.width,A=this.target.style.height;switch(this.typeCache){case"fromFlyTop":this.value=[0,A];break;case"fromFlyBottom":this.value=[0,-A];break;case"fromFlyLeft":this.value=[e,0];break;case"fromFlyRight":this.value=[-e,0]}}}_setFromZoomValue(){var e=this.typeCache;if(checkRegExp("^fromZoom.*$",e)){var A=this._getValue(this.type);let t=[];switch(e){case"fromZoomInVer":t=[1,.5];break;case"fromZoomInHor":t=[.5,1];break;case"fromZoomIn":t=[.5,.5];break;case"fromZoomOutVer":t=[1,1.5];break;case"fromZoomOutHor":t=[1.5,1];break;case"fromZoomOut":t=[1.5,1.5]}this.target.style.transformOrigin="top left",this.target.style.scale=[t[0]*A[0],t[1]*A[1]]}}}class Animator{constructor(e,A){this.opts=e,this.target=A,this.tweens=[],this.init()}init(){isType$1(this.opts,"Array")?this.opts.forEach((e=>{this._dealTarget(e)})):this._dealTarget(this.opts)}_dealTarget(e){let A=e.target;isUnDef(A)&&(A=this.target,e[A]=this.target),confirmArr(A)?A.forEach((A=>{this._dealGroup(A,e)})):this._dealGroup(A,e)}_dealGroup(e,A){checkLayoutType(e,LAYOUT_MAP.GROUP)?e.containers.forEach((e=>{this._dealAnimation({...A,target:e})})):this._dealAnimation({...A,target:e})}_dealAnimation(e){isType$1(e.animation,"Object")?this._createTick(e):this._createTick((new SceneTransition).animator(e))}_createTick(e){const A=Object.keys(e.animation);A.forEach(((t,i)=>{this.tweens=[...this.tweens,new Tick({...e,type:t,endValue:e.animation[t],callback:i===A.length-1?e.callback:null})]}))}}class AnimatorManager{constructor(e,A){this.sequence=A||new Sequence,this._running=e||!1,this._tier=1,this._instance=null,this._callbacks=[]}run(e,A,t){return this.sequence.addTicks(new Animator(e,t).tweens,this._tier,A),this._startLoop(),this.initRunner(),this._instance}initRunner(){this._instance=new AnimatorManager(this._running,this.sequence),this._instance._tier=this._tier+1,this._instance._callbacks=this._callbacks}end(){this._running&&(this._running=!1,this._callbacks=[],this.sequence.endAnimation())}pause(){isUnDef(this.ticks)||(this._running=!1,this.ticks.forEach((e=>e.pause())))}resume(){isUnDef(this.ticks)||(this.ticks.forEach((e=>e.resume())),this._startLoop())}getCallback(){return this.sequence.totalCallbacks}register({name:e,animation:A}){(new SceneTransition).registAnimation({name:e,animation:A})}_startLoop(){if(this._running)return!1;const e=this;return e._running=!0,window.requestAnimationFrame((function A(){e._running&&(window.requestAnimationFrame(A),e._flush())})),!0}_flush(){const e=this.sequence.callbacks;if(this.ticks=this.sequence.getCurrentTicks(),this.ticks.forEach(((A,t)=>{A&&A.forEach(((i,s)=>{!isDef(i)||i.init()||i.infinite||(this.sequence._recordRanTick(i),A.splice(s,1,null)),A.every((e=>isUnDef(e)))&&(e[t]&&isType$1(e[t],"Function")&&e[t](),e[t]=null)}))})),this.sequence.isFinish()){this._running=!1;var A=this._callbacks.length;for(let e=0;e<A;e++){var[t,,]=this._callbacks.shift();isType$1(t,"Function")&&t()}}}_registerCallback(e,A){isType$1(e,"Function")&&this._callbacks.push([e.bind(e=A||this),e])}_destroyCallback(){this._callbacks=[]}_end(e){this._running&&(this._callbacks.length&&(this._callbacks=this._callbacks.filter((([,A])=>A&&A.id!==e.id))),this.sequence._endAnimation(e))}}var version$1="0.1.98";class Align{constructor(){}top(e){e=this._getEls(e);var A=this._getBoundaryVal("top",e);isType$1(A,"Null")||this._render("top",e,A)}bottom(e){e=this._getEls(e);var A=this._getBoundaryVal("bottom",e);isType$1(A,"Null")||this._render("bottom",e,A)}left(e){e=this._getEls(e);var A=this._getBoundaryVal("left",e);isType$1(A,"Null")||this._render("left",e,A)}right(e){e=this._getEls(e);var A=this._getBoundaryVal("right",e);isType$1(A,"Null")||this._render("right",e,A)}horizal(e){e=this._getEls(e);var A=this._getBoundaryVal("horizal",e);isType$1(A,"Null")||this._render("horizal",e,A)}vertical(e){e=this._getEls(e);var A=this._getBoundaryVal("vertical",e);isType$1(A,"Null")||this._render("vertical",e,A)}_render(e,A,t){A.forEach((A=>{var i,s=A.bound.plainReal()[e];if(!s||s-t)switch(e){case"top":case"bottom":A.move(0,t-s);break;case"left":case"right":A.move(t-s,0);break;case"vertical":checkLayoutType(A,[LAYOUT_MAP.GROUP])?(i=this._getBoundaryVal("vertical",[A]),A.move(0,t-i)):A.move(0,t-A.height/2-A.bound.plainReal().top);break;case"horizal":checkLayoutType(A,[LAYOUT_MAP.GROUP])?(i=this._getBoundaryVal("horizal",[A]),A.move(t-i,0)):A.move(t-A.width/2-A.bound.plainReal().left,0)}}))}_getBoundaryVal(e,A){var t=A.reduce(((A,t)=>{var i=t.bound.plainReal();switch(e){case"vertical":A[0].push(i.top),A[1].push(i.bottom);break;case"horizal":A[0].push(i.left),A[1].push(i.right);break;default:A.push(i[e])}return A}),"vertical"===e||"horizal"===e?[[],[]]:[]);if("vertical"===e||"horizal"===e){if(!t[0].length||!t[1].length)return null}else if(!t.length)return null;switch(e){case"top":case"left":return Math.min(...t);case"bottom":case"right":return Math.max(...t);case"vertical":case"horizal":return(Math.min(...t[0])+Math.max(...t[1]))/2;default:return null}}_getEls(e){return e||selector.getSelectElements()}}var align=new Align;const{DOWN:DOWN,MOVE:MOVE,UP:UP}=EVENT_KEY,{CANDOWN:CANDOWN$2,CANMOVE:CANMOVE$2,CANUP:CANUP$2,ISSTOP:ISSTOP$1,ISPREVENT:ISPREVENT}=EVENT_CHECK,TYPE_CHECK={[DOWN]:CANDOWN$2,[MOVE]:CANMOVE$2,[UP]:CANUP$2};class MoveManager{constructor(){this.moveItem=null,this.mouseDownHandle=mouseDownEvent.bind(this),this.mouseMoveHandle=mouseMoveEvent.bind(this),this.mouseUpHandle=mouseUpEvent.bind(this),this.mapFns=new Map,this.mapChecks=new Map,this.buttons=0,this.initEvent()}initEvent(){document.addEventListener("mousemove",this.mouseMoveHandle),document.addEventListener("mouseup",this.mouseUpHandle)}add(e,A={},t=this){var i;e&&(({down:t,move:A,up:i}=(this.had(e,"Fns")||(this.mapFns.set(e,{self:e,ctx:t,down:[],move:[],up:[]}),this.addEvent(e)),A)),t&&this.mapFns.get(e).down.push(t),A&&this.mapFns.get(e).move.push(A),i)&&this.mapFns.get(e).up.push(i)}addEventChecks(e,A={}){var t;e&&!this.had(e,"Checks")&&(t={self:e,[ISSTOP$1]:null,[CANDOWN$2]:null,[CANMOVE$2]:null,[CANUP$2]:null},this.mapChecks.set(e,t),this.mapChecks.get(e)[ISSTOP$1]=A[ISSTOP$1],this.mapChecks.get(e)[CANDOWN$2]=A[CANDOWN$2],this.mapChecks.get(e)[CANMOVE$2]=A[CANMOVE$2],this.mapChecks.get(e)[CANUP$2]=A[CANUP$2])}addEvent(e){e.addEventListener("mousedown",this.mouseDownHandle)}remove(e){e&&this.mapFns.get(e)&&(this.destroyEvent(e),this.mapFns.delete(e),this.mapChecks.delete(e))}destroyEvent(e){e&&e.removeEventListener("mousedown",this.mouseDownHandle)}destroy(){this.mapFns.forEach((e=>{this.destroyEvent(e.self)})),document.removeEventListener("mousemove",this.mouseMoveHandle),document.removeEventListener("mouseup",this.mouseUpHandle),this.mapFns.clear(),this.mapChecks.clear(),this.moveItem=null}had(e,A){return!!this["map"+A].get(e)}getHandles(e){return Object.assign({},this.mapFns.get(e),this.mapChecks.get(e))}execute(e,A){const t=this.moveItem;if(t){var{stopProp:i,preventDeft:s}=this.getPropDeft(t,e);if(i&&e.stopPropagation(),s&&e.preventDefault(),!t[TYPE_CHECK[A]]||t[TYPE_CHECK[A]](e)){const s=getMouseBtnType(this.buttons);if(i=t[A])try{isType$1(i,"Function")?i(e):isType$1(i,"Array")?i.forEach((A=>{isType$1(A,"Function")&&A(e),isType$1(A,"Object")&&(isType$1(A[s],"Function")&&A[s].call(t.context,e),isType$1(A.default,"Function"))&&A.default.call(t.context,e)})):isType$1(i,"Object")&&(isType$1(i[s],"Function")&&i[s].call(t.context,e),isType$1(i.default,"Function"))&&i.default.call(t.context,e)}catch(A){log.error(A)}}}}getPropDeft(e,A){var t=e[ISSTOP$1];let i,s;return i=isType$1(t,"Boolean")?t:!isType$1(t,"Function")||t(A),s=isType$1(t=e[ISPREVENT],"Boolean")?t:!!isType$1(t,"Function")&&t(A),{stopProp:i,preventDeft:s}}}var moveManager=new MoveManager;function mouseDownEvent(e){this.moveItem=this.getHandles(e.currentTarget),this.buttons=e.buttons,this.execute(e,DOWN)}function mouseMoveEvent(e){this.execute(e,MOVE)}function mouseUpEvent(e){this.execute(e,UP),this.moveItem=null,this.buttons=0}class ElementRotate{constructor(e,A){this.instance=e,this.mouseRoate=A}elementRotate(){let e=this.instance.bound.record.angle+this.mouseRoate;180<e&&(e-=360),e<-180&&(e=360+e),this.instance.setBound({angle:e})}}const{ISSTOP:ISSTOP,CANDOWN:CANDOWN$1,CANMOVE:CANMOVE$1,CANUP:CANUP$1}=EVENT_CHECK;class BaseGraph{constructor(){this.elements=null}getMoveType(e){return this.elements=this._checkBeforeMove(e),isUnDef(this.elements)?"regionSelect":"move"}checkBeforeMove(){var e;return!(e=(e=selector.getLayers()).length?e:selector.getContainers()).length||checkLock(e)?null:e}addEventChecks(e){moveManager.addEventChecks(e.el,this.checkBeforeDoEvent(e))}checkBeforeDoEvent(e){return{[CANDOWN$1]:A=>this.canDown(e,A),[CANMOVE$1]:A=>this.canMove(e,A),[CANUP$1]:A=>this.needUp(e),[ISSTOP]:A=>this.checkPropagation(A,e)}}reset(){this.elements=null}remove(e){moveManager.remove(e.el)}checkPropagation(e,A){return!checkMouseBtnType(e,"right")||this.ui.rightMoveCanvasLock.defaultCtLock&&checkLayoutType(A,LAYOUT_MAP.DEFAULTCONTAINER)||A.previewModeState}canDown(e,A){return e.eventActive&&checkMouseBtnType(A,"left")&&!this.isInEditing(e)}canMove(e,A){return this.canDown(e,A)}needUp(e){return e.eventActive&&!this.isInEditing(e)}isInEditing(e){return textEditor.isInEdit&&textEditor.target&&textEditor.target.id===e.id}_checkBeforeMove(e){return!0===e.shiftKey?(selector.clear(),null):this.checkBeforeMove()}}class Rotator extends BaseGraph{constructor(){super(),this.tag=!1,this.pointA=null,this.pointB={x:0,y:0},this.pointC={x:0,y:0},this.allAngle=0}init({ui:e}){this.ui=e,this.rotateModule=new ElementRotate}addEventHandle(e){this.initRotateEvent(e)}initRotateEvent(e){e.el.firstElementChild&&moveManager.add(e.el.firstElementChild,{down:A=>{this.initDownRotate(A),this.handler=e,recordBound(selector.getSelectElements())},move:e=>{this.rotateEvent(e)},up:e=>{this.upEvent(e)}})}initDownRotate(e){var A=selector.getContainers(),{top:t,left:i}=(A=(this.pointA=A.map((e=>{var{width:A,height:t,left:i,top:s}=e.bound.plainReal();return{id:e.id,x:i+A/2,y:s+t/2}})),this.ui.canvas.getZoom()),this.ui.canvas.el.getBoundingClientRect());this.pointB.x=(e.clientX-i)/A,this.pointB.y=(e.clientY-t)/A}rotateEvent(e){var A,t,i,s=this.checkBeforeMove();null===s?this.reset():e&&(e.preventDefault(),e.stopPropagation(),A=this.ui.canvas.getZoom(),({top:t,left:i}=this.ui.canvas.el.getBoundingClientRect()),this.pointC.x=(e.clientX-i)/A,this.pointC.y=(e.clientY-t)/A,this.tag=!0,this.rotate(s),this.ui.emit("graphRotating"))}rotate(e){e.forEach((e=>this._rotate(e)))}_rotate(e){var A,t={},i={},s=this.pointA.find((A=>A.id===e.id));s&&(t.X=this.pointB.x-s.x,t.Y=this.pointB.y-s.y,i.X=this.pointC.x-s.x,i.Y=this.pointC.y-s.y,t=t.X*i.Y-t.Y*i.X,i=Math.sqrt(Math.pow(s.x-this.pointB.x,2)+Math.pow(s.y-this.pointB.y,2)),s=Math.sqrt(Math.pow(s.x-this.pointC.x,2)+Math.pow(s.y-this.pointC.y,2)),A=Math.sqrt(Math.pow(this.pointB.x-this.pointC.x,2)+Math.pow(this.pointB.y-this.pointC.y,2)),A=(Math.pow(i,2)+Math.pow(s,2)-Math.pow(A,2))/(2*i*s),i=Math.round(180*Math.acos(A)/Math.PI),this.allAngle=t<0?-i:i,this.rotateModule.instance=e,this.rotateModule.mouseRoate=this.allAngle,this.rotateModule.elementRotate())}upEvent(){this.tag?this.ui.emit("graphRotateEnd",selector.getSelectElements()):this.reset()}reset(){this.tag=!1,this.pointA=null,this.pointB.x=0,this.pointB.y=0,this.pointC.x=0,this.pointC.y=0,this.allAngle=0}handleRotateAxis(e){var{width:A,height:t}=e.bound;e=e.bound.record.angle,e=this.allAngle+e;return this._handleRotateAxis([{index:7,x:A/2,y:-t/2},{index:6,x:-A/2,y:-t/2},{index:5,x:A/2,y:t/2},{index:4,x:-A/2,y:t/2},{index:3,x:A/2,y:0},{index:2,x:-A/2,y:0},{index:1,x:0,y:-t/2},{index:0,x:0,y:t/2}],e)}_handleRotateAxis(e,A){return e.map((e=>{var t={index:e.index};return t.x=e.x*Math.cos(-A*Math.PI/180)-e.y*Math.sin(-A*Math.PI/180),t.y=e.x*Math.sin(-A*Math.PI/180)+e.y*Math.cos(-A*Math.PI/180),t}))}}var rotator=new Rotator;class Scale{constructor(e){this.instance=e,this.boundInfo={},this.resInfo=null}resizeHandler(){checkLayoutType(this.instance,LAYOUT_MAP.CONTAINER)?this.doResize():checkLayoutType(this.instance,LAYOUT_MAP.LAYER)&&(this.doResize(),this.instance.getContainers().forEach((e=>{this.doResize(e)})))}doResize(e){e=e||this.instance;var{width:A,height:t}=e.bound.plainReal(),{width:A=A,height:t=t}=this.resInfo,{mathHeight:i,mathWidth:s,mathTop:n,mathLeft:r}=this.calculateSizePosition();!e.isLock&&0<A&&0<t&&e.setBound({height:i,width:s,top:n,left:r})}calculateSizePosition(){var{height:e,width:A}=this.boundInfo.rootBound,{width:t,height:i,x:s,y:n}=this.resInfo,i=i/e,e=t/A,{relativeTop:t,offsetTop:A,relativeLeft:r,offsetLeft:o}=this.boundInfo.ctBound,a=this.instance.bound.record;return{mathHeight:Math.floor(a.height*i),mathWidth:Math.floor(a.width*e),mathTop:Math.floor(t*i+n-A),mathLeft:Math.floor(r*e+s-o)}}}class Bound{constructor(){this.rootBound=null,this.ctsBound=new Map}init(e){this.ui=e}initBoundInfo(e){if(e){const{top:A,left:t}=this.rootBound=this.ui.getBoundRect();e.forEach((e=>{var{top:i,left:s}=e.bound.plainReal(),{top:n,left:r}=e.bound.offset;this.ctsBound.set(e.id,{relativeTop:i-A,relativeLeft:s-t,offsetTop:n,offsetLeft:r})}))}}upEvent(){this.rootBound=null,this.ctsBound=new Map}}var bound=new Bound;const INDEX={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3};class Resizer extends BaseGraph{constructor(){super(),this.clickPoint=null,this.symmetricPoint=null,this.centerPosition=null,this.handler=null,this.elements=null,this.angle=0,this.mouseMoveInfo={x:0,y:0},this._mouseMoveInfo={x:0,y:0},this.x=0,this.y=0,this.offset={x:0,y:0},this.handler=null,this.sizePositionInfo=null,this.canMoveX=!0,this.canMoveY=!0}init({ui:e}){this.ui=e,this.scaleModule=new Scale,bound.init(e)}addEventHandle(e){this.initResizeEvent(e)}initResizeEvent(e){moveManager.add(e.el,{down:A=>{this.doDown(A,e)},move:e=>{this.doMove(e)},up:e=>{this.upEvent(e)}})}doDown(e,A){var t,i,s;e.stopPropagation(),this.x=e.clientX,this.y=e.clientY,this.handler=A,recordBound(selector.getSelectElements()),isUnDef(e=this.elements=this.checkBeforeMove())?this.reset():(bound.initBoundInfo(e),({top:A,left:e,width:t,height:i,angle:s}=bound.rootBound),this.angle=s,s=this.centerPosition={x:e+t/2,y:A+i/2},this.clickPoint=this.getClickPoint(s),this.symmetricPoint={x:s.x-(this.clickPoint.x-s.x),y:s.y-(this.clickPoint.y-s.y)})}doMove(e){var A,t=this.elements;isUnDef(t)?this.reset():(this.ui.emit("graphResizeStart",{elements:t}),e&&(e.preventDefault(),e.stopPropagation(),A=this.ui.canvas.getZoom(),this._mouseMoveInfo.y+=(e.clientY-this.y)/A,this._mouseMoveInfo.x+=(e.clientX-this.x)/A,this.canMoveX&&(this.mouseMoveInfo.x=this._mouseMoveInfo.x),this.canMoveY&&(this.mouseMoveInfo.y=this._mouseMoveInfo.y),this.x=e.clientX,this.y=e.clientY),A=this.getRelativePosition(this.x,this.y),e||(A.x+=this.offset.x,A.y+=this.offset.y),this.sizePositionInfo=this.calculateSizeAndPos(this.angle,A,{symmetricPoint:this.symmetricPoint}),this.resize(t,this.sizePositionInfo),this.ui.emit("graphResizing",{event:e,elements:t,handler:this.handler}))}resize(e,A){if(A){const t=this.handler.index;e.forEach((e=>this._scale(e,t,A)))}}upEvent(){this.ui.emit("graphResizeEnd"),bound.upEvent(),this.reset()}_scale(e,A,t){this.scaleModule.instance=e,this.scaleModule.index=A,this.scaleModule.boundInfo.rootBound=bound.rootBound,this.scaleModule.boundInfo.ctBound=bound.ctsBound.get(e.id),this.scaleModule.resInfo=t,this.scaleModule.resizeHandler()}reset(){super.reset(),this.clickPoint=null,this.symmetricPoint=null,this.centerPosition=null,this.handler=null,this.elements=null,this.angle=0,this.mouseMoveInfo.x=0,this.mouseMoveInfo.y=0,this._mouseMoveInfo.x=0,this._mouseMoveInfo.y=0,this.x=0,this.y=0,this.sizePositionInfo=null}getClickPoint(e){var{top:A,left:t,width:i,height:s,angle:n}=bound.rootBound;let r;switch(this.handler.index){case 0:r={x:t+i/2,y:A};break;case 1:r={x:t+i/2,y:A+s};break;case 2:r={x:t,y:A+s/2};break;case 3:r={x:t+i,y:A+s/2};break;case 4:r={x:t,y:A};break;case 5:r={x:t+i,y:A};break;case 6:r={x:t,y:A+s};break;case 7:r={x:t+i,y:A+s}}return n?this.calculateRotatedPointCoordinate(r,e,n):r}getRelativePosition(e,A){var t=this.ui.canvas.getZoom(),{top:i,left:s}=this.ui.canvas.el.getBoundingClientRect();return{x:(e-s)/t,y:(A-i)/t}}calculateAxisRotatedPoint(e,A){return A=this.angleToRadian(A),{x:e.x*Math.cos(A)-e.y*Math.sin(A),y:e.y*Math.cos(A)+e.x*Math.sin(A)}}restAxisPoint(e,A){return e=this.calculateAxisRotatedPoint(e,-A),{x:this.centerPosition.x+e.x,y:this.centerPosition.y-e.y}}calculateRotatedPointCoordinate(e,A,t){return t=this.angleToRadian(t),{x:(e.x-A.x)*Math.cos(t)-(e.y-A.y)*Math.sin(t)+A.x,y:(e.x-A.x)*Math.sin(t)+(e.y-A.y)*Math.cos(t)+A.y}}angleToRadian(e){return e*Math.PI/180}calculateSizeAndPos(e,A,t){t=t.symmetricPoint;var i=this.getCenterPoint(A,t),s=this.calculateRotatedPointCoordinate(t,i,-e),n=this.handler.index;if(Object.values(INDEX).includes(n)){const t={curPositon:A,newSymmetricPoint:s};if(n=this.calculatePoint(t,e,n))return n}else if(t=this.calculateRotatedPointCoordinate(A,i,-e),n=Math.abs(t.x-s.x),A=Math.abs(s.y-t.y),0<n&&0<A)return{width:n,height:A,x:Math.min(t.x,s.x),y:Math.min(t.y,s.y)};return null}getCenterPoint(e,A){return{x:e.x+(A.x-e.x)/2,y:e.y+(A.y-e.y)/2}}calculatePoint(e,A,t){switch(t){case INDEX.TOP:case INDEX.BOTTOM:return this.calculateYPoint(e,A,t);case INDEX.RIGHT:case INDEX.LEFT:return this.calculateXPoint(e,A,t)}}calculateYPoint(e,A,t){var{curPositon:e,newSymmetricPoint:i}=e,{width:s,height:n}=bound.rootBound;e={x:e.x-this.centerPosition.x,y:this.centerPosition.y-e.y},e={x:0,y:this.calculateAxisRotatedPoint(e,A).y};let r,o;if(t===INDEX.TOP){if(r={x:0,y:-n/2},e.y<=r.y)return null;o=e.y+n/2}else if(t===INDEX.BOTTOM){if(r={x:0,y:n/2},e.y>=r.y)return null;o=n/2-e.y}n=this.getCenterPoint(e,r),e=this.restAxisPoint(e,A);var n=this.restAxisPoint(n,A),a=this.calculateRotatedPointCoordinate(e,n,-A);let l;switch(t){case INDEX.TOP:l=Math.min(a.y,i.y);break;case INDEX.BOTTOM:l=a.y-o}return{width:s,height:o,x:a.x-s/2,y:l}}calculateXPoint(e,A,t){var{curPositon:e,newSymmetricPoint:i}=e,{width:s,height:n}=bound.rootBound;e={x:e.x-this.centerPosition.x,y:this.centerPosition.y-e.y},e={x:this.calculateAxisRotatedPoint(e,A).x,y:0};let r,o;if(t===INDEX.RIGHT){if(r={x:-s/2,y:0},e.x<=r.x)return null;o=e.x+s/2}else if(t===INDEX.LEFT){if(r={x:s/2,y:0},e.x>=r.x)return null;o=s/2-e.x}s=this.getCenterPoint(e,r),e=this.restAxisPoint(e,A);var s=this.restAxisPoint(s,A),a=this.calculateRotatedPointCoordinate(e,s,-A);let l;switch(t){case INDEX.RIGHT:l=a.x-o;break;case INDEX.LEFT:l=Math.min(a.x,i.x)}return{width:o,height:n,x:l,y:a.y-n/2}}}var resizer=new Resizer;class CalculateSelect{constructor(){this.context=null,this.boxHeight=0,this.boxWidth=0,this.boxLeft=0,this.boxTop=0}setInfo(e){var{context:e,width:A,height:t,top:i,left:s}=e;this.context=e,this.boxHeight=t,this.boxWidth=A,this.boxLeft=s,this.boxTop=i}calculateSelect(e,A,t){e.forEach((e=>{var{left:i,top:s,width:n,height:r}=e.bound.plainReal(),o=Math.max(i+n,this.boxLeft+this.boxWidth),i=Math.min(i,this.boxLeft),a=Math.max(s+r,this.boxTop+this.boxHeight),s=Math.min(s,this.boxTop);o-i<=n+this.boxWidth&&a-s<=r+this.boxHeight?isType$1(A,"Function")&&A.call(this.context||this,e):isType$1(t,"Function")&&t.call(this.context||this,e)}))}reset(){this.context=null,this.boxHeight=0,this.boxWidth=0,this.boxLeft=0,this.boxTop=0}}class RegionSelector extends BaseGraph{constructor(){super(),this.tag=!1,this.box=null,this.x=0,this.y=0,this.start_left=0,this.start_top=0,this.moveInfo={x:0,y:0},this.can=!1,this.realEls=[],this.preselectEls=[],this.after=!0,this.moveType=null}init({ui:e,canvas:A}){this.ui=e,this.canvas=A,this.initBox(),this.cs=new CalculateSelect}addEventHandle(e){this.initRegionSelectEvent(e)}initRegionSelectEvent(e){moveManager.add(e.el,{down:e=>{this.beforeRegionSelect(e)},move:A=>{this.moveType||(this.moveType=this.getMoveType(A)),"regionSelect"===this.moveType&&this.regionSelect(e,A)},up:e=>{this.upEvent(e)}})}checkBeforeRegionSelect(e){return!(!e||e.previewModeState||this.ui.insidePreview||this.ui.regionSelectLock||this.ui.tempRegionSelectLock)}initBox(){var e=createElement();e.dataset.id="regionSelector",e.style.display="none",e.style.zIndex=999,e.style.width="0px",e.style.height="0px",e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.backgroundColor="rgb(0, 122, 255, 0.1)",this.box=e,this.canvas.el.appendChild(this.box)}getCanvasBound(){var{left:e,top:A}=this.canvas.el.getBoundingClientRect();return{left:e,top:A}}beforeRegionSelect(e){var A=this.ui,t=A.layers.find((e=>e.id===selector.selectLayerId)),i=t?t.containers:null;t=t?t.groups:null,this.initDownpoints(e),e=i||A.containers;this.can=!0,!e.length||checkLock(e)?this.can=!1:(i=t||A.groups,this.realEls=e.filter((e=>!checkLayoutType(e.parent,LAYOUT_MAP.GROUP))).concat(i.filter((e=>!checkLayoutType(e.parent,LAYOUT_MAP.GROUP)))))}initDownpoints(e){var A=this.canvas.getZoom(),{left:t,top:i}=(this.x=e.clientX,this.y=e.clientY,this.getCanvasBound());this.start_top=(e.clientY-i)/A,this.start_left=(e.clientX-t)/A}regionSelect(e,A){var t,i,s,n,r;A&&this.can&&((checkLayoutType(e,LAYOUT_MAP.LAYER)||e.isLock)&&e.unselect(),A.preventDefault(),A.stopPropagation(),this.after&&this.ui.emit("graphRegionSelectStart"),this.after=!1,this.box.style.border||(this.box.style.border="2px solid rgb(0, 122, 255)"),"block"!==this.box.style.display&&(this.box.style.display="block"),e=A.clientX,A=A.clientY,r=this.canvas.getZoom(),this.moveInfo.y+=(A-this.y)/r,this.moveInfo.x+=(e-this.x)/r,t=Math.abs(this.moveInfo.y),i=Math.abs(this.moveInfo.x),({left:s,top:n}=(this.box.style.height=t+"px",this.box.style.width=i+"px",this.getCanvasBound())),s=(e-s)/r,n=Math.min((A-n)/r,this.start_top),r=Math.min(s,this.start_left),this.box.style.top=n+"px",this.box.style.left=r+"px",this.tag=!0,this.can&&(this.cs.setInfo({context:this,width:i,height:t,top:n,left:r}),this.cs.calculateSelect(this.realEls,this.preselect,this.unpreselect)),this.x=e,this.y=A,this.ui.emit("graphRegionSelecting"))}upEvent(){this.tag&&(this.select(),this.ui.emit("graphRegionSelectEnd",selector.getSelectElements()),this.box.style.display="none",this.box.style.width="0px",this.box.style.height="0px",this.box.style.top=0,this.box.style.left=0,this.box.style.border="",selector.disableMultSelect()),this.reset()}preselect(e){selector.enableMultSelect(),e.isLock||!e.visible||e.isSelected||this._preselect(e)}unpreselect(e){this._unpreselect(e)}select(){this.preselectEls.length&&this.preselectEls.forEach((e=>{selector.select(e)}))}handlePreselect(){var e=this.canvas.operation,A=e.boundRectUnion(this.preselectEls),t=e.selectType(),i=this.canvas.getZoom();e.showRect(A,i,t,!0),e.hideSubRect(),e.showResize(A,i,t,{showRotateTag:!1,showResizeTag:!0,preselectionTag:!0})}showSelectRect(){this.canvas.showSelectRect(this.preselectEls)}hiddenSelectRect(e){this.canvas.hiddenSelectRect(e)}canDown(e,A){return super.canDown(e,A)&&this.checkBeforeRegionSelect(e)}canMove(e,A){return this.canDown(e,A)}reset(){super.reset(),this.x=0,this.y=0,this.start_left=0,this.start_top=0,this.moveInfo.x=0,this.moveInfo.y=0,this.cs.reset(),this.preselectEls=[],this.realEls=[],this.after=!0,this.tag=!1,this.moveType=null}_preselect(e){this.preselectEls.includes(e)||this.preselectEls.push(e),this.handlePreselect(),this.showSelectRect()}_unpreselect(e){var A;this.preselectEls.length?(-1!==(A=this.preselectEls.findIndex((A=>A.id===e.id)))&&(this.preselectEls.splice(A,1),this.hiddenSelectRect([e])),this.handlePreselect()):this.canvas.operation.elhidden()}}var regionSelector=new RegionSelector;class ShareData{constructor(){this.x=0,this.y=0}reset(){this.x=0,this.y=0}}var shareData=new ShareData;const MOUSETYPE={DOWN:"mousedown",DBLCLICK:"dblclick"},DBLCLICKAREA=4;class SelectDown extends BaseGraph{constructor(){super(),this.target=null,this.timestamp=null,this.timeout=280,this.clickType=null,this.point={x:0,y:0}}init({ui:e}){this.ui=e}addEventHandle(e){this.initSelectEvent(e)}initSelectEvent(e){moveManager.add(e.el,{down:A=>{this.mousedownEvent(A,e)},up:e=>{this.upEvent(e)}})}executeSelect(e,A){!1===e.shiftKey&&selector.isMultSelect&&selector.disableMultSelect(),this.target=A,this.beforeSelect(e)}getRealSelect(e){return this.getCtInnerGroup(e)||(!e.isSelected&&checkLayoutType(e.parent,LAYOUT_MAP.GROUP)?this.getRealSelect(e.parent):e)}getDBSelect(e){var A=e.parent;return e.isSelected||!checkLayoutType(A,LAYOUT_MAP.GROUP)||A.isSelected?(A.isSelected&&A.unselect(),e):this.getDBSelect(A)}getPenetrateSelect(e){var A=e.parent;return e.hiddenPreSelector&&e.hiddenPreSelector(),A.isSelected&&A.unselect(),e}select(e){let A=null;(A=e.preSelected?this.getPenetrateSelect(e):this.clickType===MOUSETYPE.DBLCLICK?this.getDBSelect(e):this.getRealSelect(e)).isSelected?selector.isMultSelect&&A.unselect():A.select()}getCtInnerGroup(e){var A,t=this.ui.selector.getSelectElements()[0];return!!isInnerGroup(t,e)&&(A={curTarget:t,nextTarget:e},e.parent.id===t.parent.id||handleInclude(A,"nextParentIncludeCurTarget")?e:!!handleInclude(A,"curParentIncludeNextTarget")&&getRealInnerGroup(e,t.parent))}beforeSelect(e){this.target&&!this.checkMultiMove(e)&&this.select(this.target),shareData.x=e.clientX,shareData.y=e.clientY,recordBound(selector.getSelectElements())}mousedownEvent(e,A){var t,i=new Date;isUnDef(this.timestamp)||i.getTime()-this.timestamp>this.timeout?(this.timestamp=i.getTime(),this.clickType=MOUSETYPE.DOWN,this.executeSelect(e,A),this.setMousePoint(e)):(({x:i,y:t}=this.point),Math.abs(i-e.clientX)>DBLCLICKAREA||Math.abs(t-e.clientY)>DBLCLICKAREA?(this.clickType=MOUSETYPE.DOWN,this.executeSelect(e,A)):(this.clickType=MOUSETYPE.DBLCLICK,this.dblclickEvent(e,A)),this.resetMouseDown())}resetMouseDown(){this.timestamp=null,this.point.x=0,this.point.y=0}setMousePoint(e){this.point.x=e.clientX,this.point.y=e.clientY}dblclickEvent(e,A){this.indblclick?this.indblclick=!1:A.isSelected&&"dblclick"===e.type?(!selector.isMultSelect&&isMultiSelect()&&(selector.clear(),this.select(A)),A.textEditState&&textEditor.enterTextEdit(A)):!A.isSelected&&checkLayoutType(A.parent,LAYOUT_MAP.GROUP)&&(this.indblclick=!0,this.select(A),this.clickType=null)}checkMultiMove(e){return checkLayoutType(this.target,LAYOUT_MAP.LAYER)?multiSelectMove.checkMove(e):checkLayoutType(this.target,LAYOUT_MAP.CONTAINER)?this.target.isLock&&multiSelectMove.checkMove(e):void 0}upEvent(){this.reset()}canMove(e,A){return this.canDown(e,A)&&this.clickType===MOUSETYPE.DOWN}reset(){shareData.x=0,shareData.y=0,this.target=null}}var selectDown=new SelectDown;function isInnerGroup(e,A){return e&&!A.isSelected&&checkLayoutType(e.parent,LAYOUT_MAP.GROUP)&&checkLayoutType(A.parent,LAYOUT_MAP.GROUP)}function getRealInnerGroup(e,A){return function e(t){return!!checkLayoutType(t.parent,LAYOUT_MAP.GROUP)&&(t.parent.id===A.id?t:e(t.parent))}(e)}function handleInclude(e,A){var{curTarget:t,nextTarget:i}=e;let s,n;switch(A){case"curParentIncludeNextTarget":s=t,n=i;break;case"nextParentIncludeCurTarget":s=i,n=t}return s.parent.children.find((e=>e.id===n.parent.id||includeChild(e,n.parent.id)))}function includeChild(e,A){let t=!1;return checkLayoutType(e,LAYOUT_MAP.GROUP)?!!e.children.find((e=>e.id===A||includeChild(e,A))):t}class MultiSelectMove{constructor(){this.boundRange={},this.moving=!1}init({canvas:e,operation:A}){this.canvas=e,this.operation=A}setRange(){var e;this.operation&&(e=this.operation.getSelectBoundRect())&&Object.assign(this.boundRange,e)}initPoint(e){selectDown.executeSelect(e)}move(e){movement.doMove(e)}getMousePoint(e){var A=this.canvas.getZoom(),{left:t,top:i}=this.getCanvasBound(),i=(e.clientY-i)/A;return{x:(e.clientX-t)/A,y:i}}checkMove(e){var A=store$1$1.getSelectCtGroups();if(Object.keys(this.boundRange).length<=0||!A.length)this.reset();else{var{x:A,y:e}=this.getMousePoint(e),{top:t,bottom:i,left:s,right:n}=this.boundRange;if(t<=e&&e<=i&&s<=A&&A<=n)return this.moving=!0;this.moving=!1}return!1}getCanvasBound(){var{left:e,top:A}=this.canvas.el.getBoundingClientRect();return{left:e,top:A}}reset(){this.boundRange={},this.moving=!1}upEvent(){this.moving&&movement.upEvent()}}var multiSelectMove=new MultiSelectMove;class Movement extends BaseGraph{constructor(){super(),this.tag=!1,this.mouseMoveInfo={x:0,y:0},this._mouseMoveInfo={x:0,y:0},this.canMoveX=!0,this.canMoveY=!0,this.moveType=null}init({ui:e}){this.ui=e,this.moveModule=new ElementMove}addEventHandle(e){this.initMoveEvent(e)}initMoveEvent(e){moveManager.add(e.el,{move:e=>{this.moveType||(this.moveType=this.getMoveType(e)),"move"===this.moveType&&this.doMove(e)},up:e=>{this.upEvent(e)}})}move(e){e.forEach((e=>this._move(e)))}moveKeyEvent(e,A,t){var i=this.elements||(this.elements=this.checkBeforeMove());null===i?this.reset():(this.ui.emit("graphMoveStart",{elements:i}),this.tag||(recordBound(selector.getSelectElements()),this.tag=!0),this.mouseMoveInfo.x+=A,this.mouseMoveInfo.y+=t,this.move(i),this.ui.emit("graphMoving",{event:e,elements:i,isKeyMove:!0}))}upEvent(){this.tag&&(multiSelectMove.reset(),this.ui.emit("graphMoveEnd",selector.getSelectElements())),this.reset()}doMove(e){var A,t=this.elements||(this.elements=this.checkBeforeMove());isUnDef(t)?this.reset():(this.ui.emit("graphMoveStart",{elements:t}),e&&(e.preventDefault(),e.stopPropagation(),A=this.ui.canvas.getZoom(),this._mouseMoveInfo.y+=(e.clientY-shareData.y)/A,this._mouseMoveInfo.x+=(e.clientX-shareData.x)/A,this.canMoveX&&(this.mouseMoveInfo.x=this._mouseMoveInfo.x),this.canMoveY&&(this.mouseMoveInfo.y=this._mouseMoveInfo.y),shareData.x=e.clientX,shareData.y=e.clientY),this.tag=!0,this.move(t),this.ui.emit("graphMoving",{event:e,elements:t}))}_move(e){this.moveModule.instance=e,this.moveModule.mouseMoveInfo=this.mouseMoveInfo,this.moveModule.elementMove()}reset(){super.reset(),this.tag=!1,this.moveType=null,this.mouseMoveInfo.x=0,this.mouseMoveInfo.y=0,this._mouseMoveInfo.x=0,this._mouseMoveInfo.y=0}}var movement=new Movement;class HandlerManager{constructor(){this.rotator=rotator,this.regionSelector=regionSelector,this.movement=movement,this.selectDown=selectDown,this.resizer=resizer}init(e,A){isType$1(e,"Array")?e.forEach((e=>{this[e].init(A)})):this[e].init(A)}initEvent(e,A){isType$1(e,"Array")?e.forEach((e=>{this[e].addEventChecks(A),this[e].addEventHandle(A)})):(this[e].addEventChecks(A),this[e].addEventHandle(A))}remove(e){moveManager.remove(e.el)}destroy(){moveManager.destroy()}}var handlerManager=new HandlerManager;const{CANDOWN:CANDOWN,CANMOVE:CANMOVE,CANUP:CANUP}=EVENT_CHECK;class UIEvent{initUIEvent(){this.on("graphMoveEnd",(e=>{commandAPI.drag(e),this.setBoundRange()})).on("graphResizeEnd",(e=>{commandAPI.drag(e),this.setBoundRange()})).on("graphRotateEnd",(e=>{commandAPI.rotate(e)})).on("select",(e=>{this.setBoundRange()})).on("unselect",(e=>{textEditor.exitTextEdit(e)})),this.initEventChecks(),this.initMouseEvent(),this._resizeEvent=this.innerResize.bind(this),this._contextmenuEvent=this.contextmenuEvent.bind(this),this._keydownListener=this.keydownEvent.bind(this),this._scrollEvent=this.updateSite.bind(this),window.addEventListener("resize",this._resizeEvent),window.addEventListener("scroll",this._scrollEvent),document.addEventListener("contextmenu",this._contextmenuEvent),document.addEventListener("keydown",this._keydownListener)}removeUIEvent(){window.removeEventListener("resize",this._resizeEvent),window.removeEventListener("scroll",this._scrollEvent),document.removeEventListener("contextmenu",this._contextmenuEvent),document.removeEventListener("keydown",this._keydownListener)}eventMaps(){var e=new Map;return e.set("downLeft",(e=>{multiSelectMove.checkMove(e)?multiSelectMove.initPoint(e):(this.clickLeft(e),regionSelector.beforeRegionSelect(e),this.tagObj.canRegionSelect=!0)})),e.set("downRight",(e=>{this.canvas.lockBrowserEvent("contextmenu")})),e.set("moveLeft",(e=>{!this.tagObj.regionselect&&this.spaceDown?(this.tempRegionSelectLock=!0,this.canvasMoveBySpace=!0,this.moveCanvasBySpace(e)):multiSelectMove.moving?multiSelectMove.move(e):this.tagObj.canRegionSelect&&(this.tagObj.regionselect=!0,regionSelector.moveType="regionSelect",regionSelector.regionSelect(this,e))})),e.set("moveRight",(e=>{this.canvas._beginMove(),this.tagObj.canvasMoveByRight=!0,document.body.style.cursor||(document.body.style.cursor="pointer"),this.toMoveCanvas(e)})),e.set("upLeft",(e=>{this.canvasMoveBySpace?this.moveCanvasBySpaceEnd():(multiSelectMove.upEvent(),this.tagObj.regionselect&&regionSelector.upEvent()),this.tagObj.regionselect=!1,this.tagObj.canRegionSelect=!1,this.canvasMoveBySpace=!1})),e.set("upRight",(e=>{this.tagObj.canvasMoveByRight?(document.body.style.cursor="",this.emit("moveCanvasEnd",{})):(isMac&&this.canvas.emit("contextmenu"),this.canvas.unlockBrowserEvent("contextmenu")),this.tagObj.canvasMoveByRight=!1,this.canvas._endMove()})),e.set("upDefault",(e=>{this.tagObj.regionselect=!1,this.tagObj.canRegionSelect=!1,this.canvasMoveBySpace=!1})),e}checkBeforeDoEvent(){return{[CANDOWN]:e=>this.canDown(e),[CANMOVE]:e=>this.canMove(e),[CANUP]:e=>this.needUp(e)}}canDown(e){return!this.spaceDown&&!(checkMouseBtnType(e,"left")&&this.isPlayMode()||this.cannotRegionSelect())}canMove(e){return!(checkMouseBtnType(e,"rigth")&&this.spaceDown||checkMouseBtnType(e,"left")&&this.isPlayMode()&&!this.spaceDown||this.cannotRegionSelect())}needUp(e){return!(checkMouseBtnType(e,"left")&&!this.canvasMoveBySpace&&this.isPlayMode())}cannotRegionSelect(){return this.insidePreview||this.regionSelectLock||this.tempRegionSelectLock}}const SCROLL_PARAM={enable:!0,resize:!0,immediate:!0};class UI extends EventEmitter{constructor(e,A={},t={}){if(!(e=getElement(e)))throw new Error("无效dom");super(),this.type=LAYOUT_MAP.UI,this.lifeCycle=createLifeCycle(this),this.lifeCycle.call("beforeCreate"),this.id=getUID("ui"),this.rootEl=e,this.parentEl=null,this.el=null,this.options=clone(A),this.config=merge(defaultConfig[LAYOUT_MAP.UI],t),this.bound=null,this.nextTick=null,this.canvasMode=null,this.CANVASMODE=null,this.canvas=null,this.selector=null,this.animation=null,this.align=null,this.insidePreview=null,this.spaceDown=!1,this.canvasMoveBySpace=!1,this.tempRegionSelectLock=!1,this.store=store$1$1,this.regionSelectLock=!1,this.rightMoveCanvasLock={defaultCtLock:!0},this.resizeLock=!1,this.alignmentLineBase="layer",this.tagObj={},this.lifeCycle.call("created"),this.init()}get layers(){return store$1$1.getLayers()}get groups(){return store$1$1.getGroups()}get containers(){return store$1$1.getContainers()}get operation(){return this.canvas?this.canvas.operation:null}init(){this.id=getUID("ui"),this.parentEl=createElement(),this.parentEl.style.cssText="position: relative; width: 100%; height: 100%;",this.el=createElement(),this.el.dataset.id=this.id,this.el.style.cssText="position: absolute; width: 100%; height: 100%; overflow: hidden; background: "+this.config.theme.ui.background,this.lifeCycle.call("beforeMount"),this.parentEl.appendChild(this.el),this.rootEl.appendChild(this.parentEl),this.bound=this.createBound(),store$1$1.init(this),this.nextTick=nextTick.call.bind(nextTick),handlerManager.init(["selectDown","movement","resizer","rotator"],{ui:this}),graphEvent.init(this),this.canvasMode=CANVAS_MODE.EDIT,this.CANVASMODE=CANVAS_MODE,this.canvas=layoutManager.createLayout(this,LAYOUT_MAP.CANVAS,this.options),this.selector=selector,this.animation=new AnimatorManager,(transAnimation.root=this).transAnimation=transAnimation,this.fnMaps=this.eventMaps(),this.initUIEvent(),this.lifeCycle.call("mounted")}initEventChecks(){moveManager.addEventChecks(this.el,this.checkBeforeDoEvent())}initMouseEvent(){moveManager.add(this.el,{down:{left:this.fnMaps.get("downLeft"),right:this.fnMaps.get("downRight")},move:{left:this.fnMaps.get("moveLeft"),right:this.fnMaps.get("moveRight")},up:{left:this.fnMaps.get("upLeft"),right:this.fnMaps.get("upRight"),default:this.fnMaps.get("upDefault")}},this)}closeRegionSelect(){this.regionSelectLock=!0}openRegionSelect(){this.regionSelectLock=!1}moveCanvasBySpace(e){document.body.style.cursor||(document.body.style.cursor="pointer"),this.toMoveCanvas(e)}moveCanvasBySpaceEnd(){document.body.style.cursor&&(document.body.style.cursor=""),this.tempRegionSelectLock=!1,this.emit("moveCanvasEnd",{})}toMoveCanvas(e){e.target!==this.canvas.contentEl&&(this.canvas.move(e.movementX,e.movementY),this.nextTick((()=>{this.emit("moveCanvas",this)})))}query(e){let A=this.executeQuery(e);return Array.isArray(A)?A.filter((e=>!0===e._isMounted)):A&&(!0===A._isMounted||"Group"===A.type&&!1!==A._isMounted)?A:null}executeQuery(e){if(!e)return store$1$1.getAllElements();if(e instanceof RegExp)return store$1$1.getAllElements().filter((A=>e.test(A.name)));var A=e.substring(0,1);if("#"===A)return store$1$1.getElementById(e.substring(1));if("."!==A)return store$1$1.getElementsByName(e);switch(e.substring(1)){case LAYOUT_MAP.CANVAS:return store$1$1.getCanvas()[0];case LAYOUT_MAP.LAYER:return store$1$1.getLayers();case LAYOUT_MAP.GROUP:return store$1$1.getGroups();case LAYOUT_MAP.CONTAINER:return store$1$1.getContainers();default:return null}}toJSON(){if(!this.canvas)return"";const e={};var A=this.canvas.toJSON(),t=(i=this.ruler?this.ruler.exportLineInfo():null)?i.lines:null,i=i?i.hideAllLine:null;t&&t.length&&(A.lines=t,A.hideAllLine=i),t={version:1,scene:A,userData:e};return function A(t){var i=t.option.adapter;i&&(e[t.option.id]=i,t.option.adapter=i.type||"ConchAdapter"),t.children&&t.children.forEach((e=>{A(e)}))}(A),JSON.stringify(t)}parseJSON(e){return new Promise(((A,t)=>{this.doParse(e,A,t)}))}doParse(e,A){if(this.isPlayMode())return log.warn("预览模式下，无法使用");if(!e)return log.warn("参数不能为空");if(isType$1(e,"String"))try{e=window.JSON.parse(e)}catch(A){return log.warn(e+" 数据不符合要求")}if(!isType$1(e,"Object"))return log.warn(e+" 数据不符合要求");this.lifeCycle.call("beforeParseJSON",e,A),(e=clone(e)).scene&&function A(t){t.option.adapter&&(t.option.adapter=e.userData[t.option.id]),t.children&&t.children.forEach((e=>{A(e)}))}(e.scene);const t={};return this.canvas&&(this.canvas.layers.forEach((e=>e.isDefaultLayer&&(t[e.id]=e.dom))),this.canvas.destroy()),this.canvas=layoutManager.parseLayout(this,e.scene,{inStack:!1}),this.ruler&&e.scene.lines&&this.ruler.parseRulerLines(e),this.canvas.layers.forEach((e=>{var A=t[e.id];e.isDefaultLayer&&A&&(e.dom.parentNode.insertBefore(A,e.dom.parentNode.childNodes[1]),e.dom.parentNode.removeChild(e.dom),e.dom=A)})),isUnDef(e.userData)||Object.keys(e.userData).length||A(this),this.lifeCycle.call("afterParseJSON"),!0}play(e){if(!this.canvas)return log.warn("进入预览模式需要画布"),!1;if(this.isPlayMode())return log.warn("已经进入预览模式"),!0;this.canvasMode=CANVAS_MODE.PLAY,this.selector.clear();var A=this.canvas.updateMode();return isType$1(e,"Function")&&e((()=>{var e=transAnimation.animations;e&&e.size&&e.forEach((e=>{var{context:e,run:{enter:A}}=e;isType$1(A,"Function")&&A.apply(e)}))})),A}edit(){return this.canvas?this.canvasMode===CANVAS_MODE.EDIT?(log.warn("已经进入编辑模式"),!0):(this.canvasMode=CANVAS_MODE.EDIT,this.canvas.updateMode()):(log.warn("进入编辑模式需要画布"),!1)}enterInsidePreview(e){return!(this.canvasMode===this.CANVASMODE.PLAY||this.insidePreview||!e||!hasOwn(e,"_enterPreview")||(e.zDown&&e.zIndexUp(),!e._enterPreview())||(this.insidePreview=e,this.emit("enterInsidePreview",this.insidePreview),0))}exitInsidePreview(e){return!(!this.insidePreview||e&&e!==this.insidePreview||!this.insidePreview._exitPreview()||(this.insidePreview=null,this.emit("exitInsidePreview"),0))}exitTextEdit(){textEditor.exitTextEdit()}enterTextEdit(e){textEditor.enterTextEdit(e)}getInsidePreview(){return this.insidePreview}getScaleMode(){return this.canvas&&this.canvas.scaleMode}setScaleMode(e){var A;return this.isPlayMode()?log.warn("预览模式下，无法设置画布缩放模式"):(this.canvas&&e!==this.canvas.scaleMode&&(A=Object.entries(CANVAS_SCALE_MODE).find((A=>A[1]===e)))&&(this.canvas.scaleMode=CANVAS_SCALE_MODE[A[0]]),!0)}resize(){this.isPlayMode()?this._resizePlay():this._resizeEdit()}createBound(){return BoundingRect.create(this.el.getBoundingClientRect())}setResizeLock(e){this.resizeLock!==e&&(this.resizeLock=e)}contextmenuEvent(e){e.preventDefault()}updateSite(){var{top:e,left:A}=this.el.getBoundingClientRect(),{top:t,left:i}=this.bound;t===e&&i===A||this.bound.setData({top:e,left:A})}keydownEvent(e){"Escape"===e.code&&(this.exitInsidePreview(),this.exitTextEdit())}alignTo(e,A){return!!["top","bottom","left","right","vertical","horizal"].includes(e)&&(recordBound(A=isType$1(A,"Array")?A:void 0),e=align[e](A),commandAPI.align(A),e)}registerCommandType(e){return generateExecution.addCommandType(e)}setOperatHandlerDisplay(e){this.canvas&&this.canvas.setOperatHandlerDisplay(e)}getOperatHandlerDisState(){if(this.canvas)return this.canvas.getOperatHandlerDisState()}resetHandlerDisplay(){this.canvas&&this.canvas.resetHandlerDisplay()}getBoundRect(){return this.canvas?this.canvas.getBoundRect():null}destroy(){this.lifeCycle.call("beforeDestroy"),moveManager.destroy(),this.removeUIEvent(),super.destroyEvents(),this.bound=null,transAnimation.clear(),this.canvas&&this.canvas.destroy(),store$1$1.destroy(),this.canvasMode=null,this.rootEl.removeChild(this.parentEl),this.parentEl=null,this.lifeCycle.call("destroyed"),this.lifeCycle.destroy()}undo(e,A){return command.undo(e,A)}canUndo(){return command.canUndo()}canRedo(){return command.canRedo()}redo(e,A){return command.redo(e,A)}commandClear(){command.clear()}isPlayMode(){return this.canvasMode===CANVAS_MODE.PLAY}clickLeft(e){this.el!==e.target||this.getInsidePreview()||this.selector.clear()}setAlignmentLineBase(e){this.alignmentLineBase=e}setBoundRange(){multiSelectMove.setRange()}scrollToCenter({enable:e=!0,resize:A=!0,immediate:t=!0}=SCROLL_PARAM){this.canvas.scaleMode===CANVAS_SCALE_MODE.SCROLL&&e?(this.scrollFn=e=>{var A,t,i,{width:s,height:n}=this.el.getBoundingClientRect(),r=this.canvas.width,o=this.canvas.height;r<s&&o<n?(A=(n-o)/2,t=(s-r)/2,(i=this.canvas.style).position="absolute",i.top=A+"px",i.left=t+"px",i.transformOrigin="0px 0px"):this.el.scrollTo({top:(o-n)/2,left:(r-s)/2,behavior:"smooth"})},A&&window.addEventListener("resize",this.scrollFn),t&&this.scrollFn()):A&&window.removeEventListener("resize",this.scrollFn)}innerResize(){this.isPlayMode()?this._resizePlay():this.resizeLock||this._resizeEdit()}_resizePlay(){this.bound=this.createBound(),this.canvas.updateMode()}_resizeEdit(){this.bound=this.createBound(),this.canvas&&this.canvas.zoomAvailCenter()}_setOperatHandlerDisplay(e,A){this.canvas&&this.canvas._setOperatHandlerDisplay(e,A)}_downSpace(){this.spaceDown=!0}_upSpace(){this.spaceDown=!1,this.canvasMoveBySpace&&(this.canvasMoveBySpace=!1,this.moveCanvasBySpaceEnd())}}UI.version=version$1,applyMixins(UI,[UIEvent]);let adapterCount=0;var conchLifeCycle={ui:{beforeParseJSON({instance:e},A,t){const i=Object.keys(A.userData).length;e.on("collectCompComplete",(()=>{++adapterCount===i&&(e.off("collectCompComplete"),"function"==typeof t)&&t(e)}))}},container:{mounted({instance:e}){(e.adapter||e._initAdapterData)&&e.root.emit("beforeComponentComplete",e)}}};class Queue{constructor(){this.taskCaches=[],this.has={},this.waiting=!1,this.flushing=!1}_flushCaches(){var e;for(this.flushing=!0;this.taskCaches.length;)e=this.taskCaches.shift(),this.has[e.id]=void 0,e.run();this._resetState()}_resetState(){this.taskCaches.length=0,this.has={},this.waiting=this.flushing=!1}addTask(e){var A=e.id;void 0===this.has[A]?(this.has[A]=e.instance,this.flushing||this.taskCaches.push(e),this.waiting||(this.waiting=!0,nextTick.call(this._flushCaches.bind(this)))):this.has[A]!==e.instance&&(this.has[A]=e.instance,A=this.taskCaches.findIndex((A=>A.id===e.id)),this.taskCaches.splice(A,1),this.taskCaches.push(e))}destroy(){this._resetState()}}var queue=new Queue;const STYLELIST=["position","top","left","width","height","transform","transformOrigin","filter","right","bottom","outline","backgroundImage","backgroundColor","background","backgroundPosition","flex","padding","margin","display","border","opacity","zIndex","pointerEvents","cursor","flexDirection","justifyContent","alignItems","backgroundRepeat","backgroundSize","backdropFilter","boxSizing","userSelect"];function setTransform(e){return function(A){this._setTransform(e,A)}}function setDistance(e,A){return function(t){this._setDistance(e,A,t)}}const rotate3dMap={rotateX:setTransform("rotateX"),rotateY:setTransform("rotateY"),rotateZ:setTransform("rotateZ")},styleFnMap={translate:setTransform("translate"),scale:setTransform("scale"),skew:setTransform("skew"),rotate:setTransform("rotate"),matrix:setTransform("matrix"),...rotate3dMap},combineStyle=[["padding","margin"],["Top","Right","Bottom","Left"]],getPx=(combineStyle[0].forEach((e=>{combineStyle[1].forEach(((A,t)=>styleFnMap[e+A]=setDistance(e,t)))})),e=>/px|%/.test(e)?e:e+"px"),getDeg=e=>/deg/.test(e)?e:e+"deg",getUrl=e=>/url/.test(e)?e:`url(${e})`,isArray=e=>isType$1(e,"Array"),isNumberNaN=e=>!Number.isNaN(Number(e)),join=(e,A)=>e.join(A),replace=(e,A)=>isArray(e)?e.filter((e=>isDef(e))).map((e=>A(e))):A(e),handler={backgroundImage:e=>getUrl(e),width:e=>isNumberNaN(e)?getPx(e):e,height:e=>isNumberNaN(e)?getPx(e):e,margin:e=>isArray(e)?join(replace(e,getPx)," "):e,padding:e=>isArray(e)?join(replace(e,getPx)," "):e,top:e=>isNumber(e)?getPx(e):e,left:e=>isNumber(e)?getPx(e):e,right:e=>isNumber(e)?getPx(e):e,bottom:e=>isNumber(e)?getPx(e):e};class Style{constructor(e){return this.parent=e,this.layout=this.parent.layout,this._style={},this.dirtyMap={},new Proxy(this,{get:(e,A,t)=>-1!==STYLELIST.indexOf(A)||Reflect.has(styleFnMap,A)?e._style[A]:Reflect.get(e,A,t),set:(e,A,t,i)=>-1!==STYLELIST.indexOf(A)?(e._setStyle(A,t),!0):styleFnMap[A]?(styleFnMap[A].call(e,t),!0):Reflect.set(e,A,t,i)})}static factory(e){return new Style(e)}setOption(e){return!!isType$1(e,"Object")&&(Object.keys(e).forEach((A=>{this[A]=e[A]})),!0)}getValue(e){var A;return void 0===e?{...this._style}:(A=this._style[e],e in handler?handler[e](A):"transform"===e?this._getTransformStyleValue():isArray(A)?join(A," "):A)}_getTransformStyleValue(){var{translate:e,scale:A,rotate:t,rotateX:i,rotateY:s,rotateZ:n,skew:r,matrix:o}=this._style,a="";return(a+=(isArray(e)?`translate(${join(replace(e,getPx),",")}) `:"")+(isArray(A)?`scale(${join(A,",")}) `:"")+(isDef(t)?`rotate(${replace(t,getDeg)}) `:"")+(isDef(i)?`rotateX(${replace(i,getDeg)}) `:"")+(isDef(s)?`rotateY(${replace(s,getDeg)}) `:"")+(isDef(n)?`rotateZ(${replace(n,getDeg)}) `:"")+(isArray(r)?`skew(${join(replace(r,getDeg),",")}) `:"")+(isArray(o)?`matrix(${join(o,",")}) `:""))||this._style.transform}getDirtyStyleList(){var e=[];for(const t in this.dirtyMap){var A=this.getValue(t);null!=A&&this.dirtyMap[t]&&(e.push({name:t,value:A}),this.dirtyMap[t]=!1)}return e}_setStyle(e,A){isType$1(A,"Object")?this._style[A.name]=A.value:this._style[e]=A,this.dirtyMap[e]=!0,this.parent.dirty=!0,queue.addTask({id:this.parent.id,instance:this.parent,run:this.parent._updateStyle.bind(this.parent)})}_setDistance(e,A,t){if("margin"===e||"padding"===e){let i=this[e];(i=isType$1(i,"Array")?i:[0,0,0,0])[A]=t,this._setStyle(e,i)}}_setTransform(e,A){A=["translate","scale","skew"].includes(e)?this.formatValue(A):A,this._setStyle("transform",{name:e,value:A})}formatValue(e){let A="";return isType$1(e,"Number")&&(A=[e,e]),isType$1(e,"Array")&&isType$1(e[0],"Number")&&isType$1(e[1],"Number")?[e[0],e[1]]:A}destroy(){this._style={},this.dirtyMap={}}set dirty(e){this.parent.dirty=e}get dirty(){return this.parent.dirty}}const eventList=["click","dblclick","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu","mouseover"],blockList={};class DomEvent{initDomEvent(){this.eventBind={},this._emit=this.emit.bind(this),this.event=new EventEmitter}on(e,A,t){return this._hasType(e)&&(this.event.on(e,A,t),this._addListener(e,t)),this}once(e,A,t){if(this._hasType(e)){const i=(...s)=>{this.off(e,i),A.apply(t,s)};this.on(e,i)}return this}off(e,A){return e||A?this._hasType(e)&&(A||this._removeListener(e),this.event.off(e,A)):this.destroyEvent(),this}emit(e,A){e.type?(A&&!1===A.preventDefault&&e.preventDefault(),A&&!1===A.stopPropagation&&e.stopPropagation(),blockList[e.type]?(Array.isArray(blockList[e.type])||(blockList[e.type]=[]),blockList[e.type].push([this,e])):this.event.emit(e.type,e)):Array.isArray(blockList[e])&&blockList[e].forEach((([A,t],i)=>{A.event.emit(e,t)}))}lockBrowserEvent(e){if(!this._hasType(e))return this;blockList[e]=!0}unlockBrowserEvent(e){if(!this._hasType(e))return this;blockList[e]=null}destroyEvent(){for(const e in this.eventBind)this._removeListener(e);return this.event.destroyEvents(),this}_addListener(e,A){this.eventBind[e]||(this.eventBind[e]=!0,this.el.addEventListener(e,(e=>this.emit.call(this,e,A))))}_removeListener(e){this.eventBind[e]&&(this.eventBind[e]=!1,this.el.removeEventListener(e,this._emit))}_hasType(e){return!!eventList.includes(e)}}var dep=new EventEmitter;class EventManager{initElementEvent(e){var A=this.getType(e.type);this[`init${A}Event`]&&this[`init${A}Event`].call(e)}removeElementEvent(e){var A=this.getType(e.type);this[`remove${A}Event`]&&this[`remove${A}Event`].call(e)}registerDep(e){var A=this.getType(e.type);this[`register${A}Dep`]&&this[`register${A}Dep`].call(e)}removeDep(e){var A=this.getType(e.type);this[`remove${A}Dep`]&&this[`remove${A}Dep`].call(e)}initCanvasEvent(){this.on("mousedown",(e=>{checkMouseBtnType(e,"left")&&!multiSelectMove.checkMove(e)&&this.root.selector.clear()})),this.root.on("select",(()=>{this.showSelectRect()})).on("unselect",(e=>{this.hiddenSelectRect(e)}))}initLayerEvent(){mutualInitEvent.call(this)}initContainerEvent(){mutualInitEvent.call(this),this.on("dblclick",this._dblclickFn,this),this.on("mouseover",showBound,this),this.on("mouseout",hideBound,this),this.on("mousemove",preSelector,this),checkLayoutType(this,LAYOUT_MAP.DEFAULTCONTAINER)&&(this.root.on("canvasMode",this._canvasModeFn,this),this.root.on("beforeCanvasMode",this._beforeCanvasModeFn,this))}registerLayerDep(){dep.on("canvasModeChange",this.changeEventByMode,this)}registerContainerDep(){dep.on("canvasModeChange",this.changeEventByMode,this)}removeCanvasEvent(){this.off("mousedown")}removeLayerEvent(){mutualRemoveEvent.call(this)}removeContainerEvent(){mutualRemoveEvent.call(this),this.off("dblclick",this._dblclickFn),this.off("mouseover",showBound,this),this.off("mouseout",hideBound,this),this.off("mousemove",preSelector,this)}removeCanvasDep(){dep.off("canvasModeChange")}removeLayerDep(){mutualRemoveDep.call(this)}removeContainerDep(){mutualRemoveDep.call(this)}getType(e){return initialCapital(e)}}function mutualInitEvent(){this.eventActive=!0,handlerManager.initEvent(["selectDown","movement","regionSelector"],this),this.on("dblclick",dblclickEvent,this)}function mutualRemoveEvent(){this.eventActive=!1,handlerManager.remove(this),this.off("dblclick",dblclickEvent,this)}function mutualRemoveDep(){dep.off("canvasModeChange",this.changeEventByMode,this)}function showBound(e){multiSelectMove.moving||(e.stopPropagation(),this.eventActive&&graphEvent.mouseOverEvent(this))}function preSelector(e){this.eventActive&&graphEvent.mouseMoveEvent(this,e)}function hideBound(e){e.stopPropagation(),this.eventActive&&graphEvent.mouseOutEvent(this)}function dblclickEvent(e){e.stopPropagation(),this.eventActive&&selectDown.dblclickEvent(e,this)}let AdapterManager$1=class{constructor(){this._map=new Map}getBaseAdapter(){return this._map.has("BaseAdapter")?this._map.get("BaseAdapter"):(log.warn("BaseAdapter还没有注册"),null)}register(e,A){if(this._map.has(e))console.warn("重复注册"+e);else{if(!A.factory)throw new Error("注册的对象缺失factory静态方法");this._map.set(e,A)}}creatComponent(e,A,t,i){if(!this._map.has(e))return console.warn(e+"尚未注册，请检查参数"),!1;try{return this._map.get(e).factory(e,A,t,i)}catch(A){throw new Error(`创建${e}出错`+A)}}};var adapterManager=new AdapterManager$1;const{ENTER:ENTER,LEAVE:LEAVE}=TRANSITIONTYPE;class GraphObject extends Displayable{constructor(e,A){super(e,A),this.el=null,this.style=null,this.adapter=null,this.bound=null,this.isMounted=null,this.eventActive=null,this.maskStyle=null,this.maskDefaultEnable=!0,this.domFnEvents=[],this.eventManager=null,this._mountInfo=null,this._moveInfo=null,this._initAdapterData=null}get left(){return parseInt(this.style.left)}get top(){return parseInt(this.style.top)}get height(){return parseInt(this.style.height)}get width(){return parseInt(this.style.width)}get translate(){return this.style.translate||[0,0]}get rotate(){return this.style.rotate||0}get scale(){return this.style.scale||[1,1]}set left(e){setBoundEvent.call(this,{left:e})}set top(e){setBoundEvent.call(this,{top:e})}set height(e){setBoundEvent.call(this,{height:e})}set width(e){setBoundEvent.call(this,{width:e})}get app(){return this.adapter&&this.adapter.componentInstance}get ignoreRendering(){return this._ignoreRendering}set ignoreRendering(e){e!==this._ignoreRendering&&(this._ignoreRendering=e)}init(){super.init(),this._ignoreRendering=this.options.ignoreRendering,this.el=createElement(),this.el.dataset.id=this.id,this.contentEl=createElement(),this.contentEl.style.cssText="position: relative; width: 100%; height: 100%; zIndex: 0;",this.maskStyle||(this.maskStyle=clone(MASK_STYLE)),this.maskEl=createElementWithAttr("div",this.maskStyle,{id:"mask"}),this.el.appendChild(this.contentEl),this.maskDefaultEnable&&this._initMask(),this.style=Style.factory(this),this.setStyle(),this.options.animation&&(this.animation=this.options.animation),this.isMounted=!1,this._mountInfo=null,this._moveInfo=null,this.eventActive=!0;var{left:e,top:A,width:t,height:i,rotate:s}=this.boundingRect();this.bound=new BoundingRect(e,A,t,i,{left:0,top:0},s),this._initAdapterData=this.options.adapter,checkLayoutType(this,LAYOUT_MAP.CONTAINER)&&this.initBoundOffset(),this.initDomEvent(),this.eventManager=new EventManager,this.registerDep(),this._initEvent(),commandAPI.graph(this,this.config.inStack)}initMount(){this.ignoreRendering||this.doMount()}mount(){this.ignoreRendering=!1,this.doMount()}doMount(){if(!this.isMounted){var e=this._mountInfo;let A,t=getElementParent(this.parent);e&&(t=e.target,A=e.type),this.lifeCycle.call("beforeMount"),mount(this,t,A),this._mount&&this._mount(),this.isMounted=!0,this._mountInfo=null,this.lifeCycle.call("mounted"),this.initAdapter(),this.collectAnimation()}}initAdapter(){this.root.nextTick((()=>{var e;this._initAdapterData&&(e=this._initAdapterData,this.adapter=adapterManager.creatComponent(e.type,e.name,this,e),this.adapter._initComponent(e.option)),delete this._initAdapterData}))}collectAnimation(){const e=transAnimation.convert(this);var A;isUnDef(e)||(A={},e[ENTER]&&e[ENTER].length&&(A.enter=()=>{transAnimation.execute(this,e[ENTER])}),e[LEAVE]&&e[LEAVE].length&&(A.leave=()=>{transAnimation.execute(this,e[LEAVE])}),transAnimation.animations.set(this,{context:this,animation:e,run:A}))}registerDep(){this.eventManager.registerDep(this)}unmount(){this.ignoreRendering=!0;var e=(e=transAnimation.animations.get(this))?e.animation[type]:null;transAnimation.execute(this,e,this._animationEndCb)||this.doUnmount()}doUnmount(){if(this.isMounted){let e=this.el.nextSibling,A="before";e||(e=this.el.parentNode,A=null),this._mountInfo={target:{el:e},type:A},unmount(this),this.isMounted=!1}}show(){return this.visible?Promise.resolve(this):super.show()}hidden(){return this.visible?super.hidden():Promise.resolve(this)}setVisible(e){this.visible=e,this._setVisible(e)}setBound(e){var A,t,i,s,n;this.isLock||(this.bound.setData(e),({left:e,top:A,width:t,height:i}=this.bound),({width:s,height:n}=this.style.getValue()),this.style.setOption({left:e-this.translate[0],top:A-this.translate[1],width:t,height:i}),s===t&&n===i)||this._adapterResize()}move(e,A){var{left:t,top:i}=this.bound;setBoundEvent.call(this,{left:t+e,top:i+A})}boundingRect(){return{left:this.left+this.translate[0],top:this.top+this.translate[1],width:this.width*this.scale[0],height:this.height*this.scale[1],rotate:this.rotate}}setStyle(){this.options.style&&(this.style.setOption(this.options.style),this._setVisible(this.visible))}destroy(){this.lifeCycle.call("beforeDestroy"),super.destroy(),this._moveInfo=null,this.destroyDep(),commandAPI.unGraph(this),this.lifeCycle.call("destroyed")}destroyDep(){this.eventManager.removeDep(this)}_animationEndCb(){this.doUnmount()}_updateStyle(){this.el&&(this.lifeCycle.call("beforeUpdate"),updateStyle(this),this.lifeCycle.call("updated"))}_setVisible(e=!0){return this.style.display=e?"":"none",e}_adapterResize(){this.adapter&&this.root.nextTick((()=>{this.adapter.resize()}))}_destroyTruthy(){this._moveInfo=null,this.off(),super._destroyTruthy()}_initEvent(){this.eventManager.initElementEvent(this)}_startEvent(){return this.eventActive=!0}_pauseEvent(){return!(this.eventActive=!1)}_initMask(){return!this.maskEl.parentNode&&(this.el.appendChild(this.maskEl),!0)}_destroyMask(){return!!this.maskEl.parentNode&&(this.el.removeChild(this.maskEl),!0)}_destroyEvent(){this.eventManager.removeElementEvent(this)}}function setBoundEvent(e){this.setBound(e),this.root.emit("graphBoundChange",this)}applyMixins(GraphObject,[DomEvent]);let Base$2=class{constructor(){this.el=null,this.subEl=null,this.visible=!1,this.type=null}init(e,A,t){this.el=createElement(),this.type=this.el.dataset.id=e,Object.assign(this.el.style,A),0===t&&this.createRotateDom(A),this.visible=!0}createRotateDom(e){e=parseFloat(e.width);var A=((A=createElement()).dataset.type="rotate",this.subEl=A,{width:"16px",height:"16px",position:"absolute",cursor:"pointer",top:"-21px",left:-(8-e/2)+"px",backgroundImage:rotateIcon(),backgroundRepeat:"no-repeat",backgroundPosition:"center",pointerEvents:"all"});this.setRotateStyle(A),this.el.appendChild(this.subEl)}setStyle(e){isPlainObject(e)&&Object.assign(this.el.style,e)}setRotateStyle(e){isPlainObject(e)&&Object.assign(this.subEl.style,e)}destroy(){unmount(this),this.el=null,this.type=null,this.visible=!1,this.config=null}isRotate(e){var A=store$1$1.getSelectElements();return!A.length||!(!e||A.find((A=>A.id===e)))||!("Group"===A[0].type||1<A.length)}};class Rect extends Base$2{constructor(e,A){super(),this.config=A,this.init(e)}init(e="rect"){var{rectColor:A,rectStyle:t}=this.config.theme;super.init(e,{display:"none",top:"0px",left:"0px",width:"0px",height:"0px",zIndex:"20",border:`1px ${A} `+t,boxSizing:"border-box",position:"absolute",pointerEvents:"none"})}show(e,A,t,i){var s,{top:e,left:n,width:r,height:o,angle:a}=e;r<=0&&o<=0?this.hidden():(({rectColor:t,rectStyle:s}={...this.config.theme,...this.config.theme[t]}),this.setStyle({top:e+"px",left:n+"px",width:r+"px",height:o+"px",border:1/A+`px ${t} `+s,display:"block",transform:i&&a?`rotate(${a}deg)`:""}),this.visible=!0)}rectShow(e,A,t,i){var s=e.angle;i=!(!i||!s)&&this.isRotate();this.show(e,A,t,i)}subRectShow(e,A,t,i){var s=!!(s=e.angle)&&this.isRotate(i);this.show(e,A,t,s)}hidden(){this.visible&&this.setStyle({display:"none"}),this.visible=!1}scale(e){this.visible&&this.setStyle({borderWidth:1/e+"px"})}}class Resize extends Base$2{constructor(e,A){super(),this.index=e,this.visible=!1,this.config=A,this.size=10,this.isShowResize=!0,this.isShowFirstResize=!0,this.isShowRotate=!0,this.important={resize:0,rotate:0},this.handleColor=A.theme.handleColor,this.init()}init(){super.init("resize"+this.index,{display:"none",top:"0px",left:"0px",width:this.size+"px",height:this.size+"px",borderRadius:this.size/2+"px",backgroundColor:this.config.theme.handleColor,position:"absolute",zIndex:"21",pointerEvents:"all",cursor:CURSOR_STYLE[this.index]},this.index),this.initDomEvent(),initEvent.call(this)}contain(e,A){var{top:t,left:i,right:s,bottom:n}=this.el.getBoundingClientRect();return i<e&&t<A&&e<s&&A<n?this:null}show(e,A,t,i,s){i={...this.config.theme,...this.config.theme[i]}.handleColor;var{showRotateTag:s,showResizeTag:n,preselectionTag:r=!1}=s,n=(this.handleColor=i,this.important.resize?this.isShowResize:n);this.setStyle({display:n?"block":"none",top:A-this.size/2+"px",left:e-this.size/2+"px",transform:`scale(${1/t})`,backgroundColor:this.isShowFirstResize?i:"transparent",pointerEvents:this.isShowFirstResize?"all":"none"}),this.visible=!0,0<this.index||(this.important.rotate?!r&&this.isRotate()&&this.isShowRotate?this.subEl.style.display="block":this.subEl.style.display="none":s&&this.isRotate()?this.subEl.style.display="block":this.subEl.style.display="none")}setResizeDisplay(e,A){isDef(A)&&(this.important=A),0===this.index?(this.isShowFirstResize=e,this.setStyle({backgroundColor:e?this.handleColor:"transparent",pointerEvents:e?"all":"none"}),e&&this.setStyle({display:"block"})):(this.isShowResize=e,this.setStyle({display:e?"block":"none"}))}setRotateDisplay(e,A){isDef(A)&&(this.important=A),this.isShowRotate=e,this.setRotateStyle({display:e?"block":"none"})}hidden(){this.visible&&this.setStyle({top:"0px",left:"0px",display:"none"}),this.visible=!1}scale(e){this.visible&&this.setStyle({transform:`scale(${1/e})`})}destroy(){this.off("mousedown"),handlerManager.remove(this),super.destroy()}_setResizeDisplay(e){0===this.index?(this.setStyle({backgroundColor:e?this.handleColor:"transparent",pointerEvents:e?"all":"none"}),e&&this.setStyle({display:"block"})):this.setStyle({display:e?"block":"none"})}_setRotateDisplay(e){this.setRotateStyle({display:e&&this.isRotate()?"block":"none"})}}function initEvent(){resizer.initResizeEvent(this),rotator.initRotateEvent(this)}applyMixins(Resize,[DomEvent]);class SizeLabel extends Base$2{constructor(e){super(),this.config=e,this.isShowSizeLabel=!0,this.init()}init(){var{labelColor:e,labelBackground:A}=this.config.theme;super.init("SizeLabel",{top:"0px",left:"0px",zIndex:21,padding:"0 4px",fontSize:"12px",color:e,lineHeight:"20px",userSelect:"none",borderRadius:"2px",position:"absolute",transformOrigin:"left",backgroundColor:A,display:"none"})}show(e,A,t,i=1,s){var{labelColor:s,labelBackground:n}={...this.config.theme,...this.config.theme[s]};this.setStyle({top:A-10+"px",left:e+15+"px",color:s,backgroundColor:n,display:this.isShowSizeLabel?"inline-block":"none",transform:`scale(${1/i})`,whiteSpace:"nowrap"}),this.el.innerText=t,this.visible=!0}hidden(){this.visible&&this.setStyle({top:"0px",left:"0px",display:"none"}),this.visible=!1}setSizeLabelDisplay(e){this.isShowSizeLabel!==e&&(this.isShowSizeLabel=e,this.setStyle({display:e?"inline-block":"none"}))}scale(e){this.visible&&this.setStyle({transform:`scale(${1/e})`})}}class SelectRect extends Base$2{constructor(e,A){super(),this.target=e,this.config=A,this.init()}init(){this.el=createElement(),this.initStyle(),this.visible=!0}initStyle(e={}){var A,t,i,s,n,r,o;this.target&&this.config&&(({rectColor:A,rectStyle:t}=this.config.theme),({top:o,left:i,width:s,height:n,angle:r}=this.target.bound.plainReal()),o={top:o+"px",left:i+"px",width:s+"px",height:n+"px",zIndex:"20",border:1/this.target.root.canvas.getZoom()+`px ${A} `+t,boxSizing:"border-box",position:"absolute",pointerEvents:"none",transform:`rotate(${r}deg)`},Object.assign(o,e),this.setStyle(o))}show(){this.initStyle({display:"block"}),this.visible=!0}hidden(){this.visible&&(this.setStyle({display:"none"}),this.visible=!1)}scale(e){this.visible&&this.setStyle({borderWidth:1/e+"px"})}destroy(){super.destroy(),this.target=null}}class Operation{constructor(){this.parent=null,this.el=createElement(),this.el.dataset.id="operation",this.el.style.cssText="position:absolute;top:0;left:0;width:inherit;pointer-events:none;",this.inited=!1,this.resizes=null,this.rect=null,this.subRect=null,this.sizeLabel=null,this.alignmentLineManager=null,this.preMultSelect=!1,this.important={resize:0,rotate:0},this.selectRects={},this.config=null,this._important=null}init(e){if(!this.inited){this.parent=e;var A=this.config={theme:e.root.config.theme.bound};this.rect=new Rect("rect",A),mount(this.rect,this),this.subRect=new Rect("subRect",A),mount(this.subRect,this),this.resizes=[];for(let e=0;e<8;e++){var t=new Resize(e,A);mount(t,this.rect),this.resizes.push(t)}this.sizeLabel=new SizeLabel(A),mount(this.sizeLabel,this.rect),mount(this,{contentEl:e.el}),this.initEvent(),this.inited=!0}}initEvent(){var e=this.parent.root;e.on("graphBoundChange",syncBound,this),e.on("select",this.repaint,this),e.on("unselect",this.repaint,this),e.on("delete",this.repaint,this),e.on("graphMoving",this.hidden,this),e.on("graphResizing",this.repaintResizing,this),e.on("graphResizeEnd",this._showSelectRect,this),e.on("graphRotating",this.repaint,this),e.on("graphMoveEnd",this.repaint,this),e.on("canvasZoom",this.scale,this),e.on("moveLayer",updateLayerOffset,this),e.on("graphMouseover",this.showSubRect,this),e.on("graphMouseout",this.hideSubRect,this)}destroyEvent(){var e=this.parent.root;e.off("graphBoundChange",syncBound,this),e.off("delete",this.repaint,this),e.off("select",this.repaint,this),e.off("unselect",this.repaint,this),e.off("graphMoving",this.hidden,this),e.off("graphResizing",this.repaintResizing,this),e.off("graphResizeEnd",this._showSelectRect,this),e.off("graphRotating",this.repaint,this),e.off("graphMoveEnd",this.repaint,this),e.off("canvasZoom",this.scale,this),e.off("moveLayer",updateLayerOffset,this),e.off("graphMouseover",this.showSubRect,this),e.off("graphMouseout",this.hideSubRect,this)}destroy(){unmount(this),this.el=null,this.destroyEvent(),this.parent=null,this.resizes.forEach((e=>e.destroy())),this.rect.destroy(),this.subRect.destroy(),this.sizeLabel.destroy(),this.rect=null,this.subRect=null,this.resizes=null,this.sizeLabel=null,this.alignmentLineManager=null,this.preMultSelect=null,this.selectRects={},this.config=null}show(e){var A,t,i,s=this.getSelectBoundRect();s&&(A=this.parent.getZoom(),t=this.selectType(),({showResizeTag:e,showRotateTag:i}=(this.showRect(s,A,t),this.hideSubRect(),this._getShowTag(e))),this.showResize(s,A,t,{showRotateTag:i,showResizeTag:e}))}showRect(e,A,t,i){var s=!0;i&&this.preMultSelect&&(s=!1),this.rect.rectShow(e,A,t,s)}showResize(e,A,t,i){const s=store$1$1.getSelectElements().find((e=>checkLayoutType(e,LAYOUT_MAP.LAYER)));var{width:e,height:n}=e;const r=[{top:0,left:e/2},{top:n,left:e/2},{top:n/2,left:0},{top:n/2,left:e},{top:0,left:0},{top:0,left:e},{top:n,left:0},{top:n,left:e}];this.resizes.forEach(((e,n)=>{s?e.hidden():e.show(r[n].left,r[n].top,A,t,i)})),this.sizeLabel.show(r[3].left,r[3].top,Math.round(e)+" × "+Math.round(n),A,t)}setHandlerDisplay(e,A){const{rotate:t,resize:i,sizeLabel:s}=e;isDef(i)&&(this.important.resize=A,this.resizes.forEach((e=>e.setResizeDisplay(i,this.important)))),isDef(t)&&(this.important.rotate=A,e=this.resizes[0])&&e.setRotateDisplay(t,this.important),isDef(s)&&this.sizeLabel.setSizeLabelDisplay(s)}getHandlerDisState(){let e=!0,A=!0,t=!0;return isDef(this.resizes)&&(e=this.resizes.every((e=>e.isShowResize)),A=this.resizes[0].isShowRotate),isDef(this.sizeLabel)&&(t=this.sizeLabel.isShowSizeLabel),{resizeDis:e,rotateDis:A,sizeLabelDis:t}}resetHandlerDisplay(){isDef(this.resizes)&&(this.important.resize=0,this.important.rotate=0,this.resizes.forEach((e=>e.setResizeDisplay(!0,this.important))),this.resizes[0].setRotateDisplay(!0,this.important)),isDef(this.sizeLabel)&&this.sizeLabel.setSizeLabelDisplay(!0)}hidden(){this.visible&&(this.elhidden(),this.visible=!1)}elhidden(){this.rect.hidden(),this.resizes.forEach((e=>e.hidden())),this.sizeLabel.hidden(),this.hideSubRect(),this._hiddenSelectRect()}showSubRect(e,A){var t=this.parent.getZoom();this.subRect.subRectShow(e,t,this.selectType([A]),A.id)}hideSubRect(){this.subRect.hidden()}scale(e=1){this.rect.scale(e),this.subRect.scale(e),this.resizes.forEach((A=>A.scale(e))),this.sizeLabel.scale(e),this.selectRectScale(e)}setStyle(e){e.rect&&this.rect.setStyle(e.rect),e.resize&&this.resizes.forEach((A=>A.setStyle(e.resize))),e.label&&this.sizeLabel.setStyle(e.label)}contain(e,A){return this.resizes.find((t=>t.contain(e,A)))||null}repaint(e){this.doRepaint(e,this._showSelectRect)}repaintResizing(e){this.doRepaint(e,this._hiddenSelectRect)}doRepaint(e,A){store$1$1.getSelectElements().length?(this.show(e),A.call(this),this.visible=!0):this.hidden()}getSelectBoundRect(){var e=store$1$1.getSelectElements();return e.length?this.boundRectUnion(e):null}boundRectUnion(e){const A=new BoundingRect;return e.forEach((e=>A.union(e.bound,!0))),A.plain()}selectType(e=store$1$1.getSelectElements()){return 1===e.length?e[0].constructor.name.toLowerCase():1<e.length?"multSelect":void 0}showSelectRect(e){e.forEach((e=>{checkLayoutType(e,LAYOUT_MAP.LAYER)||this.selectRects[e.id]||(this.selectRects[e.id]=new SelectRect(e,this.config),mount(this.selectRects[e.id],this))}))}hiddenSelectRect(e){e.forEach((e=>{checkLayoutType(e,LAYOUT_MAP.LAYER)||(this.selectRects[e.id]&&this.selectRects[e.id].destroy(),delete this.selectRects[e.id])})),this.hasMultEls()||Object.keys(this.selectRects).forEach((e=>{this.selectRects[e].destroy(),delete this.selectRects[e]}))}selectRectScale(e){Object.values(this.selectRects).forEach((A=>{A.scale(e)}))}hasMultEls(){var e=store$1$1.getSelectCtGroups();return e&&1<e.length}setPreMult(e){1<(e=e||store$1$1.getSelectCtGroups()).length?this.preMultSelect=!0:1===e.length?this.preMultSelect=checkLayoutType(e[0],LAYOUT_MAP.GROUP):this.preMultSelect=!1}_showSelectRect(){this.hasMultEls()&&Object.values(this.selectRects).forEach((e=>{e.show()}))}_hiddenSelectRect(){Object.values(this.selectRects).forEach((e=>{e.hidden()}))}_getShowTag(e){return e?1<e.length||1<store$1$1.getSelectElements().length?{showResizeTag:!0,showRotateTag:!1}:checkLayoutType(e[0],LAYOUT_MAP.LAYER)||checkLayoutType(e[0],LAYOUT_MAP.GROUP)&&checkLock(e[0].containers)||checkLayoutType(e[0],LAYOUT_MAP.CONTAINER)&&e[0].lock?{showResizeTag:!1,showRotateTag:!1}:{showResizeTag:!0,showRotateTag:!0}:{showResizeTag:!0,showRotateTag:!0}}_setHandlerDisplay(e,A){!0===A?(this._important=this.important,this.important={resize:0,rotate:0}):!1===A&&(this._important&&(this.important=this._important),this._important=null);const{rotate:t,resize:i,sizeLabel:s}=e;isDef(i)&&0===this.important.resize&&this.resizes.forEach((e=>e._setResizeDisplay(i))),isDef(t)&&0===this.important.rotate&&(A=this.resizes[0])&&A._setRotateDisplay(t),isDef(s)&&this.sizeLabel.setSizeLabelDisplay(s)}}function syncBound(){this.visible&&this.repaint()}function updateLayerOffset({layers:e=[]}){e.forEach((e=>e.containers.forEach((A=>A.updateBoundRef(e.left,e.top)))))}class ScaleManage{constructor(e){this.instance=e,this.el=this.instance.el,this.ratio=null,this.rootCenter=null,this.center=null,this.location=[],this.instance.style.transformOrigin="0 0",this.lock=!1,this._keydown=this.keydown.bind(this),this._keyup=this.keyup.bind(this),this.wheelEvent=this.wheelEvent.bind(this),this.instance.el.parentNode.addEventListener("wheel",this.wheelEvent,this),document.addEventListener("keydown",this._keydown),document.addEventListener("keyup",this._keyup),this.zoomAvailCenter()}zoomAvailCenter(){var e=this.instance,A=[((A=e.root.bound).width-.2*A.width)/e.width,(A.height-.2*A.height)/e.height];return this.rootCenter=[e.root.bound.width/2,e.root.bound.height/2],this.setZoom(window.Math.min(...A))}wheelEvent(e){if(e.preventDefault(),this.lock)return!1;!isMac||this.canMacOSZoomCanvas?this._doZoom(e):this._doPan(e)}_doPan(e){var A=-e.deltaY*this.ratio;e=-e.deltaX*this.ratio;this.move(e,A),this.instance.root.nextTick((()=>{this.instance.root.emit("moveCanvas")}))}_doZoom(e){let A=this.getZoom();0<e.deltaY?A-=.02:A+=.02,this._setZoom(A),this.updateCenter({left:e.clientX,top:e.clientY})}keydown(e){"Control"!==e.key&&"Meta"!==e.key||(this.canMacOSZoomCanvas=!0)}keyup(){this.canMacOSZoomCanvas=!1}setCenter(e){return e&&(this.rootCenter=e),this.updateCenter()}getCenter(){return this.rootCenter}setZoom(e){return this._setZoom(e),this.updateCenter()}_setZoom(e){e=Number(parseFloat(e).toFixed(2)),this.ratio=e=e<=.15||4<e?e<=.15?.15:4:e}getZoom(){return this.ratio}move(e,A){this.location[0]+=e,this.location[1]+=A,this.updateStyle()}updateCenter(e){var A,t,i=this.instance,s=this.ratio;let n;return n=e?(i.root.updateSite(),A=i.root.bound,t=i.el.getBoundingClientRect(),[e.left-i.width*s*((e.left-t.left)/t.width)-A.left,e.top-i.height*s*((e.top-t.top)/t.height)-A.top]):[this.rootCenter[0]-i.width*s/2,this.rootCenter[1]-i.height*s/2],this.location=this.center=n,this.updateStyle(),this.instance.root.nextTick((()=>{this.instance&&this.instance.root&&this.instance.root.emit("canvasZoom",this.getZoom())})),!0}updateStyle(){var e=this.location.join("px, ")+"px";this.instance.style.transform=`translate(${e}) scale(${this.ratio})`}destroy(){this.instance.el.parentNode.removeEventListener("wheel",this.wheelEvent),document.removeEventListener("keydown",this._keydown),document.removeEventListener("keyup",this._keyup),this.instance=null,this.el=null,this.ratio=null,this.center=null,this.rootCenter=null}}let Canvas$1=class e extends GraphObject{static factory(A,t){return new e(A,t)}static factoryConfig(A,t,i){return new e(A,t,i)}constructor(e,A,t){if(!e||!checkLayoutType(e,LAYOUT_MAP.UI))throw new Error(`parent参数必须是${LAYOUT_MAP.UI}实例`);super(e,mergeOption(LAYOUT_MAP.CANVAS,A,t)),this.scaleMode=hasOwn(this.options,"scaleMode")?this.options.scaleMode:CANVAS_SCALE_MODE.SCALEALL,this.maskDefaultEnable=!1,this.maskStyle=merge(clone(MASK_STYLE),{zIndex:2}),this.init()}get layers(){return store$1$1.getLayers()}get groups(){return store$1$1.getGroups()}get containers(){return store$1$1.getContainers()}init(){super.init(),initOperation.call(this),handlerManager.init("regionSelector",{ui:this.root,canvas:this}),multiSelectMove.init({canvas:this,operation:this.operation}),this.canvasManage=new ScaleManage(this)}move(e,A){this.canvasManage&&this.canvasManage.move(e,A)}clear(){this.children.forEach((e=>{e.destroy()}))}setCenter(e){return this.root.canvasMode===CANVAS_MODE.PLAY?log.warn("预览模式下，无法设置中间坐标值"):isType$1(e,"Array")?this.canvasManage.setCenter(e):log.warn(e+" 必须是数组类型")}getCenter(){if(this.root.canvasMode===CANVAS_MODE.PLAY)throw new Error("预览模式下，无法获取中间坐标值");return this.canvasManage.getCenter()}setZoom(e){return this.root.canvasMode===CANVAS_MODE.PLAY?log.warn("预览模式下，无法设置缩放比例"):this.canvasManage.setZoom(e)}getZoom(e){if(this.root.canvasMode!==CANVAS_MODE.PLAY)return this._getZoom();var A=this.rect;if(e&&A)switch(this.scaleMode){case CANVAS_SCALE_MODE.SCROLL:return[1,1];case CANVAS_SCALE_MODE.SCALEALL:return A;case CANVAS_SCALE_MODE.SCALEWIDTH:return[A[0],A[0]];case CANVAS_SCALE_MODE.SCALEHEIGHT:return[A[1],A[1]]}return log.warn("预览模式下，无法获取缩放比例")}zoomAvailCenter(){return this.root.canvasMode===CANVAS_MODE.PLAY?log.warn("预览模式下，缩放画布到可视区域位置"):this.canvasManage.zoomAvailCenter()}getZoomState(){return this.canvasManage.lock}setZoomState(e){e!==this.canvasManage.lock&&(this.canvasManage.lock=e)}toJSON(){var e=super.toJSON();return e.option.scaleMode=this.scaleMode,delete e.option.style.transform,e}showSelectRect(e){this.operation&&(e=e||this.root.selector.getSelectElements())&&1<e.length&&this.operation.showSelectRect(e)}hiddenSelectRect(e){this.operation&&e&&e.length&&this.operation.hiddenSelectRect(e)}updateMode(){var e=this.style,A=this.scaleMode;if(this.root.emit("beforeCanvasMode",this.root.canvasMode),this.root.canvasMode===CANVAS_MODE.PLAY)if(this.canvasManage&&(this.canvasManage.destroy(),this.canvasManage=null),dep.emit("canvasModeChange"),A===CANVAS_SCALE_MODE.SCROLL)this.root.el.style.overflow="auto",e.transform="";else{var t=this.root.el.getBoundingClientRect(),i=[t.width/this.width,t.height/this.height];switch(this.rect=i,A){case CANVAS_SCALE_MODE.SCALEALL:e.transform=`scale(${i.join(", ")})`;break;case CANVAS_SCALE_MODE.SCALEWIDTH:e.top="50%",e.left=0,e.transform=`scale(${i[0]}) translateY(-50%)`,e.transformOrigin="0px 0px";break;case CANVAS_SCALE_MODE.SCALEHEIGHT:e.top="0",e.left="50%",e.transform=`scale(${i[1]}) translateX(-50%)`,e.transformOrigin="0px 0px"}this.root.el.style.overflow="hidden"}else e.top="",e.left="",e.transform="",this.canvasManage=new ScaleManage(this),dep.emit("canvasModeChange",!0);return canvasModeEvent.call(this),this.root.nextTick((()=>{this.root.emit("canvasMode",this.root.canvasMode)})),!0}setOperatHandlerDisplay(e){this.operation&&this.operation.setHandlerDisplay(e,1)}getOperatHandlerDisState(){if(this.operation)return this.operation.getHandlerDisState()}resetHandlerDisplay(){if(this.operation)return this.operation.resetHandlerDisplay()}getBoundRect(){return this.operation?this.operation.getSelectBoundRect():null}destroy(){return queue.destroy(),destroyOperation.call(this),this.scaleMode=null,this.canvasManage&&(this.canvasManage.destroy(),this.canvasManage=null),this.destroyDep(),store$1$1.clearStack(),super._destroyTruthy(),this.root&&(this.root.canvas=null,this.root.transAnimation.clear(),this.root=null),!0}destroyDep(){this.eventManager.removeDep(this)}_getZoom(){return this.canvasManage.getZoom()}_setOperatHandlerDisplay(e,A){this.operation&&this.operation._setHandlerDisplay(e,A)}_beginMove(){this._initMask()}_endMove(){this._destroyMask()}};function initOperation(){this.operation||(this.operation=new Operation,this.operation.init(this))}function destroyOperation(){this.operation&&this.operation.destroy(),this.operation=null}function canvasModeEvent(e){CANVAS_MODE.PLAY===e?destroyOperation.call(this):CANVAS_MODE.EDIT===e&&initOperation.call(this)}let Layer$2=class e extends GraphObject{static factory(A,t){return new e(A,t)}static factoryConfig(A,t,i){return new e(A,t,i)}constructor(e,A,t){if(!e||!checkLayoutType(e,LAYOUT_MAP.CANVAS))throw new Error(`parent参数必须是${LAYOUT_MAP.CANVAS}实例`);super(e,mergeOption(LAYOUT_MAP.LAYER,A,t)),this.maskDefaultEnable=!1,this._showCts=[],this.init()}get groups(){return store$1$1.getGroupsByEL(this)}get containers(){return store$1$1.getContainersByEl(this)}changeEventByMode(e){e?(this._initEvent(),this.style.pointerEvents="all"):(this._destroyEvent(),this.style.pointerEvents="none")}moveToTarget(e,A){return A&&checkLayoutType(e,LAYOUT_MAP.LAYER)&&e!==this?(commandAPI.move(this,e,A),this.root.operation.repaint(),!0):log.warn("图层移动只能以其他图层为目标，不能移动到内部")}unmount(){super.unmount(),this.containers.forEach((e=>{e._isMounted=!1}))}setBound(e){super.setBound(e),(isNumber(e.left)||isNumber(e.right))&&this.updateOffset()}updateOffset(){this.isLock||this.root.emit("moveLayer",{layers:[this]})}_setVisible(e){super._setVisible(e),e&&this.containers.forEach((e=>e.adapterResize()))}_mount(){this.containers.forEach((e=>{e._isMounted=!0}))}},maskDom=null;const defaultDashBorder="position: absolute; top: 0; right: 0; width: 100%; height: 100%; border: 1px dashed #027AFF; box-sizing: border-box; pointer-events: none;";let Container$1=class e extends GraphObject{static factory(A,t){return new e(A,t)}static factoryConfig(A,t,i){return new e(A,t,i)}constructor(e,A,t){if(!e||!checkLayoutType(e,[LAYOUT_MAP.LAYER,LAYOUT_MAP.GROUP]))throw new Error(`parent参数必须是${LAYOUT_MAP.LAYER}或者${LAYOUT_MAP.GROUP}实例`);super(e,mergeOption(LAYOUT_MAP.CONTAINER,A,t)),this.previewModeState=null,this.previewModeLock=null,this.controlDashByApi=null,this.dashBorderDom=null,this.penetrateOnplay=this.options.penetrateOnplay,this.preSelected=!1,this.emptyStyle=!1,this.init()}init(){super.init(),this.contentEl.style.transform="translate(0)",this.previewModeState=!1,this.previewModeLock=!0}openTextEdit(){textEditor.openTextEdit(this)}closeTextEdit(){textEditor.closeTextEdit(this)}readyTextEdit(e){textEditor.readyTextEdit(this,e)}getTextEditState(){return textEditor.isInEdit}setStyle(){var e,A;this.options.style&&(e=this.options.style,A=this.options.style.userSelect||"none",Object.assign(e,{userSelect:A}),this.style.setOption(e),this._setVisible(this.visible))}changeEventByMode(e){e?(this._initEvent(),this.contentEl.style.pointerEvents="none"):(this._destroyEvent(),this.penetrateOnplay?this.contentEl.style.pointerEvents="none":this.contentEl.style.pointerEvents="all")}createMask(){var e=this.root.config.theme.mask;return createElementWithAttr("div",{...MASK_STYLE,background:e.background,opacity:e.opacity},{id:"previewMask"})}moveToTarget(e,A){return A&&!checkLayoutType(e,[LAYOUT_MAP.GROUP,LAYOUT_MAP.CONTAINER])&&e!==this?log.warn("容器只能移动到编组或者其他容器旁边"):A||checkLayoutType(e,[LAYOUT_MAP.LAYER,LAYOUT_MAP.GROUP])?(commandAPI.move(this,e,A),this.root.operation.repaint(),!0):log.warn("容器只能移动到图层或者编组里面")}setRotate(e){isUnDef(e)||(this.setBound({angle:e}),this.root.emit("graphBoundChange",this))}setBound(e){this.isLock||(super.setBound(e),isDef(e=e.angle)&&this.style.setOption({rotate:e}))}getParentLayer(){return getParentLayer(this.parent)}initBoundOffset(){var e=this.getParentLayer();this.bound.setOffset(e.left,e.top)}updateLocation(){var e=this.getParentLayer(this);this.top=this.bound.plainReal().top-e.top,this.left=this.bound.plainReal().left-e.left,this.updateBoundRef()}updateBoundRef(e,A){var t=this.getParentLayer();isDef(e)||(e=t.left),isDef(A)||(A=t.top),this.bound.setOffset(e,A)}adapterResize(){this.app&&this._adapterResize()}loadEmptyStyle(){!this.controlDashByApi&&this.el&&(this._validEmpty()?(this.emptyStyle=!0,this._addDashBorder()):(this.emptyStyle=!1,this._removeDashBorder()))}showDash(e){this.controlDashByApi="show",this._addDashBorder(e)}hiddenDash(){this._removeDashBorder(),this.controlDashByApi="hidden"}showPreSelector(){this.preSelected=!0;var e=this.root.canvas.getZoom();this.emptyStyle?this._updateDashBorder({border:1/e+"px dashed #027AFF"}):this.showDash({border:2/e+"px dashed #027AFF"})}hiddenPreSelector(){this.emptyStyle?this._updateDashBorder():this.hiddenDash(),this.preSelected=!1}toJSON(){var e=super.toJSON();return delete e.children,e}_animationEndCb(e){e&&e(this)}_updateStyle(){super._updateStyle(),this.loadEmptyStyle()}_setVisible(){var e=setContainerDisplay(this);return super._setVisible(e),this.adapterResize(),e}_addDashBorder(e={}){var A;return!this.dashBorderDom&&"hidden"!==this.controlDashByApi&&(A=createElement(),this.dashBorderDom=A,this._updateDashBorder(e),this.el.appendChild(A),this.root.on("canvasMode",this._showDashByCanvasMode,this),!0)}_updateDashBorder(e={}){if(!this.dashBorderDom)return!1;if(Object.keys(e).length){let A=defaultDashBorder;for(const t in e)Object.hasOwn(e,t)&&(A+=`${t}:${e[t]};`);this.dashBorderDom.style=A}else this.dashBorderDom.style=defaultDashBorder;return!0}_removeDashBorder(){return!!this.dashBorderDom&&(this.el.removeChild(this.dashBorderDom),this.dashBorderDom=null,this.root.off("canvasMode",this._showDashByCanvasMode,this),!0)}_showDashByCanvasMode(e){this.root.CANVASMODE.PLAY===e?this.dashBorderDom.style.display="none":this.root.CANVASMODE.EDIT===e&&(this.dashBorderDom.style.display="block")}_dblclickFn(){this._canEnterPreview()&&(this.zDown&&this.zIndexUp(),this.root.enterInsidePreview(this))}_canEnterPreview(){return!this.previewModeState&&!checkLayoutType(this.parent,LAYOUT_MAP.GROUP)&&!this.textEditState}_destroyTruthy(){maskDom&&1===this.root.containers.length&&(maskDom.remove(),maskDom=null),this.adapter&&this.adapter.destroy(),super._destroyTruthy()}_validEmpty(){var{backgroundColor:e,backgroundImage:A,opacity:t}=this.el.style,i=this.root.canvasMode===CANVAS_MODE.EDIT,s=!!this._initAdapterData||!!this.adapter;return i&&!s&&(!A||"initial"===A)&&(!e||"rgba(0, 0, 0, 0)"===e||"transparent"===e||e&&"0"===t)}_enterPreview(){return!this.previewModeLock&&(maskDom=this.createMask(),log.info("进入预览模式"),this.select(),this.root.canvas.el.appendChild(maskDom),this._pauseEvent(),this.root.canvas._destroyEvent(),this.root.canvas.setZoomState(!0),this._destroyMask(),this.selectLock=!0,this.previewModeState=!0)}_exitPreview(){return log.info("退出预览模式"),this.root.canvas.el.removeChild(maskDom),this._startEvent(),this.root.canvas._initEvent(),this.root.canvas.setZoomState(!1),this._initMask(),this.selectLock=!1,this.previewModeState=!1,this.zDown&&this.zIndexDown(),!0}};class DefaultContainer extends Container$1{static factory(e,A){return new DefaultContainer(e,A)}static factoryConfig(e,A,t){return new DefaultContainer(e,A,t)}constructor(e,A,t){super(e,A,t),this.isDefaultContainer=!0,this.zDown=A.zDown,this.penetrateOnplay=!1}init(){this.config.isLock=!1,super.init(),this.previewModeLock=!1,this.dom=this.contentEl}changeEventByMode(e){e?this._initEvent():this._destroyEvent(),this.contentEl.style.pointerEvents="all"}createMask(){var e=this.root.config.theme.mask;return createElementWithAttr("div",{...MASK_STYLE,background:e.defaultContainer.background||e.background,opacity:e.defaultContainer.opacity||e.opacity},{id:"previewMask"})}loadEmptyStyle(){return!1}showDash(){return!1}hiddenDash(){return!1}toJSON(){var e=super.toJSON();return e.type="DefaultContainer",e}_updateStyle(){super._updateStyle()}_destroyTruthy(){this.root.off("canvasMode",this._canvasModeFn),this.root.off("beforeCanvasMode",this._beforeCanvasModeFn),super._destroyTruthy()}_beforeCanvasModeFn(e){this.root.CANVASMODE.PLAY===e&&this.previewModeState&&this.root.exitInsidePreview()}_canvasModeFn(e){this.root.CANVASMODE.PLAY===e?this._destroyMask():this.root.CANVASMODE.EDIT===e&&this._initMask()}}class Adapter{constructor(e,A,t={}){return e instanceof Container$1?(this.adapter=adapterManager.creatComponent(A.type,A.name,e,t),this.adapter._resolve=null,this.adapter.mounted=function(){return new Promise((e=>{this._resolve?e():this._resolve=e}))},e.root.nextTick((()=>{this.adapter._initComponent(A.opts)})),e.adapter=this.adapter,this.adapter):(log.warn("请传入正确父节点"),null)}}window.THING?window.THING.UI=UI:log.warn("请引入 ThingJS 后使用"),layoutManager.register(LAYOUT_MAP.UI,UI),layoutManager.register(LAYOUT_MAP.CANVAS,Canvas$1),layoutManager.register(LAYOUT_MAP.LAYER,Layer$2),layoutManager.register(LAYOUT_MAP.GROUP,Group$1),layoutManager.register(LAYOUT_MAP.CONTAINER,Container$1),layoutManager.register(LAYOUT_MAP.DEFAULTCONTAINER,DefaultContainer),UI.Layer=function(...e){return Layer$2.factory(...e)},UI.Group=function(...e){return Group$1.factory(...e)},UI.Container=function(...e){return Container$1.factory(...e)},UI.DefaultContainer=function(...e){return DefaultContainer.factory(...e)},UI.ScaleManage=function(...e){return new ScaleManage(...e)},UI.use=mm.register.bind(mm),UI.mixin=mm.mixin.bind(mm),UI.adapterManager=adapterManager,UI.Adapter=Adapter,UI.use(conchLifeCycle),UI.STATIC={CANVAS_MODE:CANVAS_MODE,CANVAS_SCALE_MODE:CANVAS_SCALE_MODE};let BaseAdapter$2=class{static factory(e,A,t,i){}constructor(e,A,t,i={}){this.parent=t,this.name=A,this.type=e,this.componentInstance=null,this.config=i,this.dom=null,this.complete=!1,this.initDom()}beforeMount(){}mounted(){this.complete=!0}beforeUpdate(){}updated(){}beforeDestroy(){}destroyed(){}initDom(){var e=createElement();e.style.width=this.parent.width+"px",e.style.height=this.parent.height+"px",this.dom=e}init(e){this.beforeMount(),this._initComponent(e),this.mounted()}update(){this.beforeUpdate(),this._updateComponent(),this.updated()}setConfig(e,A){A?this.config[A]=e:this.config=e}getConfig(e){return e?this.config[e]:this.config}getComponentInstance(){return this.componentInstance}destroy(){this.beforeDestroy(),this._destroyComponent(),this.destroyed()}resize(){var e=this.parent.width,A=this.parent.height;this.parent.contentEl.style.width=e+"px",this.parent.contentEl.style.height=A+"px",this.dom.style.width=e+"px",this.dom.style.height=A+"px",this.complete&&this.componentInstance&&this.componentInstance.resize&&this.componentInstance.resize()}toJSON(){}_initComponent(e){}_updateComponent(){}_destroyComponent(){this.parent.loadEmptyStyle&&this.parent.loadEmptyStyle()}_componentComplete(){this.parent.loadEmptyStyle&&this.parent.loadEmptyStyle(),this.parent.root.emit("componentComplete",{parent:this.parent,adapter:this}),this.parent.root.emit("collectCompComplete")}},conch,ConchAdapter$1=class e extends BaseAdapter$2{static factory(A,t,i,s){if(conch||e._loadConch(),conch&&conch[t])return new e(A,t,i,s);throw new Error(`Conch没有加载或Conch中没有ID为${t}的组件`)}static _loadConch(){return window.conch?conch=window.conch:(log.warn("请先加载spray-conch，否则组件将无法使用"),!1)}constructor(e,A,t,i){super(e,A,t,i)}setOption(e){e&&(this.config.opts=e,this.componentInstance)&&this.componentInstance.setOption(this.config.opts)}setData(e){this.config.data=e,this.componentInstance&&this.componentInstance.setData(this.config.data)}toJSON(){this.config.type=this.type,this.config.name=this.name;var e=this.componentInstance;if(e)if(isType$1(e.toJSON,"Function")){var A=e.toJSON();for(const e in A)A[e]&&(this.config[e]=A[e])}else this.oldtoJSON(e);return this.config}oldtoJSON(e){"echarts"===e.type&&e.config?this.config.opts=e.config:this.config.opts=e.opts}async _initComponent(A){if(this.config.option=merge({prefix:"/s-static"},A||{}),e._loadConch(),!conch[this.name])throw new Error(`组件${this.name}未检测到，请先到spray-conch中下载对应的组件包`);this.parent.contentEl&&this.parent.contentEl.appendChild(this.dom);try{var t={theme:this.config.theme,padding:this.config.padding};this.parent&&!this.componentInstance&&this.dom&&(this.componentInstance=new conch[this.name](this.dom,{config:t,...this.config.option})),this.componentInstance&&(this.componentInstance.parent=this.parent),await this.componentInstance.render(),this._resolve?"function"==typeof this._resolve&&this._resolve():this._resolve=!0}catch(A){this.error=A}try{Reflect.has(this.config,"data")&&this.setData(this.config.data),Reflect.has(this.config,"opts")&&this.setOption(this.config.opts)}catch(A){console.error(A)}return this.complete=!0,this.parent.root.config.enableContainerPreview&&(this.parent.previewModeLock=!1),this._componentComplete(),!0}_updateComponent(){this.complete=!1,this.componentInstance&&this._initComponent(),this.complete=!0}_destroyComponent(){this.componentInstance&&this.componentInstance.destroy(),this.config=null,this.dom&&this.parent.contentEl&&this.parent.contentEl.removeChild(this.dom),this.parent.adapter=null,this.parent.previewModeLock=!0,this.parent=null}};class AlignmentLines{constructor(e){this.lines=e?setLines(e):null}update(e){e&&(this.lines=setLines(e))}calcNearLine(e={}){if(!this.lines.v||!this.lines.h)return null;var A=[...this.lines.v,...this.lines.h];const t={v:[],h:[]};return A.forEach((A=>{var i;A.type.includes("v")?(i=findLine(A,e.v))&&t.v.push({val:Math.abs(Math.round(i.pos)-Math.round(A.pos)),from:A,...i}):(i=findLine(A,e.h))&&t.h.push({val:Math.abs(Math.round(i.pos)-Math.round(A.pos)),from:A,...i})})),{vLines:getShowLines(t.v)||[],hLines:getShowLines(t.h)||[],vLinesAll:t.v||[],hLinesAll:t.h||[]}}}function setLines(e){var{left:A,top:t,width:i,height:s}=e;return{v:[{type:"vl",pos:A,start:t,end:t+s,displayable:e},{type:"vm",pos:A+i/2,start:t,end:t+s,displayable:e},{type:"vr",pos:A+i,start:t,end:t+s,displayable:e}],h:[{type:"ht",pos:t,start:A,end:A+i,displayable:e},{type:"hm",pos:t+s/2,start:A,end:A+i,displayable:e},{type:"hb",pos:t+s,start:A,end:A+i,displayable:e}]}}function findLine(e={},A=[]){if(A.length<=0)return null;let t=0,i=A.length-1;for(;t<=i;){var s=Math.round(i-(i-t)/2);if(Math.round(e.pos)<Math.round(A[s].pos))i=s-1;else{if(!(Math.round(e.pos)>Math.round(A[s].pos)))return A[s];t=s+1}}return t===i?A[t]:t>i?t>=A.length?A[i]:i<0?A[0]:Math.abs(Math.round(A[i].pos)-Math.round(e.pos))<Math.abs(Math.round(A[t].pos)-Math.round(e.pos))?A[i]:A[t]:null}function getShowLines(e=[]){return e.sort(((e,A)=>e.val-A.val)),e.filter(((e,A)=>0===A||0===e.val))}class Line extends Base$2{constructor(e,A){super();e=e.config.theme.alignmentLines;this.index=A,this.realWidth=e.width,this.realHeight=e.width,this.color=e.color,this.visible=!1,this.isAdsorbed=!1,this.adsorbMovement=0,this.init()}init(){this.initStyle={display:"none",top:"0px",left:"0px",width:this.realWidth+"px",height:this.realHeight+"px",backgroundColor:this.color,position:"absolute",pointerEvents:"all"},super.init("alignment-line"+this.index,this.initStyle)}resetStyle(){this.setStyle(this.initStyle)}show(e={}){e.display="block",this.setStyle(e),this.visible=!0}hidden(){this.visible&&this.setStyle({top:"0px",left:"0px",display:"none"}),this.visible=!1}}const rulerBreakAdsorb=2,alignBreakAdsorb=0;class Adsorb{constructor(){this.adsorbDistance=4,this.adsorbed=[0,0],this.rulerAdsorbed=[0,0],this.ratio=1}setOffset(e={}){e.top&&(setMouseMoveInfo({x:0,y:e.top}),this.rulerAdsorbed[1]=1),e.left&&(setMouseMoveInfo({x:e.left,y:0}),this.rulerAdsorbed[0]=1)}execute(){1===this.rulerAdsorbed[0]&&(movement.doMove(),movement.canMoveX=!1,this.rulerAdsorbed[0]=0),1===this.rulerAdsorbed[1]&&(movement.doMove(),movement.canMoveY=!1,this.rulerAdsorbed[1]=0),this.isBreakAdsorb(rulerBreakAdsorb)}setAlignment(e,A=[]){A.forEach((A=>{"left"===A.type&&0===this.adsorbed[0]&&(setMouseMoveInfo({x:A.offset,y:0},e),this.adsorbed[0]=1),"top"===A.type&&0===this.adsorbed[1]&&(setMouseMoveInfo({x:0,y:A.offset},e),this.adsorbed[1]=1)}))}executeAlignment(e){var A=!1,t=getInstance(e);return 1===this.adsorbed[0]&&(A=!0,t.doMove(),t.canMoveX=!1,this.adsorbed[0]=0),1===this.adsorbed[1]&&(A=!0,t.doMove(),t.canMoveY=!1,this.adsorbed[1]=0),this.isBreakAdsorb(alignBreakAdsorb,e),A}isBreakAdsorb(e,A="move"){A=getInstance(A);var{mouseMoveInfo:t,_mouseMoveInfo:i}=getMouseMoveInfo(A);Math.abs(i.x-t.x)>e&&(A.canMoveX=!0),Math.abs(i.y-t.y)>e&&(A.canMoveY=!0)}destroy(){this.adsorbDistance=null}resetAdsorbMovement(){this.adsorbed=[0,0]}resetCanmove(e){(e=getInstance(e)).canMoveX=!0,e.canMoveY=!0}}function getMouseMoveInfo(e){return{mouseMoveInfo:{x:e.mouseMoveInfo.x,y:e.mouseMoveInfo.y},_mouseMoveInfo:{x:e._mouseMoveInfo.x,y:e._mouseMoveInfo.y}}}function setMouseMoveInfo({x:e,y:A},t="move"){switch(t){case"move":movement.mouseMoveInfo.x+=e,movement.mouseMoveInfo.y+=A;break;case"resize":resizer.offset.x=e,resizer.offset.y=A}}function getInstance(e){switch(e){case"move":return movement;case"resize":return resizer}}const defaultStyle={position:"absolute",top:"0px",left:"0px",backgroundColor:"#CCFF99"};class DistanceLine{constructor(e,A){var{alignmentLines:t}=e.root.config.theme;this.parent=e,this.index=A,this.el=null,this.toolTip=null,this.leftSide=null,this.rightSide=null,this.index=A,this.isShow=!1,this.realWidth=t.distanceStyle.width,this.realHeight=t.distanceStyle.width,defaultStyle.backgroundColor=t.distanceStyle.color,this.toolTipWidth=40,this.toolTipHeight=20,this.sideWidth=2,this.sideHeight=2,this.sideShowSize=8,this.init(A)}init(e){this.el=createElement(),this.toolTip=createElement(),this.leftSide=createElement(),this.rightSide=createElement(),this.el.dataset.id="distance-line"+e,this.toolTip.dataset.id="tip"+e,this.leftSide.dataset.id="left-side"+e,this.rightSide.dataset.id="right-side"+e,this.initStyle(),this.el.appendChild(this.toolTip),this.el.appendChild(this.leftSide),this.el.appendChild(this.rightSide),this.parent.el.appendChild(this.el)}initStyle(){Object.assign(this.el.style,defaultStyle,{display:"none",width:this.realWidth+"px",height:this.realHeight+"px",zIndex:20}),Object.assign(this.toolTip.style,defaultStyle,{display:"block",width:this.toolTipWidth+"px",height:this.toolTipHeight+"px",color:"#333",lineHeight:this.toolTipHeight+"px",textAlign:"center"}),Object.assign(this.leftSide.style,defaultStyle,{display:"block",width:this.sideWidth+"px",height:this.sideHeight+"px"}),Object.assign(this.rightSide.style,defaultStyle,{display:"block",width:this.sideWidth+"px",height:this.sideHeight+"px"})}resetStyle(){this.initStyle(),this.isShow=!1}show(e,A,t=1){if(e)switch(this.isShow=!0,A){case 0:Object.assign(this.el.style,{display:"block",left:e.pos+("vl"===e.from.type?-1:0)+"px",top:e.from.start-e.distance+"px",height:e.distance+"px",transform:`scaleX(${1/t})`}),this.showTipY(e,t),this.showSideY(e);break;case 1:Object.assign(this.el.style,{display:"block",left:e.pos+("vl"===e.from.type?-1:0)+"px",top:e.from.end+"px",height:e.distance+"px",transform:`scaleX(${1/t})`}),this.showTipY(e,t),this.showSideY(e);break;case 2:Object.assign(this.el.style,{display:"block",left:e.from.start-e.distance+"px",top:e.pos+("ht"===e.from.type?-1:0)+"px",width:e.distance+"px",transform:`scaleY(${1/t})`}),this.showTipX(e,t),this.showSideX(e);break;case 3:Object.assign(this.el.style,{display:"block",left:e.from.end+"px",top:e.pos+("ht"===e.from.type?-1:0)+"px",width:e.distance+"px",transform:`scaleY(${1/t})`}),this.showTipX(e,t),this.showSideX(e)}}showTipX(e,A){this.toolTip.innerText=e.distance,Object.assign(this.toolTip.style,{left:e.distance/2-20+"px",transform:`scaleX(${1/A})`})}showTipY(e,A){this.toolTip.innerText=e.distance,Object.assign(this.toolTip.style,{top:e.distance/2-10+"px",transform:`scaleY(${1/A})`})}showSideX(e){Object.assign(this.leftSide.style,{height:this.sideShowSize+"px",transform:"translate(0, -50%)"}),Object.assign(this.rightSide.style,{height:this.sideShowSize+"'px",transform:`translate(${e.distance-this.sideWidth}px, -50%)`})}showSideY(e){Object.assign(this.leftSide.style,{width:this.sideShowSize+"px",transform:"translate(-50%, 0)"}),Object.assign(this.rightSide.style,{width:this.sideShowSize+"px",transform:`translate(-50%, ${e.distance-this.sideHeight}px)`})}}class DistanceTip{constructor(e){this.parent=e,this.left=[],this.right=[],this.top=[],this.bottom=[],this.compareLines=this._compareLines(),this.ratio=1}show(e){this.init(),this.setLines(e),this.showLines()}init(){this.left=[],this.right=[],this.top=[],this.bottom=[]}setLines(e=[]){const A={ht:0,hm:1,hb:2},t={vl:0,vm:1,vr:2};e.forEach((e=>{var i=e.from.type;i.includes("v")?(e.start<e.from.start&&(this.top[t[i]]=this._setDistanceItem({target:this.top[t[i]],line:e,index:0})),e.end>e.from.end&&(this.bottom[t[i]]=this._setDistanceItem({target:this.bottom[t[i]],line:e,index:1}))):(e.start<e.from.start&&(this.left[A[i]]=this._setDistanceItem({target:this.left[A[i]],line:e,index:2})),e.end>e.from.end&&(this.right[A[i]]=this._setDistanceItem({target:this.right[A[i]],line:e,index:3})))}))}showLines(){var e=this.parent.distanceLines;const A=[this.top,this.bottom,this.left,this.right];e.forEach(((e,t)=>{e.resetStyle();var i=this._getLine(A[t],t);e.show(i,t,this.ratio)}))}hideLines(){this.parent.distanceLines.forEach((e=>{e.resetStyle()}))}_getLine(e,A){return e.forEach((e=>{e.distance=Math.round(Math.abs(this.compareLines.get(A)(e)))})),e.sort(((e,A)=>e.distance-A.distance))[0]}_compareLines(){var e=new Map;return e.set(0,compareLinesLT),e.set(1,compareLinesRB),e.set(2,compareLinesLT),e.set(3,compareLinesRB),e}_setDistanceItem(e={}){var{target:e,index:A,line:t}=e;return e&&Math.abs(this.compareLines.get(A)(e))<=Math.abs(this.compareLines.get(A)(t))?e:t}}function compareLinesLT(e){return e.end>=e.from.start?e.from.start-e.start:e.from.start-e.end}function compareLinesRB(e){return e.start<=e.from.end?e.from.end-e.end:e.from.end-e.start}const handlerFnArr=[[0],[1],[2],[3],[0,2],[0,3],[1,2],[1,3]];class AlignmentLinesManager{constructor(){this.parent=null,this.el=createElement(),this.el.dataset.id="alignment",this.el.style.cssText="position:absolute;top:0;left:0;z-index:21;",this.lineEntities=null,this.graphLinesData={},this.graphLayerIds={},this.alignmentLines=null,this.updated=!1,this.lineSelect=null,this.adsorb=null,this.adsorbLinesInfo=null,this.distanceLines=null,this.distanceTip=null}init(e,A){if(!this.parent){this.parent=A,this.root=e,mount(this,{contentEl:A.el}),this.lineEntities=[];for(let A=0;A<6;A++){var t=new Line(e,A);mount(t,this),this.lineEntities.push(t)}this.distanceLines=[];for(let e=0;e<4;e++)this.distanceLines.push(new DistanceLine(this,e));this.alignmentLines={v:[],h:[]},this.updated=!1,this.lineSelect=new AlignmentLines,this.adsorb=new Adsorb,this.distanceTip=new DistanceTip(this),this.initEvent(),this.resetStore()}}disable(){this.destroyEvent(),this.enable=!1,this.lineEntities&&this.lineEntities.forEach((e=>e.destroy())),unmount(this),this.lineEntities=null,this.lineSelect=null,this.adsorb=null,this.adsorbLinesInfo=null,this.parent=null,this.root=null,this.distanceLines=null,this.distanceTip=null}destroy(){this.disable(),this.el=null,this.graphLinesData=null,this.graphLayerIds=null}initEvent(){var e=this.root;e.on("select",this.resetStore,this),e.on("graphMoveEnd",this.hidden,this),e.on("graphResizeEnd",this.hidden,this)}destroyEvent(){var e=this.root;e&&(e.off("select",this.resetStore,this),e.off("graphMoveEnd",this.hidden,this),e.off("graphResizeEnd",this.hidden,this))}addLine(e,A,t){e&&t&&(this.updated=!1,this.graphLinesData[e]=t,this.graphLayerIds[e]=A)}removeLine(e){e&&(this.updated=!1,e in this.graphLinesData&&delete this.graphLinesData[e],e in this.graphLayerIds)&&delete this.graphLayerIds[e]}resetStore(){var e=selector.getContainers();if(!(e.length<=0)){let r;if("layer"!==this.root.alignmentLineBase||(r=getLayerId(e))){var A,t=this.root.operation,i=(this.lineSelect.update(t.getSelectBoundRect()),getIds(e)),{graphLinesData:s,alignmentLines:n}=(this.alignmentLines={v:[],h:[]},this);for(const e in s)this.canAddLine(i,e,r)&&(A=s[e],n.v=[...n.v,...A.lines.v],n.h=[...n.h,...A.lines.h]);n.v=this.union(n.v),n.h=this.union(n.h),this.updated=!0,this.adsorb.resetAdsorbMovement()}}}union(e=[]){const A={};return e.forEach((e=>{var t,i;A[e.pos]?(t=[(i=A[e.pos]).start,i.end,e.start,e.end].sort(((e,A)=>e-A)),i=[...this.getBefore(i),...this.getBefore(e)],A[e.pos]={...e,start:t[0],end:t[3],isCombine:!0,before:i}):A[e.pos]=e})),Object.values(A).sort(((e,A)=>e.pos-A.pos))}getBefore(e={}){var A=e.before;return!A||A.length<1?[e]:[...A]}repaint({event:e,handler:A},t="move"){var i,s;this.updated&&!selector.getLayers().length&&(i=selector.getContainers(),this.parent?(s=(s=this.root.operation).getSelectBoundRect())&&(this.lineSelect.update(s),this.updateContainerAlignmentLines(i),e)&&(!(s=this.showLine(t,A,e).info).length||[37,38,39,40].includes(e.keyCode)?clearStopMove.call(this,t):executeAdsorb.call(this,s,t,A)):this.updateContainerAlignmentLines(i))}updateContainerAlignmentLines(e=[]){e.forEach((e=>{e.alignmentLines&&e.alignmentLines.update(e.bound.plainReal())}))}showLine(e="move",A=null,t={}){var i=this.lineSelect.calcNearLine(this.alignmentLines);const s=this.parent.getZoom();if(!Array.isArray(i.vLines)||!Array.isArray(i.hLines))return[];const n=[...i.vLines,...i.hLines],r=[...i.vLinesAll,...i.hLinesAll],o=[],a=[],l=[37,38,39,40];return this.lineEntities.forEach(((i,c)=>{c=("move"===e?n:r)[c],i.resetStyle(),!c||c.val>this.adsorb.adsorbDistance/s||"resize"===e&&c.from.type.includes("m")||l.includes(t.keyCode)&&0!==c.val?i.hidden():(i.show(getLineStyle(c,s)),o.push(c),"move"===e&&a.push(getMoveInfo(c)),"resize"===e&&a.push(getResizeInfo(c,A)))})),this.distanceTip.ratio=s,this.distanceTip.show(o),{lines:o,info:a}}hidden(){this.lineEntities&&this.lineEntities.forEach((e=>{e.resetStyle()})),this.distanceTip.hideLines(),this.adsorb.resetAdsorbMovement()}canAddLine(e,A,t){return e=e.includes(A),A="canvas"===this.root.alignmentLineBase||this.graphLayerIds[A]===t,!e&&A}}function clearStopMove(e){this.adsorb.resetCanmove(e)}function executeAdsorb(e,A,t){this.adsorb.ratio=this.parent.getZoom(),this.adsorb.setAlignment(A,e),this.adsorb.executeAlignment(A)&&this.showLine(A,t)}function getIds(e){return e.map?e.map((e=>e.id)):[]}function getLineStyle(e,A){var t=[e.start,e.end,e.from.start,e.from.end].sort(((e,A)=>e-A));return e.type.includes("v")?{top:t[0]+"px",left:e.pos+("vl"===e.from.type?-1:0)+"px",transform:`scaleX(${1/A})`,height:Math.abs(t[3]-t[0])+"px"}:{top:e.pos+("ht"===e.from.type?-1:0)+"px",left:t[0]+"px",transform:`scaleY(${1/A})`,width:Math.abs(t[3]-t[0])+"px"}}function getMoveInfo(e){var{pos:e,from:A,type:t}=e;e=Math.round(e)-Math.round(A.pos);return t.includes("v")?{offset:e,type:"left"}:t.includes("h")?{offset:e,type:"top"}:{}}function getResizeInfo(e,A){const t=["ht","hb","vl","vr"];A=handlerFnArr[A.index].map((e=>t[e]));var{pos:e,from:i,type:s}=e;e=Math.round(e)-Math.round(i.pos);if(i&&i.type&&!i.type.includes("m")){if(s.includes("v")&&A.includes(i.type))return{offset:e,type:"left"};if(s.includes("h")&&A.includes(i.type))return{offset:e,type:"top"}}return{}}function getLayerId(e){var A=new Set;for(let t,i=0;t=e[i];i++){if(1<A.size)return null;A.add(getLayerParentId(t))}return Array.from(A)[0]}new AlignmentLinesManager;const getBlueprintNode=e=>{if(THING&&THING.CODELESS&&THING.CODELESS.BaseNode){class A extends THING.CODELESS.BaseNode{constructor(){super()}isEntrance(){return!0}onExecute(A,t,i){e.onExecute(A,t,i,this)}onStop(){e.onStop(this)}}return A.config={name:e.name,id:e.id,group:"THING-UI",inputs:[{name:"显示",type:"exec"},{name:"隐藏",type:"exec"},{name:"数据",type:"any"}],outputs:[]},A}return log.warn("请先加载蓝图类"),null};function toBlueprintNode(){return getBlueprintNode(this)}function onExecute(e,A,t,i){"显示"===(i=i.curExecName)?this.show():"隐藏"===i&&this.hidden()}function onStop(){}const bluePrintNodeModule={setup(e){e.mixin({container:{toBlueprintNode:toBlueprintNode,onExecute:onExecute,onStop:onStop},group:{toBlueprintNode:toBlueprintNode,onExecute:onExecute,onStop:onStop},layer:{toBlueprintNode:toBlueprintNode,onExecute:onExecute,onStop:onStop}})}},defaultFilters={brightness:1,contrast:1,hueRotate:0,opacity:1,saturate:1};class Filter{constructor(e,A){this.parent=e,this.filters=null,A&&(this.filters=clone(defaultFilters),this.update(A))}update(e){if(!isType$1(e,"Object"))return!1;if(!this.filters)return log.warn("滤镜被清空了，请先重置后在设置新值"),!1;for(const A in e)e.hasOwnProperty(A)&&this._setData(A,e[A]);return this.updateStyle()}getData(){return clone(this.filters)}setData(e,A){return this.filters?(this._setData(e,A),this.updateStyle()):(log.warn("滤镜被清空了，请先重置后在设置新值"),!1)}_setData(e,A){return!(!hasOwn(this.filters,e)&&this.filters[e]===A&&!isType$1(A,"Number")||(this.filters[e]=A,0))}reset(){return this.filters=clone(defaultFilters),this.updateStyle()}toJSON(){return this.getData()}clear(){return this.filters=null,this.updateStyle()}updateStyle(){var e=this.filters;let A="";return e&&(A=`hue-rotate(${e.hueRotate}deg) contrast(${100*e.contrast}%) opacity(${100*e.opacity}%) saturate(${100*e.saturate}%) brightness(${100*e.brightness}%)`),this.parent.style.filter=A,!0}destroy(){return this.clear(),!(this.parent=null)}}const filterModule={setup(e){e.mixin({canvas:{enableFilter(){return this.filter.reset()},getFilter(){return this.filter.getData()},setFilter(e,A){return this.filter.setData(e,A)},updateFilter(e){return this.filter.update(e)},resetFilter(){return this.filter.reset()},clearFiler(){return this.filter.clear()}}})},canvas:{beforeMount(){this.filter=new Filter(this,this.options.filters)},beforeToJSON(e,A){var t=this.filter.toJSON();t&&(A.option.filters=t),delete A.option.style.filter},beforeDestroy(){this.filter.destroy(),this.filter=null}}};class KeyMap{constructor(e){this.parent=e,this._keyMap=new Map,this.init()}init(){document.addEventListener("keydown",this.keyDownEvent.bind(this)),document.addEventListener("keyup",this.keyDownEvent.bind(this)),document.addEventListener("click",this.keyDownEvent.bind(this)),document.addEventListener("mouseover",this.keyDownEvent.bind(this)),document.addEventListener("contextmenu",this.keyDownEvent.bind(this))}register(e){var A=e.code;this._keyMap.set(A,e)}_reset(e){"click"!==e.type&&"contextmenu"!==e.type&&"Escape"!==e.code||!1!==e.shiftKey||(A=this._keyMap.get("Shift")&&this._keyMap.get("Shift").fn||{}).up&&A.up(e);var A=isMac?e.ctrlKey||e.metaKey:e.ctrlKey;"mouseover"===e.type&&!1===A&&(A=this._keyMap.get("Control")&&this._keyMap.get("Control").fn||{}).up&&A.up(e)}keyDownEvent(e){var A;this._reset(e),document.activeElement===document.body&&(A=this.collect(e))&&(this._keyMap.has(A)||this._isMacResult(A))&&(e.preventDefault(),this.run(e,A))}_isMacResult(e){return isMac&&"Control+contextmenu"===e}collect(e){var A=[];return"Shift"===e.key||"Control"===e.key||"Meta"===e.key||"Alt"===e.key?A.push("Meta"===e.key&&isMac?"Control":e.key):(e.metaKey&&A.push("Control"),e.ctrlKey&&A.push("Control"),e.altKey&&A.push("Alt"),e.shiftKey&&A.push("Shift"),e.code?A.push(e.code):A.push(e.type)),A.join("+")}run(e,A){this._keyMap.has(A)&&("function"==typeof(A=this._keyMap.get(A).fn)?"keyup"!==e.type&&A(e):"keydown"===e.type?A.down&&A.down(e):"keyup"===e.type&&A.up&&A.up(e))}clear(){document.removeEventListener("keydown",this.keyDownEvent.bind(this)),document.removeEventListener("keyup",this.keyDownEvent.bind(this)),document.removeEventListener("click",this.keyDownEvent.bind(this)),document.removeEventListener("contextmenu",this.keyDownEvent.bind(this)),document.removeEventListener("mouseover",this.keyDownEvent.bind(this)),this._keyMap.clear()}}let keyMap=null;const keyMove=(e,A)=>({down:t=>{movement.moveKeyEvent(t,e,A)},up:()=>{movement.upEvent()}}),KeyMapMoudle={setup(e){e.mixin({ui:{keyMap:keyMap}})},ui:{beforeMount(){this.keyMap=new KeyMap(this),this.keyMap.register({name:"编组选中对象",code:"Control+KeyG",fn:()=>{this.selector.createGroup()}}),this.keyMap.register({name:"取消编组",code:"Control+Shift+KeyG",fn:()=>{this.selector.cancelGroup()}}),this.keyMap.register({name:"删除选中对象",code:"Delete",fn:()=>{this.selector.delete()}}),this.keyMap.register({name:"重做",code:"Control+KeyY",fn:()=>{this.redo()}}),this.keyMap.register({name:"取消",code:"Control+KeyZ",fn:()=>{this.undo()}}),this.keyMap.register({name:"取消",code:"Escape",fn:()=>{this.edit(),this.exitInsidePreview()}}),this.keyMap.register({name:"向上移动1px",code:"ArrowUp",fn:keyMove(0,-1)}),this.keyMap.register({name:"向下移动1px",code:"ArrowDown",fn:keyMove(0,1)}),this.keyMap.register({name:"向左移动1px",code:"ArrowLeft",fn:keyMove(-1,0)}),this.keyMap.register({name:"向右移动1px",code:"ArrowRight",fn:keyMove(1,0)}),this.keyMap.register({name:"向上移动10px",code:"Shift+ArrowUp",fn:keyMove(0,-10)}),this.keyMap.register({name:"向下移动10px",code:"Shift+ArrowDown",fn:keyMove(0,10)}),this.keyMap.register({name:"向左移动10px",code:"Shift+ArrowLeft",fn:keyMove(-10,0)}),this.keyMap.register({name:"向右移动10px",code:"Shift+ArrowRight",fn:keyMove(10,0)}),this.keyMap.register({name:"画布移动",code:"Space",fn:{down:e=>{this._downSpace(e),this.canvas._beginMove()},up:e=>{this._upSpace(e),this.canvas._endMove()}}}),this.keyMap.register({name:"多选模式",code:"Shift",fn:{down:()=>{this.selector.enableMultSelect()},up:()=>{this.selector.disableMultSelect()}}}),this.keyMap.register({name:"编辑文本内容",code:"Enter",fn:()=>{this.enterTextEdit()}})},beforeDestroy(){this.keyMap.clear()}}},levelMap={0:["error","warn","info"],1:["error","warn"],2:["error"]};class Log{constructor(e={}){this.maxLog=e.maxLog||100,this.printDate=Boolean(e.printDate)||!0,this.printOnBrowser=Boolean(e.printOnBrowser)||!0,this.level=isNumber(e.level)||0,this._logRange={},this._logStore=[]}getLog(){return this._logStore.join("")}clearLog(){this._logStore=[]}setLevel(e){if(!Object.keys(levelMap).map((e=>Number(e))).includes(e))throw new Error("日志级别配置错误！");this.level=e}downloadLog(){var e=this.getLog(),A=(e=new Blob([e],{type:"data:text/plain;charset=utf-8"}),createElement("a"));A.href=window.URL.createObjectURL(e),A.target="_blank",A.download=`THING.UI-${this.level}-log.txt`,document.body.appendChild(A),A.click(),document.body.removeChild(A),window.URL.revokeObjectURL(A.href)}record(e,A,...t){if(!levelMap[this.level].includes(e))return!1;this._logStore.length>=this.maxLog&&this._logStore.shift(),this.printOnBrowser&&log[e](...t);var i="";i=(i+=this.printDate?`[THING.UI ${e}] ${this._date()} `:`[THING.UI ${e}] `)+t.map((e=>JSON.stringify(e))).join(" ");return this._logStore.push(i+="\n"),this._logRange[A]=new Date,!0}output(e){return new Date-this._logRange[e]}_date(){var e=new Date;return e.toLocaleDateString()+" "+e.toLocaleTimeString()}}new Log;var extendStatics=function(e,A){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,A){e.__proto__=A}:function(e,A){for(var t in A)Object.prototype.hasOwnProperty.call(A,t)&&(e[t]=A[t])}))(e,A)};function __extends(e,A){if("function"!=typeof A&&null!==A)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");function t(){this.constructor=e}extendStatics(e,A),e.prototype=null===A?Object.create(A):(t.prototype=A.prototype,new t)}var __assign=function(){return(__assign=Object.assign||function(e){for(var A,t=1,i=arguments.length;t<i;t++)for(var s in A=arguments[t])Object.prototype.hasOwnProperty.call(A,s)&&(e[s]=A[s]);return e}).apply(this,arguments)};function __awaiter(e,A,t,i){return new(t=t||Promise)((function(s,n){function r(e){try{a(i.next(e))}catch(e){n(e)}}function o(e){try{a(i.throw(e))}catch(e){n(e)}}function a(e){var A;e.done?s(e.value):((A=e.value)instanceof t?A:new t((function(e){e(A)}))).then(r,o)}a((i=i.apply(e,A||[])).next())}))}function __generator(e,A){var t,i,s,n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},r={next:o(0),throw:o(1),return:o(2)};return"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){var a=[r,o];if(t)throw new TypeError("Generator is already executing.");for(;n;)try{if(t=1,i&&(s=2&a[0]?i.return:a[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,a[1])).done)return s;switch(i=0,(a=s?[2&a[0],s.value]:a)[0]){case 0:case 1:s=a;break;case 4:return n.label++,{value:a[1],done:!1};case 5:n.label++,i=a[1],a=[0];continue;case 7:a=n.ops.pop(),n.trys.pop();continue;default:if(!(s=0<(s=n.trys).length&&s[s.length-1])&&(6===a[0]||2===a[0])){n=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3]))n.label=a[1];else if(6===a[0]&&n.label<s[1])n.label=s[1],s=a;else{if(!(s&&n.label<s[2])){s[2]&&n.ops.pop(),n.trys.pop();continue}n.label=s[2],n.ops.push(a)}}a=A.call(e,n)}catch(o){a=[6,o],i=0}finally{t=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}}}function __spreadArray(e,A,t){if(t||2===arguments.length)for(var i,s=0,n=A.length;s<n;s++)!i&&s in A||((i=i||Array.prototype.slice.call(A,0,s))[s]=A[s]);return e.concat(i||A)}for(var Bounds=function(){function e(e,A,t,i){this.left=e,this.top=A,this.width=t,this.height=i}return e.prototype.add=function(A,t,i,s){return new e(this.left+A,this.top+t,this.width+i,this.height+s)},e.fromClientRect=function(A,t){return new e(t.left+A.windowBounds.left,t.top+A.windowBounds.top,t.width,t.height)},e.fromDOMRectList=function(A,t){return t=Array.from(t).find((function(e){return 0!==e.width})),t?new e(t.left+A.windowBounds.left,t.top+A.windowBounds.top,t.width,t.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),parseBounds=function(e,A){return Bounds.fromClientRect(e,A.getBoundingClientRect())},parseDocumentSize=function(e){var A,t=e.body;e=e.documentElement;if(t&&e)return A=Math.max(Math.max(t.scrollWidth,e.scrollWidth),Math.max(t.offsetWidth,e.offsetWidth),Math.max(t.clientWidth,e.clientWidth)),t=Math.max(Math.max(t.scrollHeight,e.scrollHeight),Math.max(t.offsetHeight,e.offsetHeight),Math.max(t.clientHeight,e.clientHeight)),new Bounds(0,0,A,t);throw new Error("Unable to get document size")},toCodePoints$1=function(e){for(var A=[],t=0,i=e.length;t<i;){var s,n=e.charCodeAt(t++);55296<=n&&n<=56319&&t<i?56320==(64512&(s=e.charCodeAt(t++)))?A.push(((1023&n)<<10)+(1023&s)+65536):(A.push(n),t--):A.push(n)}return A},fromCodePoint$1=function(){for(var e=[],A=0;A<arguments.length;A++)e[A]=arguments[A];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var t=e.length;if(!t)return"";for(var i=[],s=-1,n="";++s<t;){var r=e[s];r<=65535?i.push(r):i.push(55296+((r-=65536)>>10),r%1024+56320),(s+1===t||16384<i.length)&&(n+=String.fromCharCode.apply(String,i),i.length=0)}return n},chars$2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$2="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i$2=0;i$2<chars$2.length;i$2++)lookup$2[chars$2.charCodeAt(i$2)]=i$2;for(var chars$1$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1$1="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i$1$1=0;i$1$1<chars$1$1.length;i$1$1++)lookup$1$1[chars$1$1.charCodeAt(i$1$1)]=i$1$1;for(var decode$1=function(e){for(var A,t,i,s,n=.75*e.length,r=e.length,o=0,a=(n=("="===e[e.length-1]&&(n--,"="===e[e.length-2])&&n--,new("undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?ArrayBuffer:Array)(n)),Array.isArray(n)?n:new Uint8Array(n)),l=0;l<r;l+=4)A=lookup$1$1[e.charCodeAt(l)],t=lookup$1$1[e.charCodeAt(l+1)],i=lookup$1$1[e.charCodeAt(l+2)],s=lookup$1$1[e.charCodeAt(l+3)],a[o++]=A<<2|t>>4,a[o++]=(15&t)<<4|i>>2,a[o++]=(3&i)<<6|63&s;return n},polyUint16Array$1=function(e){for(var A=e.length,t=[],i=0;i<A;i+=2)t.push(e[i+1]<<8|e[i]);return t},polyUint32Array$1=function(e){for(var A=e.length,t=[],i=0;i<A;i+=4)t.push(e[i+3]<<24|e[i+2]<<16|e[i+1]<<8|e[i]);return t},UTRIE2_SHIFT_2$1=5,UTRIE2_SHIFT_1$1=11,UTRIE2_INDEX_SHIFT$1=2,UTRIE2_SHIFT_1_2$1=UTRIE2_SHIFT_1$1-UTRIE2_SHIFT_2$1,UTRIE2_LSCP_INDEX_2_OFFSET$1=65536>>UTRIE2_SHIFT_2$1,UTRIE2_DATA_BLOCK_LENGTH$1=1<<UTRIE2_SHIFT_2$1,UTRIE2_DATA_MASK$1=UTRIE2_DATA_BLOCK_LENGTH$1-1,UTRIE2_LSCP_INDEX_2_LENGTH$1=1024>>UTRIE2_SHIFT_2$1,UTRIE2_INDEX_2_BMP_LENGTH$1=UTRIE2_LSCP_INDEX_2_OFFSET$1+UTRIE2_LSCP_INDEX_2_LENGTH$1,UTRIE2_UTF8_2B_INDEX_2_OFFSET$1=UTRIE2_INDEX_2_BMP_LENGTH$1,UTRIE2_UTF8_2B_INDEX_2_LENGTH$1=32,UTRIE2_INDEX_1_OFFSET$1=UTRIE2_UTF8_2B_INDEX_2_OFFSET$1+UTRIE2_UTF8_2B_INDEX_2_LENGTH$1,UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1=65536>>UTRIE2_SHIFT_1$1,UTRIE2_INDEX_2_BLOCK_LENGTH$1=1<<UTRIE2_SHIFT_1_2$1,UTRIE2_INDEX_2_MASK$1=UTRIE2_INDEX_2_BLOCK_LENGTH$1-1,slice16$1=function(e,A,t){return e.slice?e.slice(A,t):new Uint16Array(Array.prototype.slice.call(e,A,t))},slice32$1=function(e,A,t){return e.slice?e.slice(A,t):new Uint32Array(Array.prototype.slice.call(e,A,t))},createTrieFromBase64$1=function(e,A){e=decode$1(e);var t=Array.isArray(e)?polyUint32Array$1(e):new Uint32Array(e),i=(e=Array.isArray(e)?polyUint16Array$1(e):new Uint16Array(e),slice16$1(e,12,t[4]/2));e=2===t[5]?slice16$1(e,(24+t[4])/2):slice32$1(t,Math.ceil((24+t[4])/4));return new Trie$1(t[0],t[1],t[2],t[3],i,e)},Trie$1=function(){function e(e,A,t,i,s,n){this.initialValue=e,this.errorValue=A,this.highStart=t,this.highValueIndex=i,this.index=s,this.data=n}return e.prototype.get=function(e){var A;if(0<=e){if(e<55296||56319<e&&e<=65535)return A=this.index[e>>UTRIE2_SHIFT_2$1],this.data[A=(A<<UTRIE2_INDEX_SHIFT$1)+(e&UTRIE2_DATA_MASK$1)];if(e<=65535)return A=this.index[UTRIE2_LSCP_INDEX_2_OFFSET$1+(e-55296>>UTRIE2_SHIFT_2$1)],this.data[A=(A<<UTRIE2_INDEX_SHIFT$1)+(e&UTRIE2_DATA_MASK$1)];if(e<this.highStart)return A=this.index[A=UTRIE2_INDEX_1_OFFSET$1-UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1+(e>>UTRIE2_SHIFT_1$1)],A=this.index[A+=e>>UTRIE2_SHIFT_2$1&UTRIE2_INDEX_2_MASK$1],this.data[A=(A<<UTRIE2_INDEX_SHIFT$1)+(e&UTRIE2_DATA_MASK$1)];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),chars$3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$3="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i$3=0;i$3<chars$3.length;i$3++)lookup$3[chars$3.charCodeAt(i$3)]=i$3;var base64$1="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",LETTER_NUMBER_MODIFIER=50,BK=1,CR$1=2,LF$1=3,CM=4,NL=5,WJ=7,ZW=8,GL=9,SP=10,ZWJ$1=11,B2=12,BA=13,BB=14,HY=15,CB=16,CL=17,CP=18,EX=19,IN=20,NS=21,OP=22,QU=23,IS=24,NU=25,PO=26,PR=27,SY=28,AI=29,AL=30,CJ=31,EB=32,EM=33,H2=34,H3=35,HL=36,ID=37,JL=38,JV=39,JT=40,RI$1=41,SA=42,XX=43,ea_OP=[9001,65288],BREAK_MANDATORY="!",BREAK_NOT_ALLOWED$1="×",BREAK_ALLOWED$1="÷",UnicodeTrie$1=createTrieFromBase64$1(base64$1),ALPHABETICS=[AL,HL],HARD_LINE_BREAKS=[BK,CR$1,LF$1,NL],SPACE$1=[SP,ZW],PREFIX_POSTFIX=[PR,PO],LINE_BREAKS=HARD_LINE_BREAKS.concat(SPACE$1),KOREAN_SYLLABLE_BLOCK=[JL,JV,JT,H2,H3],HYPHEN=[HY,BA],codePointsToCharacterClasses=function(e,A){void 0===A&&(A="strict");var t=[],i=[],s=[];return e.forEach((function(e,n){var r=UnicodeTrie$1.get(e);return LETTER_NUMBER_MODIFIER<r?(s.push(!0),r-=LETTER_NUMBER_MODIFIER):s.push(!1),-1!==["normal","auto","loose"].indexOf(A)&&-1!==[8208,8211,12316,12448].indexOf(e)?(i.push(n),t.push(CB)):r!==CM&&r!==ZWJ$1?(i.push(n),r===CJ?t.push("strict"===A?NS:ID):r===SA||r===AI?t.push(AL):r===XX?t.push(131072<=e&&e<=196605||196608<=e&&e<=262141?ID:AL):void t.push(r)):0!==n&&-1===LINE_BREAKS.indexOf(e=t[n-1])?(i.push(i[n-1]),t.push(e)):(i.push(n),t.push(AL))})),[i,t,s]},isAdjacentWithSpaceIgnored=function(e,A,t,i){var s=i[t];if(Array.isArray(e)?-1!==e.indexOf(s):e===s)for(var n=t;n<=i.length;){if((o=i[++n])===A)return!0;if(o!==SP)break}if(s===SP)for(n=t;0<n;){var r=i[--n];if(Array.isArray(e)?-1!==e.indexOf(r):e===r)for(var o,a=t;a<=i.length;){if((o=i[++a])===A)return!0;if(o!==SP)break}if(r!==SP)break}return!1},previousNonSpaceClassType=function(e,A){for(var t=e;0<=t;){var i=A[t];if(i!==SP)return i;t--}return 0},_lineBreakAtIndex=function(e,A,t,i,s){if(0===t[i])return BREAK_NOT_ALLOWED$1;if(i-=1,Array.isArray(s)&&!0===s[i])return BREAK_NOT_ALLOWED$1;s=i-1;var n=1+i,r=A[i],o=0<=s?A[s]:0,a=A[n];if(r===CR$1&&a===LF$1)return BREAK_NOT_ALLOWED$1;if(-1!==HARD_LINE_BREAKS.indexOf(r))return BREAK_MANDATORY;if(-1!==HARD_LINE_BREAKS.indexOf(a))return BREAK_NOT_ALLOWED$1;if(-1!==SPACE$1.indexOf(a))return BREAK_NOT_ALLOWED$1;if(previousNonSpaceClassType(i,A)===ZW)return BREAK_ALLOWED$1;if(UnicodeTrie$1.get(e[i])===ZWJ$1)return BREAK_NOT_ALLOWED$1;if((r===EB||r===EM)&&UnicodeTrie$1.get(e[n])===ZWJ$1)return BREAK_NOT_ALLOWED$1;if(r===WJ||a===WJ)return BREAK_NOT_ALLOWED$1;if(r===GL)return BREAK_NOT_ALLOWED$1;if(-1===[SP,BA,HY].indexOf(r)&&a===GL)return BREAK_NOT_ALLOWED$1;if(-1!==[CL,CP,EX,IS,SY].indexOf(a))return BREAK_NOT_ALLOWED$1;if(previousNonSpaceClassType(i,A)===OP)return BREAK_NOT_ALLOWED$1;if(isAdjacentWithSpaceIgnored(QU,OP,i,A))return BREAK_NOT_ALLOWED$1;if(isAdjacentWithSpaceIgnored([CL,CP],NS,i,A))return BREAK_NOT_ALLOWED$1;if(isAdjacentWithSpaceIgnored(B2,B2,i,A))return BREAK_NOT_ALLOWED$1;if(r===SP)return BREAK_ALLOWED$1;if(r===QU||a===QU)return BREAK_NOT_ALLOWED$1;if(a===CB||r===CB)return BREAK_ALLOWED$1;if(-1!==[BA,HY,NS].indexOf(a)||r===BB)return BREAK_NOT_ALLOWED$1;if(o===HL&&-1!==HYPHEN.indexOf(r))return BREAK_NOT_ALLOWED$1;if(r===SY&&a===HL)return BREAK_NOT_ALLOWED$1;if(a===IN)return BREAK_NOT_ALLOWED$1;if(-1!==ALPHABETICS.indexOf(a)&&r===NU||-1!==ALPHABETICS.indexOf(r)&&a===NU)return BREAK_NOT_ALLOWED$1;if(r===PR&&-1!==[ID,EB,EM].indexOf(a)||-1!==[ID,EB,EM].indexOf(r)&&a===PO)return BREAK_NOT_ALLOWED$1;if(-1!==ALPHABETICS.indexOf(r)&&-1!==PREFIX_POSTFIX.indexOf(a)||-1!==PREFIX_POSTFIX.indexOf(r)&&-1!==ALPHABETICS.indexOf(a))return BREAK_NOT_ALLOWED$1;if(-1!==[PR,PO].indexOf(r)&&(a===NU||-1!==[OP,HY].indexOf(a)&&A[1+n]===NU)||-1!==[OP,HY].indexOf(r)&&a===NU||r===NU&&-1!==[NU,SY,IS].indexOf(a))return BREAK_NOT_ALLOWED$1;if(-1!==[NU,SY,IS,CL,CP].indexOf(a))for(var l=i;0<=l;){if((c=A[l])===NU)return BREAK_NOT_ALLOWED$1;if(-1===[SY,IS].indexOf(c))break;l--}if(-1!==[PR,PO].indexOf(a)){var c;for(l=-1!==[CL,CP].indexOf(r)?s:i;0<=l;){if((c=A[l])===NU)return BREAK_NOT_ALLOWED$1;if(-1===[SY,IS].indexOf(c))break;l--}}if(JL===r&&-1!==[JL,JV,H2,H3].indexOf(a)||-1!==[JV,H2].indexOf(r)&&-1!==[JV,JT].indexOf(a)||-1!==[JT,H3].indexOf(r)&&a===JT)return BREAK_NOT_ALLOWED$1;if(-1!==KOREAN_SYLLABLE_BLOCK.indexOf(r)&&-1!==[IN,PO].indexOf(a)||-1!==KOREAN_SYLLABLE_BLOCK.indexOf(a)&&r===PR)return BREAK_NOT_ALLOWED$1;if(-1!==ALPHABETICS.indexOf(r)&&-1!==ALPHABETICS.indexOf(a))return BREAK_NOT_ALLOWED$1;if(r===IS&&-1!==ALPHABETICS.indexOf(a))return BREAK_NOT_ALLOWED$1;if(-1!==ALPHABETICS.concat(NU).indexOf(r)&&a===OP&&-1===ea_OP.indexOf(e[n])||-1!==ALPHABETICS.concat(NU).indexOf(a)&&r===CP)return BREAK_NOT_ALLOWED$1;if(r===RI$1&&a===RI$1){for(var h=t[i],u=1;0<h&&A[--h]===RI$1;)u++;if(u%2!=0)return BREAK_NOT_ALLOWED$1}return r===EB&&a===EM?BREAK_NOT_ALLOWED$1:BREAK_ALLOWED$1},cssFormattedClasses=function(e,A){var t=(s=codePointsToCharacterClasses(e,(A=A||{lineBreak:"normal",wordBreak:"normal"}).lineBreak))[0],i=s[1],s=s[2];"break-all"!==A.wordBreak&&"break-word"!==A.wordBreak||(i=i.map((function(e){return-1!==[NU,AL,SA].indexOf(e)?ID:e}))),A="keep-all"===A.wordBreak?s.map((function(A,t){return A&&19968<=e[t]&&e[t]<=40959})):void 0;return[t,i,A]},Break=function(){function e(e,A,t,i){this.codePoints=e,this.required=A===BREAK_MANDATORY,this.start=t,this.end=i}return e.prototype.slice=function(){return fromCodePoint$1.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),LineBreaker=function(e,A){var t=toCodePoints$1(e),i=(e=cssFormattedClasses(t,A))[0],s=e[1],n=e[2],r=t.length,o=0,a=0;return{next:function(){if(r<=a)return{done:!0,value:null};for(var e,A=BREAK_NOT_ALLOWED$1;a<r&&(A=_lineBreakAtIndex(t,s,i,++a,n))===BREAK_NOT_ALLOWED$1;);return A!==BREAK_NOT_ALLOWED$1||a===r?(e=new Break(t,A,o,a),o=a,{value:e,done:!1}):{done:!0,value:null}}}},FLAG_UNRESTRICTED=1,FLAG_ID=2,FLAG_INTEGER=4,FLAG_NUMBER=8,LINE_FEED=10,SOLIDUS=47,REVERSE_SOLIDUS=92,CHARACTER_TABULATION=9,SPACE=32,QUOTATION_MARK=34,EQUALS_SIGN=61,NUMBER_SIGN=35,DOLLAR_SIGN=36,PERCENTAGE_SIGN=37,APOSTROPHE=39,LEFT_PARENTHESIS=40,RIGHT_PARENTHESIS=41,LOW_LINE=95,HYPHEN_MINUS=45,EXCLAMATION_MARK=33,LESS_THAN_SIGN=60,GREATER_THAN_SIGN=62,COMMERCIAL_AT=64,LEFT_SQUARE_BRACKET=91,RIGHT_SQUARE_BRACKET=93,CIRCUMFLEX_ACCENT=61,LEFT_CURLY_BRACKET=123,QUESTION_MARK=63,RIGHT_CURLY_BRACKET=125,VERTICAL_LINE=124,TILDE=126,CONTROL=128,REPLACEMENT_CHARACTER=65533,ASTERISK=42,PLUS_SIGN=43,COMMA=44,COLON=58,SEMICOLON=59,FULL_STOP=46,NULL=0,BACKSPACE=8,LINE_TABULATION=11,SHIFT_OUT=14,INFORMATION_SEPARATOR_ONE=31,DELETE=127,EOF=-1,ZERO=48,a=97,e=101,f=102,u=117,z=122,A=65,E=69,F=70,U=85,Z=90,isDigit=function(e){return ZERO<=e&&e<=57},isSurrogateCodePoint=function(e){return 55296<=e&&e<=57343},isHex=function(e){return isDigit(e)||A<=e&&e<=F||a<=e&&e<=f},isLowerCaseLetter=function(e){return a<=e&&e<=z},isUpperCaseLetter=function(e){return A<=e&&e<=Z},isLetter=function(e){return isLowerCaseLetter(e)||isUpperCaseLetter(e)},isNonASCIICodePoint=function(e){return CONTROL<=e},isWhiteSpace=function(e){return e===LINE_FEED||e===CHARACTER_TABULATION||e===SPACE},isNameStartCodePoint=function(e){return isLetter(e)||isNonASCIICodePoint(e)||e===LOW_LINE},isNameCodePoint=function(e){return isNameStartCodePoint(e)||isDigit(e)||e===HYPHEN_MINUS},isNonPrintableCodePoint=function(e){return NULL<=e&&e<=BACKSPACE||e===LINE_TABULATION||SHIFT_OUT<=e&&e<=INFORMATION_SEPARATOR_ONE||e===DELETE},isValidEscape=function(e,A){return e===REVERSE_SOLIDUS&&A!==LINE_FEED},isIdentifierStart=function(e,A,t){return e===HYPHEN_MINUS?isNameStartCodePoint(A)||isValidEscape(A,t):!!isNameStartCodePoint(e)||!(e!==REVERSE_SOLIDUS||!isValidEscape(e,A))},isNumberStart=function(e,A,t){return e===PLUS_SIGN||e===HYPHEN_MINUS?!!isDigit(A)||A===FULL_STOP&&isDigit(t):isDigit(e===FULL_STOP?A:e)},stringToNumber=function(A){for(var t=0,i=1,s=(A[t]!==PLUS_SIGN&&A[t]!==HYPHEN_MINUS||(A[t]===HYPHEN_MINUS&&(i=-1),t++),[]);isDigit(A[t]);)s.push(A[t++]);for(var n=s.length?parseInt(fromCodePoint$1.apply(void 0,s),10):0,r=(A[t]===FULL_STOP&&t++,[]);isDigit(A[t]);)r.push(A[t++]);for(var o=r.length,a=o?parseInt(fromCodePoint$1.apply(void 0,r),10):0,l=(A[t]!==E&&A[t]!==e||t++,1),c=(A[t]!==PLUS_SIGN&&A[t]!==HYPHEN_MINUS||(A[t]===HYPHEN_MINUS&&(l=-1),t++),[]);isDigit(A[t]);)c.push(A[t++]);var h=c.length?parseInt(fromCodePoint$1.apply(void 0,c),10):0;return i*(n+a*Math.pow(10,-o))*Math.pow(10,l*h)},LEFT_PARENTHESIS_TOKEN={type:2},RIGHT_PARENTHESIS_TOKEN={type:3},COMMA_TOKEN={type:4},SUFFIX_MATCH_TOKEN={type:13},PREFIX_MATCH_TOKEN={type:8},COLUMN_TOKEN={type:21},DASH_MATCH_TOKEN={type:9},INCLUDE_MATCH_TOKEN={type:10},LEFT_CURLY_BRACKET_TOKEN={type:11},RIGHT_CURLY_BRACKET_TOKEN={type:12},SUBSTRING_MATCH_TOKEN={type:14},BAD_URL_TOKEN={type:23},BAD_STRING_TOKEN={type:1},CDO_TOKEN={type:25},CDC_TOKEN={type:24},COLON_TOKEN={type:26},SEMICOLON_TOKEN={type:27},LEFT_SQUARE_BRACKET_TOKEN={type:28},RIGHT_SQUARE_BRACKET_TOKEN={type:29},WHITESPACE_TOKEN={type:31},EOF_TOKEN={type:32},Tokenizer=function(){function A(){this._value=[]}return A.prototype.write=function(e){this._value=this._value.concat(toCodePoints$1(e))},A.prototype.read=function(){for(var e=[],A=this.consumeToken();A!==EOF_TOKEN;)e.push(A),A=this.consumeToken();return e},A.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case QUOTATION_MARK:return this.consumeStringToken(QUOTATION_MARK);case NUMBER_SIGN:var A=this.peekCodePoint(0),t=this.peekCodePoint(1),i=this.peekCodePoint(2);if(isNameCodePoint(A)||isValidEscape(t,i))return A=isIdentifierStart(A,t,i)?FLAG_ID:FLAG_UNRESTRICTED,{type:5,value:this.consumeName(),flags:A};break;case DOLLAR_SIGN:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),SUFFIX_MATCH_TOKEN;break;case APOSTROPHE:return this.consumeStringToken(APOSTROPHE);case LEFT_PARENTHESIS:return LEFT_PARENTHESIS_TOKEN;case RIGHT_PARENTHESIS:return RIGHT_PARENTHESIS_TOKEN;case ASTERISK:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),SUBSTRING_MATCH_TOKEN;break;case PLUS_SIGN:if(isNumberStart(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case COMMA:return COMMA_TOKEN;case HYPHEN_MINUS:if(t=e,i=this.peekCodePoint(0),A=this.peekCodePoint(1),isNumberStart(t,i,A))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(isIdentifierStart(t,i,A))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(i===HYPHEN_MINUS&&A===GREATER_THAN_SIGN)return this.consumeCodePoint(),this.consumeCodePoint(),CDC_TOKEN;break;case FULL_STOP:if(isNumberStart(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case SOLIDUS:if(this.peekCodePoint(0)===ASTERISK)for(this.consumeCodePoint();;){var s=this.consumeCodePoint();if(s===ASTERISK&&(s=this.consumeCodePoint())===SOLIDUS)return this.consumeToken();if(s===EOF)return this.consumeToken()}break;case COLON:return COLON_TOKEN;case SEMICOLON:return SEMICOLON_TOKEN;case LESS_THAN_SIGN:if(this.peekCodePoint(0)===EXCLAMATION_MARK&&this.peekCodePoint(1)===HYPHEN_MINUS&&this.peekCodePoint(2)===HYPHEN_MINUS)return this.consumeCodePoint(),this.consumeCodePoint(),CDO_TOKEN;break;case COMMERCIAL_AT:if(t=this.peekCodePoint(0),i=this.peekCodePoint(1),A=this.peekCodePoint(2),isIdentifierStart(t,i,A))return{type:7,value:this.consumeName()};break;case LEFT_SQUARE_BRACKET:return LEFT_SQUARE_BRACKET_TOKEN;case REVERSE_SOLIDUS:if(isValidEscape(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case RIGHT_SQUARE_BRACKET:return RIGHT_SQUARE_BRACKET_TOKEN;case CIRCUMFLEX_ACCENT:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),PREFIX_MATCH_TOKEN;break;case LEFT_CURLY_BRACKET:return LEFT_CURLY_BRACKET_TOKEN;case RIGHT_CURLY_BRACKET:return RIGHT_CURLY_BRACKET_TOKEN;case u:case U:return t=this.peekCodePoint(0),i=this.peekCodePoint(1),t!==PLUS_SIGN||!isHex(i)&&i!==QUESTION_MARK||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case VERTICAL_LINE:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),DASH_MATCH_TOKEN;if(this.peekCodePoint(0)===VERTICAL_LINE)return this.consumeCodePoint(),COLUMN_TOKEN;break;case TILDE:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),INCLUDE_MATCH_TOKEN;break;case EOF:return EOF_TOKEN}return isWhiteSpace(e)?(this.consumeWhiteSpace(),WHITESPACE_TOKEN):isDigit(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):isNameStartCodePoint(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:fromCodePoint$1(e)}},A.prototype.consumeCodePoint=function(){var e=this._value.shift();return void 0===e?-1:e},A.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},A.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},A.prototype.consumeUnicodeRangeToken=function(){for(var e=[],A=this.consumeCodePoint();isHex(A)&&e.length<6;)e.push(A),A=this.consumeCodePoint();for(var t=!1;A===QUESTION_MARK&&e.length<6;)e.push(A),A=this.consumeCodePoint(),t=!0;if(t)return{type:30,start:parseInt(fromCodePoint$1.apply(void 0,e.map((function(e){return e===QUESTION_MARK?ZERO:e}))),16),end:parseInt(fromCodePoint$1.apply(void 0,e.map((function(e){return e===QUESTION_MARK?F:e}))),16)};var i=parseInt(fromCodePoint$1.apply(void 0,e),16);if(this.peekCodePoint(0)===HYPHEN_MINUS&&isHex(this.peekCodePoint(1))){this.consumeCodePoint();A=this.consumeCodePoint();for(var s=[];isHex(A)&&s.length<6;)s.push(A),A=this.consumeCodePoint();return{type:30,start:i,end:parseInt(fromCodePoint$1.apply(void 0,s),16)}}return{type:30,start:i,end:i}},A.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return"url"===e.toLowerCase()&&this.peekCodePoint(0)===LEFT_PARENTHESIS?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===LEFT_PARENTHESIS?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},A.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF)return{type:22,value:""};var A=this.peekCodePoint(0);if(A===APOSTROPHE||A===QUOTATION_MARK)return 0===(A=this.consumeStringToken(this.consumeCodePoint())).type&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF||this.peekCodePoint(0)===RIGHT_PARENTHESIS)?(this.consumeCodePoint(),{type:22,value:A.value}):(this.consumeBadUrlRemnants(),BAD_URL_TOKEN);for(;;){var t=this.consumeCodePoint();if(t===EOF||t===RIGHT_PARENTHESIS)return{type:22,value:fromCodePoint$1.apply(void 0,e)};if(isWhiteSpace(t))return this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF||this.peekCodePoint(0)===RIGHT_PARENTHESIS?(this.consumeCodePoint(),{type:22,value:fromCodePoint$1.apply(void 0,e)}):(this.consumeBadUrlRemnants(),BAD_URL_TOKEN);if(t===QUOTATION_MARK||t===APOSTROPHE||t===LEFT_PARENTHESIS||isNonPrintableCodePoint(t))return this.consumeBadUrlRemnants(),BAD_URL_TOKEN;if(t===REVERSE_SOLIDUS){if(!isValidEscape(t,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),BAD_URL_TOKEN;e.push(this.consumeEscapedCodePoint())}else e.push(t)}},A.prototype.consumeWhiteSpace=function(){for(;isWhiteSpace(this.peekCodePoint(0));)this.consumeCodePoint()},A.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===RIGHT_PARENTHESIS||e===EOF)return;isValidEscape(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},A.prototype.consumeStringSlice=function(e){for(var A="";0<e;){var t=Math.min(5e4,e);A+=fromCodePoint$1.apply(void 0,this._value.splice(0,t)),e-=t}return this._value.shift(),A},A.prototype.consumeStringToken=function(e){for(var A="",t=0;;){var i,s=this._value[t];if(s===EOF||void 0===s||s===e)return{type:0,value:A+=this.consumeStringSlice(t)};if(s===LINE_FEED)return this._value.splice(0,t),BAD_STRING_TOKEN;s===REVERSE_SOLIDUS&&(i=this._value[t+1])!==EOF&&void 0!==i&&(i===LINE_FEED?(A+=this.consumeStringSlice(t),t=-1,this._value.shift()):isValidEscape(s,i)&&(A=(A+=this.consumeStringSlice(t))+fromCodePoint$1(this.consumeEscapedCodePoint()),t=-1)),t++}},A.prototype.consumeNumber=function(){var A=[],t=FLAG_INTEGER;for((i=this.peekCodePoint(0))!==PLUS_SIGN&&i!==HYPHEN_MINUS||A.push(this.consumeCodePoint());isDigit(this.peekCodePoint(0));)A.push(this.consumeCodePoint());var i=this.peekCodePoint(0),s=this.peekCodePoint(1);if(i===FULL_STOP&&isDigit(s))for(A.push(this.consumeCodePoint(),this.consumeCodePoint()),t=FLAG_NUMBER;isDigit(this.peekCodePoint(0));)A.push(this.consumeCodePoint());i=this.peekCodePoint(0);s=this.peekCodePoint(1);var n=this.peekCodePoint(2);if((i===E||i===e)&&((s===PLUS_SIGN||s===HYPHEN_MINUS)&&isDigit(n)||isDigit(s)))for(A.push(this.consumeCodePoint(),this.consumeCodePoint()),t=FLAG_NUMBER;isDigit(this.peekCodePoint(0));)A.push(this.consumeCodePoint());return[stringToNumber(A),t]},A.prototype.consumeNumericToken=function(){var e=(A=this.consumeNumber())[0],A=A[1],t=this.peekCodePoint(0),i=this.peekCodePoint(1),s=this.peekCodePoint(2);return isIdentifierStart(t,i,s)?{type:15,number:e,flags:A,unit:this.consumeName()}:t===PERCENTAGE_SIGN?(this.consumeCodePoint(),{type:16,number:e,flags:A}):{type:17,number:e,flags:A}},A.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(isHex(e)){for(var A=fromCodePoint$1(e);isHex(this.peekCodePoint(0))&&A.length<6;)A+=fromCodePoint$1(this.consumeCodePoint());isWhiteSpace(this.peekCodePoint(0))&&this.consumeCodePoint();var t=parseInt(A,16);return 0===t||isSurrogateCodePoint(t)||1114111<t?REPLACEMENT_CHARACTER:t}return e===EOF?REPLACEMENT_CHARACTER:e},A.prototype.consumeName=function(){for(var e="";;){var A=this.consumeCodePoint();if(isNameCodePoint(A))e+=fromCodePoint$1(A);else{if(!isValidEscape(A,this.peekCodePoint(0)))return this.reconsumeCodePoint(A),e;e+=fromCodePoint$1(this.consumeEscapedCodePoint())}}},A}(),Parser=function(){function e(e){this._tokens=e}return e.create=function(A){var t=new Tokenizer;return t.write(A),new e(t.read())},e.parseValue=function(A){return e.create(A).parseComponentValue()},e.parseValues=function(A){return e.create(A).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var e=this.consumeToken();31===e.type;)e=this.consumeToken();if(32===e.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);for(var A=this.consumeComponentValue();31===(e=this.consumeToken()).type;);if(32===e.type)return A;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var e=[];;){var A=this.consumeComponentValue();if(32===A.type)return e;e.push(A),e.push()}},e.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},e.prototype.consumeSimpleBlock=function(e){for(var A={type:e,values:[]},t=this.consumeToken();;){if(32===t.type||isEndingTokenFor(t,e))return A;this.reconsumeToken(t),A.values.push(this.consumeComponentValue()),t=this.consumeToken()}},e.prototype.consumeFunction=function(e){for(var A={name:e.value,values:[],type:18};;){var t=this.consumeToken();if(32===t.type||3===t.type)return A;this.reconsumeToken(t),A.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var e=this._tokens.shift();return void 0===e?EOF_TOKEN:e},e.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},e}(),isDimensionToken=function(e){return 15===e.type},isNumberToken=function(e){return 17===e.type},isIdentToken=function(e){return 20===e.type},isStringToken=function(e){return 0===e.type},isIdentWithValue=function(e,A){return isIdentToken(e)&&e.value===A},nonWhiteSpace=function(e){return 31!==e.type},nonFunctionArgSeparator=function(e){return 31!==e.type&&4!==e.type},parseFunctionArgs=function(e){var A=[],t=[];return e.forEach((function(e){if(4===e.type){if(0===t.length)throw new Error("Error parsing function args, zero tokens for arg");A.push(t),t=[]}else 31!==e.type&&t.push(e)})),t.length&&A.push(t),A},isEndingTokenFor=function(e,A){return 11===A&&12===e.type||28===A&&29===e.type||2===A&&3===e.type},isLength=function(e){return 17===e.type||15===e.type},isLengthPercentage=function(e){return 16===e.type||isLength(e)},parseLengthPercentageTuple=function(e){return 1<e.length?[e[0],e[1]]:[e[0]]},ZERO_LENGTH={type:17,number:0,flags:FLAG_INTEGER},FIFTY_PERCENT={type:16,number:50,flags:FLAG_INTEGER},HUNDRED_PERCENT={type:16,number:100,flags:FLAG_INTEGER},getAbsoluteValueForTuple=function(e,A,t){var i=e[0];e=e[1];return[getAbsoluteValue(i,A),getAbsoluteValue(void 0!==e?e:i,t)]},getAbsoluteValue=function(e,A){if(16===e.type)return e.number/100*A;if(isDimensionToken(e))switch(e.unit){case"rem":case"em":return 16*e.number;default:return e.number}return e.number},DEG="deg",GRAD="grad",RAD="rad",TURN="turn",angle={name:"angle",parse:function(e,A){if(15===A.type)switch(A.unit){case DEG:return Math.PI*A.number/180;case GRAD:return Math.PI/200*A.number;case RAD:return A.number;case TURN:return 2*Math.PI*A.number}throw new Error("Unsupported angle type")}},isAngle=function(e){return 15===e.type&&(e.unit===DEG||e.unit===GRAD||e.unit===RAD||e.unit===TURN)},parseNamedSide=function(e){switch(e.filter(isIdentToken).map((function(e){return e.value})).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[ZERO_LENGTH,ZERO_LENGTH];case"to top":case"bottom":return deg(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[ZERO_LENGTH,HUNDRED_PERCENT];case"to right":case"left":return deg(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[HUNDRED_PERCENT,HUNDRED_PERCENT];case"to bottom":case"top":return deg(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[HUNDRED_PERCENT,ZERO_LENGTH];case"to left":case"right":return deg(270)}return 0},deg=function(e){return Math.PI*e/180},color$1={name:"color",parse:function(e,A){if(18===A.type){var t=SUPPORTED_COLOR_FUNCTIONS[A.name];if(void 0===t)throw new Error('Attempting to parse an unsupported color function "'+A.name+'"');return t(e,A.values)}if(5===A.type){var i,s,n,r;if(3===A.value.length)return i=A.value.substring(0,1),s=A.value.substring(1,2),n=A.value.substring(2,3),pack(parseInt(i+i,16),parseInt(s+s,16),parseInt(n+n,16),1);if(4===A.value.length)return i=A.value.substring(0,1),s=A.value.substring(1,2),n=A.value.substring(2,3),r=A.value.substring(3,4),pack(parseInt(i+i,16),parseInt(s+s,16),parseInt(n+n,16),parseInt(r+r,16)/255);if(6===A.value.length)return i=A.value.substring(0,2),s=A.value.substring(2,4),n=A.value.substring(4,6),pack(parseInt(i,16),parseInt(s,16),parseInt(n,16),1);if(8===A.value.length)return i=A.value.substring(0,2),s=A.value.substring(2,4),n=A.value.substring(4,6),r=A.value.substring(6,8),pack(parseInt(i,16),parseInt(s,16),parseInt(n,16),parseInt(r,16)/255)}return 20===A.type&&void 0!==(t=COLORS[A.value.toUpperCase()])?t:COLORS.TRANSPARENT}},isTransparent=function(e){return 0==(255&e)},asString=function(e){var A=255&e,t=255&e>>8,i=255&e>>16;e=255&e>>24;return A<255?"rgba("+e+","+i+","+t+","+A/255+")":"rgb("+e+","+i+","+t+")"},pack=function(e,A,t,i){return(e<<24|A<<16|t<<8|Math.round(255*i)<<0)>>>0},getTokenColorValue=function(e,A){var t;return 17===e.type?e.number:16===e.type?(t=3===A?1:255,3===A?e.number/100*t:Math.round(e.number/100*t)):0},rgb=function(e,A){var t,i,s;return 3===(A=A.filter(nonFunctionArgSeparator)).length?(t=(s=A.map(getTokenColorValue))[0],i=s[1],s=s[2],pack(t,i,s,1)):4===A.length?(t=(A=A.map(getTokenColorValue))[0],i=A[1],s=A[2],A=A[3],pack(t,i,s,A)):0};function hue2rgb(e,A,t){return t<0&&(t+=1),1<=t&&--t,t<1/6?(A-e)*t*6+e:t<.5?A:t<2/3?6*(A-e)*(2/3-t)+e:e}var hsl=function(e,A){var t,i=(A=A.filter(nonFunctionArgSeparator))[0],s=A[1],n=A[2];A=A[3],e=(17===i.type?deg(i.number):angle.parse(e,i))/(2*Math.PI),i=isLengthPercentage(s)?s.number/100:0,s=isLengthPercentage(n)?n.number/100:0,n=void 0!==A&&isLengthPercentage(A)?getAbsoluteValue(A,1):1;return 0==i?pack(255*s,255*s,255*s,1):(i=hue2rgb(s=2*s-(A=s<=.5?s*(1+i):s+i-s*i),A,e+1/3),t=hue2rgb(s,A,e),s=hue2rgb(s,A,e-1/3),pack(255*i,255*t,255*s,n))},SUPPORTED_COLOR_FUNCTIONS={hsl:hsl,hsla:hsl,rgb:rgb,rgba:rgb},parseColor=function(e,A){return color$1.parse(e,Parser.create(A).parseComponentValue())},COLORS={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},backgroundClip={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,A){return A.map((function(e){if(isIdentToken(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},backgroundColor={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},parseColorStop=function(e,A){return e=color$1.parse(e,A[0]),(A=A[1])&&isLengthPercentage(A)?{color:e,stop:A}:{color:e,stop:null}},processColorStops=function(e,A){for(var t=e[0],i=e[e.length-1],s=(null===t.stop&&(t.stop=ZERO_LENGTH),null===i.stop&&(i.stop=HUNDRED_PERCENT),[]),n=0,r=0;r<e.length;r++){var o=e[r].stop;null!==o?(o=getAbsoluteValue(o,A),s.push(n<o?o:n),n=o):s.push(null)}var a=null;for(r=0;r<s.length;r++){var l=s[r];if(null===l)null===a&&(a=r);else if(null!==a){for(var c=r-a,h=(l-s[a-1])/(1+c),u=1;u<=c;u++)s[a+u-1]=h*u;a=null}}return e.map((function(e,t){return{color:e.color,stop:Math.max(Math.min(1,s[t]/A),0)}}))},getAngleFromCorner=function(e,A,t){var i=A/2,s=t/2;A=getAbsoluteValue(e[0],A)-i,i=s-getAbsoluteValue(e[1],t);return(Math.atan2(i,A)+2*Math.PI)%(2*Math.PI)},calculateGradientDirection=function(e,A,t){e="number"==typeof e?e:getAngleFromCorner(e,A,t);var i=Math.abs(A*Math.sin(e))+Math.abs(t*Math.cos(e)),s=(A=A/2,t=t/2,i/2),n=Math.sin(e-Math.PI/2)*s;return[i,A-(e=Math.cos(e-Math.PI/2)*s),A+e,t-n,t+n]},distance=function(e,A){return Math.sqrt(e*e+A*A)},findCorner=function(e,A,t,i,s){return[[0,0],[0,A],[e,0],[e,A]].reduce((function(e,A){var n=A[0],r=A[1];n=distance(t-n,i-r);return(s?n<e.optimumDistance:n>e.optimumDistance)?{optimumCorner:A,optimumDistance:n}:e}),{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},calculateRadius=function(e,A,t,i,s){var n,r,o,a,l=0,c=0;switch(e.size){case 0:0===e.shape?l=c=Math.min(Math.abs(A),Math.abs(A-i),Math.abs(t),Math.abs(t-s)):1===e.shape&&(l=Math.min(Math.abs(A),Math.abs(A-i)),c=Math.min(Math.abs(t),Math.abs(t-s)));break;case 2:0===e.shape?l=c=Math.min(distance(A,t),distance(A,t-s),distance(A-i,t),distance(A-i,t-s)):1===e.shape&&(n=Math.min(Math.abs(t),Math.abs(t-s))/Math.min(Math.abs(A),Math.abs(A-i)),o=(a=findCorner(i,s,A,t,!0))[0],a=a[1],c=n*(l=distance(o-A,(a-t)/n)));break;case 1:0===e.shape?l=c=Math.max(Math.abs(A),Math.abs(A-i),Math.abs(t),Math.abs(t-s)):1===e.shape&&(l=Math.max(Math.abs(A),Math.abs(A-i)),c=Math.max(Math.abs(t),Math.abs(t-s)));break;case 3:0===e.shape?l=c=Math.max(distance(A,t),distance(A,t-s),distance(A-i,t),distance(A-i,t-s)):1===e.shape&&(n=Math.max(Math.abs(t),Math.abs(t-s))/Math.max(Math.abs(A),Math.abs(A-i)),o=(r=findCorner(i,s,A,t,!1))[0],a=r[1],c=n*(l=distance(o-A,(a-t)/n)))}return Array.isArray(e.size)&&(l=getAbsoluteValue(e.size[0],i),c=2===e.size.length?getAbsoluteValue(e.size[1],s):l),[l,c]},linearGradient=function(e,A){var t=deg(180),i=[];return parseFunctionArgs(A).forEach((function(A,s){if(0===s){if(20===(s=A[0]).type&&"to"===s.value)return void(t=parseNamedSide(A));if(isAngle(s))return void(t=angle.parse(e,s))}s=parseColorStop(e,A),i.push(s)})),{angle:t,stops:i,type:1}},prefixLinearGradient=function(e,A){var t=deg(180),i=[];return parseFunctionArgs(A).forEach((function(A,s){if(0===s){if(20===(s=A[0]).type&&-1!==["top","left","right","bottom"].indexOf(s.value))return void(t=parseNamedSide(A));if(isAngle(s))return void(t=(angle.parse(e,s)+deg(270))%deg(360))}s=parseColorStop(e,A),i.push(s)})),{angle:t,stops:i,type:1}},webkitGradient=function(e,A){var t=deg(180),i=[],s=1;return parseFunctionArgs(A).forEach((function(A,t){var n;A=A[0];if(0===t){if(isIdentToken(A)&&"linear"===A.value)return void(s=1);if(isIdentToken(A)&&"radial"===A.value)return void(s=2)}18===A.type&&("from"===A.name?(n=color$1.parse(e,A.values[0]),i.push({stop:ZERO_LENGTH,color:n})):"to"===A.name?(n=color$1.parse(e,A.values[0]),i.push({stop:HUNDRED_PERCENT,color:n})):"color-stop"===A.name&&2===(t=A.values.filter(nonFunctionArgSeparator)).length&&(n=color$1.parse(e,t[1]),A=t[0],isNumberToken(A))&&i.push({stop:{type:16,number:100*A.number,flags:A.flags},color:n}))})),1===s?{angle:(t+deg(180))%deg(360),stops:i,type:s}:{size:3,shape:0,stops:i,position:[],type:s}},CLOSEST_SIDE="closest-side",FARTHEST_SIDE="farthest-side",CLOSEST_CORNER="closest-corner",FARTHEST_CORNER="farthest-corner",CIRCLE="circle",ELLIPSE="ellipse",COVER="cover",CONTAIN="contain",radialGradient=function(e,A){var t=0,i=3,s=[],n=[];return parseFunctionArgs(A).forEach((function(A,r){var o,a=!0;0===r&&(o=!1,a=A.reduce((function(e,A){if(o)if(isIdentToken(A))switch(A.value){case"center":return n.push(FIFTY_PERCENT),e;case"top":case"left":return n.push(ZERO_LENGTH),e;case"right":case"bottom":return n.push(HUNDRED_PERCENT),e}else(isLengthPercentage(A)||isLength(A))&&n.push(A);else if(isIdentToken(A))switch(A.value){case CIRCLE:return t=0,!1;case ELLIPSE:return!(t=1);case"at":return!(o=!0);case CLOSEST_SIDE:return i=0,!1;case COVER:case FARTHEST_SIDE:return!(i=1);case CONTAIN:case CLOSEST_CORNER:return!(i=2);case FARTHEST_CORNER:return!(i=3)}else if(isLength(A)||isLengthPercentage(A))return(i=Array.isArray(i)?i:[]).push(A),!1;return e}),a)),a&&(r=parseColorStop(e,A),s.push(r))})),{size:i,shape:t,stops:s,position:n,type:2}},prefixRadialGradient=function(e,A){var t=0,i=3,s=[],n=[];return parseFunctionArgs(A).forEach((function(A,r){var o=!0;0===r?o=A.reduce((function(e,A){if(isIdentToken(A))switch(A.value){case"center":return n.push(FIFTY_PERCENT),!1;case"top":case"left":return n.push(ZERO_LENGTH),!1;case"right":case"bottom":return n.push(HUNDRED_PERCENT),!1}else if(isLengthPercentage(A)||isLength(A))return n.push(A),!1;return e}),o):1===r&&(o=A.reduce((function(e,A){if(isIdentToken(A))switch(A.value){case CIRCLE:return t=0,!1;case ELLIPSE:return!(t=1);case CONTAIN:case CLOSEST_SIDE:return i=0,!1;case FARTHEST_SIDE:return!(i=1);case CLOSEST_CORNER:return!(i=2);case COVER:case FARTHEST_CORNER:return!(i=3)}else if(isLength(A)||isLengthPercentage(A))return(i=Array.isArray(i)?i:[]).push(A),!1;return e}),o)),o&&(r=parseColorStop(e,A),s.push(r))})),{size:i,shape:t,stops:s,position:n,type:2}},isLinearGradient=function(e){return 1===e.type},isRadialGradient=function(e){return 2===e.type},image={name:"image",parse:function(e,A){if(22===A.type)return t={url:A.value,type:0},e.cache.addImage(A.value),t;if(18!==A.type)throw new Error("Unsupported image type "+A.type);var t=SUPPORTED_IMAGE_FUNCTIONS[A.name];if(void 0===t)throw new Error('Attempting to parse an unsupported image function "'+A.name+'"');return t(e,A.values)}};function isSupportedImage(e){return!(20===e.type&&"none"===e.value||18===e.type&&!SUPPORTED_IMAGE_FUNCTIONS[e.name])}for(var SUPPORTED_IMAGE_FUNCTIONS={"linear-gradient":linearGradient,"-moz-linear-gradient":prefixLinearGradient,"-ms-linear-gradient":prefixLinearGradient,"-o-linear-gradient":prefixLinearGradient,"-webkit-linear-gradient":prefixLinearGradient,"radial-gradient":radialGradient,"-moz-radial-gradient":prefixRadialGradient,"-ms-radial-gradient":prefixRadialGradient,"-o-radial-gradient":prefixRadialGradient,"-webkit-radial-gradient":prefixRadialGradient,"-webkit-gradient":webkitGradient},backgroundImage={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,A){var t;return 0===A.length||20===(t=A[0]).type&&"none"===t.value?[]:A.filter((function(e){return nonFunctionArgSeparator(e)&&isSupportedImage(e)})).map((function(A){return image.parse(e,A)}))}},backgroundOrigin={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,A){return A.map((function(e){if(isIdentToken(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},backgroundPosition={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,A){return parseFunctionArgs(A).map((function(e){return e.filter(isLengthPercentage)})).map(parseLengthPercentageTuple)}},backgroundRepeat={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,A){return parseFunctionArgs(A).map((function(e){return e.filter(isIdentToken).map((function(e){return e.value})).join(" ")})).map(parseBackgroundRepeat)}},parseBackgroundRepeat=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}},BACKGROUND_SIZE,backgroundSize=(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"}(BACKGROUND_SIZE=BACKGROUND_SIZE||{}),{name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,A){return parseFunctionArgs(A).map((function(e){return e.filter(isBackgroundSizeInfoToken)}))}}),isBackgroundSizeInfoToken=function(e){return isIdentToken(e)||isLengthPercentage(e)},borderColorForSide=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},borderTopColor=borderColorForSide("top"),borderRightColor=borderColorForSide("right"),borderBottomColor=borderColorForSide("bottom"),borderLeftColor=borderColorForSide("left"),borderRadiusForSide=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(e,A){return parseLengthPercentageTuple(A.filter(isLengthPercentage))}}},borderTopLeftRadius=borderRadiusForSide("top-left"),borderTopRightRadius=borderRadiusForSide("top-right"),borderBottomRightRadius=borderRadiusForSide("bottom-right"),borderBottomLeftRadius=borderRadiusForSide("bottom-left"),borderStyleForSide=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,A){switch(A){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},borderTopStyle=borderStyleForSide("top"),borderRightStyle=borderStyleForSide("right"),borderBottomStyle=borderStyleForSide("bottom"),borderLeftStyle=borderStyleForSide("left"),borderWidthForSide=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,A){return isDimensionToken(A)?A.number:0}}},borderTopWidth=borderWidthForSide("top"),borderRightWidth=borderWidthForSide("right"),borderBottomWidth=borderWidthForSide("bottom"),borderLeftWidth=borderWidthForSide("left"),color={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},direction={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,A){return"rtl"!==A?0:1}},display={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,A){return A.filter(isIdentToken).reduce((function(e,A){return e|parseDisplayValue(A.value)}),0)}},parseDisplayValue=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},float={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,A){switch(A){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},letterSpacing={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,A){return 20===A.type&&"normal"===A.value||17!==A.type&&15!==A.type?0:A.number}},LINE_BREAK,lineBreak=(function(e){e.NORMAL="normal",e.STRICT="strict"}(LINE_BREAK=LINE_BREAK||{}),{name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,A){return"strict"!==A?LINE_BREAK.NORMAL:LINE_BREAK.STRICT}}),lineHeight={name:"line-height",initialValue:"normal",prefix:!1,type:4},computeLineHeight=function(e,A){return isIdentToken(e)&&"normal"===e.value?1.2*A:17===e.type?A*e.number:isLengthPercentage(e)?getAbsoluteValue(e,A):A},listStyleImage={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,A){return 20===A.type&&"none"===A.value?null:image.parse(e,A)}},listStylePosition={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,A){return"inside"!==A?1:0}},listStyleType={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,A){switch(A){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},marginForSide=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},marginTop=marginForSide("top"),marginRight=marginForSide("right"),marginBottom=marginForSide("bottom"),marginLeft=marginForSide("left"),overflow={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,A){return A.filter(isIdentToken).map((function(e){switch(e.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}}))}},overflowWrap={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,A){return"break-word"!==A?"normal":"break-word"}},paddingForSide=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},paddingTop=paddingForSide("top"),paddingRight=paddingForSide("right"),paddingBottom=paddingForSide("bottom"),paddingLeft=paddingForSide("left"),textAlign={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,A){switch(A){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},position={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,A){switch(A){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},textShadow={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,A){return 1===A.length&&isIdentWithValue(A[0],"none")?[]:parseFunctionArgs(A).map((function(A){for(var t={color:COLORS.TRANSPARENT,offsetX:ZERO_LENGTH,offsetY:ZERO_LENGTH,blur:ZERO_LENGTH},i=0,s=0;s<A.length;s++){var n=A[s];isLength(n)?(0===i?t.offsetX=n:1===i?t.offsetY=n:t.blur=n,i++):t.color=color$1.parse(e,n)}return t}))}},textTransform={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,A){switch(A){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},transform$1={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,A){if(20===A.type&&"none"===A.value)return null;if(18!==A.type)return null;var t=SUPPORTED_TRANSFORM_FUNCTIONS[A.name];if(void 0===t)throw new Error('Attempting to parse an unsupported transform function "'+A.name+'"');return t(A.values)}},matrix=function(e){return 6===(e=e.filter((function(e){return 17===e.type})).map((function(e){return e.number}))).length?e:null},matrix3d=function(e){var A=(e=e.filter((function(e){return 17===e.type})).map((function(e){return e.number})))[0],t=e[1],i=(e[2],e[3],e[4]),s=e[5],n=(e[6],e[7],e[8],e[9],e[10],e[11],e[12]),r=e[13];return e[14],e[15],16===e.length?[A,t,i,s,n,r]:null},SUPPORTED_TRANSFORM_FUNCTIONS={matrix:matrix,matrix3d:matrix3d},DEFAULT_VALUE={type:16,number:50,flags:FLAG_INTEGER},DEFAULT=[DEFAULT_VALUE,DEFAULT_VALUE],transformOrigin={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,A){return 2!==(A=A.filter(isLengthPercentage)).length?DEFAULT:[A[0],A[1]]}},visibility={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,A){switch(A){case"hidden":return 1;case"collapse":return 2;default:return 0}}},WORD_BREAK,wordBreak=(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"}(WORD_BREAK=WORD_BREAK||{}),{name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,A){switch(A){case"break-all":return WORD_BREAK.BREAK_ALL;case"keep-all":return WORD_BREAK.KEEP_ALL;default:return WORD_BREAK.NORMAL}}}),zIndex={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,A){if(20===A.type)return{auto:!0,order:0};if(isNumberToken(A))return{auto:!1,order:A.number};throw new Error("Invalid z-index number parsed")}},time={name:"time",parse:function(e,A){if(15===A.type)switch(A.unit.toLowerCase()){case"s":return 1e3*A.number;case"ms":return A.number}throw new Error("Unsupported time type")}},opacity={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,A){return isNumberToken(A)?A.number:1}},textDecorationColor={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},textDecorationLine={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,A){return A.filter(isIdentToken).map((function(e){switch(e.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0})).filter((function(e){return 0!==e}))}},fontFamily={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,A){var t=[],i=[];return A.forEach((function(e){switch(e.type){case 20:case 0:t.push(e.value);break;case 17:t.push(e.number.toString());break;case 4:i.push(t.join(" ")),t.length=0}})),t.length&&i.push(t.join(" ")),i.map((function(e){return-1===e.indexOf(" ")?e:"'"+e+"'"}))}},fontSize={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},fontWeight={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,A){return isNumberToken(A)?A.number:isIdentToken(A)&&"bold"===A.value?700:400}},fontVariant={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,A){return A.filter(isIdentToken).map((function(e){return e.value}))}},fontStyle={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,A){switch(A){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},contains=function(e,A){return 0!=(e&A)},content={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,A){var t;return 0===A.length||20===(t=A[0]).type&&"none"===t.value?[]:A}},counterIncrement={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,A){if(0===A.length)return null;var t=A[0];if(20===t.type&&"none"===t.value)return null;for(var i=[],s=A.filter(nonWhiteSpace),n=0;n<s.length;n++){var r=s[n],o=s[n+1];20===r.type&&(o=o&&isNumberToken(o)?o.number:1,i.push({counter:r.value,increment:o}))}return i}},counterReset={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,A){if(0===A.length)return[];for(var t=[],i=A.filter(nonWhiteSpace),s=0;s<i.length;s++){var n=i[s],r=i[s+1];isIdentToken(n)&&"none"!==n.value&&(r=r&&isNumberToken(r)?r.number:0,t.push({counter:n.value,reset:r}))}return t}},duration={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,A){return A.filter(isDimensionToken).map((function(A){return time.parse(e,A)}))}},quotes={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,A){if(0===A.length)return null;var t=A[0];if(20===t.type&&"none"===t.value)return null;var i=[],s=A.filter(isStringToken);if(s.length%2!=0)return null;for(var n=0;n<s.length;n+=2){var r=s[n].value,o=s[n+1].value;i.push({open:r,close:o})}return i}},getQuote=function(e,A,t){return e&&(A=e[Math.min(A,e.length-1)])?t?A.open:A.close:""},boxShadow={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,A){return 1===A.length&&isIdentWithValue(A[0],"none")?[]:parseFunctionArgs(A).map((function(A){for(var t={color:255,offsetX:ZERO_LENGTH,offsetY:ZERO_LENGTH,blur:ZERO_LENGTH,spread:ZERO_LENGTH,inset:!1},i=0,s=0;s<A.length;s++){var n=A[s];isIdentWithValue(n,"inset")?t.inset=!0:isLength(n)?(0===i?t.offsetX=n:1===i?t.offsetY=n:2===i?t.blur=n:t.spread=n,i++):t.color=color$1.parse(e,n)}return t}))}},paintOrder={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,A){var t=[];return A.filter(isIdentToken).forEach((function(e){switch(e.value){case"stroke":t.push(1);break;case"fill":t.push(0);break;case"markers":t.push(2)}})),[0,1,2].forEach((function(e){-1===t.indexOf(e)&&t.push(e)})),t}},webkitTextStrokeColor={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},webkitTextStrokeWidth={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,A){return isDimensionToken(A)?A.number:0}},CSSParsedDeclaration=function(){function e(e,A){this.animationDuration=parse(e,duration,A.animationDuration),this.backgroundClip=parse(e,backgroundClip,A.backgroundClip),this.backgroundColor=parse(e,backgroundColor,A.backgroundColor),this.backgroundImage=parse(e,backgroundImage,A.backgroundImage),this.backgroundOrigin=parse(e,backgroundOrigin,A.backgroundOrigin),this.backgroundPosition=parse(e,backgroundPosition,A.backgroundPosition),this.backgroundRepeat=parse(e,backgroundRepeat,A.backgroundRepeat),this.backgroundSize=parse(e,backgroundSize,A.backgroundSize),this.borderTopColor=parse(e,borderTopColor,A.borderTopColor),this.borderRightColor=parse(e,borderRightColor,A.borderRightColor),this.borderBottomColor=parse(e,borderBottomColor,A.borderBottomColor),this.borderLeftColor=parse(e,borderLeftColor,A.borderLeftColor),this.borderTopLeftRadius=parse(e,borderTopLeftRadius,A.borderTopLeftRadius),this.borderTopRightRadius=parse(e,borderTopRightRadius,A.borderTopRightRadius),this.borderBottomRightRadius=parse(e,borderBottomRightRadius,A.borderBottomRightRadius),this.borderBottomLeftRadius=parse(e,borderBottomLeftRadius,A.borderBottomLeftRadius),this.borderTopStyle=parse(e,borderTopStyle,A.borderTopStyle),this.borderRightStyle=parse(e,borderRightStyle,A.borderRightStyle),this.borderBottomStyle=parse(e,borderBottomStyle,A.borderBottomStyle),this.borderLeftStyle=parse(e,borderLeftStyle,A.borderLeftStyle),this.borderTopWidth=parse(e,borderTopWidth,A.borderTopWidth),this.borderRightWidth=parse(e,borderRightWidth,A.borderRightWidth),this.borderBottomWidth=parse(e,borderBottomWidth,A.borderBottomWidth),this.borderLeftWidth=parse(e,borderLeftWidth,A.borderLeftWidth),this.boxShadow=parse(e,boxShadow,A.boxShadow),this.color=parse(e,color,A.color),this.direction=parse(e,direction,A.direction),this.display=parse(e,display,A.display),this.float=parse(e,float,A.cssFloat),this.fontFamily=parse(e,fontFamily,A.fontFamily),this.fontSize=parse(e,fontSize,A.fontSize),this.fontStyle=parse(e,fontStyle,A.fontStyle),this.fontVariant=parse(e,fontVariant,A.fontVariant),this.fontWeight=parse(e,fontWeight,A.fontWeight),this.letterSpacing=parse(e,letterSpacing,A.letterSpacing),this.lineBreak=parse(e,lineBreak,A.lineBreak),this.lineHeight=parse(e,lineHeight,A.lineHeight),this.listStyleImage=parse(e,listStyleImage,A.listStyleImage),this.listStylePosition=parse(e,listStylePosition,A.listStylePosition),this.listStyleType=parse(e,listStyleType,A.listStyleType),this.marginTop=parse(e,marginTop,A.marginTop),this.marginRight=parse(e,marginRight,A.marginRight),this.marginBottom=parse(e,marginBottom,A.marginBottom),this.marginLeft=parse(e,marginLeft,A.marginLeft),this.opacity=parse(e,opacity,A.opacity);var t=parse(e,overflow,A.overflow);this.overflowX=t[0],this.overflowY=t[1<t.length?1:0],this.overflowWrap=parse(e,overflowWrap,A.overflowWrap),this.paddingTop=parse(e,paddingTop,A.paddingTop),this.paddingRight=parse(e,paddingRight,A.paddingRight),this.paddingBottom=parse(e,paddingBottom,A.paddingBottom),this.paddingLeft=parse(e,paddingLeft,A.paddingLeft),this.paintOrder=parse(e,paintOrder,A.paintOrder),this.position=parse(e,position,A.position),this.textAlign=parse(e,textAlign,A.textAlign),this.textDecorationColor=parse(e,textDecorationColor,null!=(t=A.textDecorationColor)?t:A.color),this.textDecorationLine=parse(e,textDecorationLine,null!=(t=A.textDecorationLine)?t:A.textDecoration),this.textShadow=parse(e,textShadow,A.textShadow),this.textTransform=parse(e,textTransform,A.textTransform),this.transform=parse(e,transform$1,A.transform),this.transformOrigin=parse(e,transformOrigin,A.transformOrigin),this.visibility=parse(e,visibility,A.visibility),this.webkitTextStrokeColor=parse(e,webkitTextStrokeColor,A.webkitTextStrokeColor),this.webkitTextStrokeWidth=parse(e,webkitTextStrokeWidth,A.webkitTextStrokeWidth),this.wordBreak=parse(e,wordBreak,A.wordBreak),this.zIndex=parse(e,zIndex,A.zIndex)}return e.prototype.isVisible=function(){return 0<this.display&&0<this.opacity&&0===this.visibility},e.prototype.isTransparent=function(){return isTransparent(this.backgroundColor)},e.prototype.isTransformed=function(){return null!==this.transform},e.prototype.isPositioned=function(){return 0!==this.position},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return 0!==this.float},e.prototype.isInlineLevel=function(){return contains(this.display,4)||contains(this.display,33554432)||contains(this.display,268435456)||contains(this.display,536870912)||contains(this.display,67108864)||contains(this.display,134217728)},e}(),CSSParsedPseudoDeclaration=function(e,A){this.content=parse(e,content,A.content),this.quotes=parse(e,quotes,A.quotes)},CSSParsedCounterDeclaration=function(e,A){this.counterIncrement=parse(e,counterIncrement,A.counterIncrement),this.counterReset=parse(e,counterReset,A.counterReset)},parse=function(e,A,t){var i=new Tokenizer,s=(t=null!=t?t.toString():A.initialValue,i.write(t),new Parser(i.read()));switch(A.type){case 2:var n=s.parseComponentValue();return A.parse(e,isIdentToken(n)?n.value:A.initialValue);case 0:return A.parse(e,s.parseComponentValue());case 1:return A.parse(e,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(A.format){case"angle":return angle.parse(e,s.parseComponentValue());case"color":return color$1.parse(e,s.parseComponentValue());case"image":return image.parse(e,s.parseComponentValue());case"length":var r=s.parseComponentValue();return isLength(r)?r:ZERO_LENGTH;case"length-percentage":return r=s.parseComponentValue(),isLengthPercentage(r)?r:ZERO_LENGTH;case"time":return time.parse(e,s.parseComponentValue())}}},elementDebuggerAttribute="data-html2canvas-debug",getElementDebugType=function(e){switch(e.getAttribute(elementDebuggerAttribute)){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},isDebugging=function(e,A){return 1===(e=getElementDebugType(e))||A===e},ElementContainer=function(e,A){this.context=e,this.textNodes=[],this.elements=[],this.flags=0,isDebugging(A,3),this.styles=new CSSParsedDeclaration(e,window.getComputedStyle(A,null)),isHTMLElementNode(A)&&(this.styles.animationDuration.some((function(e){return 0<e}))&&(A.style.animationDuration="0s"),null!==this.styles.transform)&&(A.style.transform="none"),this.bounds=parseBounds(this.context,A),isDebugging(A,4)&&(this.flags|=16)},base64="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",chars$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i$1=0;i$1<chars$1.length;i$1++)lookup$1[chars$1.charCodeAt(i$1)]=i$1;for(var decode=function(e){for(var A,t,i,s,n=.75*e.length,r=e.length,o=0,a=(n=("="===e[e.length-1]&&(n--,"="===e[e.length-2])&&n--,new("undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?ArrayBuffer:Array)(n)),Array.isArray(n)?n:new Uint8Array(n)),l=0;l<r;l+=4)A=lookup$1[e.charCodeAt(l)],t=lookup$1[e.charCodeAt(l+1)],i=lookup$1[e.charCodeAt(l+2)],s=lookup$1[e.charCodeAt(l+3)],a[o++]=A<<2|t>>4,a[o++]=(15&t)<<4|i>>2,a[o++]=(3&i)<<6|63&s;return n},polyUint16Array=function(e){for(var A=e.length,t=[],i=0;i<A;i+=2)t.push(e[i+1]<<8|e[i]);return t},polyUint32Array=function(e){for(var A=e.length,t=[],i=0;i<A;i+=4)t.push(e[i+3]<<24|e[i+2]<<16|e[i+1]<<8|e[i]);return t},UTRIE2_SHIFT_2=5,UTRIE2_SHIFT_1=11,UTRIE2_INDEX_SHIFT=2,UTRIE2_SHIFT_1_2=UTRIE2_SHIFT_1-UTRIE2_SHIFT_2,UTRIE2_LSCP_INDEX_2_OFFSET=65536>>UTRIE2_SHIFT_2,UTRIE2_DATA_BLOCK_LENGTH=1<<UTRIE2_SHIFT_2,UTRIE2_DATA_MASK=UTRIE2_DATA_BLOCK_LENGTH-1,UTRIE2_LSCP_INDEX_2_LENGTH=1024>>UTRIE2_SHIFT_2,UTRIE2_INDEX_2_BMP_LENGTH=UTRIE2_LSCP_INDEX_2_OFFSET+UTRIE2_LSCP_INDEX_2_LENGTH,UTRIE2_UTF8_2B_INDEX_2_OFFSET=UTRIE2_INDEX_2_BMP_LENGTH,UTRIE2_UTF8_2B_INDEX_2_LENGTH=32,UTRIE2_INDEX_1_OFFSET=UTRIE2_UTF8_2B_INDEX_2_OFFSET+UTRIE2_UTF8_2B_INDEX_2_LENGTH,UTRIE2_OMITTED_BMP_INDEX_1_LENGTH=65536>>UTRIE2_SHIFT_1,UTRIE2_INDEX_2_BLOCK_LENGTH=1<<UTRIE2_SHIFT_1_2,UTRIE2_INDEX_2_MASK=UTRIE2_INDEX_2_BLOCK_LENGTH-1,slice16=function(e,A,t){return e.slice?e.slice(A,t):new Uint16Array(Array.prototype.slice.call(e,A,t))},slice32=function(e,A,t){return e.slice?e.slice(A,t):new Uint32Array(Array.prototype.slice.call(e,A,t))},createTrieFromBase64=function(e,A){e=decode(e);var t=Array.isArray(e)?polyUint32Array(e):new Uint32Array(e),i=(e=Array.isArray(e)?polyUint16Array(e):new Uint16Array(e),slice16(e,12,t[4]/2));e=2===t[5]?slice16(e,(24+t[4])/2):slice32(t,Math.ceil((24+t[4])/4));return new Trie(t[0],t[1],t[2],t[3],i,e)},Trie=function(){function e(e,A,t,i,s,n){this.initialValue=e,this.errorValue=A,this.highStart=t,this.highValueIndex=i,this.index=s,this.data=n}return e.prototype.get=function(e){var A;if(0<=e){if(e<55296||56319<e&&e<=65535)return A=this.index[e>>UTRIE2_SHIFT_2],this.data[A=(A<<UTRIE2_INDEX_SHIFT)+(e&UTRIE2_DATA_MASK)];if(e<=65535)return A=this.index[UTRIE2_LSCP_INDEX_2_OFFSET+(e-55296>>UTRIE2_SHIFT_2)],this.data[A=(A<<UTRIE2_INDEX_SHIFT)+(e&UTRIE2_DATA_MASK)];if(e<this.highStart)return A=this.index[A=UTRIE2_INDEX_1_OFFSET-UTRIE2_OMITTED_BMP_INDEX_1_LENGTH+(e>>UTRIE2_SHIFT_1)],A=this.index[A+=e>>UTRIE2_SHIFT_2&UTRIE2_INDEX_2_MASK],this.data[A=(A<<UTRIE2_INDEX_SHIFT)+(e&UTRIE2_DATA_MASK)];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;var Prepend=1,CR=2,LF=3,Control=4,Extend=5,SpacingMark=7,L=8,V=9,T=10,LV=11,LVT=12,ZWJ=13,Extended_Pictographic=14,RI=15,toCodePoints=function(e){for(var A=[],t=0,i=e.length;t<i;){var s,n=e.charCodeAt(t++);55296<=n&&n<=56319&&t<i?56320==(64512&(s=e.charCodeAt(t++)))?A.push(((1023&n)<<10)+(1023&s)+65536):(A.push(n),t--):A.push(n)}return A},fromCodePoint=function(){for(var e=[],A=0;A<arguments.length;A++)e[A]=arguments[A];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var t=e.length;if(!t)return"";for(var i=[],s=-1,n="";++s<t;){var r=e[s];r<=65535?i.push(r):i.push(55296+((r-=65536)>>10),r%1024+56320),(s+1===t||16384<i.length)&&(n+=String.fromCharCode.apply(String,i),i.length=0)}return n},UnicodeTrie=createTrieFromBase64(base64),BREAK_NOT_ALLOWED="×",BREAK_ALLOWED="÷",codePointToClass=function(e){return UnicodeTrie.get(e)},_graphemeBreakAtIndex=function(e,A,t){var i=t-2,s=A[i],n=A[t-1];t=A[t];if(n===CR&&t===LF)return BREAK_NOT_ALLOWED;if(n!==CR&&n!==LF&&n!==Control&&t!==CR&&t!==LF&&t!==Control){if(n===L&&-1!==[L,V,LV,LVT].indexOf(t))return BREAK_NOT_ALLOWED;if(!(n!==LV&&n!==V||t!==V&&t!==T))return BREAK_NOT_ALLOWED;if((n===LVT||n===T)&&t===T)return BREAK_NOT_ALLOWED;if(t===ZWJ||t===Extend)return BREAK_NOT_ALLOWED;if(t===SpacingMark)return BREAK_NOT_ALLOWED;if(n===Prepend)return BREAK_NOT_ALLOWED;if(n===ZWJ&&t===Extended_Pictographic){for(;s===Extend;)s=A[--i];if(s===Extended_Pictographic)return BREAK_NOT_ALLOWED}if(n===RI&&t===RI){for(var r=0;s===RI;)r++,s=A[--i];if(r%2==0)return BREAK_NOT_ALLOWED}}return BREAK_ALLOWED},GraphemeBreaker=function(e){var A=toCodePoints(e),t=A.length,i=0,s=0,n=A.map(codePointToClass);return{next:function(){if(t<=i)return{done:!0,value:null};for(var e,r=BREAK_NOT_ALLOWED;i<t&&(r=_graphemeBreakAtIndex(A,n,++i))===BREAK_NOT_ALLOWED;);return r!==BREAK_NOT_ALLOWED||i===t?(e=fromCodePoint.apply(null,A.slice(s,i)),s=i,{value:e,done:!1}):{done:!0,value:null}}}},splitGraphemes=function(e){for(var A,t=GraphemeBreaker(e),i=[];!(A=t.next()).done;)A.value&&i.push(A.value.slice());return i},testRangeBounds=function(e){if(e.createRange&&(t=e.createRange()).getBoundingClientRect){var A=e.createElement("boundtest"),t=(A.style.height="123px",A.style.display="block",e.body.appendChild(A),t.selectNode(A),t.getBoundingClientRect());t=Math.round(t.height);if(e.body.removeChild(A),123===t)return!0}return!1},testIOSLineBreak=function(e){var A=e.createElement("boundtest"),t=(A.style.width="50px",A.style.display="block",A.style.fontSize="12px",A.style.letterSpacing="0px",A.style.wordSpacing="0px",e.body.appendChild(A),e.createRange()),i=(A.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"",A.firstChild),s=toCodePoints$1(i.data).map((function(e){return fromCodePoint$1(e)})),n=0,r={};s=s.every((function(e,A){t.setStart(i,n),t.setEnd(i,n+e.length);var s=t.getBoundingClientRect();n+=e.length,e=s.x>r.x||s.y>r.y;return r=s,0===A||e}));return e.body.removeChild(A),s},testCORS=function(){return void 0!==(new Image).crossOrigin},testResponseType=function(){return"string"==typeof(new XMLHttpRequest).responseType},testSVG=function(e){var A=new Image,t=(e=e.createElement("canvas")).getContext("2d");if(!t)return!1;A.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{t.drawImage(A,0,0),e.toDataURL()}catch(e){return!1}return!0},isGreenPixel=function(e){return 0===e[0]&&255===e[1]&&0===e[2]&&255===e[3]},testForeignObject=function(e){var A=e.createElement("canvas"),t=100,i=(A.width=t,A.height=t,A.getContext("2d"));if(!i)return Promise.reject(!1);i.fillStyle="rgb(0, 255, 0)",i.fillRect(0,0,t,t);var s=new Image,n=A.toDataURL();s.src=n,A=createForeignObjectSVG(t,t,0,0,s);return i.fillStyle="red",i.fillRect(0,0,t,t),loadSerializedSVG$1(A).then((function(A){i.drawImage(A,0,0);A=i.getImageData(0,0,t,t).data;var s=(i.fillStyle="red",i.fillRect(0,0,t,t),e.createElement("div"));return s.style.backgroundImage="url("+n+")",s.style.height="100px",isGreenPixel(A)?loadSerializedSVG$1(createForeignObjectSVG(t,t,0,0,s)):Promise.reject(!1)})).then((function(e){return i.drawImage(e,0,0),isGreenPixel(i.getImageData(0,0,t,t).data)})).catch((function(){return!1}))},createForeignObjectSVG=function(e,A,t,i,s){var n="http://www.w3.org/2000/svg",r=document.createElementNS(n,"svg");n=document.createElementNS(n,"foreignObject");return r.setAttributeNS(null,"width",e.toString()),r.setAttributeNS(null,"height",A.toString()),n.setAttributeNS(null,"width","100%"),n.setAttributeNS(null,"height","100%"),n.setAttributeNS(null,"x",t.toString()),n.setAttributeNS(null,"y",i.toString()),n.setAttributeNS(null,"externalResourcesRequired","true"),r.appendChild(n),n.appendChild(s),r},loadSerializedSVG$1=function(e){return new Promise((function(A,t){var i=new Image;i.onload=function(){return A(i)},i.onerror=t,i.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},FEATURES={get SUPPORT_RANGE_BOUNDS(){var e=testRangeBounds(document);return Object.defineProperty(FEATURES,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=FEATURES.SUPPORT_RANGE_BOUNDS&&testIOSLineBreak(document);return Object.defineProperty(FEATURES,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=testSVG(document);return Object.defineProperty(FEATURES,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e="function"==typeof Array.from&&"function"==typeof window.fetch?testForeignObject(document):Promise.resolve(!1);return Object.defineProperty(FEATURES,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=testCORS();return Object.defineProperty(FEATURES,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=testResponseType();return Object.defineProperty(FEATURES,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(FEATURES,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!("undefined"==typeof Intl||!Intl.Segmenter);return Object.defineProperty(FEATURES,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},TextBounds=function(e,A){this.text=e,this.bounds=A},parseTextBounds=function(e,A,t,i){A=breakText(A,t);var s=[],n=0;return A.forEach((function(A){var r,o,a;t.textDecorationLine.length||0<A.trim().length?FEATURES.SUPPORT_RANGE_BOUNDS?1<(r=createRange(i,n,A.length).getClientRects()).length?(a=segmentGraphemes(A),o=0,a.forEach((function(A){s.push(new TextBounds(A,Bounds.fromDOMRectList(e,createRange(i,o+n,A.length).getClientRects()))),o+=A.length}))):s.push(new TextBounds(A,Bounds.fromDOMRectList(e,r))):(a=i.splitText(A.length),s.push(new TextBounds(A,getWrapperBounds(e,i))),i=a):FEATURES.SUPPORT_RANGE_BOUNDS||(i=i.splitText(A.length)),n+=A.length})),s},getWrapperBounds=function(e,A){if(t=A.ownerDocument){var t,i=((t=t.createElement("html2canvaswrapper")).appendChild(A.cloneNode(!0)),A.parentNode);if(i)return i.replaceChild(t,A),A=parseBounds(e,t),t.firstChild&&i.replaceChild(t.firstChild,t),A}return Bounds.EMPTY},createRange=function(e,A,t){var i=e.ownerDocument;if(i)return(i=i.createRange()).setStart(e,A),i.setEnd(e,A+t),i;throw new Error("Node has no owner document")},segmentGraphemes=function(e){var A;return FEATURES.SUPPORT_NATIVE_TEXT_SEGMENTATION?(A=new Intl.Segmenter(void 0,{granularity:"grapheme"}),Array.from(A.segment(e)).map((function(e){return e.segment}))):splitGraphemes(e)},segmentWords=function(e,A){var t;return FEATURES.SUPPORT_NATIVE_TEXT_SEGMENTATION?(t=new Intl.Segmenter(void 0,{granularity:"word"}),Array.from(t.segment(e)).map((function(e){return e.segment}))):breakWords(e,A)},breakText=function(e,A){return 0!==A.letterSpacing?segmentGraphemes(e):segmentWords(e,A)},wordSeparators=[32,160,4961,65792,65793,4153,4241],breakWords=function(e,A){for(var t,i=LineBreaker(e,{lineBreak:A.lineBreak,wordBreak:"break-word"===A.overflowWrap?"break-word":A.wordBreak}),s=[];!(t=i.next()).done;)!function(){var e,A;t.value&&(e=t.value.slice(),e=toCodePoints$1(e),A="",e.forEach((function(e){-1===wordSeparators.indexOf(e)?A+=fromCodePoint$1(e):(A.length&&s.push(A),s.push(fromCodePoint$1(e)),A="")})),A.length)&&s.push(A)}();return s},TextContainer=function(e,A,t){this.text=transform(A.data,t.textTransform),this.textBounds=parseTextBounds(e,this.text,t,A)},transform=function(e,A){switch(A){case 1:return e.toLowerCase();case 3:return e.replace(CAPITALIZE,capitalize);case 2:return e.toUpperCase();default:return e}},CAPITALIZE=/(^|\s|:|-|\(|\))([a-z])/g,capitalize=function(e,A,t){return 0<e.length?A+t.toUpperCase():e},ImageElementContainer=function(e){function A(A,t){return(A=e.call(this,A,t)||this).src=t.currentSrc||t.src,A.intrinsicWidth=t.naturalWidth,A.intrinsicHeight=t.naturalHeight,A.context.cache.addImage(A.src),A}return __extends(A,e),A}(ElementContainer),CanvasElementContainer=function(e){function A(A,t){return(A=e.call(this,A,t)||this).canvas=t,A.intrinsicWidth=t.width,A.intrinsicHeight=t.height,A}return __extends(A,e),A}(ElementContainer),SVGElementContainer=function(e){function A(A,t){var i=e.call(this,A,t)||this,s=new XMLSerializer;A=parseBounds(A,t);return t.setAttribute("width",A.width+"px"),t.setAttribute("height",A.height+"px"),i.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(t)),i.intrinsicWidth=t.width.baseVal.value,i.intrinsicHeight=t.height.baseVal.value,i.context.cache.addImage(i.svg),i}return __extends(A,e),A}(ElementContainer),LIElementContainer=function(e){function A(A,t){return(A=e.call(this,A,t)||this).value=t.value,A}return __extends(A,e),A}(ElementContainer),OLElementContainer=function(e){function A(A,t){return(A=e.call(this,A,t)||this).start=t.start,A.reversed="boolean"==typeof t.reversed&&!0===t.reversed,A}return __extends(A,e),A}(ElementContainer),CHECKBOX_BORDER_RADIUS=[{type:15,flags:0,unit:"px",number:3}],RADIO_BORDER_RADIUS=[{type:16,flags:0,number:50}],reformatInputBounds=function(e){return e.width>e.height?new Bounds(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new Bounds(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},getInputValue=function(e){var A=e.type===PASSWORD?new Array(e.value.length+1).join("•"):e.value;return 0===A.length?e.placeholder||"":A},CHECKBOX="checkbox",RADIO="radio",PASSWORD="password",INPUT_COLOR=707406591,InputElementContainer=function(e){function A(A,t){var i=e.call(this,A,t)||this;switch(i.type=t.type.toLowerCase(),i.checked=t.checked,i.value=getInputValue(t),i.type!==CHECKBOX&&i.type!==RADIO||(i.styles.backgroundColor=3739148031,i.styles.borderTopColor=i.styles.borderRightColor=i.styles.borderBottomColor=i.styles.borderLeftColor=2779096575,i.styles.borderTopWidth=i.styles.borderRightWidth=i.styles.borderBottomWidth=i.styles.borderLeftWidth=1,i.styles.borderTopStyle=i.styles.borderRightStyle=i.styles.borderBottomStyle=i.styles.borderLeftStyle=1,i.styles.backgroundClip=[0],i.styles.backgroundOrigin=[0],i.bounds=reformatInputBounds(i.bounds)),i.type){case CHECKBOX:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=CHECKBOX_BORDER_RADIUS;break;case RADIO:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=RADIO_BORDER_RADIUS}return i}return __extends(A,e),A}(ElementContainer),SelectElementContainer=function(e){function A(A,t){return A=e.call(this,A,t)||this,t=t.options[t.selectedIndex||0],A.value=t&&t.text||"",A}return __extends(A,e),A}(ElementContainer),TextareaElementContainer=function(e){function A(A,t){return(A=e.call(this,A,t)||this).value=t.value,A}return __extends(A,e),A}(ElementContainer),IFrameElementContainer=function(e){function A(A,t){var i,s,n=e.call(this,A,t)||this;n.src=t.src,n.width=parseInt(t.width,10)||0,n.height=parseInt(t.height,10)||0,n.backgroundColor=n.styles.backgroundColor;try{t.contentWindow&&t.contentWindow.document&&t.contentWindow.document.documentElement&&(n.tree=parseTree(A,t.contentWindow.document.documentElement),i=t.contentWindow.document.documentElement?parseColor(A,getComputedStyle(t.contentWindow.document.documentElement).backgroundColor):COLORS.TRANSPARENT,s=t.contentWindow.document.body?parseColor(A,getComputedStyle(t.contentWindow.document.body).backgroundColor):COLORS.TRANSPARENT,n.backgroundColor=isTransparent(i)?isTransparent(s)?n.styles.backgroundColor:s:i)}catch(A){}return n}return __extends(A,e),A}(ElementContainer),LIST_OWNERS=["OL","UL","MENU"],parseNodeTree=function(e,A,t,i){for(var s=A.firstChild;s;s=r){var n,r=s.nextSibling;isTextNode(s)&&0<s.data.trim().length?t.textNodes.push(new TextContainer(e,s,t.styles)):isElementNode(s)&&(isSlotElement(s)&&s.assignedNodes?s.assignedNodes().forEach((function(A){return parseNodeTree(e,A,t,i)})):(n=createContainer$1(e,s)).styles.isVisible()&&(createsRealStackingContext(s,n,i)?n.flags|=4:createsStackingContext(n.styles)&&(n.flags|=2),-1!==LIST_OWNERS.indexOf(s.tagName)&&(n.flags|=8),t.elements.push(n),s.slot,s.shadowRoot?parseNodeTree(e,s.shadowRoot,n,i):isTextareaElement(s)||isSVGElement(s)||isSelectElement(s)||parseNodeTree(e,s,n,i)))}},createContainer$1=function(e,A){return new(isImageElement(A)?ImageElementContainer:isCanvasElement(A)?CanvasElementContainer:isSVGElement(A)?SVGElementContainer:isLIElement(A)?LIElementContainer:isOLElement(A)?OLElementContainer:isInputElement(A)?InputElementContainer:isSelectElement(A)?SelectElementContainer:isTextareaElement(A)?TextareaElementContainer:isIFrameElement(A)?IFrameElementContainer:ElementContainer)(e,A)},parseTree=function(e,A){var t=createContainer$1(e,A);return t.flags|=4,parseNodeTree(e,A,t,t),t},createsRealStackingContext=function(e,A,t){return A.styles.isPositionedWithZIndex()||A.styles.opacity<1||A.styles.isTransformed()||isBodyElement(e)&&t.styles.isTransparent()},createsStackingContext=function(e){return e.isPositioned()||e.isFloating()},isTextNode=function(e){return e.nodeType===Node.TEXT_NODE},isElementNode=function(e){return e.nodeType===Node.ELEMENT_NODE},isHTMLElementNode=function(e){return isElementNode(e)&&void 0!==e.style&&!isSVGElementNode(e)},isSVGElementNode=function(e){return"object"==typeof e.className},isLIElement=function(e){return"LI"===e.tagName},isOLElement=function(e){return"OL"===e.tagName},isInputElement=function(e){return"INPUT"===e.tagName},isHTMLElement=function(e){return"HTML"===e.tagName},isSVGElement=function(e){return"svg"===e.tagName},isBodyElement=function(e){return"BODY"===e.tagName},isCanvasElement=function(e){return"CANVAS"===e.tagName},isVideoElement=function(e){return"VIDEO"===e.tagName},isImageElement=function(e){return"IMG"===e.tagName},isIFrameElement=function(e){return"IFRAME"===e.tagName},isStyleElement=function(e){return"STYLE"===e.tagName},isScriptElement=function(e){return"SCRIPT"===e.tagName},isTextareaElement=function(e){return"TEXTAREA"===e.tagName},isSelectElement=function(e){return"SELECT"===e.tagName},isSlotElement=function(e){return"SLOT"===e.tagName},isCustomElement=function(e){return 0<e.tagName.indexOf("-")},CounterState=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(e){return(e=this.counters[e])&&e.length?e[e.length-1]:1},e.prototype.getCounterValues=function(e){return(e=this.counters[e])||[]},e.prototype.pop=function(e){var A=this;e.forEach((function(e){return A.counters[e].pop()}))},e.prototype.parse=function(e){var A=this,t=e.counterIncrement,i=(e=e.counterReset,!0),s=(null!==t&&t.forEach((function(e){var t=A.counters[e.counter];t&&0!==e.increment&&(i=!1,t.length||t.push(1),t[Math.max(0,t.length-1)]+=e.increment)})),[]);return i&&e.forEach((function(e){var t=A.counters[e.counter];s.push(e.counter),(t=t||(A.counters[e.counter]=[])).push(e.reset)})),s},e}(),ROMAN_UPPER={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},ARMENIAN={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},HEBREW={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},GEORGIAN={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},createAdditiveCounter=function(e,A,t,i,s,n){return e<A||t<e?createCounterText(e,s,0<n.length):i.integers.reduce((function(A,t,s){for(;t<=e;)e-=t,A+=i.values[s];return A}),"")+n},createCounterStyleWithSymbolResolver=function(e,A,t,i){for(var s="";t||e--,s=i(e)+s,A<=(e/=A)*A;);return s},createCounterStyleFromRange=function(e,A,t,i,s){var n=t-A+1;return(e<0?"-":"")+(createCounterStyleWithSymbolResolver(Math.abs(e),n,i,(function(e){return fromCodePoint$1(Math.floor(e%n)+A)}))+s)},createCounterStyleFromSymbols=function(e,A,t){void 0===t&&(t=". ");var i=A.length;return createCounterStyleWithSymbolResolver(Math.abs(e),i,!1,(function(e){return A[Math.floor(e%i)]}))+t},CJK_ZEROS=1,CJK_TEN_COEFFICIENTS=2,CJK_TEN_HIGH_COEFFICIENTS=4,CJK_HUNDRED_COEFFICIENTS=8,createCJKCounter=function(e,A,t,i,s,n){if(e<-9999||9999<e)return createCounterText(e,4,0<s.length);var r=Math.abs(e),o=s;if(0===r)return A[0]+o;for(var a=0;0<r&&a<=4;a++){var l=r%10;0==l&&contains(n,CJK_ZEROS)&&""!==o?o=A[l]+o:1<l||1==l&&0===a||1==l&&1===a&&contains(n,CJK_TEN_COEFFICIENTS)||1==l&&1===a&&contains(n,CJK_TEN_HIGH_COEFFICIENTS)&&100<e||1==l&&1<a&&contains(n,CJK_HUNDRED_COEFFICIENTS)?o=A[l]+(0<a?t[a-1]:"")+o:1==l&&0<a&&(o=t[a-1]+o),r=Math.floor(r/10)}return(e<0?i:"")+o},CHINESE_INFORMAL_MULTIPLIERS="十百千萬",CHINESE_FORMAL_MULTIPLIERS="拾佰仟萬",JAPANESE_NEGATIVE="マイナス",KOREAN_NEGATIVE="마이너스",createCounterText=function(e,A,t){var i=t?". ":"",s=t?"、":"",n=t?", ":"",r=t?" ":"";switch(A){case 0:return"•"+r;case 1:return"◦"+r;case 2:return"◾"+r;case 5:var o=createCounterStyleFromRange(e,48,57,!0,i);return o.length<4?"0"+o:o;case 4:return createCounterStyleFromSymbols(e,"〇一二三四五六七八九",s);case 6:return createAdditiveCounter(e,1,3999,ROMAN_UPPER,3,i).toLowerCase();case 7:return createAdditiveCounter(e,1,3999,ROMAN_UPPER,3,i);case 8:return createCounterStyleFromRange(e,945,969,!1,i);case 9:return createCounterStyleFromRange(e,97,122,!1,i);case 10:return createCounterStyleFromRange(e,65,90,!1,i);case 11:return createCounterStyleFromRange(e,1632,1641,!0,i);case 12:case 49:return createAdditiveCounter(e,1,9999,ARMENIAN,3,i);case 35:return createAdditiveCounter(e,1,9999,ARMENIAN,3,i).toLowerCase();case 13:return createCounterStyleFromRange(e,2534,2543,!0,i);case 14:case 30:return createCounterStyleFromRange(e,6112,6121,!0,i);case 15:return createCounterStyleFromSymbols(e,"子丑寅卯辰巳午未申酉戌亥",s);case 16:return createCounterStyleFromSymbols(e,"甲乙丙丁戊己庚辛壬癸",s);case 17:case 48:return createCJKCounter(e,"零一二三四五六七八九",CHINESE_INFORMAL_MULTIPLIERS,"負",s,CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 47:return createCJKCounter(e,"零壹貳參肆伍陸柒捌玖",CHINESE_FORMAL_MULTIPLIERS,"負",s,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 42:return createCJKCounter(e,"零一二三四五六七八九",CHINESE_INFORMAL_MULTIPLIERS,"负",s,CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 41:return createCJKCounter(e,"零壹贰叁肆伍陆柒捌玖",CHINESE_FORMAL_MULTIPLIERS,"负",s,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 26:return createCJKCounter(e,"〇一二三四五六七八九","十百千万",JAPANESE_NEGATIVE,s,0);case 25:return createCJKCounter(e,"零壱弐参四伍六七八九","拾百千万",JAPANESE_NEGATIVE,s,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 31:return createCJKCounter(e,"영일이삼사오육칠팔구","십백천만",KOREAN_NEGATIVE,n,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 33:return createCJKCounter(e,"零一二三四五六七八九","十百千萬",KOREAN_NEGATIVE,n,0);case 32:return createCJKCounter(e,"零壹貳參四五六七八九","拾百千",KOREAN_NEGATIVE,n,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 18:return createCounterStyleFromRange(e,2406,2415,!0,i);case 20:return createAdditiveCounter(e,1,19999,GEORGIAN,3,i);case 21:return createCounterStyleFromRange(e,2790,2799,!0,i);case 22:return createCounterStyleFromRange(e,2662,2671,!0,i);case 22:return createAdditiveCounter(e,1,10999,HEBREW,3,i);case 23:return createCounterStyleFromSymbols(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return createCounterStyleFromSymbols(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return createCounterStyleFromRange(e,3302,3311,!0,i);case 28:return createCounterStyleFromSymbols(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",s);case 29:return createCounterStyleFromSymbols(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",s);case 34:return createCounterStyleFromRange(e,3792,3801,!0,i);case 37:return createCounterStyleFromRange(e,6160,6169,!0,i);case 38:return createCounterStyleFromRange(e,4160,4169,!0,i);case 39:return createCounterStyleFromRange(e,2918,2927,!0,i);case 40:return createCounterStyleFromRange(e,1776,1785,!0,i);case 43:return createCounterStyleFromRange(e,3046,3055,!0,i);case 44:return createCounterStyleFromRange(e,3174,3183,!0,i);case 45:return createCounterStyleFromRange(e,3664,3673,!0,i);case 46:return createCounterStyleFromRange(e,3872,3881,!0,i);default:return createCounterStyleFromRange(e,48,57,!0,i)}},IGNORE_ATTRIBUTE="data-html2canvas-ignore",DocumentCloner=function(){function e(e,A,t){if(this.context=e,this.options=t,this.scrolledElements=[],this.referenceElement=A,this.counters=new CounterState,this.quoteDepth=0,!A.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(A.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(e,A){var t,i,s,n,r=this,o=createIFrameContainer(e,A);return o.contentWindow?(t=e.defaultView.pageXOffset,e=e.defaultView.pageYOffset,i=o.contentWindow,s=i.document,n=iframeLoader(o).then((function(){return __awaiter(r,void 0,void 0,(function(){var e,t;return __generator(this,(function(n){switch(n.label){case 0:return this.scrolledElements.forEach(restoreNodeScroll),i&&(i.scrollTo(A.left,A.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||i.scrollY===A.top&&i.scrollX===A.left||(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(i.scrollX-A.left,i.scrollY-A.top,0,0))),e=this.options.onclone,void 0===(t=this.clonedReferenceElement)?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:s.fonts&&s.fonts.ready?[4,s.fonts.ready]:[3,2];case 1:n.sent(),n.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,imagesReady(s)]:[3,4];case 3:n.sent(),n.label=4;case 4:return"function"==typeof e?[2,Promise.resolve().then((function(){return e(s,t)})).then((function(){return o}))]:[2,o]}}))}))})),s.open(),s.write(serializeDoctype(document.doctype)+"<html></html>"),restoreOwnerScroll(this.referenceElement.ownerDocument,t,e),s.replaceChild(s.adoptNode(this.documentElement),s.documentElement),s.close(),n):Promise.reject("Unable to find iframe window")},e.prototype.createElementClone=function(e){var A;return isDebugging(e,2),isCanvasElement(e)?this.createCanvasClone(e):isVideoElement(e)?this.createVideoClone(e):isStyleElement(e)?this.createStyleClone(e):(A=e.cloneNode(!1),isImageElement(A)&&(isImageElement(e)&&e.currentSrc&&e.currentSrc!==e.src&&(A.src=e.currentSrc,A.srcset=""),"lazy"===A.loading)&&(A.loading="eager"),isCustomElement(A)?this.createCustomElementClone(A):A)},e.prototype.createCustomElementClone=function(e){var A=document.createElement("html2canvascustomelement");return copyCSSStyles(e.style,A),A},e.prototype.createStyleClone=function(e){try{var A,t,i=e.sheet;if(i&&i.cssRules)return A=[].slice.call(i.cssRules,0).reduce((function(e,A){return A&&"string"==typeof A.cssText?e+A.cssText:e}),""),(t=e.cloneNode(!1)).textContent=A,t}catch(e){if(this.context.logger.error("Unable to access cssRules property",e),"SecurityError"!==e.name)throw e}return e.cloneNode(!1)},e.prototype.createCanvasClone=function(e){var A;if(this.options.inlineImages&&e.ownerDocument){var t=e.ownerDocument.createElement("img");try{return t.src=e.toDataURL(),t}catch(A){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}t=e.cloneNode(!1);try{t.width=e.width,t.height=e.height;var i,s,n=e.getContext("2d"),r=t.getContext("2d");r&&(!this.options.allowTaint&&n?r.putImageData(n.getImageData(0,0,e.width,e.height),0,0):((i=null!=(A=e.getContext("webgl2"))?A:e.getContext("webgl"))&&!1===(null==(s=i.getContextAttributes())?void 0:s.preserveDrawingBuffer)&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e),r.drawImage(e,0,0)))}catch(A){this.context.logger.info("Unable to clone canvas as it is tainted",e)}return t},e.prototype.createVideoClone=function(e){var A=e.ownerDocument.createElement("canvas"),t=(A.width=e.offsetWidth,A.height=e.offsetHeight,A.getContext("2d"));try{return t&&(t.drawImage(e,0,0,A.width,A.height),this.options.allowTaint||t.getImageData(0,0,A.width,A.height)),A}catch(A){this.context.logger.info("Unable to clone video as it is tainted",e)}return(t=e.ownerDocument.createElement("canvas")).width=e.offsetWidth,t.height=e.offsetHeight,t},e.prototype.appendChildNode=function(e,A,t){isElementNode(A)&&(isScriptElement(A)||A.hasAttribute(IGNORE_ATTRIBUTE)||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(A))||this.options.copyStyles&&isElementNode(A)&&isStyleElement(A)||e.appendChild(this.cloneNode(A,t))},e.prototype.cloneChildNodes=function(e,A,t){for(var i,s=this,n=(e.shadowRoot||e).firstChild;n;n=n.nextSibling)isElementNode(n)&&isSlotElement(n)&&"function"==typeof n.assignedNodes?(i=n.assignedNodes()).length&&i.forEach((function(e){return s.appendChildNode(A,e,t)})):this.appendChildNode(A,n,t)},e.prototype.cloneNode=function(e,A){var t,i,s,n,r;return isTextNode(e)?document.createTextNode(e.data):e.ownerDocument&&(s=e.ownerDocument.defaultView)&&isElementNode(e)&&(isHTMLElementNode(e)||isSVGElementNode(e))?((t=this.createElementClone(e)).style.transitionProperty="none",i=s.getComputedStyle(e),r=s.getComputedStyle(e,":before"),s=s.getComputedStyle(e,":after"),this.referenceElement===e&&isHTMLElementNode(t)&&(this.clonedReferenceElement=t),isBodyElement(t)&&createPseudoHideStyles(t),n=this.counters.parse(new CSSParsedCounterDeclaration(this.context,i)),r=this.resolvePseudoContent(e,t,r,PseudoElementType.BEFORE),isCustomElement(e)&&(A=!0),isVideoElement(e)||this.cloneChildNodes(e,t,A),r&&t.insertBefore(r,t.firstChild),(r=this.resolvePseudoContent(e,t,s,PseudoElementType.AFTER))&&t.appendChild(r),this.counters.pop(n),(i&&(this.options.copyStyles||isSVGElementNode(e))&&!isIFrameElement(e)||A)&&copyCSSStyles(i,t),0===e.scrollTop&&0===e.scrollLeft||this.scrolledElements.push([t,e.scrollLeft,e.scrollTop]),(isTextareaElement(e)||isSelectElement(e))&&(isTextareaElement(t)||isSelectElement(t))&&(t.value=e.value),t):e.cloneNode(!1)},e.prototype.resolvePseudoContent=function(e,A,t,i){var s=this;if(t){var n,r,o=t.content,a=A.ownerDocument;if(a&&o&&"none"!==o&&"-moz-alt-content"!==o&&"none"!==t.display)return this.counters.parse(new CSSParsedCounterDeclaration(this.context,t)),n=new CSSParsedPseudoDeclaration(this.context,t),r=a.createElement("html2canvaspseudoelement"),copyCSSStyles(t,r),n.content.forEach((function(A){if(0===A.type)r.appendChild(a.createTextNode(A.value));else if(22===A.type){var t=a.createElement("img");t.src=A.value,t.style.opacity="1",r.appendChild(t)}else if(18===A.type){var i,o,l,c;"attr"===A.name?(t=A.values.filter(isIdentToken)).length&&r.appendChild(a.createTextNode(e.getAttribute(t[0].value)||"")):"counter"===A.name?(l=(t=A.values.filter(nonFunctionArgSeparator))[0],c=t[1],l&&isIdentToken(l)&&(t=s.counters.getCounterValue(l.value),i=c&&isIdentToken(c)?listStyleType.parse(s.context,c.value):3,r.appendChild(a.createTextNode(createCounterText(t,i,!1))))):"counters"===A.name&&(l=(t=A.values.filter(nonFunctionArgSeparator))[0],i=t[1],c=t[2],l)&&isIdentToken(l)&&(t=s.counters.getCounterValues(l.value),o=c&&isIdentToken(c)?listStyleType.parse(s.context,c.value):3,l=i&&0===i.type?i.value:"",c=t.map((function(e){return createCounterText(e,o,!1)})).join(l),r.appendChild(a.createTextNode(c)))}else if(20===A.type)switch(A.value){case"open-quote":r.appendChild(a.createTextNode(getQuote(n.quotes,s.quoteDepth++,!0)));break;case"close-quote":r.appendChild(a.createTextNode(getQuote(n.quotes,--s.quoteDepth,!1)));break;default:r.appendChild(a.createTextNode(A.value))}})),r.className=PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+PSEUDO_HIDE_ELEMENT_CLASS_AFTER,o=i===PseudoElementType.BEFORE?" "+PSEUDO_HIDE_ELEMENT_CLASS_BEFORE:" "+PSEUDO_HIDE_ELEMENT_CLASS_AFTER,isSVGElementNode(A)?A.className.baseValue+=o:A.className+=o,r}},e.destroy=function(e){return!!e.parentNode&&(e.parentNode.removeChild(e),!0)},e}(),PseudoElementType,createIFrameContainer=(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"}(PseudoElementType=PseudoElementType||{}),function(e,A){var t=e.createElement("iframe");return t.className="html2canvas-container",t.style.visibility="hidden",t.style.position="fixed",t.style.left="-10000px",t.style.top="0px",t.style.border="0",t.width=A.width.toString(),t.height=A.height.toString(),t.scrolling="no",t.setAttribute(IGNORE_ATTRIBUTE,"true"),e.body.appendChild(t),t}),imageReady=function(e){return new Promise((function(A){!e.complete&&e.src?(e.onload=A,e.onerror=A):A()}))},imagesReady=function(e){return Promise.all([].slice.call(e.images,0).map(imageReady))},iframeLoader=function(e){return new Promise((function(A,t){var i=e.contentWindow;if(!i)return t("No window assigned for iframe");var s=i.document;i.onload=e.onload=function(){i.onload=e.onload=null;var t=setInterval((function(){0<s.body.childNodes.length&&"complete"===s.readyState&&(clearInterval(t),A(e))}),50)}}))},ignoredStyleProperties=["all","d","content"],copyCSSStyles=function(e,A){for(var t=e.length-1;0<=t;t--){var i=e.item(t);-1===ignoredStyleProperties.indexOf(i)&&A.style.setProperty(i,e.getPropertyValue(i))}return A},serializeDoctype=function(e){var A="";return e&&(A+="<!DOCTYPE ",e.name&&(A+=e.name),e.internalSubset&&(A+=e.internalSubset),e.publicId&&(A+='"'+e.publicId+'"'),e.systemId&&(A+='"'+e.systemId+'"'),A+=">"),A},restoreOwnerScroll=function(e,A,t){e&&e.defaultView&&(A!==e.defaultView.pageXOffset||t!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(A,t)},restoreNodeScroll=function(e){var A=e[0],t=e[1];e=e[2];A.scrollLeft=t,A.scrollTop=e},PSEUDO_BEFORE=":before",PSEUDO_AFTER=":after",PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",PSEUDO_HIDE_ELEMENT_STYLE='{\n    content: "" !important;\n    display: none !important;\n}',createPseudoHideStyles=function(e){createStyles(e,"."+PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+PSEUDO_BEFORE+PSEUDO_HIDE_ELEMENT_STYLE+"\n         ."+PSEUDO_HIDE_ELEMENT_CLASS_AFTER+PSEUDO_AFTER+PSEUDO_HIDE_ELEMENT_STYLE)},createStyles=function(e,A){var t=e.ownerDocument;t&&((t=t.createElement("style")).textContent=A,e.appendChild(t))},CacheStorage=function(){function e(){}return e.getOrigin=function(A){var t=e._link;return t?(t.href=A,t.href=t.href,t.protocol+t.hostname+t.port):"about:blank"},e.isSameOrigin=function(A){return e.getOrigin(A)===e._origin},e.setContext=function(A){e._link=A.document.createElement("a"),e._origin=e.getOrigin(A.location.href)},e._origin="about:blank",e}(),Cache=function(){function e(e,A){this.context=e,this._options=A,this._cache={}}return e.prototype.addImage=function(e){var A=Promise.resolve();return this.has(e)||(isBlobImage(e)||isRenderable(e))&&(this._cache[e]=this.loadImage(e)).catch((function(){})),A},e.prototype.match=function(e){return this._cache[e]},e.prototype.loadImage=function(e){return __awaiter(this,void 0,void 0,(function(){var A,t,i,s,n=this;return __generator(this,(function(r){switch(r.label){case 0:return A=CacheStorage.isSameOrigin(e),t=!isInlineImage(e)&&!0===this._options.useCORS&&FEATURES.SUPPORT_CORS_IMAGES&&!A,i=!isInlineImage(e)&&!A&&!isBlobImage(e)&&"string"==typeof this._options.proxy&&FEATURES.SUPPORT_CORS_XHR&&!t,A||!1!==this._options.allowTaint||isInlineImage(e)||isBlobImage(e)||i||t?(s=e,i?[4,this.proxy(s)]:[3,2]):[2];case 1:s=r.sent(),r.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise((function(e,A){var i=new Image;i.onload=function(){return e(i)},i.onerror=A,(isInlineBase64Image(s)||t)&&(i.crossOrigin="anonymous"),i.src=s,!0===i.complete&&setTimeout((function(){return e(i)}),500),0<n._options.imageTimeout&&setTimeout((function(){return A("Timed out ("+n._options.imageTimeout+"ms) loading image")}),n._options.imageTimeout)}))];case 3:return[2,r.sent()]}}))}))},e.prototype.has=function(e){return void 0!==this._cache[e]},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(e){var A,t=this,i=this._options.proxy;if(i)return A=e.substring(0,256),new Promise((function(s,n){var r,o=FEATURES.SUPPORT_RESPONSE_TYPE?"blob":"text",a=new XMLHttpRequest,l=(a.onload=function(){var e;200===a.status?"text"==o?s(a.response):((e=new FileReader).addEventListener("load",(function(){return s(e.result)}),!1),e.addEventListener("error",(function(e){return n(e)}),!1),e.readAsDataURL(a.response)):n("Failed to proxy resource "+A+" with status code "+a.status)},a.onerror=n,-1<i.indexOf("?")?"&":"?");a.open("GET",i+l+"url="+encodeURIComponent(e)+"&responseType="+o),"text"!=o&&a instanceof XMLHttpRequest&&(a.responseType=o),t._options.imageTimeout&&(r=t._options.imageTimeout,a.timeout=r,a.ontimeout=function(){return n("Timed out ("+r+"ms) proxying "+A)}),a.send()}));throw new Error("No proxy defined")},e}(),INLINE_SVG=/^data:image\/svg\+xml/i,INLINE_BASE64=/^data:image\/.*;base64,/i,INLINE_IMG=/^data:image\/.*/i,isRenderable=function(e){return FEATURES.SUPPORT_SVG_DRAWING||!isSVG(e)},isInlineImage=function(e){return INLINE_IMG.test(e)},isInlineBase64Image=function(e){return INLINE_BASE64.test(e)},isBlobImage=function(e){return"blob"===e.substr(0,4)},isSVG=function(e){return"svg"===e.substr(-3).toLowerCase()||INLINE_SVG.test(e)},Vector=function(){function e(e,A){this.type=0,this.x=e,this.y=A}return e.prototype.add=function(A,t){return new e(this.x+A,this.y+t)},e}(),lerp=function(e,A,t){return new Vector(e.x+(A.x-e.x)*t,e.y+(A.y-e.y)*t)},BezierCurve=function(){function e(e,A,t,i){this.type=1,this.start=e,this.startControl=A,this.endControl=t,this.end=i}return e.prototype.subdivide=function(A,t){var i=lerp(this.start,this.startControl,A),s=lerp(this.startControl,this.endControl,A),n=lerp(this.endControl,this.end,A),r=lerp(i,s,A);s=lerp(s,n,A),A=lerp(r,s,A);return t?new e(this.start,i,r,A):new e(A,s,n,this.end)},e.prototype.add=function(A,t){return new e(this.start.add(A,t),this.startControl.add(A,t),this.endControl.add(A,t),this.end.add(A,t))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),isBezierCurve=function(e){return 1===e.type},BoundCurves=function(e){var A=e.styles,t=e.bounds,i=(s=getAbsoluteValueForTuple(A.borderTopLeftRadius,t.width,t.height))[0],s=s[1],n=(r=getAbsoluteValueForTuple(A.borderTopRightRadius,t.width,t.height))[0],r=r[1],o=(a=getAbsoluteValueForTuple(A.borderBottomRightRadius,t.width,t.height))[0],a=a[1],l=(c=getAbsoluteValueForTuple(A.borderBottomLeftRadius,t.width,t.height))[0],c=c[1];(h=[]).push((i+n)/t.width),h.push((l+o)/t.width),h.push((s+c)/t.height),h.push((r+a)/t.height),1<(h=Math.max.apply(Math,h))&&(i/=h,s/=h,n/=h,r/=h,o/=h,a/=h,l/=h,c/=h);var h=t.width-n,u=t.height-a,d=t.width-o,p=t.height-c,g=A.borderTopWidth,B=A.borderRightWidth,m=A.borderBottomWidth,f=A.borderLeftWidth,y=getAbsoluteValue(A.paddingTop,e.bounds.width),C=getAbsoluteValue(A.paddingRight,e.bounds.width),w=getAbsoluteValue(A.paddingBottom,e.bounds.width);A=getAbsoluteValue(A.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=0<i||0<s?getCurvePoints(t.left+f/3,t.top+g/3,i-f/3,s-g/3,CORNER.TOP_LEFT):new Vector(t.left+f/3,t.top+g/3),this.topRightBorderDoubleOuterBox=0<i||0<s?getCurvePoints(t.left+h,t.top+g/3,n-B/3,r-g/3,CORNER.TOP_RIGHT):new Vector(t.left+t.width-B/3,t.top+g/3),this.bottomRightBorderDoubleOuterBox=0<o||0<a?getCurvePoints(t.left+d,t.top+u,o-B/3,a-m/3,CORNER.BOTTOM_RIGHT):new Vector(t.left+t.width-B/3,t.top+t.height-m/3),this.bottomLeftBorderDoubleOuterBox=0<l||0<c?getCurvePoints(t.left+f/3,t.top+p,l-f/3,c-m/3,CORNER.BOTTOM_LEFT):new Vector(t.left+f/3,t.top+t.height-m/3),this.topLeftBorderDoubleInnerBox=0<i||0<s?getCurvePoints(t.left+2*f/3,t.top+2*g/3,i-2*f/3,s-2*g/3,CORNER.TOP_LEFT):new Vector(t.left+2*f/3,t.top+2*g/3),this.topRightBorderDoubleInnerBox=0<i||0<s?getCurvePoints(t.left+h,t.top+2*g/3,n-2*B/3,r-2*g/3,CORNER.TOP_RIGHT):new Vector(t.left+t.width-2*B/3,t.top+2*g/3),this.bottomRightBorderDoubleInnerBox=0<o||0<a?getCurvePoints(t.left+d,t.top+u,o-2*B/3,a-2*m/3,CORNER.BOTTOM_RIGHT):new Vector(t.left+t.width-2*B/3,t.top+t.height-2*m/3),this.bottomLeftBorderDoubleInnerBox=0<l||0<c?getCurvePoints(t.left+2*f/3,t.top+p,l-2*f/3,c-2*m/3,CORNER.BOTTOM_LEFT):new Vector(t.left+2*f/3,t.top+t.height-2*m/3),this.topLeftBorderStroke=0<i||0<s?getCurvePoints(t.left+f/2,t.top+g/2,i-f/2,s-g/2,CORNER.TOP_LEFT):new Vector(t.left+f/2,t.top+g/2),this.topRightBorderStroke=0<i||0<s?getCurvePoints(t.left+h,t.top+g/2,n-B/2,r-g/2,CORNER.TOP_RIGHT):new Vector(t.left+t.width-B/2,t.top+g/2),this.bottomRightBorderStroke=0<o||0<a?getCurvePoints(t.left+d,t.top+u,o-B/2,a-m/2,CORNER.BOTTOM_RIGHT):new Vector(t.left+t.width-B/2,t.top+t.height-m/2),this.bottomLeftBorderStroke=0<l||0<c?getCurvePoints(t.left+f/2,t.top+p,l-f/2,c-m/2,CORNER.BOTTOM_LEFT):new Vector(t.left+f/2,t.top+t.height-m/2),this.topLeftBorderBox=0<i||0<s?getCurvePoints(t.left,t.top,i,s,CORNER.TOP_LEFT):new Vector(t.left,t.top),this.topRightBorderBox=0<n||0<r?getCurvePoints(t.left+h,t.top,n,r,CORNER.TOP_RIGHT):new Vector(t.left+t.width,t.top),this.bottomRightBorderBox=0<o||0<a?getCurvePoints(t.left+d,t.top+u,o,a,CORNER.BOTTOM_RIGHT):new Vector(t.left+t.width,t.top+t.height),this.bottomLeftBorderBox=0<l||0<c?getCurvePoints(t.left,t.top+p,l,c,CORNER.BOTTOM_LEFT):new Vector(t.left,t.top+t.height),this.topLeftPaddingBox=0<i||0<s?getCurvePoints(t.left+f,t.top+g,Math.max(0,i-f),Math.max(0,s-g),CORNER.TOP_LEFT):new Vector(t.left+f,t.top+g),this.topRightPaddingBox=0<n||0<r?getCurvePoints(t.left+Math.min(h,t.width-B),t.top+g,h>t.width+B?0:Math.max(0,n-B),Math.max(0,r-g),CORNER.TOP_RIGHT):new Vector(t.left+t.width-B,t.top+g),this.bottomRightPaddingBox=0<o||0<a?getCurvePoints(t.left+Math.min(d,t.width-f),t.top+Math.min(u,t.height-m),Math.max(0,o-B),Math.max(0,a-m),CORNER.BOTTOM_RIGHT):new Vector(t.left+t.width-B,t.top+t.height-m),this.bottomLeftPaddingBox=0<l||0<c?getCurvePoints(t.left+f,t.top+Math.min(p,t.height-m),Math.max(0,l-f),Math.max(0,c-m),CORNER.BOTTOM_LEFT):new Vector(t.left+f,t.top+t.height-m),this.topLeftContentBox=0<i||0<s?getCurvePoints(t.left+f+A,t.top+g+y,Math.max(0,i-(f+A)),Math.max(0,s-(g+y)),CORNER.TOP_LEFT):new Vector(t.left+f+A,t.top+g+y),this.topRightContentBox=0<n||0<r?getCurvePoints(t.left+Math.min(h,t.width+f+A),t.top+g+y,h>t.width+f+A?0:n-f+A,r-(g+y),CORNER.TOP_RIGHT):new Vector(t.left+t.width-(B+C),t.top+g+y),this.bottomRightContentBox=0<o||0<a?getCurvePoints(t.left+Math.min(d,t.width-(f+A)),t.top+Math.min(u,t.height+g+y),Math.max(0,o-(B+C)),a-(m+w),CORNER.BOTTOM_RIGHT):new Vector(t.left+t.width-(B+C),t.top+t.height-(m+w)),this.bottomLeftContentBox=0<l||0<c?getCurvePoints(t.left+f+A,t.top+p,Math.max(0,l-(f+A)),c-(m+w),CORNER.BOTTOM_LEFT):new Vector(t.left+f+A,t.top+t.height-(m+w))},CORNER,getCurvePoints=(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"}(CORNER=CORNER||{}),function(e,A,t,i,s){var n=(Math.sqrt(2)-1)/3*4,r=t*n,o=i*n,a=e+t,l=A+i;switch(s){case CORNER.TOP_LEFT:return new BezierCurve(new Vector(e,l),new Vector(e,l-o),new Vector(a-r,A),new Vector(a,A));case CORNER.TOP_RIGHT:return new BezierCurve(new Vector(e,A),new Vector(e+r,A),new Vector(a,l-o),new Vector(a,l));case CORNER.BOTTOM_RIGHT:return new BezierCurve(new Vector(a,A),new Vector(a,A+o),new Vector(e+r,l),new Vector(e,l));default:return CORNER.BOTTOM_LEFT,new BezierCurve(new Vector(a,l),new Vector(a-r,l),new Vector(e,A+o),new Vector(e,A))}}),calculateBorderBoxPath=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},calculateContentBoxPath=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},calculatePaddingBoxPath=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},TransformEffect=function(e,A,t){this.offsetX=e,this.offsetY=A,this.matrix=t,this.type=0,this.target=6},ClipEffect=function(e,A){this.path=e,this.target=A,this.type=1},OpacityEffect=function(e){this.opacity=e,this.type=2,this.target=6},isTransformEffect=function(e){return 0===e.type},isClipEffect=function(e){return 1===e.type},isOpacityEffect=function(e){return 2===e.type},equalPath=function(e,A){return e.length===A.length&&e.some((function(e,t){return e===A[t]}))},transformPath=function(e,A,t,i,s){return e.map((function(e,n){switch(n){case 0:return e.add(A,t);case 1:return e.add(A+i,t);case 2:return e.add(A+i,t+s);case 3:return e.add(A,t+s)}return e}))},StackingContext=function(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]},ElementPaint=function(){function e(e,A){var t;this.container=e,this.parent=A,this.effects=[],this.curves=new BoundCurves(this.container),this.container.styles.opacity<1&&this.effects.push(new OpacityEffect(this.container.styles.opacity)),null!==this.container.styles.transform&&(e=this.container.bounds.left+this.container.styles.transformOrigin[0].number,A=this.container.bounds.top+this.container.styles.transformOrigin[1].number,t=this.container.styles.transform,this.effects.push(new TransformEffect(e,A,t))),0!==this.container.styles.overflowX&&(e=calculateBorderBoxPath(this.curves),A=calculatePaddingBoxPath(this.curves),equalPath(e,A)?this.effects.push(new ClipEffect(e,6)):(this.effects.push(new ClipEffect(e,2)),this.effects.push(new ClipEffect(A,4))))}return e.prototype.getEffects=function(e){for(var A=-1===[2,3].indexOf(this.container.styles.position),t=this.parent,i=this.effects.slice(0);t;){var s,n,r=t.effects.filter((function(e){return!isClipEffect(e)}));A||0!==t.container.styles.position||!t.parent?(i.unshift.apply(i,r),A=-1===[2,3].indexOf(t.container.styles.position),0!==t.container.styles.overflowX&&(s=calculateBorderBoxPath(t.curves),n=calculatePaddingBoxPath(t.curves),equalPath(s,n)||i.unshift(new ClipEffect(n,6)))):i.unshift.apply(i,r),t=t.parent}return i.filter((function(A){return contains(A.target,e)}))},e}(),parseStackTree=function(e,A,t,i){e.container.elements.forEach((function(s){var n,r,o,a,l=contains(s.flags,4),c=contains(s.flags,2),h=new ElementPaint(s,e),u=(contains(s.styles.display,2048)&&i.push(h),contains(s.flags,8)?[]:i);l||c?(c=l||s.styles.isPositioned()?t:A,n=new StackingContext(h),s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()?(r=s.styles.zIndex.order)<0?(o=0,c.negativeZIndex.some((function(e,A){return r>e.element.container.styles.zIndex.order?(o=A,!1):0<o})),c.negativeZIndex.splice(o,0,n)):0<r?(a=0,c.positiveZIndex.some((function(e,A){return r>=e.element.container.styles.zIndex.order?(a=A+1,!1):0<a})),c.positiveZIndex.splice(a,0,n)):c.zeroOrAutoZIndexOrTransformedOrOpacity.push(n):(s.styles.isFloating()?c.nonPositionedFloats:c.nonPositionedInlineLevel).push(n),parseStackTree(h,n,l?n:t,u)):((s.styles.isInlineLevel()?A.inlineLevel:A.nonInlineLevel).push(h),parseStackTree(h,A,t,u)),contains(s.flags,8)&&processListItems(s,u)}))},processListItems=function(e,A){for(var t=e instanceof OLElementContainer?e.start:1,i=e instanceof OLElementContainer&&e.reversed,s=0;s<A.length;s++){var n=A[s];n.container instanceof LIElementContainer&&"number"==typeof n.container.value&&0!==n.container.value&&(t=n.container.value),n.listValue=createCounterText(t,n.container.styles.listStyleType,!0),t+=i?-1:1}},parseStackingContexts=function(e){e=new ElementPaint(e,null);var A=new StackingContext(e),t=[];return parseStackTree(e,A,A,t),processListItems(e.container,t),A},parsePathForBorder=function(e,A){switch(A){case 0:return createPathFromCurves(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return createPathFromCurves(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return createPathFromCurves(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);default:return createPathFromCurves(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},parsePathForBorderDoubleOuter=function(e,A){switch(A){case 0:return createPathFromCurves(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return createPathFromCurves(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return createPathFromCurves(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);default:return createPathFromCurves(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},parsePathForBorderDoubleInner=function(e,A){switch(A){case 0:return createPathFromCurves(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return createPathFromCurves(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return createPathFromCurves(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);default:return createPathFromCurves(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},parsePathForBorderStroke=function(e,A){switch(A){case 0:return createStrokePathFromCurves(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return createStrokePathFromCurves(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return createStrokePathFromCurves(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);default:return createStrokePathFromCurves(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},createStrokePathFromCurves=function(e,A){var t=[];return isBezierCurve(e)?t.push(e.subdivide(.5,!1)):t.push(e),isBezierCurve(A)?t.push(A.subdivide(.5,!0)):t.push(A),t},createPathFromCurves=function(e,A,t,i){var s=[];return isBezierCurve(e)?s.push(e.subdivide(.5,!1)):s.push(e),isBezierCurve(t)?s.push(t.subdivide(.5,!0)):s.push(t),isBezierCurve(i)?s.push(i.subdivide(.5,!0).reverse()):s.push(i),isBezierCurve(A)?s.push(A.subdivide(.5,!1).reverse()):s.push(A),s},paddingBox=function(e){var A=e.bounds;e=e.styles;return A.add(e.borderLeftWidth,e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth),-(e.borderTopWidth+e.borderBottomWidth))},contentBox=function(e){var A=e.styles,t=(e=e.bounds,getAbsoluteValue(A.paddingLeft,e.width)),i=getAbsoluteValue(A.paddingRight,e.width),s=getAbsoluteValue(A.paddingTop,e.width),n=getAbsoluteValue(A.paddingBottom,e.width);return e.add(t+A.borderLeftWidth,s+A.borderTopWidth,-(A.borderRightWidth+A.borderLeftWidth+t+i),-(A.borderTopWidth+A.borderBottomWidth+s+n))},calculateBackgroundPositioningArea=function(e,A){return 0===e?A.bounds:(2===e?contentBox:paddingBox)(A)},calculateBackgroundPaintingArea=function(e,A){return 0===e?A.bounds:(2===e?contentBox:paddingBox)(A)},calculateBackgroundRendering=function(e,A,t){var i=calculateBackgroundPositioningArea(getBackgroundValueForIndex(e.styles.backgroundOrigin,A),e),s=calculateBackgroundPaintingArea(getBackgroundValueForIndex(e.styles.backgroundClip,A),e),n=(t=calculateBackgroundSize(getBackgroundValueForIndex(e.styles.backgroundSize,A),t,i))[0],r=t[1],o=getAbsoluteValueForTuple(getBackgroundValueForIndex(e.styles.backgroundPosition,A),i.width-n,i.height-r);return[calculateBackgroundRepeatPath(getBackgroundValueForIndex(e.styles.backgroundRepeat,A),o,t,i,s),Math.round(i.left+o[0]),Math.round(i.top+o[1]),n,r]},isAuto=function(e){return isIdentToken(e)&&e.value===BACKGROUND_SIZE.AUTO},hasIntrinsicValue=function(e){return"number"==typeof e},calculateBackgroundSize=function(e,A,t){var i=A[0],s=A[1],n=(A=A[2],e[0]);e=e[1];if(!n)return[0,0];if(isLengthPercentage(n)&&e&&isLengthPercentage(e))return[getAbsoluteValue(n,t.width),getAbsoluteValue(e,t.height)];var r=hasIntrinsicValue(A);if(isIdentToken(n)&&(n.value===BACKGROUND_SIZE.CONTAIN||n.value===BACKGROUND_SIZE.COVER))return hasIntrinsicValue(A)?t.width/t.height<A!=(n.value===BACKGROUND_SIZE.COVER)?[t.width,t.width/A]:[t.height*A,t.height]:[t.width,t.height];var o=hasIntrinsicValue(i),a=hasIntrinsicValue(s),l=o||a;if(isAuto(n)&&(!e||isAuto(e)))return o&&a?[i,s]:r||l?l&&r?[o?i:s*A,a?s:i/A]:[o?i:t.width,a?s:t.height]:[t.width,t.height];if(r)return r=l=0,isLengthPercentage(n)?l=getAbsoluteValue(n,t.width):isLengthPercentage(e)&&(r=getAbsoluteValue(e,t.height)),isAuto(n)?l=r*A:e&&!isAuto(e)||(r=l/A),[l,r];if(A=null,l=null,isLengthPercentage(n)?A=getAbsoluteValue(n,t.width):e&&isLengthPercentage(e)&&(l=getAbsoluteValue(e,t.height)),null!==(A=null!==(l=null===A||e&&!isAuto(e)?l:o&&a?A/i*s:t.height)&&isAuto(n)?o&&a?l/s*i:t.width:A)&&null!==l)return[A,l];throw new Error("Unable to calculate background-size for element")},getBackgroundValueForIndex=function(e,A){return void 0===(A=e[A])?e[0]:A},calculateBackgroundRepeatPath=function(e,A,t,i,s){var n=A[0],r=A[1],o=t[0],a=t[1];switch(e){case 2:return[new Vector(Math.round(i.left),Math.round(i.top+r)),new Vector(Math.round(i.left+i.width),Math.round(i.top+r)),new Vector(Math.round(i.left+i.width),Math.round(a+i.top+r)),new Vector(Math.round(i.left),Math.round(a+i.top+r))];case 3:return[new Vector(Math.round(i.left+n),Math.round(i.top)),new Vector(Math.round(i.left+n+o),Math.round(i.top)),new Vector(Math.round(i.left+n+o),Math.round(i.height+i.top)),new Vector(Math.round(i.left+n),Math.round(i.height+i.top))];case 1:return[new Vector(Math.round(i.left+n),Math.round(i.top+r)),new Vector(Math.round(i.left+n+o),Math.round(i.top+r)),new Vector(Math.round(i.left+n+o),Math.round(i.top+r+a)),new Vector(Math.round(i.left+n),Math.round(i.top+r+a))];default:return[new Vector(Math.round(s.left),Math.round(s.top)),new Vector(Math.round(s.left+s.width),Math.round(s.top)),new Vector(Math.round(s.left+s.width),Math.round(s.height+s.top)),new Vector(Math.round(s.left),Math.round(s.height+s.top))]}},SMALL_IMAGE="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",SAMPLE_TEXT="Hidden Text",FontMetrics=function(){function e(e){this._data={},this._document=e}return e.prototype.parseMetrics=function(e,A){var t=this._document.createElement("div"),i=this._document.createElement("img"),s=this._document.createElement("span"),n=this._document.body;t.style.visibility="hidden",t.style.fontFamily=e,t.style.fontSize=A,t.style.margin="0",t.style.padding="0",t.style.whiteSpace="nowrap",n.appendChild(t),i.src=SMALL_IMAGE,i.width=1,i.height=1,i.style.margin="0",i.style.padding="0",i.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=A,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(SAMPLE_TEXT)),t.appendChild(s),t.appendChild(i),e=i.offsetTop-s.offsetTop+2,t.removeChild(s),t.appendChild(this._document.createTextNode(SAMPLE_TEXT)),t.style.lineHeight="normal",i.style.verticalAlign="super",A=i.offsetTop-t.offsetTop+2;return n.removeChild(t),{baseline:e,middle:A}},e.prototype.getMetrics=function(e,A){var t=e+" "+A;return void 0===this._data[t]&&(this._data[t]=this.parseMetrics(e,A)),this._data[t]},e}(),Renderer=function(e,A){this.context=e,this.options=A},MASK_OFFSET=1e4,CanvasRenderer=function(e){function A(A,t){return(A=e.call(this,A,t)||this)._activeEffects=[],A.canvas=t.canvas||document.createElement("canvas"),A.ctx=A.canvas.getContext("2d"),t.canvas||(A.canvas.width=Math.floor(t.width*t.scale),A.canvas.height=Math.floor(t.height*t.scale),A.canvas.style.width=t.width+"px",A.canvas.style.height=t.height+"px"),A.fontMetrics=new FontMetrics(document),A.ctx.scale(A.options.scale,A.options.scale),A.ctx.translate(-t.x,-t.y),A.ctx.textBaseline="bottom",A._activeEffects=[],A.context.logger.debug("Canvas renderer initialized ("+t.width+"x"+t.height+") with scale "+t.scale),A}return __extends(A,e),A.prototype.applyEffects=function(e){for(var A=this;this._activeEffects.length;)this.popEffect();e.forEach((function(e){return A.applyEffect(e)}))},A.prototype.applyEffect=function(e){this.ctx.save(),isOpacityEffect(e)&&(this.ctx.globalAlpha=e.opacity),isTransformEffect(e)&&(this.ctx.translate(e.offsetX,e.offsetY),this.ctx.transform(e.matrix[0],e.matrix[1],e.matrix[2],e.matrix[3],e.matrix[4],e.matrix[5]),this.ctx.translate(-e.offsetX,-e.offsetY)),isClipEffect(e)&&(this.path(e.path),this.ctx.clip()),this._activeEffects.push(e)},A.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},A.prototype.renderStack=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(A){switch(A.label){case 0:return e.element.container.styles.isVisible()?[4,this.renderStackContent(e)]:[3,2];case 1:A.sent(),A.label=2;case 2:return[2]}}))}))},A.prototype.renderNode=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(A){switch(A.label){case 0:return contains(e.container.flags,16),e.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(e)]:[3,3];case 1:return A.sent(),[4,this.renderNodeContent(e)];case 2:A.sent(),A.label=3;case 3:return[2]}}))}))},A.prototype.renderTextWithLetterSpacing=function(e,A,t){var i=this;0===A?this.ctx.fillText(e.text,e.bounds.left,e.bounds.top+t):segmentGraphemes(e.text).reduce((function(A,s){return i.ctx.fillText(s,A,e.bounds.top+t),A+i.ctx.measureText(s).width}),e.bounds.left)},A.prototype.createFontStyle=function(e){var A=e.fontVariant.filter((function(e){return"normal"===e||"small-caps"===e})).join(""),t=fixIOSSystemFonts(e.fontFamily).join(", "),i=isDimensionToken(e.fontSize)?""+e.fontSize.number+e.fontSize.unit:e.fontSize.number+"px";return[[e.fontStyle,A,e.fontWeight,i,t].join(" "),t,i]},A.prototype.renderTextNode=function(e,A){return __awaiter(this,void 0,void 0,(function(){var t,i,s,n,r,o,a=this;return __generator(this,(function(l){return i=this.createFontStyle(A),s=i[0],t=i[1],i=i[2],this.ctx.font=s,this.ctx.direction=1===A.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",s=this.fontMetrics.getMetrics(t,i),n=s.baseline,r=s.middle,o=A.paintOrder,e.textBounds.forEach((function(e){o.forEach((function(t){switch(t){case 0:a.ctx.fillStyle=asString(A.color),a.renderTextWithLetterSpacing(e,A.letterSpacing,n);var i=A.textShadow;i.length&&e.text.trim().length&&(i.slice(0).reverse().forEach((function(t){a.ctx.shadowColor=asString(t.color),a.ctx.shadowOffsetX=t.offsetX.number*a.options.scale,a.ctx.shadowOffsetY=t.offsetY.number*a.options.scale,a.ctx.shadowBlur=t.blur.number,a.renderTextWithLetterSpacing(e,A.letterSpacing,n)})),a.ctx.shadowColor="",a.ctx.shadowOffsetX=0,a.ctx.shadowOffsetY=0,a.ctx.shadowBlur=0),A.textDecorationLine.length&&(a.ctx.fillStyle=asString(A.textDecorationColor||A.color),A.textDecorationLine.forEach((function(A){switch(A){case 1:a.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top+n),e.bounds.width,1);break;case 2:a.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top),e.bounds.width,1);break;case 3:a.ctx.fillRect(e.bounds.left,Math.ceil(e.bounds.top+r),e.bounds.width,1)}})));break;case 1:A.webkitTextStrokeWidth&&e.text.trim().length&&(a.ctx.strokeStyle=asString(A.webkitTextStrokeColor),a.ctx.lineWidth=A.webkitTextStrokeWidth,a.ctx.lineJoin=window.chrome?"miter":"round",a.ctx.strokeText(e.text,e.bounds.left,e.bounds.top+n)),a.ctx.strokeStyle="",a.ctx.lineWidth=0,a.ctx.lineJoin="miter"}}))})),[2]}))}))},A.prototype.renderReplacedElement=function(e,A,t){var i;t&&0<e.intrinsicWidth&&0<e.intrinsicHeight&&(i=contentBox(e),A=calculatePaddingBoxPath(A),this.path(A),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(t,0,0,e.intrinsicWidth,e.intrinsicHeight,i.left,i.top,i.width,i.height),this.ctx.restore())},A.prototype.renderNodeContent=function(e){return __awaiter(this,void 0,void 0,(function(){var t,i,s,n,r,o,a,l,c,h,u,d,p;return __generator(this,(function(g){switch(g.label){case 0:this.applyEffects(e.getEffects(4)),t=e.container,i=e.curves,s=t.styles,n=0,r=t.textNodes,g.label=1;case 1:return n<r.length?(o=r[n],[4,this.renderTextNode(o,s)]):[3,4];case 2:g.sent(),g.label=3;case 3:return n++,[3,1];case 4:if(!(t instanceof ImageElementContainer))return[3,8];g.label=5;case 5:return g.trys.push([5,7,,8]),[4,this.context.cache.match(t.src)];case 6:return h=g.sent(),this.renderReplacedElement(t,i,h),[3,8];case 7:return g.sent(),this.context.logger.error("Error loading image "+t.src),[3,8];case 8:if(t instanceof CanvasElementContainer&&this.renderReplacedElement(t,i,t.canvas),!(t instanceof SVGElementContainer))return[3,12];g.label=9;case 9:return g.trys.push([9,11,,12]),[4,this.context.cache.match(t.svg)];case 10:return h=g.sent(),this.renderReplacedElement(t,i,h),[3,12];case 11:return g.sent(),this.context.logger.error("Error loading svg "+t.svg.substring(0,255)),[3,12];case 12:return t instanceof IFrameElementContainer&&t.tree?[4,new A(this.context,{scale:this.options.scale,backgroundColor:t.backgroundColor,x:0,y:0,width:t.width,height:t.height}).render(t.tree)]:[3,14];case 13:o=g.sent(),t.width&&t.height&&this.ctx.drawImage(o,0,0,t.width,t.height,t.bounds.left,t.bounds.top,t.bounds.width,t.bounds.height),g.label=14;case 14:if(t instanceof InputElementContainer&&(a=Math.min(t.bounds.width,t.bounds.height),t.type===CHECKBOX?t.checked&&(this.ctx.save(),this.path([new Vector(t.bounds.left+.39363*a,t.bounds.top+.79*a),new Vector(t.bounds.left+.16*a,t.bounds.top+.5549*a),new Vector(t.bounds.left+.27347*a,t.bounds.top+.44071*a),new Vector(t.bounds.left+.39694*a,t.bounds.top+.5649*a),new Vector(t.bounds.left+.72983*a,t.bounds.top+.23*a),new Vector(t.bounds.left+.84*a,t.bounds.top+.34085*a),new Vector(t.bounds.left+.39363*a,t.bounds.top+.79*a)]),this.ctx.fillStyle=asString(INPUT_COLOR),this.ctx.fill(),this.ctx.restore()):t.type===RADIO&&t.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(t.bounds.left+a/2,t.bounds.top+a/2,a/4,0,2*Math.PI,!0),this.ctx.fillStyle=asString(INPUT_COLOR),this.ctx.fill(),this.ctx.restore())),isTextInputElement(t)&&t.value.length){switch(a=this.createFontStyle(s),d=a[0],u=a[1],u=this.fontMetrics.getMetrics(d,u).baseline,this.ctx.font=d,this.ctx.fillStyle=asString(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=canvasTextAlign(t.styles.textAlign),p=contentBox(t),l=0,t.styles.textAlign){case 1:l+=p.width/2;break;case 2:l+=p.width}c=p.add(l,0,0,-p.height/2+1),this.ctx.save(),this.path([new Vector(p.left,p.top),new Vector(p.left+p.width,p.top),new Vector(p.left+p.width,p.top+p.height),new Vector(p.left,p.top+p.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new TextBounds(t.value,c),s.letterSpacing,u),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!contains(t.styles.display,2048))return[3,20];if(null===t.styles.listStyleImage)return[3,19];if(0!==(c=t.styles.listStyleImage).type)return[3,18];h=void 0,u=c.url,g.label=15;case 15:return g.trys.push([15,17,,18]),[4,this.context.cache.match(u)];case 16:return h=g.sent(),this.ctx.drawImage(h,t.bounds.left-(h.width+10),t.bounds.top),[3,18];case 17:return g.sent(),this.context.logger.error("Error loading list-style-image "+u),[3,18];case 18:return[3,20];case 19:e.listValue&&-1!==t.styles.listStyleType&&(d=this.createFontStyle(s)[0],this.ctx.font=d,this.ctx.fillStyle=asString(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",p=new Bounds(t.bounds.left,t.bounds.top+getAbsoluteValue(t.styles.paddingTop,t.bounds.width),t.bounds.width,computeLineHeight(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new TextBounds(e.listValue,p),s.letterSpacing,computeLineHeight(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),g.label=20;case 20:return[2]}}))}))},A.prototype.renderStackContent=function(e){return __awaiter(this,void 0,void 0,(function(){var A,t,i,s,n,r,o,a,l,c,h,u,d,p,g;return __generator(this,(function(B){switch(B.label){case 0:return contains(e.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(e.element)];case 1:B.sent(),A=0,t=e.negativeZIndex,B.label=2;case 2:return A<t.length?(g=t[A],[4,this.renderStack(g)]):[3,5];case 3:B.sent(),B.label=4;case 4:return A++,[3,2];case 5:return[4,this.renderNodeContent(e.element)];case 6:B.sent(),i=0,s=e.nonInlineLevel,B.label=7;case 7:return i<s.length?(g=s[i],[4,this.renderNode(g)]):[3,10];case 8:B.sent(),B.label=9;case 9:return i++,[3,7];case 10:n=0,r=e.nonPositionedFloats,B.label=11;case 11:return n<r.length?(g=r[n],[4,this.renderStack(g)]):[3,14];case 12:B.sent(),B.label=13;case 13:return n++,[3,11];case 14:o=0,a=e.nonPositionedInlineLevel,B.label=15;case 15:return o<a.length?(g=a[o],[4,this.renderStack(g)]):[3,18];case 16:B.sent(),B.label=17;case 17:return o++,[3,15];case 18:l=0,c=e.inlineLevel,B.label=19;case 19:return l<c.length?(g=c[l],[4,this.renderNode(g)]):[3,22];case 20:B.sent(),B.label=21;case 21:return l++,[3,19];case 22:h=0,u=e.zeroOrAutoZIndexOrTransformedOrOpacity,B.label=23;case 23:return h<u.length?(g=u[h],[4,this.renderStack(g)]):[3,26];case 24:B.sent(),B.label=25;case 25:return h++,[3,23];case 26:d=0,p=e.positiveZIndex,B.label=27;case 27:return d<p.length?(g=p[d],[4,this.renderStack(g)]):[3,30];case 28:B.sent(),B.label=29;case 29:return d++,[3,27];case 30:return[2]}}))}))},A.prototype.mask=function(e){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(e.slice(0).reverse()),this.ctx.closePath()},A.prototype.path=function(e){this.ctx.beginPath(),this.formatPath(e),this.ctx.closePath()},A.prototype.formatPath=function(e){var A=this;e.forEach((function(e,t){var i=isBezierCurve(e)?e.start:e;0===t?A.ctx.moveTo(i.x,i.y):A.ctx.lineTo(i.x,i.y),isBezierCurve(e)&&A.ctx.bezierCurveTo(e.startControl.x,e.startControl.y,e.endControl.x,e.endControl.y,e.end.x,e.end.y)}))},A.prototype.renderRepeat=function(e,A,t,i){this.path(e),this.ctx.fillStyle=A,this.ctx.translate(t,i),this.ctx.fill(),this.ctx.translate(-t,-i)},A.prototype.resizeImage=function(e,A,t){var i;return e.width===A&&e.height===t?e:((i=(null!=(i=this.canvas.ownerDocument)?i:document).createElement("canvas")).width=Math.max(1,A),i.height=Math.max(1,t),i.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,A,t),i)},A.prototype.renderBackgroundImage=function(e){return __awaiter(this,void 0,void 0,(function(){var A,t,i,s,n,r;return __generator(this,(function(o){switch(o.label){case 0:A=e.styles.backgroundImage.length-1,t=function(t){var s,n,r,o,a,l,c,h,u,d,p,g,B,m,f,y,C,w,E,b,I;return __generator(this,(function(U){switch(U.label){case 0:if(0!==t.type)return[3,5];s=void 0,n=t.url,U.label=1;case 1:return U.trys.push([1,3,,4]),[4,i.context.cache.match(n)];case 2:return s=U.sent(),[3,4];case 3:return U.sent(),i.context.logger.error("Error loading background-image "+n),[3,4];case 4:return s&&(d=calculateBackgroundRendering(e,A,[s.width,s.height,s.width/s.height]),l=d[0],g=d[1],B=d[2],u=d[3],d=d[4],o=i.ctx.createPattern(i.resizeImage(s,u,d),"repeat"),i.renderRepeat(l,o,g,B)),[3,6];case 5:isLinearGradient(t)?(p=calculateBackgroundRendering(e,A,[null,null,null]),l=p[0],g=p[1],B=p[2],u=p[3],d=p[4],p=calculateGradientDirection(t.angle,u,d),m=p[0],a=p[1],h=p[2],c=p[3],p=p[4],(y=document.createElement("canvas")).width=u,y.height=d,f=y.getContext("2d"),r=f.createLinearGradient(a,c,h,p),processColorStops(t.stops,m).forEach((function(e){return r.addColorStop(e.stop,asString(e.color))})),f.fillStyle=r,f.fillRect(0,0,u,d),0<u&&0<d&&(o=i.ctx.createPattern(y,"repeat"),i.renderRepeat(l,o,g,B))):isRadialGradient(t)&&(a=calculateBackgroundRendering(e,A,[null,null,null]),l=a[0],c=a[1],h=a[2],u=a[3],d=a[4],p=0===t.position.length?[FIFTY_PERCENT]:t.position,g=getAbsoluteValue(p[0],u),B=getAbsoluteValue(p[p.length-1],d),m=calculateRadius(t,g,B,u,d),f=m[0],y=m[1],0<f)&&0<y&&(C=i.ctx.createRadialGradient(c+g,h+B,0,c+g,h+B,f),processColorStops(t.stops,2*f).forEach((function(e){return C.addColorStop(e.stop,asString(e.color))})),i.path(l),i.ctx.fillStyle=C,f!==y?(w=e.bounds.left+.5*e.bounds.width,E=e.bounds.top+.5*e.bounds.height,I=1/(b=y/f),i.ctx.save(),i.ctx.translate(w,E),i.ctx.transform(1,0,0,b,0,0),i.ctx.translate(-w,-E),i.ctx.fillRect(c,I*(h-E)+E,u,d*I),i.ctx.restore()):i.ctx.fill()),U.label=6;case 6:return A--,[2]}}))},i=this,s=0,n=e.styles.backgroundImage.slice(0).reverse(),o.label=1;case 1:return s<n.length?(r=n[s],[5,t(r)]):[3,4];case 2:o.sent(),o.label=3;case 3:return s++,[3,1];case 4:return[2]}}))}))},A.prototype.renderSolidBorder=function(e,A,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(i){return this.path(parsePathForBorder(t,A)),this.ctx.fillStyle=asString(e),this.ctx.fill(),[2]}))}))},A.prototype.renderDoubleBorder=function(e,A,t,i){return __awaiter(this,void 0,void 0,(function(){var s;return __generator(this,(function(n){switch(n.label){case 0:return A<3?[4,this.renderSolidBorder(e,t,i)]:[3,2];case 1:return n.sent(),[2];case 2:return s=parsePathForBorderDoubleOuter(i,t),this.path(s),this.ctx.fillStyle=asString(e),this.ctx.fill(),s=parsePathForBorderDoubleInner(i,t),this.path(s),this.ctx.fill(),[2]}}))}))},A.prototype.renderNodeBackgroundAndBorders=function(e){return __awaiter(this,void 0,void 0,(function(){var A,t,i,s,n,r,o,a,l=this;return __generator(this,(function(c){switch(c.label){case 0:return this.applyEffects(e.getEffects(2)),A=e.container.styles,t=!isTransparent(A.backgroundColor)||A.backgroundImage.length,i=[{style:A.borderTopStyle,color:A.borderTopColor,width:A.borderTopWidth},{style:A.borderRightStyle,color:A.borderRightColor,width:A.borderRightWidth},{style:A.borderBottomStyle,color:A.borderBottomColor,width:A.borderBottomWidth},{style:A.borderLeftStyle,color:A.borderLeftColor,width:A.borderLeftWidth}],s=calculateBackgroundCurvedPaintingArea(getBackgroundValueForIndex(A.backgroundClip,0),e.curves),t||A.boxShadow.length?(this.ctx.save(),this.path(s),this.ctx.clip(),isTransparent(A.backgroundColor)||(this.ctx.fillStyle=asString(A.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(e.container)]):[3,2];case 1:c.sent(),this.ctx.restore(),A.boxShadow.slice(0).reverse().forEach((function(A){l.ctx.save();var t=calculateBorderBoxPath(e.curves),i=A.inset?0:MASK_OFFSET,s=transformPath(t,-i+(A.inset?1:-1)*A.spread.number,(A.inset?1:-1)*A.spread.number,A.spread.number*(A.inset?-2:2),A.spread.number*(A.inset?-2:2));A.inset?(l.path(t),l.ctx.clip(),l.mask(s)):(l.mask(t),l.ctx.clip(),l.path(s)),l.ctx.shadowOffsetX=A.offsetX.number+i,l.ctx.shadowOffsetY=A.offsetY.number,l.ctx.shadowColor=asString(A.color),l.ctx.shadowBlur=A.blur.number,l.ctx.fillStyle=A.inset?asString(A.color):"rgba(0,0,0,1)",l.ctx.fill(),l.ctx.restore()})),c.label=2;case 2:r=n=0,o=i,c.label=3;case 3:return r<o.length?0!==(a=o[r]).style&&!isTransparent(a.color)&&0<a.width?2!==a.style?[3,5]:[4,this.renderDashedDottedBorder(a.color,a.width,n,e.curves,2)]:[3,11]:[3,13];case 4:return c.sent(),[3,11];case 5:return 3!==a.style?[3,7]:[4,this.renderDashedDottedBorder(a.color,a.width,n,e.curves,3)];case 6:return c.sent(),[3,11];case 7:return 4!==a.style?[3,9]:[4,this.renderDoubleBorder(a.color,a.width,n,e.curves)];case 8:return c.sent(),[3,11];case 9:return[4,this.renderSolidBorder(a.color,n,e.curves)];case 10:c.sent(),c.label=11;case 11:n++,c.label=12;case 12:return r++,[3,3];case 13:return[2]}}))}))},A.prototype.renderDashedDottedBorder=function(e,A,t,i,s){return __awaiter(this,void 0,void 0,(function(){var n,r,o,a,l,c,h,u,d,p,g;return __generator(this,(function(B){return this.ctx.save(),l=parsePathForBorderStroke(i,t),n=parsePathForBorder(i,t),2===s&&(this.path(n),this.ctx.clip()),d=(isBezierCurve(n[0])?(r=n[0].start.x,n[0].start):(r=n[0].x,n[0])).y,a=(isBezierCurve(n[1])?(o=n[1].end.x,n[1].end):(o=n[1].x,n[1])).y,d=0===t||2===t?Math.abs(r-o):Math.abs(d-a),this.ctx.beginPath(),3===s?this.formatPath(l):this.formatPath(n.slice(0,2)),a=A<3?3*A:2*A,l=A<3?2*A:A,3===s&&(l=a=A),c=!0,d<=2*a?c=!1:d<=2*a+l?(a*=h=d/(2*a+l),l*=h):(h=Math.floor((d+l)/(a+l)),u=(d-h*a)/(h-1),l=(d=(d-(h+1)*a)/h)<=0||Math.abs(l-u)<Math.abs(l-d)?u:d),c&&(3===s?this.ctx.setLineDash([0,a+l]):this.ctx.setLineDash([a,l])),3===s?(this.ctx.lineCap="round",this.ctx.lineWidth=A):this.ctx.lineWidth=2*A+1.1,this.ctx.strokeStyle=asString(e),this.ctx.stroke(),this.ctx.setLineDash([]),2===s&&(isBezierCurve(n[0])&&(p=n[3],g=n[0],this.ctx.beginPath(),this.formatPath([new Vector(p.end.x,p.end.y),new Vector(g.start.x,g.start.y)]),this.ctx.stroke()),isBezierCurve(n[1]))&&(p=n[1],g=n[2],this.ctx.beginPath(),this.formatPath([new Vector(p.end.x,p.end.y),new Vector(g.start.x,g.start.y)]),this.ctx.stroke()),this.ctx.restore(),[2]}))}))},A.prototype.render=function(e){return __awaiter(this,void 0,void 0,(function(){var A;return __generator(this,(function(t){switch(t.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=asString(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),A=parseStackingContexts(e),[4,this.renderStack(A)];case 1:return t.sent(),this.applyEffects([]),[2,this.canvas]}}))}))},A}(Renderer),isTextInputElement=function(e){return e instanceof TextareaElementContainer||e instanceof SelectElementContainer||e instanceof InputElementContainer&&e.type!==RADIO&&e.type!==CHECKBOX},calculateBackgroundCurvedPaintingArea=function(e,A){switch(e){case 0:return calculateBorderBoxPath(A);case 2:return calculateContentBoxPath(A);default:return calculatePaddingBoxPath(A)}},canvasTextAlign=function(e){switch(e){case 1:return"center";case 2:return"right";default:return"left"}},iOSBrokenFonts=["-apple-system","system-ui"],fixIOSSystemFonts=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter((function(e){return-1===iOSBrokenFonts.indexOf(e)})):e},ForeignObjectRenderer=function(e){function A(A,t){return(A=e.call(this,A,t)||this).canvas=t.canvas||document.createElement("canvas"),A.ctx=A.canvas.getContext("2d"),A.options=t,A.canvas.width=Math.floor(t.width*t.scale),A.canvas.height=Math.floor(t.height*t.scale),A.canvas.style.width=t.width+"px",A.canvas.style.height=t.height+"px",A.ctx.scale(A.options.scale,A.options.scale),A.ctx.translate(-t.x,-t.y),A.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+t.width+"x"+t.height+" at "+t.x+","+t.y+") with scale "+t.scale),A}return __extends(A,e),A.prototype.render=function(e){return __awaiter(this,void 0,void 0,(function(){var A;return __generator(this,(function(t){switch(t.label){case 0:return A=createForeignObjectSVG(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,e),[4,loadSerializedSVG(A)];case 1:return A=t.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=asString(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(A,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}}))}))},A}(Renderer),loadSerializedSVG=function(e){return new Promise((function(A,t){var i=new Image;i.onload=function(){A(i)},i.onerror=t,i.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},Logger=function(){function e(e){var A=e.id;e=e.enabled;this.id=A,this.enabled=e,this.start=Date.now()}return e.prototype.debug=function(){for(var e=[],A=0;A<arguments.length;A++)e[A]=arguments[A];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.debug?console.debug.apply(console,__spreadArray([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var e=[],A=0;A<arguments.length;A++)e[A]=arguments[A];this.enabled&&"undefined"!=typeof window&&window.console&&"function"==typeof console.info&&console.info.apply(console,__spreadArray([this.id,this.getTime()+"ms"],e))},e.prototype.warn=function(){for(var e=[],A=0;A<arguments.length;A++)e[A]=arguments[A];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.warn?console.warn.apply(console,__spreadArray([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},e.prototype.error=function(){for(var e=[],A=0;A<arguments.length;A++)e[A]=arguments[A];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.error?console.error.apply(console,__spreadArray([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},e.instances={},e}(),Context=function(){function e(A,t){this.windowBounds=t,this.instanceName="#"+e.instanceCount++,this.logger=new Logger({id:this.instanceName,enabled:A.logging}),this.cache=null!=(t=A.cache)?t:new Cache(this,A)}return e.instanceCount=1,e}(),html2canvas=function(e,A){return renderElement(e,A=void 0===A?{}:A)},renderElement=("undefined"!=typeof window&&CacheStorage.setContext(window),function(e,A){return __awaiter(void 0,void 0,void 0,(function(){var t,i,s,n,r,o,a,l,c,h,u,d,p,g,B,m;return __generator(this,(function(f){switch(f.label){case 0:if(!e||"object"!=typeof e)return[2,Promise.reject("Invalid element provided as first argument")];if(!(p=e.ownerDocument))throw new Error("Element is not attached to a Document");if(t=p.defaultView)return g={allowTaint:null!=(g=A.allowTaint)&&g,imageTimeout:null!=(g=A.imageTimeout)?g:15e3,proxy:A.proxy,useCORS:null!=(g=A.useCORS)&&g},h=__assign({logging:null==(h=A.logging)||h,cache:A.cache},g),g={windowWidth:null!=(g=A.windowWidth)?g:t.innerWidth,windowHeight:null!=(g=A.windowHeight)?g:t.innerHeight,scrollX:null!=(g=A.scrollX)?g:t.pageXOffset,scrollY:null!=(g=A.scrollY)?g:t.pageYOffset},g=new Bounds(g.scrollX,g.scrollY,g.windowWidth,g.windowHeight),h=new Context(h,g),u=null!=(u=A.foreignObjectRendering)&&u,d={allowTaint:null!=(d=A.allowTaint)&&d,onclone:A.onclone,ignoreElements:A.ignoreElements,inlineImages:u,copyStyles:u},h.logger.debug("Starting document clone with size "+g.width+"x"+g.height+" scrolled to "+-g.left+","+-g.top),d=new DocumentCloner(h,e,d),(i=d.clonedReferenceElement)?[4,d.toIFrame(p,g)]:[2,Promise.reject("Unable to find element in cloned iframe")];throw new Error("Document is not attached to a Window");case 1:return s=f.sent(),d=isBodyElement(i)||isHTMLElement(i)?parseDocumentSize(i.ownerDocument):parseBounds(h,i),n=d.width,r=d.height,o=d.left,a=d.top,l=parseBackgroundColor(h,i,A.backgroundColor),B={canvas:A.canvas,backgroundColor:l,scale:null!=(g=null!=(p=A.scale)?p:t.devicePixelRatio)?g:1,x:(null!=(B=A.x)?B:0)+o,y:(null!=(B=A.y)?B:0)+a,width:null!=(B=A.width)?B:Math.ceil(n),height:null!=(B=A.height)?B:Math.ceil(r)},u?(h.logger.debug("Document cloned, using foreign object rendering"),[4,new ForeignObjectRenderer(h,B).render(i)]):[3,3];case 2:return c=f.sent(),[3,5];case 3:return h.logger.debug("Document cloned, element located at "+o+","+a+" with size "+n+"x"+r+" using computed rendering"),h.logger.debug("Starting DOM parsing"),m=parseTree(h,i),l===m.styles.backgroundColor&&(m.styles.backgroundColor=COLORS.TRANSPARENT),h.logger.debug("Starting renderer for element at "+B.x+","+B.y+" with size "+B.width+"x"+B.height),[4,new CanvasRenderer(h,B).render(m)];case 4:c=f.sent(),f.label=5;case 5:return null!=(m=A.removeContainer)&&!m||DocumentCloner.destroy(s)||h.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore"),h.logger.debug("Finished rendering"),[2,c]}}))}))}),parseBackgroundColor=function(e,A,t){var i=A.ownerDocument,s=i.documentElement?parseColor(e,getComputedStyle(i.documentElement).backgroundColor):COLORS.TRANSPARENT,n=i.body?parseColor(e,getComputedStyle(i.body).backgroundColor):COLORS.TRANSPARENT;e="string"==typeof t?parseColor(e,t):null===t?COLORS.TRANSPARENT:4294967295;return A===i.documentElement?isTransparent(s)?isTransparent(n)?e:n:s:e};const snapshotModule={setup(e){e.mixin({ui:{async getSnapshot(e,A){A=A||{};var t=(e=e||this.canvas.el).getBoundingClientRect().width,i=e.getBoundingClientRect().height;return(await html2canvas(e,{width:t,height:i,allowTaint:!0,taintTest:!1,useCORS:!0,logging:!1,...A,scrollY:0,scrollX:0})).toDataURL("image/png",1)}}})}},styleArr=["width","height","backgroundColor","backgroundImage","backgroundSize","opacity"],makeMap=e=>{const A={};return e.forEach((e=>{A[e]=!0})),A},hasStyleMap=makeMap(styleArr);class SprayToUI{constructor(){this.canvasSize={width:null,height:null},this.groupMap={},this.userData={}}transform(e){if(isType$1(e,"String"))try{e=JSON.parse(e)}catch(e){return log.warn("定义文件异常"),!1}if(!isType$1(e,"Object"))return log.warn("定义文件不符合要求"),!1;e=clone(e);var A=this.toCanvas(e);this.toConch(e.conchOptions,e.dataOptions),e=this.userData;return this.canvasSize.width=null,this.canvasSize.height=null,this.groupMap={},{scene:A,userData:e,version:1}}toCanvas(e){var A,t={type:"Canvas"};return"Canvas"===e.type&&(A=t.option=this.toOptions(e.option),this.canvasSize.width=A.style.width,this.canvasSize.height=A.style.height,delete A.style.top,delete A.style.left,isType$1(e.children,"Array")&&(t.children=e.children.map((e=>this.toLayer(e)))),this.toThingJs(t)),t}toThingJs(e){if(e.children){let i=[],s=(e.children.forEach(((A,t)=>{"ThingJSAdapter"===A.option.adapter&&i.push({index:t,thingJSContainer:A,prev:getLayer(e,t,-1),next:getLayer(e,t,1)})})),i.length-1);for(;0<=s;s--){var A=i[s],t=(e.children.splice(A.index,1),merge(A.thingJSContainer,{type:"DefaultContainer",option:{adapter:null}}));A.prev?A.prev.children.push(t):A.next?A.next.children.splice(0,0,t):e.children.push({type:"Layer",option:{id:"layer-"+t.option.id,lock:!0,name:"",style:{width:0,height:0,top:0,left:0}},children:[t]})}}}toLayer(e){const A={type:"Layer"};var t,i;return"Layer"!==e.type?null:(hasOwn(i=(t=A.option=this.toOptions(e.option)).style,"backgroundColor")||hasOwn(i,"backgroundImage")||"ThingJSAdapter"===t.adapter?(hasOwn(i,"width")&&"inherit"!==i.width||(i.width=this.canvasSize.width),hasOwn(i,"height")&&"inherit"!==i.height||(i.height=this.canvasSize.height)):(i.width=0,i.height=0),hasOwn(i,"top")||(i.top=0),hasOwn(i,"left")||(i.left=0),isType$1(e.children,"Array")&&e.children.forEach((e=>{A.children=this.toFree(e)})),A)}toFree(e){let A;return"Free"===e.type?this.toChildren(e.children):A}toChildren(e){const A=[];return isType$1(e,"Array")&&e.forEach((e=>{let t;"Group"===e.type&&(t=this.toGroup(e)),(t="FreeContainer"===e.type?this.toContainer(e):t)&&(e.option.groupId?this.groupMap[e.option.groupId].children:A).push(t)})),A}toGroup(e){var A=e.option.id;e={type:"Group",option:{id:A,name:e.option.name},children:[]};return this.groupMap[A]=e}toContainer(e){return{type:"Container",option:this.toOptions(e.option)}}toOptions(e){var A,t,i={id:e.id,name:e.name,lock:!0};return e.sceneAnimator&&(i.animation={},A=e.sceneAnimator.enter,t=e.sceneAnimator.leave,A&&(i.animation.enter=[A.name,A.duration]),t)&&(i.animation.leave=[t.name,t.duration]),e.style&&(i.style=this.toStyle(e.style),i.style.top=e.top||0,i.style.left=e.left||0),e.adapter&&e.adapter.type&&(i.adapter=this.toAdapter(e.adapter,e.id)),i}toAdapter(e,A){let t={};return"ConchAdapter"===e.type&&(t={type:"ConchAdapter",name:e.name,option:e.option}),"ThingJSAdapter"!==e.type&&(this.userData[A]=t),e.type}toStyle(e){const A={};return Object.entries(e).forEach((e=>{hasStyleMap[e[0]]&&(A[e[0]]=e[1])})),A}toConch(e={},A={}){Object.entries(e).forEach((e=>{var A=this.userData[e[0]];if(A&&"ConchAdapter"===A.type)try{A.opts=JSON.parse(e[1])}catch(A){log.warn(e[0]+" 的数据异常")}})),Object.entries(A).forEach((e=>{var A=this.userData[e[0]];if(A&&"ConchAdapter"===A.type)try{A.data=JSON.parse(e[1].staticData)}catch(A){log.warn(e[0]+" 的数据异常")}}))}}function getLayer(e,A,t){return function A(i){var s=e.children[i];if(s)return"ThingJSAdapter"!==s.option.adapter?s:A(i+t)}(A+t)}const sprayToUI=new SprayToUI,sprayToUIModule={setup(e){e.mixin({ui:{sprayToUI:e=>sprayToUI.transform(e)}})},ui:{beforeParseJSON(e,A){var t;A.version||(t=clone(A),t=this.sprayToUI(t),emptyObject(A),merge(A,t))}}};function emptyObject(e){if(!isType$1(e,"object"))return!1;var A;for(A of Object.keys(e))delete e[A];return!0}const defaultTagRE=/\{\{((?:.|\r?\n)+?)\}\}/g;function transformValue(value,params){if(value){let result=defaultTagRE.exec(value);for(;result;){let[e,A]=result;const t=params[A.trim()];t&&(value=value.replace(e,t)),result=defaultTagRE.exec(value)}return eval(value)}}const templateParser={setup(e){e.mixin({layer:{parserTemplate(A){if(Array.isArray(A)&&0<A.length){var{width:t,height:i}=this;const s={width:t,height:i};return A.map((A=>{var t=transformValue(A.width,s)||0,i=transformValue(A.height,s)||0,n=transformValue(A.top,s)||0,r=transformValue(A.left,s)||0;return new e.Container(this,{name:A.name||"",style:{top:n,left:r,width:t,height:i}})}))}}}})}};async function wait(e){return new Promise((A=>{setTimeout((()=>A(!0)),e)}))}UI.adapterManager.register("BaseAdapter",BaseAdapter$2),UI.adapterManager.register("ConchAdapter",ConchAdapter$1);class Command{constructor(e,A={}){this.options=A,this.params=null}async asyncExec(){try{const{result:e,params:A}=await this.options.exec();return this.params=A,e}catch(e){console.error("异步运行命令执行错误",e)}}exec(){try{const{result:e,params:A}=this.options.exec();return this.params=A,e}catch(e){console.error("运行命令执行错误",e)}}async undo(e){try{await this.options.undo(e,deepClone(this.params))}catch(e){console.error("撤销命令执行错误",e)}return this}async redo(e){try{await this.options.redo(e,deepClone(this.params))}catch(e){console.error("恢复命令执行错误",e)}return this}destroy(){return this.params=null,this.options=null,this}}class CommandManager{constructor(e){this.parent=e,this.state=null,this.index=null,this.isAdd=null,this._execRunning=null,this._undoRunning=null,this._redoRunning=null}init(){return this.state=[],this.index=0,this.isAdd=!0,this._execRunning=!0,this._undoRunning=!0,this._redoRunning=!0,this}_addState(e){this.index<this.state.length&&this.state.splice(this.index,this.state.length-this.index),this.state.push(e),this.index++}async asyncAdd(e){const A=new Command(this.parent,e);let t;return this._execRunning=!1,this.parent.$emit("CommandBeforeExec",A),this.isAdd&&!e.noAdd?(this.isAdd=!1,this._addState(A),t=await A.asyncExec(),this.parent.$emit("commandAdd",A),this.isAdd=!0):t=await A.asyncExec(),this._execRunning=!0,this.parent.$emit("CommandExec",A),t}add(e){const A=new Command(this.parent,e);let t;return this._execRunning=!1,this.parent.$emit("CommandBeforeExec",A),this.isAdd&&!e.noAdd?(this.isAdd=!1,this._addState(A),t=A.exec(),this.parent.$emit("commandAdd",A),this.isAdd=!0):t=A.exec(),this._execRunning=!0,this.parent.$emit("CommandExec",A),t}async undo(){if(this.canUndo()){this.isAdd=!1,this._undoRunning=!1,this.index--;const e=this.state[this.index];this.parent.$emit("commandBeforeUndo",e),await e.undo(this.parent),this._undoRunning=!0,this.isAdd=!0,this.parent.$emit("commandUndo",e)}return this}async redo(){if(this.canRedo()){this.isAdd=!1,this._undoRunning=!1;const e=this.state[this.index];this.parent.$emit("commandBeforeRedo",e),await e.redo(this.parent),this.index++,this._undoRunning=!0,this.isAdd=!0,this.parent.$emit("commandRedo",e)}return this}canAdd(){return this._execRunning}canUndo(){return this._undoRunning&&!!this.index&&this._execRunning}canRedo(){return this._redoRunning&&this.index!==this.state.length&&this._execRunning}clearCommand(){this.state.forEach((e=>e.destroy())),this.state=[],this.index=0}toLog(){return this.state.map((e=>deepClone(e.options.args)))}toLogStr(){return JSON.stringify(this.toLog(),((e,A)=>"handler"===e?A+"":A))}async recover(e=[],A=500){const t=this;console.log("恢复开始"),await async function i(s){const n=e[s];n&&await n.handler(t.parent,n),e[s+1]&&(await wait(A),await i(s+1))}(0),console.log("恢复完成")}async recoverByStr(e){await this.recover(JSON.parse(e,((e,A)=>"handler"===e?new Function(`return ${A}`)():A)))}clear(){return this.clearCommand(),this.parent.$emit("commandClear"),this}destroy(){return this.clearCommand(),this.isAdd=null,this.index=null,this.state=null,this.parent=null,this}}let _id=0;function getNewId(){return _id++}let Manager$1=class{constructor(e){this.parent=e,this.module=e.module,this.compMap=new Map,this.compUiIdMap=new Map,this.uiCompMap=new Map}getComp(e){return this.compMap.get(e)}getCompByUiId(e){return this.compUiIdMap.get(e)}addComp(e){this.compMap.set(e.$options.id,e),this.compUiIdMap.set(e.$options.options.option.id,e)}removeComp(e){this.compMap.delete(e.$options.id),this.compUiIdMap.delete(e.id)}getUiComp(e){return this.uiCompMap.get(e)}addUiComp(e,A){this.uiCompMap.set(e.$options.id,A)}removeUiComp(e){this.uiCompMap.delete(e.$options.id)}create(e){const A=this.module.getElement(e);if(A)return new A;console.error(e+"没有注册方法")}getType(e){return this.module.getElementType(e)}getAllChildren(e,A){const t=[];return function e(i=[]){i.forEach((i=>{e(i.children),A?i.type===A&&t.push(i):t.push(i)}))}(e.children),t}};function getDefaultValue(e,A){const t={top:"height",left:"width"},{minTypeValue:i,maxValue:s,maxSizeValue:n,allSizeValue:r}=e.reduce(((e,i)=>{const s=i[A],n=i[t[A]],r=s+n;return(null===e.minTypeValue||s<e.minTypeValue)&&(e.minTypeValue=s),(null===e.maxValue||r>e.maxValue)&&(e.maxValue=r),e.maxSizeValue<n&&(e.maxSizeValue=n),e.allSizeValue+=n,e}),{minTypeValue:null,maxValue:null,maxSizeValue:0,allSizeValue:0});if(s-i>n)return(s-i-r)/(e.length-1)}class Ui{constructor(){this.$events={elements:{},events:{}},this.$parent=null,this.$root=this,this.$manager=null,this.$adapterManager=null,this.$dataManager=null,this.$command=null,this.$canvas=null,this.$selectComponent=null,this.$selectLayer=null,this.$options={id:getNewId(),root:this,dom:null,manager:null,adapterManager:null,dataManager:null,status:null,isSelect:!0,isEdit:null,events:{element:{},events:{}},def:null,defOptions:null,options:null,config:null,rootConfig:null},this.canvasRadio=null,this.isUi=!0,this.mouseEvent=null,this.$mutual=null,this.rulerVisible=null,this.alignmentVisible=null,this.$jsCode=null,this.$bluePrint=null,this.$on("hook:selectLayer",this._updateSelectLayer,this)}_initBegin(e,A,t,i){const s=new DataManager(this,i.data);this.$parent=e,this.$manager=e.manager,this.$adapterManager=e.adapterManager,this.$options.rootConfig=i,this.$options.options=A,this.$options.config=t,this.$options.manager=e.manager,this.$options.adapterManager=e.adapterManager,this.$options.dataManager=s,this.$options.isEdit=e.isEdit,this.$options.status=!0,this.$options.dom=e.dom,this.$selectComponent=[],this.$selectLayer=null,this.rulerVisible=null,this.alignmentVisible=null,this.$dataManager=s,this.$mutual=new Mutual(this),this.$jsCode=new JsCode(this),this.$command=new CommandManager(this),this.$bluePrint=new BluePrintManager(this,i.Blueprint,i.BlueprintModules),this.$options.manager.addComp(this),this.$command.init(),this.$bluePrint.init()}_create(){this.$dataManager.init()}async _mount(){const e=new UI(this.$options.dom,this.$options.options.option,this.$options.config);this.$options.manager.addUiComp(this,e),this.$options.events=this._initEvent();const A=this.$ui.canvas.toJSON();this.$canvas=this.$manager.create(A.type),await this.$canvas.init(this,A),this.$canvas.select(),this.$canvas.$on("beforeDestroy",(()=>{this.$canvas=null})),this.$dataManager.start(),this._initUiEvent()}_initEnd(){this.$options.isEdit&&(this._updateRulerState(),this._updateAlignmentState()),this.$command.clear()}async init(e,A,t,i){return e.dom?(this.$options.status?console.warn("当前状态无法初始化"):(this._initBegin(e,A,t,i),this.$emit("beforeCreate",this),this.$emit("beforeCreate:Ui",this),this._create(),this.$emit("created",this),this.$emit("created:Ui",this),await this._mount(),this.$emit("mounted",this),this.$emit("mounted:Ui",this),this._initEnd()),this):console.error("dom 无效")}_initUiEvent(){const e=this.$uiComp;e.keyMap&&(e.keyMap.register({name:"编组选中对象",code:"Control+KeyG",fn:()=>{}}),e.keyMap.register({name:"取消编组",code:"Control+Shift+KeyG",fn:()=>{}}),e.keyMap.register({name:"重做",code:"Control+KeyY",fn:()=>{}}),e.keyMap.register({name:"取消",code:"Control+KeyZ",fn:()=>{}}),e.keyMap.register({name:"取消",code:"Escape",fn:()=>{}}),e.keyMap.register({name:"删除选中对象",code:"Delete",fn:()=>{}}),e.keyMap.register({name:"编辑文本内容",code:"Enter",fn:()=>{}}))}_update(e,A,t){return this.$emit("update",this,e,A,t),this}_updateContextmenu(e,A){this.$emit("updateContextmenu",e,A)}_updateSelectLayer(e){this.$selectLayer=e}play(e){return this.$ui.play(e),this}edit(){return this.$ui.edit(),this}sprayToUIDef(e){return this.$ui.sprayToUI(e)}toJSON(){const e=JSON.parse(this.$uiComp.toJSON()),A=this.$canvas.toJSON(),t={},i={};return function e(A){const{children:s,option:n,kpOption:r}=A;n.adapter&&(t[n.id]=n.adapter,n.adapter=n.adapter.type),r&&(i[n.id]=r,delete A.kpOption),s&&s.forEach((A=>{e(A)}))}(A),isEmpty$1(e.scene.hideAllLine)||(A.hideAllLine=e.scene.hideAllLine),isEmpty$1(e.scene.lines)||(A.lines=e.scene.lines),{scene:A,userData:t,kpUserData:i,version:1,kpVersion:1}}async parseJSON(e,A={}){this.$emit("beforeParseJSON",this,e),this.$dataManager.stop(),this.$canvas&&this.$canvas.destroy(),this.$dataManager.clear(),this.$options.def=deepClone$1(e),this.$options.defOptions=deepClone$1(A);const t=transformKpOptionDef(e);return await this.$ui.parseJSON(deepClone$1(t)),this.$canvas=this.$manager.create(t.scene.type),await this.$canvas.init(this,t.scene),this.$dataManager.start(),this._loadExtends(),this.$emit("parseJSONed",this,t),this.$canvas}_loadExtends(){const e=this.$options.defOptions;this.$options.isEdit||(this.$bluePrint.run(e.bluePrint),this.$jsCode.run(e.jsCode))}updateCompsAttrs(e=[]){e.forEach((e=>e.comp.updateAttrs(e.attrs)))}async updateAdapters(e=[],A={}){const t=[],i=[];return e.forEach((e=>{e.comp.adapter?i.push(e):t.push(e.comp.id)})),t.length&&console.warn("空图表无法更新适配器 ",t.join(",")),Promise.all(i.map((e=>e.comp.updateAdapter(e.option))))}dismissGroups(e=[]){const A=[],t=[];return e.forEach((e=>{"Group"===e.type?t.push(e):A.push(e)})),A.length&&console.warn("非编组无法解散 "+A.join(",")),t.forEach((e=>e.dismiss())),this}destroyComps(e=[]){return e.forEach((e=>e.destroy())),this}_updateSelect(){if(!this.$options.isSelect)return;this.$ui.insidePreview&&this.$ui.exitInsidePreview();const e=this.$ui.selector.getSelectElements();!e.length&&this.$canvas&&e.push(this.$canvas.$uiComp),this.__updateSelect(e.map((e=>e.__DIAGRAM__)))}__updateSelect(e=[]){this.$selectComponent.filter((A=>!e.find((e=>e===A)))).forEach((e=>{e.$options.status&&e._updateSelect(!1)})),e.forEach((e=>{e.isSelected||e._updateSelect(!0)})),this.$selectComponent=e,this.$emit("updateSelectComponent",e)}select(e){if(Array.isArray(e)||(e=[e]),e.length){const A=e.filter((e=>"Canvas"===e.type))[0];A?A.select():this.$ui.selector.select(e.map((e=>e.$uiComp)))}else console.warn("没有需要选择的节点");return this}unSelect(e){Array.isArray(e)||(e=[e]),this.$ui.selector.unselect(e.map((e=>e.$uiComp)))}alignTo(e,A){this.$ui.alignTo(e,A.map((e=>e.$uiComp)));const t=A.flatMap((e=>"Group"===e.type?e.containers:[]));A.concat(t).forEach((e=>{e.$updateAttr("top").$updateAttr("left")}))}equidistant(e,A,t=null){if(!Array.isArray(A))return;const i={top:"height",left:"width"};null===t&&(t=getDefaultValue(A,e)),null!==t&&(A.sort(((A,t)=>A[e]-t[e])),A.forEach(((s,n)=>{if(n&&n!==A.length-1){const r=A[n-1],o=r[e]+r[i[e]]+t;s[e]=o}})))}_updateRulerState(){try{this.rulerVisible=this.$ui.el.contains(this.$ui.ruler._elObject.ruler)}catch(e){console.warn("更新标尺状态错误",e)}}enableRuler(){try{this.$ui.ruler.enable()}catch(e){console.warn("启用标尺错误",e)}return this._updateRulerState(),this}disableRuler(){try{this.$ui.ruler.disable()}catch(e){console.warn("禁用标尺错误",e)}return this._updateRulerState(),this}_updateAlignmentState(){try{this.alignmentVisible=!!Array.from(this.$ui.canvas.el.children).find((e=>e.dataset&&"alignment"===e.dataset.id))}catch(e){console.warn("更新对齐线状态错误",e)}}enableAlignment(){try{this.$ui.enableAlignment()}catch(e){console.warn("启用对齐线错误",e)}return this._updateAlignmentState(),this}disableAlignment(){try{this.$ui.disableAlignment()}catch(e){console.warn("禁用对齐线错误",e)}return this._updateAlignmentState(),this}getUid(e){const A=e.toLowerCase()+"-"+window.Math.random().toString(24).slice(-10);return this.$ui.query("#"+A)?this.getUid(e):A}queryById(e){return this.$options.manager.getCompByUiId(e)}$queryById(e){return this.queryById(e)}$addEventListener(e,A,t,i){return addEventListener(this,e,A,t,i)}$removeEventListener(e,A,t,i){return removeEventListener(this,e,A,t,i)}$on(e,A,t){return on(this,e,A,t)}$once(e,A,t){return once(this,e,A,t)}$off(e,A,t){return off(this,e,A,t)}$emit(e,...A){return emit(this,e,A)}async $syncEmit(e,...A){return syncEmit(this,e,A)}$startSelect(){return this.$options.isSelect=!0,this}$pauseSelect(){return this.$options.isSelect=!1,this}enterInsidePreview(e){this.$ui.enterInsidePreview(e.$uiComp)}exitInsidePreview(){this.$ui.exitInsidePreview()}_initEvent(){const e=this.$ui,A=e=>{},t=e=>{},i=e=>{this._updateSelect()},s=()=>{},n=()=>{},r=e=>{const A=e.app;let t;"mtext"===A.tag?t=A.data||A.opts.content:"text"===A.tag&&(t=A.data.content),e.readyTextEdit(t)},o=()=>{this.$parent.state.textEditing=!0,this.$parent.state.contextMenuRunning=!1},a=(e,A)=>{const t=A.app;let i;"mtext"===t.tag?i=e:"text"===t.tag&&(i={...deepClone$1(t.data),content:e}),A.__DIAGRAM__.adapter.updateSourceData("staticData",i),this.$parent.state.textEditing=!1,this.$parent.state.contextMenuRunning=!0},l=e=>{this.$emit("enterInsidePreview",e.__DIAGRAM__)},c=()=>{this.$emit("exitInsidePreview")},h=()=>{this.$canvas&&this.$parent.state.enableCanvasZoom&&this.$emit("hook:uiCanvasZoom")&&this.$emit("uiCanvasZoom")};let u=null;const d=()=>{u=new Map;const e=e=>{u.has(e.id)||u.set(e.id,{comp:e,top:e.top,left:e.left})};this.$selectComponent.forEach((A=>{"Group"===A.type&&A.containers.forEach(e),e(A)}))},p=e=>{e.$updateAttr("top"),e.$updateAttr("left")},g=()=>{this.$selectComponent.forEach(p)},B=()=>{const e=new Map;this.$selectComponent.forEach((A=>{"Group"===A.type?(A.groups.forEach(p),A.containers.forEach(p)):"Group"===A.$parent.type&&p(A.$parent),p(A),function(A){if(e.has(A.id))return;const t=u.get(A.id);e.set(A.id,{comp:A,attrs:[{name:"top",value:A.top,oldValue:t.top},{name:"left",value:A.left,oldValue:t.left}]})}(A)})),this.updateCompsAttrs(Array.from(e.values())),e.clear(),u=null};let m=null;const f=()=>{function e(e){m.has(e.id)||m.set(e.id,{comp:e,width:e.width,height:e.height,left:e.left,top:e.top})}m=new Map,this.$selectComponent.forEach((A=>{"Group"===A.type?A.containers.forEach(e):e(A)}))},y=e=>{e.$updateAttr("width"),e.$updateAttr("height"),e.$updateAttr("top"),e.$updateAttr("left")},C=()=>{this.$selectComponent.forEach(y)},w=()=>{const e=new Map;function A(A){if(e.has(A.id))return;const t=m.get(A.id);e.set(A.id,{comp:A,attrs:[{name:"top",value:A.top,oldValue:t.top},{name:"left",value:A.left,oldValue:t.left},{name:"width",value:A.width,oldValue:t.width},{name:"height",value:A.height,oldValue:t.height}]})}this.$selectComponent.forEach((e=>{"Group"===e.type?(e.containers.forEach((e=>{y(e),A(e)})),e.groups.forEach(y),y(e)):(y(e),A(e))})),this.updateCompsAttrs(Array.from(e.values())),m=null,e.clear()},E=()=>{const e=[];this.$selectComponent.forEach((A=>{const t=A.rotate;A.$updateAttr("rotate"),e.push({comp:A,attrs:[{name:"rotate",value:A.rotate,oldValue:t}]})})),this.updateCompsAttrs(e)},b=()=>{},I=()=>{this.$emit("rulerChange")},U=({parent:e})=>{e.app&&["mtext","text"].includes(e.app.tag)&&e.openTextEdit();const A=e.__DIAGRAM__;A&&this.$emit("hook:componentComplete",A)},T=e=>{e.__DIAGRAM__.$updateAttr("visible")},Q=e=>{e.__DIAGRAM__.$updateAttr("visible")},v=A=>{A.currentTarget===e.el?this.mouseEvent=A:this.mouseEvent=null},F=()=>{this.mouseEvent=null},_=()=>{this.$emit("resize",this)},S=e=>{this.$options.isEdit&&this.$root.$parent.canShortcutKey&&("Enter"===e.key?document.activeElement===document.body&&(e.preventDefault(),this.$uiComp.enterTextEdit()):"Escape"===e.key&&(document.activeElement===document.body||this.$el.contains(document.activeElement))&&this.$uiComp.exitTextEdit())};return e.on("select",A),e.on("unselect",t),e.on("selectElements",i),e.on("graphRegionSelectStart",s),e.on("graphRegionSelectEnd",n),e.on("beforeTextEdit",r),e.on("inTextEdit",o),e.on("afterTextEdit",a),e.on("enterInsidePreview",l),e.on("exitInsidePreview",c),e.on("canvasZoom",h),e.on("graphMoveStart",d),e.on("graphMoving",g),e.on("graphMoveEnd",B),e.on("graphResizeStart",f),e.on("graphResizing",C),e.on("graphResizeEnd",w),e.on("graphRotateEnd",E),e.on("delete",b),e.on("rulerChange",I),e.on("componentComplete",U),e.on("afterShow",T),e.on("afterHidden",Q),e.el.addEventListener("mousemove",v),e.el.addEventListener("mouseleave",F),window.addEventListener("resize",_),window.addEventListener("keydown",S),()=>{e.off("select",A),e.off("unselect",t),e.off("selectElements",i),e.off("graphRegionSelectStart",s),e.off("graphRegionSelectEnd",n),e.off("beforeTextEdit",r),e.off("inTextEdit",o),e.off("afterTextEdit",a),e.off("enterInsidePreview",l),e.off("exitInsidePreview",c),e.off("canvasZoom",h),e.off("graphMoveStart",d),e.off("graphMoving",g),e.off("graphMoveEnd",B),e.off("graphResizeStart",f),e.off("graphResizing",C),e.off("graphResizeEnd",w),e.off("graphRotateEnd",E),e.off("delete",b),e.off("rulerChange",I),e.off("componentComplete",U),e.off("afterShow",T),e.off("afterHidden",Q),e.el.removeEventListener("mousemove",v),e.el.removeEventListener("mouseleave",F),window.removeEventListener("resize",_),window.removeEventListener("keydown",S)}}transformDef(e){return transform$2(this.$ui,e)}_destroyBegin(){return this}_destroy(){this.$dataManager.destroy(),this.$mutual.destroy(),this.$jsCode.destroy(),this.$bluePrint.destroy(),this.$options.manager.removeComp(this)}_destroyEnd(){return this.$jsCode=null,this.$bluePrint=null,this.$mutual=null,this.$dataManager=null,this.alignmentVisible=null,this.rulerVisible=null,this.$selectLayer=null,this.$selectComponent=null,this.$adapterManager=null,this.$manager=null,this.$parent=null,this.$options.rootConfig=null,this}destroy(){return this._destroyBegin(),this._destroy(),this._destroyEnd(),this}get $ui(){return this.$options.manager.getUiComp(this.$options.id)}get $uiComp(){return this.$options.manager.getUiComp(this.$options.id)}get $el(){return this.$uiComp.el}}function getter(e){return e.get?e.get():e.value}function setter(e,A,t){if(!A.set)return;const i=e[A.name];if(i===t)return;const{setBefore:s,setAfter:n}=A.option;s&&s(),e._updateAttr(A,t,deepClone$1(i)),n&&n()}let Base$1=class{constructor(){this.$options={rootConfig:null,options:null,config:null,kpOption:null,children:null,parent:null,root:null,elm:null,manager:null,adapterManager:null,dataManager:null,id:getNewId(),type:null,status:null,attrs:{},isBeingDestroyed:null,isDestroyed:null,isEdit:null,events:null},this.$parent=null,this.$root=null,this.$canvas=null,this.adapter=null,this.children=null,this.$complete=null,this.$events={elements:{},events:{}},this._beforeInit()}_registerAttr(e,A,t,i,s,n={}){if(this.$options.status)console.warn("当前状态不允许注册属性");else if(this.$options.attrs[e])console.warn(`${e} 已被注册`);else{const r={name:e,value:A,init:t,get:i,set:s,option:n};this.$options.attrs[e]=r,Object.defineProperty(this,e,{enumerable:!0,configurable:!0,get:()=>getter(r),set(e){setter(this,r,e)}})}return this}_removeAttr(e){return this.$options.status?console.warn("当前状态不允许移除属性"):(delete this.$options.attrs[e],delete this[e]),this}_beforeInit(){return initAttrs$1(this),this}async init(e,A={},t={}){return this.$options.status?console.warn("节点已被初始化过"):(this.$options.status="beforeCreate",this._initBegin(e,A,t),this.$emit("beforeCreate",this),this.$root.$emit("beforeCreate",this),this.$emit("beforeCreate:"+this.$options.type,this),this.$root.$emit("beforeCreate:"+this.$options.type,this),this._create(),this.$options.status="created",this.$emit("created",this),this.$root.$emit("created",this),this.$emit("created:"+this.$options.type,this),this.$root.$emit("created:"+this.$options.type,this),await this._mount(),this.$options.status="mounted",this.$emit("mounted",this),this.$root.$emit("mounted",this),this.$emit("mounted:"+this.$options.type,this),this.$root.$emit("mounted:"+this.$options.type,this),this._initEnd()),this}_initBegin(e,A,t){return this.$options.rootConfig=e.$options.rootConfig,this.$options.options=A,this.$options.config=t,this.$options.kpOption=A.kpOption||{},this.$options.parent=e,this.$options.root=e.$root,this.$options.manager=e.$options.manager,this.$options.adapterManager=e.$options.adapterManager,this.$options.dataManager=e.$options.dataManager,this.$options.type=e.$options.manager.getType(this),this.$options.isDestroyed=null,this.$options.isEdit=e.$options.isEdit,this.$parent=e,this.$root=e.$root,this.$canvas=e.$root.$canvas,this.$options.manager.addComp(this),this.children=[],this.$complete=!1,this}_create(){return this}_updateChildren(e){return this.$emit("updateChildren",this),this.$root.$emit("updateChildren",this),this._update("children",this.children,e),this}_initEvent(){return this}_destroyEvent(){return this}_initCompCreateUi(){const e=this.$options;if(UI[e.type])return new UI[e.type](this.$parent.$uiComp,e.options?.option);console.warn(`ThingUi没有${e.type}方法`)}_initComp(){let e;return this.$options.options?.option?.id&&(e=this.$ui.query("#"+this.$options.options.option.id)),e||(e=this._initCompCreateUi()),e||console.warn("没有ui实例"),this.$options.manager.addUiComp(this,e),e.__DIAGRAM__=this,this.$options.elm=e.el,this.$emit("elementMounted",this),this.$root.$emit("elementMounted",this),this.$emit("elementMounted:"+this.$options.type,this),this.$root.$emit("elementMounted:"+this.$options.type,this),this}_destroyComp(){delete this.$uiComp.__DIAGRAM__;try{this.$uiComp.destroy()}catch(e){console.warn(e)}return this.$options.manager.removeUiComp(this),this}async _initChildren(){const e=this.$options.options.children||[];for(const A of e){let e=A.type;"Layer"===e&&A.kpOption?._kp3DLayer&&(e="ThingJSLayer"),"DefaultContainer"===e&&(e="Container");const t=this.$options.manager.getCompByUiId(A.option.id);t&&t.$options.status?console.warn("节点初始化已经完成了"):await this.$options.manager.create(e).init(this,A)}return this}async _mount(){return this._initComp(),this._initEvent(),this.$updateAttrs(),this._initUiEvents(),this._initAddParent(),await this._initChildren(),this}_initUiEvents(){return this.$uiComp.on&&this.$uiComp.on("contextmenu",this._updateContextmenuEvent,{comp:this,preventDefault:!1,stopPropagation:!1}),this}_initAddParent(){const e=this.$options.config.nextComp;if(e){const A=e.$ranking;this.$parent._spliceChildren&&this.$parent._spliceChildren(A,0,this)}else this.$parent._addChildren&&this.$parent._addChildren(this);return this}_initEnd(){return this.$complete=!0,this}_updateContextMenuGroupEvent(e,A){const t=e.$root.$selectComponent,i=e.$rootGroup;if(i){const s=getParentSelectGroup(e);s?s.$root._updateContextmenu(t,A):(i.select(!0),i.$root._updateContextmenu([i],A))}else e.select(!0),e.$root._updateContextmenu([e],A)}_updateContextmenuEvent(e){const{comp:A}=this;if(A.$options.isEdit&&A.$root.$parent.state.contextMenuRunning){const t=A.type;"Container"===t?A.isSelected?A.$root._updateContextmenu(A.$root.$selectComponent,e):A._updateContextMenuGroupEvent(A,e):"Layer"===t&&(A.$parent.select(),A.$root._updateContextmenu([A.$parent],e))}}_spliceChildren(e,A,...t){const i=[...this.children];let s=e;s>=i.length&&(s=i.length),A&&(this.children.splice(s,A),this._updateChildren(i)),t.length&&(this.children.splice(s,0,...t),this._updateChildren(i))}_addChildren(...e){const A=[...this.children];this.children.push(...e),this._updateChildren(A)}$addEventListener(e,A,t,i){return addEventListener(this,e,A,t,i),this}$removeEventListener(e,A,t,i){return removeEventListener(this,e,A,t,i),this}$on(e,A,t){return on(this,e,A,t),this}$once(e,A,t){return once(this,e,A,t),this}$off(e,A,t){return off(this,e,A,t),this}$emit(e,...A){return emit(this,e,A),this}_updateAttr(e,A,t){return e.value=e.set(A),this._update(e.name,A,t),this}_update(e,A,t){return this.$emit("update",this,e,A,t),this.$root.$emit("update",this,e,A,t),this}updateAttrs(e=[]){return e.forEach((e=>{this[e.name]=e.value})),this}$updateAttrs(){return Object.keys(this.$options.attrs).forEach((e=>{this.$updateAttr(e)})),this}$updateAttr(e){const A=this.$options.attrs[e];if(A&&A.init){const e=deepClone$1(A.value),t=A.init();t!==e&&(A.value=t,this._update(A.name,t,e))}return this}_updateSelect(e){const A=this.$options.attrs.isSelected,t=A.value;return e!==t&&(A.value=e,this._update(A.name,e,t),e?(this.$emit("select",this),this.$root.$emit("select",this)):(this.$emit("unSelect",this),this.$root.$emit("unSelect",this))),this}toJSON(){const e=this.$uiComp.toJSON(),{name:A,id:t,type:i,isLock:s,visible:n,top:r,left:o,width:a,height:l,backgroundColor:c,backgroundImage:h}=this,u={position:e.option.style.position,top:r,left:o,width:a,height:l,backgroundColor:c};h&&(u.backgroundImage=h);return{option:{id:t,name:A,isLock:s,visible:n,ignoreRendering:e.option.ignoreRendering,style:u},kpOption:{},type:i,children:this.children.map((e=>e.toJSON()))}}showOverComp(){return this.$ui.operation.showSubRect(this.$uiComp.bound,this.$uiComp),this}hiddenOverComp(){return this.$ui.operation.hideSubRect(),this}select(e=!1){return e&&this!==this.$canvas&&(1===this.$root.$selectComponent.length&&this.$root.$selectComponent[0]===this.$canvas||this.$canvas.select()),this.isSelected||(this.isSelected=!0),this}unSelect(){return this.isSelected&&(this.isSelected=!1),this}selectAll(){return this.$root.select(this.children),this}show(){return this.visible||(this.visible=!0),this}hidden(){return this.visible&&(this.visible=!1),this}moveToTarget(e,A){if(this.$uiComp.moveToTarget(e.$uiComp,A),this._deletePaternity(),A){let t=e.$parent.children.findIndex((A=>A===e));"after"===A&&t++,e.$parent._spliceChildren(t,0,this)}else e._addChildren(this);return A?(this.$parent=e.$parent,this.$options.parent=e.$options.parent):(this.$parent=e,this.$options.parent=e),this.$emit("moveToTarget",this),this.$root.$emit("moveToTarget",this),this}clear(){return this.children.forEach((e=>e.destroy())),this}async _toImage(e,A){const t="data:image/jpeg;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=";if(!this.width||!this.height)return t;const i={backgroundColor:"#282A2E",width:this.width,height:this.height};let s;Object.assign(i,e,{onclone(e){const t=e.body,i=e.querySelector(`[${A}]`);if(i){i.style.transform="";[...t.childNodes].forEach((e=>e.remove())),t.appendChild(i)}},ignoreElements:e=>{const A=document.body,t=this.$root.$el;if(A.contains(e)&&!t.contains(e)&&!e.contains(t))return!0;if(["VIDEO","IMG","CANVAS"].includes(e.nodeName)){const A=document.createElement("canvas");A.width=e.offsetWidth,A.height=e.offsetHeight;const t=A.getContext("2d");try{t.drawImage(e,0,0,A.width,A.height),t.getImageData(0,0,A.width,A.height)}catch(e){return!0}}}});try{s=await this.$ui.getSnapshot(this.$el,i)}catch(e){console.warn("截图失败",e),s=t}return s}async toImage(e={}){this.$emit("beforeToImage",this),this.$root.$emit("beforeToImage",this),this.$canvas.select();const A=getNodeOnlyAttr("canvas-image-dom",!0);this.$canvas.$el.setAttribute(A,""),await this.$ui.nextTick();const t=await this._toImage(e,A);return this.$canvas.$el.removeAttribute(A),this.$emit("toImaged",this),this.$root.$emit("toImaged",this),t}_deletePaternity(){if("Canvas"===this.$options.type)this.$parent.$canvas=null;else{const e=this.$parent.children.findIndex((e=>e===this));~e&&this.$parent._spliceChildren(e,1)}return this}_destroyBegin(){return this.$complete=null,this.$options.isBeingDestroyed=!0,this.$options.status=null,this}_destroyUiEvents(){return this.$uiComp.off&&this.$uiComp.off("contextmenu",this._updateContextmenuEvent,{comp:this,preventDefault:!1,stopPropagation:!1}),this}_destroy(){this._destroyUiEvents();if([...this.children].forEach((e=>{e.destroy()})),this._destroyComp(),this.$parent.children){const e=this.$parent.children.findIndex((e=>e===this));~e?this.$parent._spliceChildren(e,1):console.warn("已经从父节点销毁了")}return this.$options.manager.removeComp(this),"Group"===this.$parent.type&&!this.$parent.children.length&&this.$parent.$options.status&&this.$parent.destroy(),this}_destroyEnd(){return this._destroyEvent(),this.$options.isBeingDestroyed=null,this.$options.isDestroyed=!0,this.$options.rootConfig=null,this.$options.options=null,this.$options.config=null,this.$options.kpOption=null,this.$options.children=null,this.$options.parent=null,this.$options.root=null,this.$options.elm=null,this.$options.manager=null,this.$options.adapterManager=null,this.$options.dataManager=null,this.$options.events=null,this.$parent=null,this.$root=null,this.$canvas=null,this.adapter=null,this.children=null,this.$events={elements:{},events:{}},this}destroy(){return this.$options.isBeingDestroyed?console.warn("节点正在销毁"):this.$options.isDestroyed?console.warn("节点已经销毁"):(this._destroyBegin(),this.$emit("beforeDestroy",this),this.$root.$emit("beforeDestroy",this),this.$emit("beforeDestroy:"+this.$options.type,this),this.$root.$emit("beforeDestroy:"+this.$options.type,this),this._destroy(),this.$emit("destroyed",this),this.$root.$emit("destroyed",this),this.$emit("destroyed:"+this.$options.type,this),this.$root.$emit("destroyed:"+this.$options.type,this),this._destroyEnd()),this}next(){return this.$next}prev(){return this.$prev}get $el(){return this.$uiComp.el}get $uiComp(){return this.$options.manager.getUiComp(this.$options.id)}get $ui(){return this.$root.$uiComp}get $next(){let e=null;if(this.$parent?.children){const A=this.$parent.children.findIndex((e=>e===this));~A&&(e=this.$parent.children[A+1])}return e}get $prev(){let e=null;if(this.$parent?.children){const A=this.$parent.children.findIndex((e=>e===this));~A&&(e=this.$parent.children[A-1])}return e}get $ranking(){return this.$parent?.children.findIndex((e=>e===this))}get $realVisible(){return getParentVisible(this)}get $dataAdapterRealVisible(){return!!this.adapter.$dataAdapter&&(this.$options.isEdit?this.$realVisible:this.$parent.$realVisible)}get $nextSibling(){return this.$parent.children.slice(this.$parent.children.findIndex((e=>e===this)))}get $prevSibling(){return this.$parent.children.slice(0,this.$parent.children.findIndex((e=>e===this))-1)}get $sibling(){return this.$parent.children.filter((e=>e!==this))}};function getParentVisible(e){return"Canvas"===e.type?e.visible:e.visible?getParentVisible(e.$parent):e.visible}function initAttrs$1(e){e._registerAttr("id",null,(function(){return e.$uiComp.id}))._registerAttr("name",null,(function(){return e.$uiComp.name}),null,(function(A){return e.$uiComp.name=A,A}))._registerAttr("type",null,(function(){return e.$uiComp.type}))._registerAttr("isSelected",null,(function(){return e.$uiComp.isSelected}),null,(function(A){return A?(e.$ui.selector.select(e.$uiComp),e.$emit("select",this),e.$root.$emit("select",this)):(e.$uiComp.unselect(),e.$emit("unSelect",this),e.$root.$emit("unSelect",this)),A}),{noAdd:!0})._registerAttr("isLock",null,(function(){return e.$uiComp.lock}),null,(function(A){return e.$uiComp.lock=A,A}),{setAfter:()=>{"Group"===e.$parent.type&&e.$parent.$updateAttr("isLock")}})._registerAttr("visible",null,(function(){return e.$uiComp.visible}),null,(function(A){return e.$uiComp.setVisible(!!A),A}))._registerAttr("top",null,(function(){return e.$uiComp.top}),null,(function(A){return e.$uiComp.top=A,A}),{setAfter:()=>{"Group"===e.$parent.type&&e.$parent.$updateAttr("top")}})._registerAttr("left",null,(function(){return e.$uiComp.left}),null,(function(A){return e.$uiComp.left=A,A}),{setAfter:()=>{"Group"===e.$parent.type&&e.$parent.$updateAttr("left")}})._registerAttr("width",null,(function(){return e.$uiComp.width}),null,(function(A){return e.$uiComp.width=A,A}),{setAfter:()=>{"Group"===e.$parent.type&&e.$parent.$updateAttr("width")}})._registerAttr("height",null,(function(){return e.$uiComp.height}),null,(function(A){return e.$uiComp.height=A,A}),{setAfter:()=>{"Group"===e.$parent.type&&e.$parent.$updateAttr("height")}})._registerAttr("rotate",null,(function(){return transformRotate(e.$uiComp.rotate)}),null,(function(A){const t=transformRotate(A);return e.$uiComp.setRotate(t),t}))._registerAttr("backgroundColor",null,(function(){return e.$uiComp.style.backgroundColor}),null,(function(A){return e.$uiComp.style.backgroundColor=A,A}))._registerAttr("backgroundImage",null,(function(){return e.$uiComp.style.backgroundImage||""}),null,(function(A){return e.$uiComp.style.backgroundImage=A,A}))._registerAttr("animation",null,(function(){return deepClone$1(e.$uiComp.animation)}),null,(function(A){const{enter:t,leave:i}=deepClone$1(A)||[];return e.$uiComp.setAnimation("enter",t),e.$uiComp.setAnimation("leave",i),A}))}function getParentSelectGroup(e){return function e(A){if("Group"===A.type)return A.isSelected?A:e(A.$parent)}(e.$parent)}function transformRotate(e){const A=e%360;return A<0?A+360:A}function removeUdatavBackground(e){const{$uiComp:A}=e;A.style.background&&(A.el.style.background="",delete A.style._style.background)}class Canvas extends Base$1{_beforeInit(){super._beforeInit();const e=this;return this.isCanvas=!0,e._removeAttr("rotate")._removeAttr("isSelected")._removeAttr("top")._removeAttr("left")._removeAttr("backgroundColor")._removeAttr("backgroundImage")._removeAttr("width")._removeAttr("height")._registerAttr("backgroundColor",null,(function(){return e.$uiComp.style.backgroundColor}),null,(function(A){return removeUdatavBackground(e),e.$uiComp.style.backgroundColor=A,A}))._registerAttr("backgroundImage",null,(function(){return e.$uiComp.style.backgroundImage||""}),null,(function(A){return removeUdatavBackground(e),e.$uiComp.style.backgroundImage=A,A}))._registerAttr("scaleMode",null,(function(){return e.$ui.getScaleMode()}),null,(function(A){return e.$ui.setScaleMode(A),A}))._registerAttr("canvasZoom",null,(function(){return e.$uiComp.getZoom()}),null,(function(A){return e.$uiComp.setZoom(A),A}))._registerAttr("isSelected",null,null,null,(function(A){return A?(e.$ui.selector.clear(),e.$emit("select",e),e.$root.$emit("select",e)):(e.$emit("unSelect",e),e.$root.$emit("unSelect",e)),e.$parent._updateSelect(),A}),{noAdd:!0})._registerAttr("width",null,(function(){return e.$uiComp.width}),null,(function(A){return e.$uiComp.width=A,e._initLayerSize(),A}))._registerAttr("height",null,(function(){return e.$uiComp.height}),null,(function(A){return e.$uiComp.height=A,e._initLayerSize(),A})),e._registerAttr("filters",null,(function(){return e.$uiComp.getFilter&&e.$uiComp.getFilter()}),null,null),this.$currentLayer=null,this.isSelected=null,this.boundOffset={top:0,left:0,right:0,bottom:0},this}_initBegin(e,A,t){return super._initBegin(e,A,t),this.$root.$on("hook:uiCanvasZoom",this.updateZoom,this),this.$root.$on("hook:selectLayer",this._selectLayer,this),this.$root.$on("hook:unSelectLayer",this._unSelectLayer,this),this}_initLayerSize(){const{width:e,height:A}=this;this.layers.forEach((t=>{t.isLock=!1,t.width=e,t.height=A}))}_selectLayer(e){this.$currentLayer!==e&&(this.$currentLayer=e)}_unSelectLayer(e){this.$currentLayer===e&&(this.$currentLayer=null)}_destroyEvent(){return super._destroyEvent(),this.$options.events&&(this.$options.events(),this.$options.events=null),this}_destroyComp(){delete this.$uiComp.__DIAGRAM__,this.$options.manager.removeUiComp(this)}updateZoom(){return this.$updateAttr("canvasZoom"),this.$root.$emit("updateCanvasZoom",this.canvasZoom),this.$emit("updateCanvasZoom",this.canvasZoom),this}async _mount(){return await super._mount(),this.$uiComp.lock=!1,this.updateZoom(),this}_initEnd(){return super._initEnd(),this._initLayerSize(),this.isSelected||this._updateSelect(!0),this.$parent._updateSelect(),this}updateBound(e={}){const A=this.boundOffset;Object.assign(A,e);const t=this.$parent.$el.getBoundingClientRect();try{this.$ui.updateBound({height:t.height-A.bottom})}catch(e){console.warn("更新画布居中位置失败",e)}return this}updateCanvasCenter(){try{this.$uiComp.zoomAvailCenter()}catch(e){console.warn("更新画布居中位置失败",e)}return this}resetFilter(){return this.$uiComp.resetFilter(),this.$updateAttr("filters"),this}setFilter(e,A){return this.$uiComp.setFilter(e,A),this.$updateAttr("filters"),this}clearFiler(){return this.$uiComp.clearFiler(),this.$updateAttr("filters"),this}setSize(e=[]){return this.updateAttrs(e),this.updateBound(),this.updateCanvasCenter(),this}getThingLayer(){return this.children.find((e=>e.isThingLayer))}async createLayer(e={},A={}){const t=this.$options.manager.create(e.type);return await t.init(this,e),A.clip&&(t.clip=!0),isNumber$1(A.beforeCompIndex)&&t.moveToTarget(this.children[A.beforeCompIndex],"before"),A.select&&t.select(),this.$emit("createLayer",t),this.$root.$emit("createLayer",t),t}toJSON(){const e=this.$uiComp.toJSON(),A=super.toJSON();return A.option.filters=deepClone$1(this.filters),A.option.scaleMode=this.scaleMode,A.option.style.backgroundPosition=e.option.style.backgroundPosition,A.option.style.backgroundRepeat=e.option.style.backgroundRepeat,A.option.style.backgroundSize=e.option.style.backgroundSize,A.option.style.transformOrigin=e.option.style.transformOrigin,A.kpOption.dataFilters=deepClone$1(this.$options.dataManager.filterManager.toJSON()),delete A.option.style.top,delete A.option.style.left,delete A.kpOption.isSelected,A}transformLocation(e,A){const{x:t,y:i}=this.$uiComp.el.getBoundingClientRect(),{canvasZoom:s}=this;return{x:(e-t)/s,y:(A-i)/s}}_destroyEnd(){return this.$root.$off("hook:uiCanvasZoom",this.updateZoom,this),this.$root.$off("hook:selectLayer",this._selectLayer,this),this.$root.$off("hook:unSelectLayer",this._unSelectLayer,this),super._destroyEnd(),this}get layers(){return this.children}get groups(){return this.$options.manager.getAllChildren(this,"Group")}get containers(){return this.$options.manager.getAllChildren(this,"Container")}get $twinContainers(){return this.containers.filter((e=>e.adapter?.isThing))}}let Layer$1=class extends Base$1{_beforeInit(e,A){super._beforeInit(e,A);const t=this;return this.isLayer=!0,t._removeAttr("rotate")._removeAttr("isSelected")._removeAttr("backgroundColor")._removeAttr("backgroundImage")._registerAttr("isSelected",!1,(function(){return t.$options.kpOption?._kpSelected||!1}),null,(function(e){return e?(t.show(),t.$uiComp.select()):t.clip||t.hidden(),e}),{noAdd:!0})._registerAttr("clip",null,(function(){return t.$options.kpOption?._kpClip||!1}),null,(function(e){return e?t.show():t.isSelected||t.hidden(),e})),this}_initComp(){super._initComp(),this.$uiComp.lock=!1}_initEnd(){super._initEnd(),!this.visible&&this.clip&&this.show(),this.isSelected&&(this.$sibling.forEach((e=>{e.isSelected&&e.unSelect()})),this.$options.isEdit&&(this.visible||this.show(),this.$uiComp.select()),this.$emit("hook:selectLayer",this),this.$root.$emit("hook:selectLayer",this),this.$emit("selectLayer",this),this.$root.$emit("selectLayer",this))}select(){return this.$sibling.forEach((e=>e.unSelect())),super.select(!0),this.isSelected&&(this.$emit("hook:selectLayer",this),this.$root.$emit("hook:selectLayer",this),this.$emit("selectLayer",this),this.$root.$emit("selectLayer",this)),this}unSelect(){return super.unSelect(),this.isSelected||(this.$emit("hook:unSelectLayer",this),this.$root.$emit("hook:unSelectLayer",this),this.$emit("unSelectLayer",this),this.$root.$emit("unSelectLayer",this)),this}async createContainer(e,A){return this._createContainer(e,A)}async _createContainer(e={},A={}){const t=this.$options.manager.create(e.type);return await t.init(this,e,A.container),A.lock&&(t.isLock=!0),A.select&&t.select(),this.$emit("createContainer",t),this.$root.$emit("createContainer",t),t}async parserTemplate(e,A={}){const t=await Promise.all(this.$uiComp.parserTemplate(e).map((e=>this._createContainer(e.toJSON()))));return A.select&&this.$root.select(t),t}async parseJSON(e,A={}){Array.isArray(e)||(e=[e]),e.forEach((e=>this.$root.queryById(e.id)?.destroy()));const t=await Promise.all(e.map((e=>this._createContainer(e))));return A.select&&this.$root.select(t),t}toJSON(){const e=super.toJSON();return e.option.visible=this.clip&&this.visible,e.kpOption._kpClip=this.clip,e.kpOption._kpSelected=this.isSelected,delete e.option.style.backgroundColor,delete e.option.style.backgroundImage,e}getEmptyContainerByLocation(e,A){return this.containers.filter((({visible:t,adapter:i,top:s,left:n,width:r,height:o,backgroundImage:a})=>!i&&t&&!a&&s<=A&&s+o>=A&&n<=e&&n+r>=e))}_destroy(){const e=this.$next||this.$prev;return this.unSelect(),super._destroy(),e&&e.select&&e.select(),this}get groups(){return this.$options.manager.getAllChildren(this,"Group")}get containers(){return this.$options.manager.getAllChildren(this,"Container")}get $twinContainers(){return this.containers.filter((e=>e.adapter?.isThing))}};class ThingJSLayer extends Layer$1{_beforeInit(e,A){return super._beforeInit(e,A),this.isThingLayer=!0,this}_initCompCreateUi(){const e=this.$options;return new UI.Layer(this.$parent.$uiComp,e.options.option)}parserTemplate(){return Promise.reject(new Error("无法使用布局模板，只能创建孪生图表"))}parseJSON(){return Promise.reject(new Error("无法导入定义文件，只能创建孪生图表"))}toJSON(){const e=super.toJSON();return e.kpOption._kp3DLayer=!0,e}}const getUpperData=e=>{let A=e;for(;A.$parent;){if("Layer"===A.$parent.type)return{$id:A.id,animation:A.animation,name:A.name,$comp:A};A=A.$parent}},getOpacity=e=>(void 0===e&&(e=1),e),recordAttribute=e=>{const{id:A,width:t,height:i,top:s,left:n,isLock:r,visible:o,$uiComp:a}=e,{translate:l,scale:c,opacity:h}=a.style||{};return{id:A,visible:o,basic:{lock:r},style:{width:t,height:i,top:s,left:n,opacity:getOpacity(h),translate:l||[0,0],scale:c||[1,1]}}};class Single{constructor(e,A){this.element=e,this.parent=A,this.current=0,this.total=null,this.data=null,this.animation=null}execute(e){this.record(),this.animation=e;const A=e?.enter||[],t=e?.leave||[];this.setTotal(A,t);const i=A.length>0?"enter":"leave";this.do(i)}do(e){(this.animation?.[e]||[]).forEach((A=>{const t=this.getParams(e,A[0]);let i=this.$ui.animation;i=i.run([{...t.animation}],(()=>{t.after&&t.after()}));const s=A.slice(1);for(const A of s){const t=this.getParams(e,A);i=i.run([{...t.animation}],(()=>{t.after&&t.after()}))}}))}getParams(e,A){const{total:t}=this,{animation:i,duration:s}=A,n=this.animation?.enter||[],r=this.animation?.leave||[],o=this.element?.$uiComp;let a;if("enter"===e&&r.length>0){const e=n.flat().length;a=()=>{++this.current,e>=this.current&&this.do("leave")}}else a=()=>{++this.current,t===this.current&&(this.current=0,setTimeout((()=>{this.element.$emit("afterAnimation",this.element)})))};return{animation:{target:o,animation:i,duration:s},after:a}}record(){this.data=recordAttribute(this.element)}restore(){const{basic:e,style:A,visible:t}=this.data||{},i=this.element?.$uiComp;if(i){i.setVisible(t);for(const A in e)i[A]=e[A];for(const e in A)i.style[e]=A[e]}}setTotal(e,A){const t=e?.flat()?.length||0,i=A?.flat()?.length||0;this.total=t+i}end(){this.restore(),Object.assign(this,{current:0,total:null,animation:null})}get $ui(){return this.element?.$ui}}class Collection{constructor(){this.map=new Map}set(e,A){this.map.set(e,A)}get(e){return this.map.get(e)}has(e){return this.map.has(e)}delete(e){return this.map.delete(e)}clear(){this.map.clear()}get size(){return this.map.size}}var collection=new Collection;function transformAnimation(e){const A={enter:[],leave:[]};let t=null;return e.length?(e.forEach(((e,i)=>{const{animation:s,basic:n,duration:r}=e,{execute:o}=n,a={animation:s,duration:r,index:i};if("after"!==o)t=o,A[o].push([a]);else{const e=A[t];e[e.length-1].push(a)}})),A):null}class Manager{constructor(){this.element=null,this.parent=null,this.current=0,this.total=0}getAnimator(e){return this._init(e),this}_init(e){this.element?.id&&this.element.id!==e.id&&this.end(),this.element=e,this.parent=getUpperData(e)}execute(e){this.element.$root.$emit("beforeAnimation",this.element);const{containers:A}=this;this.total=A.length,this.setOperate({resize:!1,rotate:!1});for(const t of A){const A=new Single(t,this.parent);collection.set(t.id,A),A.execute(e),t.$on("afterAnimation",(e=>{++this.current,t.$off("afterAnimation"),this.total===this.current&&(this.end(),this.element.$root.$emit("afterAnimation",this.element))}))}}setOperate({resize:e,rotate:A}){const{$ui:t}=this;t&&t.setOperatHandlerDisplay({resize:e,rotate:A})}end(){collection.size&&(this.$ui?.animation?.end(),this.$ui?.setOperatHandlerDisplay({resize:!0,rotate:!0}),collection.map.forEach(((e,A)=>{e.end(),collection.delete(A)})),collection.clear(),this.current=0)}destroy(){this.end(),Object.assign(this,{element:null,parent:null,total:null})}transform(e){return transformAnimation(e)}update(e){this.parent.$comp.animation=e,this.parent.animation=e}get $ui(){return this.element?.$ui}get containers(){const{element:e}=this||{};return e.isGroup?e.containers:[e]}get enter(){return this.parent?.animation?.enter||[]}get leave(){return this.parent?.animation?.leave||[]}}var animatorManager=new Manager;class Group extends Base$1{_beforeInit(){super._beforeInit();const e=this;return this.isGroup=!0,e._removeAttr("visible")._removeAttr("top")._removeAttr("left")._removeAttr("width")._removeAttr("height")._removeAttr("rotate")._removeAttr("isLock")._removeAttr("backgroundColor")._removeAttr("backgroundImage")._registerAttr("visible",null,(function(){return e.$uiComp.visible}),null,(function(A){return e.$uiComp.visible=A,e.$uiComp._setVisible(),A}))._registerAttr("top",null,(function(){return e.$uiComp.bound.top}),null,(function(A){return e.$uiComp.move(0,A-e.top),A}),{setAfter:()=>{!function e(A){A.forEach((A=>{A.$updateAttr("top"),"Group"===A.type&&A.children.length&&e(A.children)}))}(e.children)}})._registerAttr("left",null,(function(){return e.$uiComp.bound.left}),null,(function(A){return e.$uiComp.move(A-e.left,0),A}),{setAfter:()=>{!function e(A){A.forEach((A=>{A.$updateAttr("left"),"Group"===A.type&&A.children.length&&e(A.children)}))}(e.children)}})._registerAttr("width",null,(function(){return e.$uiComp.bound.width}))._registerAttr("height",null,(function(){return e.$uiComp.bound.height}))._registerAttr("isLock",null,(function(){return!e.children.some((e=>!e.isLock))}),null,(function(A){return e.children.forEach((e=>e.isLock=A)),A}),{setAfter:()=>{"Group"===e.$parent.type&&e.$parent.$updateAttr("isLock")}}),this}async _initGroupChildren(){const e=this.$options.options.children||[];for(const A of e){let e=A.type;A.kpOption?.adapter?.thingType&&(e="DefaultContainer");let t=this.$options.manager.getCompByUiId(A.option.id);t?t.$options.status||await this.$options.manager.create(e).init(this.$parentLayer,A):t=await this.$options.manager.create(e).init(this.$parentLayer,A),t._deletePaternity(),t.$parent=t.$options.parent=this,this.children.push(t)}return this}async _initChildren(){return this}async _mount(){return await this._initGroupChildren(),await super._mount(),this}_initCompCreateUi(){const e=this.$options;if(UI[e.type])return new UI[e.type](this.children.map((e=>e.$uiComp)),e.options?.option);console.error(`ThingUi没有${e.type}方法`)}_initEnd(){return super._initEnd(),this.children.forEach((e=>{e.animation=null})),this}$updateAttr(e){return super.$updateAttr(e),"Group"===this.$parent.type&&["isLock","width","height","left","top"].includes(e)&&this.$parent.$updateAttr(e),this}async createGroup(e=[],A={},t={}){return groupInit(this.$options.manager.create("Group"),[this,...e],A,t)}async toImage(e={}){if(!this.width||!this.height)return"data:image/jpeg;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=";const A=document.createElement("canvas");A.width=this.width,A.height=this.height;const t=A.getContext("2d");t.fillStyle="#282A2E",t.fillRect(0,0,A.width,A.height),this.$canvas.select();const i=getNodeOnlyAttr("canvas-image-dom",!0);this.$canvas.$el.setAttribute(i,""),await this.$ui.nextTick();for(const e of this.children){const A=await loadImg$1(await e.toImage({backgroundColor:"transparent"},i));try{t.drawImage(A.target,e.left-this.left,e.top-this.top)}catch(e){console.warn("截图报错",e)}}return this.$canvas.$el.removeAttribute(i),A.toDataURL("image/jpeg",1)}dismiss(){const e=this.$root,A=[...this.children];return this._destroyAnimator(),A.forEach((e=>{e.moveToTarget(this,"before")})),this.destroy(),e.select(A),this}toJSON(){const e=this.$uiComp.toJSON(),{type:A}=this;return{option:{...e.option,animation:this.animation},kpOption:{},type:A,children:this.children.map((e=>e.toJSON()))}}_destroy(){this.unSelect(),this._destroyAnimator(),super._destroy()}_destroyComp(){delete this.$uiComp.__DIAGRAM__;try{this.$uiComp?.destroy()}catch(e){console.warn(e)}return this.$options.manager.removeUiComp(this),this}_destroyAnimator(){this.animator&&this.animator.destroy&&this.animator.destroy()}get groups(){return this.$options.manager.getAllChildren(this,"Group")}get containers(){return this.$options.manager.getAllChildren(this,"Container")}get $parentLayer(){return function e(A){return"Layer"===A.type?A:e(A.$parent)}(this.$parent)}get $twinContainers(){return this.containers.filter((e=>e.adapter?.isThing))}get animator(){return animatorManager?.getAnimator(this)}}class Container extends Base$1{_beforeInit(){super._beforeInit();const e=this;return this.isContainer=!0,e._registerAttr("penetrateOnplay",null,(function(){return e.$uiComp.penetrateOnplay}),null,(function(A){return e.$uiComp.penetrateOnplay=A,A})),this}_initCompCreateUi(){const e=this.$options;let A=e.type;if(e.kpOption?.adapter?.thingType&&(A="DefaultContainer"),UI[A])return new UI[A](this.$parent.$uiComp,e.options?.option);console.error(`ThingUi没有${A}方法`)}async _mount(){await super._mount();const e=this.$options.options.option,A=this.$options.kpOption;if(e.adapter){const t=this.$options.adapterManager.create(getAdapterType(e.adapter,A.adapter));await t.init(this,e.adapter,A.adapter,this.$options.config.adapter)}}_destroyAdapter(){this.adapter&&this.adapter.$destroy()}async createAdapter(e,A,t={}){if(this.adapter)return console.warn("节点已包含适配器"),this.adapter;{const i=this.$options.adapterManager.create(getAdapterType(e,A));return await i.init(this,e,A,t.adapter),t.select&&this.select(!0),i}}async createGroup(e=[],A={},t={}){return groupInit(this.$options.manager.create("Group"),[this,...e],A,t)}async updateAdapter(e={},A={},t={}){if(this.adapter){const A=deepClone$1(this.adapter.toJSON()),t={options:A.options,kpOption:A.kpOption,config:deepClone$1(this.$options.config)};this.$emit("updateAdapter",this),this.$root.$emit("updateAdapter",this);const i=this.adapter.$type,s=deepClone$1(this.adapter.toJSON());this.adapter.$destroy();const n=this.$options.adapterManager.create(i);return s.option.name=e.name,await n.init(this,s.option,s.kpOption,{merge:!0}),this.$emit("updatedAdapter",this),this.$root.$emit("updatedAdapter",this),this._update("adapter",{options:this.$options.options,kpOption:this.$options.kpOption,config:this.$options.config},t),n}return console.error("节点没有适配器")}enterInsidePreview(){this.$root.enterInsidePreview(this)}exitInsidePreview(){this.$root.exitInsidePreview()}_destroy(){this._destroyAnimator(),super._destroy()}_destroyComp(){this._destroyAdapter(),super._destroyComp()}_destroyAnimator(){this.animator&&this.animator.destroy&&this.animator.destroy()}toJSON(){const e=this.$uiComp.toJSON(),A=super.toJSON();if(A.option.animation=this.animation,A.option.penetrateOnplay=this.penetrateOnplay,A.option.style.rotate=this.rotate,A.option.style.userSelect=e.option.style.userSelect,delete A.children,this.adapter){const e=this.adapter.toJSON();A.kpOption.adapter=e.kpOption,A.option.adapter=e.option}return A}get animator(){return animatorManager.getAnimator(this)}get $uiAdapter(){return this.$uiComp.adapter}get $uiApp(){return this.$uiComp.app}get $rootGroup(){return getParentGroups(this).shift()}get $parentLayer(){return function e(A){return"Layer"===A.type?A:e(A.$parent)}(this.$parent)}}function getParentGroups(e){const A=[];return function e(t){"Group"===t.type&&(A.push(t),e(t.$parent))}(e.$parent),A}function parseData(e,A){let t=e;if(""!==A)try{t=new Function("return "+A)()(e)}catch(i){try{t=e[A]}catch(e){t={type:"error",message:e}}}return t}class SubscriberWork{constructor(e){this.parent=e,this.subscriberList=null,this.data=null}init(){return this.subscriberList=[],this.data=null,this}sub(e,A){this.subscriberList.push({option:e,dataItem:A})}unsub(e){const A=this.subscriberList.findIndex((A=>A.dataItem===e));~A&&this.subscriberList.splice(A,1)}setData(e){this.data=e,this.subscriberList.forEach((A=>{A.dataItem._setData(parseData(e,A.option.level))}))}get(){return this.subscriberList.map((e=>e.option))}destroy(){const e=[...this.subscriberList];for(const A of e)A.dataItem.dataSource.setType("staticData"),A.dataItem.refresh();this.parent=null,this.subscriberList=null,this.data=null}}function getDateNow(){return Date.now()}class TimerWork{constructor(e,A={}){this.parent=e,this.dataManager=e.dataManager,this.timerManager=e.dataManager.timeManager,this._options=A,this.options=deepClone$1(A),this.close=null,this.time=null,this.now=null,this.running=null,this.init()}init(){return this.close=!!isEmpty$1(this.options.close)||this.options.close,this.time=+this.options.time||10,this.updateNow(),this.timerManager.add(this),this}start(){this.running=!0}stop(){this.running=!1}get(){return this.options}updateTime(e){Object.assign(this.options,{time:e}),this.init()}updateClose(e){Object.assign(this.options,{close:e}),this.init()}updateNow(){return this.now=getDateNow(),this}run(){return this.parent.refresh(),this}getRefreshable(){return!this.close&&this.running&&this.parent.getRefreshable()&&this.now+1e3*this.time<=getDateNow()}toJSON(){return{time:this.time,close:this.close}}destroy(){this.timerManager.remove(this),this.parent=null,this.dataManager=null,this.options=null,this.close=null,this.time=null,this.now=null,this.running=null}}class FieldMapping{constructor(e,A={}){this.parent=e,this._options=A,this.options=deepClone$1(A),this.fieldList=null,this.data=null}init(){const e=this.options.fields||[];return this.fieldList=e.map((({desc:e,name:A,value:t})=>({field:{desc:e,name:A,value:t||A},status:!1}))),this}addFields(e){this.options.fields=e,this.init()}update(e,A){const t=this.fieldList.find((A=>A.field.name===e));t&&(t.field.value=""===A?t.field.name:A)}get(e){return this.fieldList.find((A=>A.field.name===e))}_initFieldStatus(){this.fieldList.forEach((e=>{e.status=!1}))}execute(e){const A=deepClone$1(e);if(this.fieldList.length){this._initFieldStatus();switch(_toString(A)){case"[object Object]":this._execute(A);break;case"[object Array]":A.forEach((e=>{this._execute(e)}))}}return this.data=A,A}_execute(e){return"object"==typeof e&&this.fieldList.forEach((A=>{Reflect.has(e,A.field.value)&&(A.status=!0,e[A.field.name]=e[A.field.value])})),e}toJSON(){return this.fieldList.map((e=>deepClone$1(e.field)))}destroy(){this.parent=null,this.options=null,this.fieldList=null,this.data=null}}class Base{constructor(e,A){this.parent=e,this.dataManager=e.dataManager,this.type=null,this.root=e.root,this.adapter=e.adapter,this._options=A,this.options=deepClone$1(A),this.data=null,this.isReady=null,this.running=null}init(){this.isReady=!1,this.running=!1}_getDefaultData(){return{status:200,statusText:"",body:null,type:this.type}}getData(e){const A=this._getDefaultData();return A.body=this.data,A}set(e){this.options=e,this.start()}get(){return this.options}start(){this.running=!0,this.isReady=!0,this.parent._updateReady()}stop(){this.running=!1,this.isReady=!1}destroy(){this.stop(),this.parent=null,this.dataManager=null,this.root=null,this._options=null,this.options=null,this.data=null,this.isReady=null,this.running=null}}class StaticData extends Base{constructor(e,A){super(e,A),this.type="staticData"}init(){super.init(),this.data=this.options}set(e){this.options=e,this.data=e,this.start()}}class RestData extends Base{static defaultOptions={url:"",header:null,level:null,body:null,method:"POST",conditionType:"condition",callbackArgs:[],code:"return body"};constructor(e,A){super(e,A),this.type="restData"}init(){super.init(),this.options||(this.options=deepClone$1(RestData.defaultOptions))}async getData(e){const A=await this.dataManager.restDataManager.getData(this.parent.parent,{...this.options,body:this._getBody()},e);this.data=A.data;const t=this._getDefaultData();return t.status=A.status,t.body=this.data,t}_getBody(){const{body:e,code:A}=this.options,t={},i=this.options.callbackArgs||[],s=this.dataManager.filterArgs;for(const e of i)s[e]&&(t[e]=s[e]);try{let i;e&&(i=new Function("return "+e)());const s=new Function("body","callbackArgs",A)(i,t);return s&&(Array.isArray(s)||isType$3(s,"Object"))?JSON.stringify(s):s}catch(e){console.error(e)}}}class SubscriberData extends Base{constructor(e,A){super(e,A),this.subscribeComp=null,this.type="subscriberData"}_init(){if(this.options){const e=this.root.$queryById(this.options.id);e?.adapter.$complete?this._sub(e):this.root.$on("adapterCompleted",this._subEvent,this)}else this.isReady=!0,this.parent._updateReady()}_subEvent(e){e.$parent.id===this.options.id&&this._sub(e.$parent)}_sub(e){this.subscribeComp=e,this.subscribeComp.adapter.$data.subscriber.sub(this.options,this.parent.parent),this.isReady=!0,this.parent._updateReady()}_unSub(){this.subscribeComp&&(this.subscribeComp.adapter.$data.subscriber.unsub(this.parent.parent),this.subscribeComp=null)}set(e={}){this._unSub(),super.set(e)}start(){this.running=!0,this._init()}stop(){super.stop(),this._unSub(),this.options={}}async getData(e){const A=await this.subscribeComp.adapter.$data.getData(void 0,{getFn:A=>{e&&e((()=>{A.cancelFn()}))}});if(200===A.status){this.data=parseData(A.body,this.options.level);const e=this._getDefaultData();return e.status=200,e.body=this.data,e}return A}destroy(){this.root.$off("adapterCompleted",this._subEvent,this),super.destroy()}}class DataSource{constructor(e,A={}){this.parent=e,this.root=e.root,this.dataManager=e.dataManager,this.adapter=e.parent,this.options=A,this.dataType=A.dataType||"staticData",this.typeMap={staticData:new StaticData(this,A.source?.staticData),restData:new RestData(this,A.source?.restData),subscribeData:new SubscriberData(this,A.subscribeData)}}init(){return Object.values(this.typeMap).forEach((e=>e.init())),this.typeMap[this.dataType].start(),this}getReady(){return this.typeMap[this.dataType].isReady}_updateReady(){this.getReady()&&(this.adapter.$emit("dataSourceReady",this),this.root.$emit("dataSourceReady",this))}setType(e){return this.typeMap[this.dataType]?.stop(),this.dataType=e,this.typeMap[this.dataType]?.start(),this}set(e,A){return this.typeMap[this.dataType]?.stop(),this.dataType=e,this.typeMap[this.dataType]?.set(A),this}get(e){return this.typeMap[e]?.get()}async getData(e){return this.typeMap[this.dataType].getData(e)}async getDataByType(e=this.dataType,A=null){return this.typeMap[e].getData(A)}toJSON(){const e=this.typeMap,A={};for(const t in e)A[t]=deepClone$1(e[t].get());return A}_destroyMap(){const e=this.typeMap;for(const A in e)e[A].destroy()}destroy(){this._destroyMap(),this.parent=null,this.root=null,this.dataManager=null,this.adapter=null,this.options=null,this.dataType=null,this.typeMap=null}}class FilterWork{constructor(e,A={}){this.parent=e,this.root=e.root,this.dataManager=e.dataManager,this.filterManager=e.dataManager.filterManager,this.options=A,this.enabled=null,this.filterList=null}init(){this.enabled=!!this.options.enabled;const e=this.options.list||[];return this.filterList=e.map((e=>{const A=this.filterManager.getFilterByName(e.name);return A.addUse(this),{enabled:e.enabled,filter:A}})),this}addUse(e,A=!1,t=null){return e.addUse(this),isNumber$1(t)?this.filterList.splice(t,0,{enabled:A,filter:e}):this.filterList.push({enabled:A,filter:e}),A&&this._updateMainEnabled(A),!0}add(e,A,t){this.filterList.find((A=>A.filter===e))||this.addUse(e,A,t)}getMainEnabled(){return this.enabled}execute(e){let A=deepClone$1(e);return this.enabled&&this.filterList.forEach((e=>{e.enabled&&(A=e.filter.execute(A))})),A}getFilterItem(e){return this.filterList.find((A=>A.filter===e))}getFilterItemIndex(e){return e&&this.filterList.findIndex((A=>A===e))}getFilterItemByName(e){return this.filterList.find((A=>A.filter.name===e))}updateMainEnabled(e){return this._updateMainEnabled(e),!0}_updateMainEnabled(e){this.enabled=e}updateEnabled(e,A){return e.enabled=A,A&&this._updateMainEnabled(A),!0}updateName(e,A){const t=this.filterManager.getFilterByName(A);return!(!A||t||!e)&&(e.filter.updateName(A),!0)}updateData(e,A,t=[]){return e.filter.updateData(A,t),!0}moveTo(e,A,t){if(e&&A&&t){if("before"===t)return this._moveTo(e,A,0);if("after"===t)return this._moveTo(e,A,1)}}_moveTo(e,A,t){const i=this.getFilterItemIndex(e),s=this.getFilterItemIndex(A);if(~i&&~s){const e=this.filterList.splice(i,1)[0];this.filterList.splice(s+t,0,e)}}toJSON(){return{enabled:this.enabled,list:this.filterList.map((e=>({enabled:e.enabled,name:e.filter.name})))}}remove(e){const A=this.filterList.findIndex((A=>A.filter===e));if(~A){return this.filterList.splice(A,1)[0].filter.removeUse(this),!0}return!1}clear(){this.filterList.forEach((e=>{e.filter.removeUse(this)})),this.filterList=[],this.enabled&&this.parent.refresh()}destroy(){this.enabled=null,this.clear(),this.filterList=null,this.options=null,this.filterManager=null,this.dataManager=null,this.root=null,this.parent=null}}class DataItem{constructor(){this.parent=null,this.root=null,this.dataManager=null,this.options=null,this.starting=null,this.firstLoad=null,this.getDataFn=null,this.cancelFn=null,this.sourceData=null,this.filterBeforeData=null,this.overData=null,this.emptyData=null,this.status=null,this.beforeDestroyStatus=null,this.destroyStatus=null,this.fieldMapping=null,this.dataSource=null,this.subscriber=null,this.filterWork=null,this.timerItem=null,this.throttlingMode=null}_initBegin(e,A){this.parent=e,this.root=e.$root,this.dataManager=e.$dataManager,this.options=A,this.starting=!1,this.firstLoad=!1,this.dataManager._add(this),this.dataSource=new DataSource(this,this.options).init(),this.subscriber=new SubscriberWork(this).init(),this.fieldMapping=new FieldMapping(this,{fields:this.options.fieldMapping}).init(),this.timerItem=new TimerWork(this,this.options).init(),this.filterWork=new FilterWork(this,this.options.filter).init()}init(e,A={}){this.status?console.error("已被初始化过"):(this.beforeDestroyStatus=null,this.destroyStatus=null,this.status=!0,this._initBegin(e,A),this.emptyData=isEmpty$1(this.dataSource.get("staticData")),this.throttlingMode=!this.parent.$dataAdapter||!!this.parent?.opts?.dataThrottling,this.dataSource.getReady()?this.start():this.parent.$on("dataSourceReady",this.start,this))}set(e,A){this.dataSource.set(e,A)}get(e){return this.dataSource.get(e)}_getRealVisible(){return this.parent.$dataAdapter?this.parent.$parent.$dataAdapterRealVisible:this.parent.$parent.$realVisible}getRefreshable(){return!this.starting||!this.throttlingMode||this._getRealVisible()}async refresh(){if(this.starting&&this.dataSource.getReady())return"subscribeData"===this.dataSource.dataType?this._setData(deepClone$1(this.sourceData)):this.getData()}async refreshRealData(){if(this.starting)return"subscribeData"===this.dataSource.dataType?this.dataSource.typeMap.subscribeData.subscribeComp.adapter.$data.refresh():this.getData()}async getData(e,A={}){if(this.cancelFn&&(this.cancelFn(),this.cancelFn=null),this.getDataFn&&await this.getDataFn,!this.starting)return;this.getDataFn=this.dataSource.getDataByType(e,(e=>{this.cancelFn=e})),A.getFn&&A.getFn(this);const t=await this.getDataFn;return this.cancelFn=null,this.beforeDestroyStatus||this.destroyStatus?void 0:(200===t.status&&(this._setData(t.body),this.timerItem.updateNow()),t)}_execute(e){this.sourceData=deepClone$1(e);let A=deepClone$1(e);return A=this.fieldMapping.execute(A),this.filterBeforeData=deepClone$1(A),A=this.filterWork.execute(A),this.overData=A,A}_setData(e){const A=this._execute(e);return this._setAppData(A),this.parent.$emit("dataChange",A),this.root.$emit("dataChange",this.parent.$parent,A),this.subscriber.setData(A),A}_setAppData(e){try{this.parent.$uiApp.setData(deepClone$1(e))}catch(e){console.warn(this.parent.$parent.id+" 这个图表设置数据失败",e)}}async _firstStart(){const e=this.dataSource.dataType;this.firstLoad=!0,await this.getData("staticData"),["subscribeData","staticData"].includes(e)||await this.getData()}start(){return this.dataManager.started&&this.parent.$complete&&!this.starting&&(this.starting=!0,this.firstLoad?["subscribeData"].includes(this.dataSource.dataType)||this.refresh():this._firstStart(),this.timerItem.start()),this}stop(){return this.starting?(this.starting=!1,this.timerItem.stop()):console.warn("已经停止了"),this}toJSON(){const e=this.dataSource.toJSON(),A=this.dataSource.dataType,t=this.fieldMapping.toJSON(),{close:i,time:s}=this.timerItem.toJSON(),n=this.filterWork.toJSON(),r=e.subscribeData;return delete e.subscribeData,{close:i,time:s,dataType:A,source:e,subscribeData:r,fieldMapping:t,filter:n}}destroy(){return this.parent.$off("dataSourceReady",this.start,this),this.status=!1,this.beforeDestroyStatus=!0,this.dataManager.remove(this),this.subscriber.destroy(),this.dataSource.destroy(),this.timerItem.destroy(),this.fieldMapping.destroy(),this.filterWork.destroy(),this.beforeDestroyStatus=!1,this.destroyStatus=!0,this.throttlingMode=null,this.timerItem=null,this.filterWork=null,this.subscriber=null,this.dataSource=null,this.fieldMapping=null,this.emptyData=null,this.overData=null,this.filterBeforeData=null,this.sourceData=null,this.getDataFn=null,this.firstLoad=null,this.starting=null,this.options=null,this.dataManager=null,this.root=null,this.parent=null,this}}function getOpts(e){return e?"echarts"===e.type?e.config:e.opts:null}let BaseAdapter$1=class{constructor(){this.$options={rootConfig:null,name:null,options:null,_kpOption:null,kpOption:null,config:null,parent:null,root:null,adapterManager:null,dataManager:null,attrs:{},status:null},this.$parent=null,this.$root=null,this.$type=null,this.$complete=null,this.$dataAdapter=null,this.$dataManager=null,this._waitComplete=null,this._waitResolve=null,this.$data=null,this.isAdapter=!0,this._beforeInit()}_registerAttr(e,A,t=null,i=null,s=null,n={}){if(this.$options.attrs[e])console.warn(`${e} 已被注册`);else{const r={name:e,value:A,init:t,get:i,set:s,option:n};this.$options.attrs[e]=r,Object.defineProperty(this,e,{enumerable:!0,configurable:!0,get:()=>r.get?r.get():r.value,set(A){if(!r.set)return;const t=this[e];t!==A&&this._updateAttr(r,A,deepClone$1(t))}})}return this}_removeAttr(e){return delete this.$options.attrs[e],this}_updateAttr(e,A,t){return e.value=e.set(A),this._update(e.name,A,t),this}_update(e,A,t){return this.$emit("adapterUpdate",this,e,A,t),this.$root.$emit("adapterUpdate",this,e,A,t),this.$emit("update",this.$parent,e,A,t),this.$root.$emit("update",this.$parent,e,A,t),this}_beforeInit(){return initAttrs(this),this}_initBegin(e,A,t,i){return this.$options.rootConfig=e.$options.rootConfig,this.$options.status=!0,this.$options.name=A.name,this.$options.options=A,this.$options._kpOption=t,this.$options.kpOption=t,this.$options.config=i,this.$options.parent=e,this.$options.root=e.$root,this.$options.adapterManager=e.$options.adapterManager,this.$options.dataManager=e.$options.dataManager,this.$parent=e,this.$root=e.$root,this.$type=e.$options.adapterManager.getType(this),this.$dataManager=e.$options.dataManager,this.$data=new DataItem,this}async _complete(){return this.$parent.adapter=this,await this.$parent.$ui.nextTick(),this._initComp(),await this.waitComplete(),this._completed(),this}async _initConfig(){return this}async _initEnd(){try{this.$uiAdapter.setOption(this.opts)}catch(e){console.warn(this.$parent.id+" 这个图表设置样式失败",e)}return await this._initConfig(),this}async init(e,A={},t={},i={}){return this.$options.status?console.error("已被初始化过"):(this._initBegin(e,A,t,i),this.$emit("beforeCreateAdapter",this),this.$root.$emit("beforeCreateAdapter",this),this.$emit("beforeCreateAdapter:"+this.$type,this),this.$root.$emit("beforeCreateAdapter:"+this.$type,this),await this._complete(),this.$emit("adapterCompleted",this),this.$root.$emit("adapterCompleted",this),this.$emit("adapterCompleted:"+this.$type,this),this.$root.$emit("adapterCompleted:"+this.$type,this),await this._initEnd()),this}_initComp(){return this.$uiAdapter?this:new UI.Adapter(this.$uiComp,deepClone$1(this.$options.options))}async waitComplete(){if(this._waitComplete)return this._waitComplete;if(this.$uiAdapter?.complete)return Promise.resolve(this);const e=this._waitComplete=new Promise((e=>{this._waitResolve=e,this.$root.$on("hook:componentComplete",this._componentComplete,this)}));return this._waitComplete=null,e}_componentComplete(e){if(e===this.$parent){const e=this._waitResolve;return this._waitResolve=null,e(this)}}_completed(){this.$complete=!0,this.$updateAttrs();const e=this.$options.kpOption.kpData,A=this.$options.options;return e?.source&&!Reflect.has(e.source,"staticData")&&Reflect.has(A,"data")&&(e.source.staticData=A.data),this.$data.init(this,e),this}setOption(e){return this.opts=e,this}updateDataField(e,A){const t=this.$data.fieldMapping.get(e);return this.$data.fieldMapping.update(e,A),this._update("data:field",{name:e,value:A},{name:e,value:t}),this}updateDataClose(e){const A=this.$data.timerItem.close;return this.$data.timerItem.updateClose(e),this._update("data:timerClose",e,A),this}updateDataTime(e){const A=this.$data.timerItem.time;return this.$data.timerItem.updateTime(e),this._update("data:timerTime",e,A),this}updateSourceData(e,A){const t=this.$data.dataSource.dataType,i=this.$data.dataSource.get(t);return this.$data.dataSource.set(e,A),this.$data.refreshRealData(),this._update("data:source",{type:e,data:A},{type:t,oldValue:i}),this}updateFilterMainEnable(e){const A=this.$data.filterWork.getMainEnabled();return this.$data.filterWork.updateMainEnabled(e),this.$data.refresh(),this._update("data:filterMainEnable",e,A),this}updateFilterEnabled(e,A){const t=e.enabled;return this.$data.filterWork.updateEnabled(e,A),this.$data.refresh(),this._update("data:filterEnable",{filterItem:e,enabled:A},{filterItem:e,enabled:t}),this}updateFilterName(e,A){const t=e.filter.name;return this.$data.filterWork.updateName(e,A),this._update("data:filterName",{filter:e,name:A},{filter:e,name:t}),this}updateFilterData(e,A,t){const i=e.filter.code,s=deepClone$1(e.filter.callbackArgs);return this.$data.filterWork.updateData(e,A,t),this.$data.refresh(),this._update("data:filterData",{filter:e,code:A,callbackArgs:t},{filter:e,code:i,callbackArgs:s}),this}addFilter(e){const A=this.$data.dataManager.filterManager.add(e);return this.$data.filterWork.add(A)}removeFilter(e){return this.$data.dataManager.filterManager.remove(e),e.enabled&&this.$data.refresh(),this}useFilter(e,A){return this.$data.filterWork.addUse(e,A),this.$data.refresh(),this._update("data:filterUse",{filter:e,enabled:A},null),this}unUseFilter(e){return this.$data.filterWork.remove(e),this._update("data:filterUnUse",null,{filter:e}),this}moveFilter(e,A,t){return this.$data.filterWork.moveTo(e,A,t),this.$data.refresh(),this._update("data:filterMoveTo",{sourceFilterItem:e,targetFilterItem:A,type:t},null),this}_toJSON(){const{type:e,name:A,opts:t}=this,i=deepClone$1(this.$data.dataSource.get("staticData")),s=this.$data.toJSON();return delete s.source.staticData,{option:{type:e,name:A,opts:deepClone$1(t),data:i},kpOption:{kpData:s}}}toJSON(){const e=this._toJSON();return Object.values(this.$options.attrs).forEach((A=>{A.option.toJSONFn&&A.option.toJSONFn(e)})),e}_destroyBegin(){return this.$options.status=!1,this}_destroy(){return this.$root.$off("hook:componentComplete",this._componentComplete,this),this.$uiAdapter?.destroy(),this.$data.destroy(),this.$parent.adapter=null,this}_destroyEnd(){return this.$data=null,this._waitResolve=null,this._waitComplete=null,this.$dataManager=null,this.$dataAdapter=null,this.$complete=null,this.$type=null,this.$root=null,this.$parent=null,this.$options.name=null,this.$options.options=null,this.$options._kpOption=null,this.$options.kpOption=null,this.$options.config=null,this.$options.parent=null,this.$options.root=null,this.$options.adapterManager=null,this.$options.dataManager=null,this}$destroy(){return this._destroyBegin(),this.$emit("beforeDestroyAdapter",this),this.$root.$emit("beforeDestroyAdapter",this),this.$emit("beforeDestroyAdapter:"+this.$type,this),this.$root.$emit("beforeDestroyAdapter:"+this.$type,this),this._destroy(),this.$emit("destroyedAdapter",this),this.$root.$emit("destroyedAdapter",this),this.$emit("destroyedAdapter:"+this.$type,this),this.$root.$emit("destroyedAdapter:"+this.$type,this),this._destroyEnd(),this}$updateAttrs(){return Object.keys(this.$options.attrs).forEach((e=>{this.$updateAttr(e)})),this}$updateAttr(e){const A=this.$options.attrs[e];return A&&A.init&&(A.value=A.init()),this}$addEventListener(e,A,t){return this.$parent.$addEventListener(e,A,t),this}$removeEventListener(e,A,t){return this.$parent.$removeEventListener(e,A,t),this}$on(e,A,t){return this.$parent.$on(e,A,t),this}$once(e,A,t){return this.$parent.$once(e,A,t),this}$off(e,A,t){return this.$parent.$off(e,A,t),this}$emit(e,...A){return this.$parent.$emit(e,...A),this}get $canvas(){return this.$parent.$canvas}get $el(){return this.$parent.$el}get $uiAdapter(){return this.$uiComp.adapter}get $uiApp(){return this.$uiAdapter.componentInstance}get $uiComp(){return this.$parent.$uiComp}};function initAttrs(e){e._registerAttr("name",null,(function(){return e.$options.options.name}))._registerAttr("opts",null,(function(){let A;return A=isEmpty$1(e.$options.options.opts)?deepClone$1(getOpts(e.$uiApp)):deepClone$1(e.$options.options.opts),A}),null,(function(A){try{e.$uiAdapter.setOption(deepClone$1(A))}catch(A){console.warn(e.$parent.id+" 这个图表设置样式失败",A)}return A}))._registerAttr("type",null,(function(){return e.$uiAdapter.type}))._registerAttr("option",null,(function(){return e.$options.options.option}))}class ConchAdapter extends BaseAdapter$1{_beforeInit(){super._beforeInit(),this.propertyPanel=null,this.isConch=!0;const e=this;return e._registerAttr("events",null,(function(){return deepClone$1(e.$options.options.events||[])}),null,(function(e){return e}),(function(A){return A.option.events=deepClone$1(e.events),A}))._registerAttr("theme",null,(function(){let A=null;return e.$options.options.theme?A=deepClone$1(e.$options.options.theme):e.$uiApp.theme&&(A=deepClone$1(e.$uiApp.theme)),A}),null,(function(A){return e.$uiApp.setTheme(deepClone$1(A)),A}))._registerAttr("padding",null,(function(){let A=null;return e.$options.options.padding?A=deepClone$1(e.$options.options.padding):e.$uiApp.padding&&(A=deepClone$1(e.$uiApp.padding)),A}),null,(function(A){return e.$uiApp.setPadding(deepClone$1(A)),A})),this}_completed(){this.$dataAdapter="seabedData"===this.$uiApp?.tag,this.propertyPanel=this.$uiApp?._options?.propertyPanel;const e=this.$options.kpOption.kpData;return e?this.$options.config.merge&&(e.fieldMapping=mergeDataFields(e.fieldMapping,deepClone$1(this.$uiApp?._options?.fields))):this.$options.kpOption.kpData={close:!0,time:10,dataType:"staticData",source:{staticData:deepClone$1(this.$uiApp?.data),restData:{url:"",header:null,level:null,body:null,method:"POST",conditionType:"condition",callbackArgs:[],code:"return body"}},subscribeData:null,fieldMapping:deepClone$1(this.$uiApp?._options?.fields),filter:{enabled:!1,list:[]}},super._completed(),this}async _initEnd(){if(await super._initEnd(),this.theme)try{this.$uiApp.setTheme(this.theme)}catch(e){console.warn(this.$parent.id+" 这个图表设置颜色方案失败",e)}if(this.padding)try{this.$uiApp.setPadding(this.padding)}catch(e){console.warn(this.$parent.id+" 这个图表设置边距失败",e)}return this}async _initConfig(){const e=this.$options.config||{};if(e.suCaiObj){const{type:A,url:t}=e.suCaiObj,i=this.$uiApp;switch(A){case"shape":await i.init({basic:t});break;case"image":await i.init({image:t});break;case"custom":await i.init({shapeType:"custom",custom:t});break;case"audio":case"video":await i.setOption(Object.assign(deepClone$1(i.opts),{[A]:t}))}this.opts=deepClone$1(i.opts)}}setTheme(e){this.theme=e}setPadding(e){this.padding=e}_toJSON(){const e=super._toJSON(),A={option:deepClone$1(this.option),theme:deepClone$1(this.theme),padding:deepClone$1(this.padding)};return Object.assign(e.option,A),e}$destroy(){super.$destroy(),this.propertyPanel=null}}let UdatavAdapter$1=class extends BaseAdapter$1{_toJSON(){const e=super._toJSON();return e.option.options=this.$options.options?.options,e}},ctrlName,ctrl;class ThingJSAdapter extends ConchAdapter{_beforeInit(){return super._beforeInit(),this.thingType=null,this.thingOpts=null,this.thingId=null,this.isThing=!0,this.$twinComplete=!1,this}_initBegin(e,A,t,i){return super._initBegin(e,A,t,i),this.thingType=t.thingType,this.thingOpts=deepClone$1(t.thingOpts),this.thingId=t.thingId,this}async _initEnd(){return await super._initEnd(),this.$emit("createdTwin",this),this.$emit("createdTwin:"+this.$type,this),this.$root.$emit("createdTwin",this),this.$root.$emit("createdTwin:"+this.$type,this),this._initTwinApp(),this.$root.$on("resize",this._initStyle,this),this.$root.$on("beforeToImage",this._beforeToImage,this),this.$root.$on("toImaged",this._toImaged,this),this}async _initTwinApp(){this.$options.rootConfig.twin.disable?console.warn("孪生功能已禁用"):await this._initApp()}_getTwinConfig(e){const A=this.$options.rootConfig.twin.configFormatter;return A?A(e,this):e}async _initApp(){return this}_twinCompleted(){this._initStyle(),this.$twinComplete=!0,this.$emit("completedTwin",this),this.$emit("completedTwin:"+this.$type,this),this.$root.$emit("completedTwin",this),this.$root.$emit("completedTwin:"+this.$type,this)}_initStyle(){"function"==typeof this.twinInstance?._initStyle&&this.twinInstance._initStyle()}async refresh(){this._destroyTwin(),await this._initTwinApp()}reset(){return this}fly(e,A,t){const i=this.twinInstance,s=i.query("##"+e)[0];return s?(i.camera.stopFlying(),i.pauseEvent(window.THING.EventType.EnterLevel,"*",window.THING.EventTag.LevelFly),i.one(window.THING.EventType.EnterLevel,"."+s.type,(e=>{const s=e.object;i.camera.flyTo({object:s,position:A,target:t,time:1e3,complete:function(){console.log("飞行结束")}}),i.resumeEvent(window.THING.EventType.EnterLevel,"*",window.THING.EventTag.LevelFly)}),"customLevelFly"),i.level.change(s),!0):(console.error("没有找到这个目标，uuid为："+e),!1)}earthFly(e,A){const t=this.twinInstance;t.camera.stopFlying();const i={position:e,target:A,time:1e3,complete:function(){console.log("飞行结束")}};return t.camera.earthFlyTo?t.camera.earthFlyTo(i):t.camera.flyTo(i),!0}_beforeToImage(){this.$uiComp.maskEl.style.backgroundImage=`url(${this.$uiApp.toImage()})`}_toImaged(){this.$uiComp.maskEl.style.backgroundImage=""}_toJSON(){const e=super._toJSON(),A={thingType:this.thingType,thingOpts:deepClone$1(this.thingOpts),thingId:this.thingId,isThing:this.isThing};return Object.assign(e.kpOption,A),e}_destroyTwin(){try{this.$uiApp.destroyCampus()}catch(e){console.error("孪生销毁失败",e)}}_destroyBegin(){return super._destroyBegin(),this.$emit("beforeDestroyTwin",this),this.$emit("beforeDestroyTwin:"+this.$type,this),this.$root.$emit("beforeDestroyTwin",this),this.$root.$emit("beforeDestroyTwin:"+this.$type,this),this}_destroy(){return this._destroyTwin(),super._destroy()}_destroyEnd(){return this.isThing=null,this.thingType=null,this.thingOpts=null,this.thingId=null,this.$root.$off("resize",this._initStyle,this),this.$root.$off("beforeToImage",this._beforeToImage,this),this.$root.$off("toImaged",this._toImaged,this),this.$emit("destroyedTwin",this),this.$emit("destroyedTwin:"+this.$type,this),this.$root.$emit("destroyedTwin",this),this.$root.$emit("destroyedTwin:"+this.$type,this),super._destroyEnd()}get twinInstance(){return this.$uiApp.app}}function getCtrlName(){return"campus-"+(new Date).getTime()}class EffectThemeControl{constructor(){this.app=null}init(e){if(this.hasEffectResource){this.app=e;const A=new THING.EffectThemeControl;e.addControl(A,"效果模板控制器"),ctrl=e.getControl("效果模板控制器")}}decrypt(e){if(!window.CryptoJS)return null;const A=window.CryptoJS;if("object"==typeof e)return e;const t=A.enc.Utf8.parse("CityBuilder@2019"),i=A.AES.decrypt(e,t,{mode:A.mode.ECB,padding:A.pad.Pkcs7});return A.enc.Utf8.stringify(i).toString()}update(e,A){ctrlName=getCtrlName(),ctrl.registerTheme(ctrlName,e,A);const t=this.app.query(".Campus")[0];t.applyTheme(ctrlName),ctrl.applyEffectTheme(ctrlName,t),ctrl.applyThemeEnvironment(ctrlName,t)}destroy(){if(this.app){const e=this.app.query(".Campus")[0];THING.ThemeManager.findStyle(ctrlName)&&(ctrl.destroyEffectTheme(ctrlName,e),e.applyTheme(null),THING.App.current.off(THING.EventType.EnterLevel,null,"ThemeEnterLevelToUpdateEnv"))}}destroyControl(){this.app=null,ctrl=null,ctrlName=null}get hasEffectResource(){return window.THING.EffectThemeControl}}var effectThemeControl=new EffectThemeControl;class CampusAdapter extends ThingJSAdapter{_beforeInit(){super._beforeInit();const e=this;e._registerAttr("effectTheme",null,(function(){let A=null;return e.$options.kpOption.effectTheme?A=deepClone$1(e.$options.kpOption.effectTheme):e.$uiApp.effectTheme&&(A=deepClone$1(e.$uiApp.effectTheme)),A}),null,(function(e){return e}),{noAdd:!0})}async _initApp(){this.$twinComplete=!1,!this.thingOpts.urlV1&&this.thingOpts.url&&(this.thingOpts.urlV1=this.thingOpts.url.split("/builder/api-campus/")[1],this.thingOpts.code=this.thingId);const e=await this._waitAppInit();return await this._campusCompleted(e),this}_waitAppInit(){let e=!1;return new Promise((A=>{const t=this.$options.rootConfig,i=this._getTwinConfig({authServerUrl:t.twin.thingJsAuthServerUrl,urlV1:"/builder/api-campus/"+this.thingOpts.urlV1,options:{complete:e=>A(e)}}),s=this.$uiApp.init(this.thingOpts,i);this.$uiApp.hasCompleteFn||s.one("load",(t=>{if(!e)return e=!0,A(t)}))}))}async _campusCompleted(e){this.twinInstance&&(this.twinInstance.level.change(e.campus),this.twinInstance.level.options.autoChangeBackground=!1,this.effectControl.init(this.twinInstance),await this._setEffectTheme(this.effectTheme),this._twinCompleted(e))}async _setEffectTheme(e){return this.$uiApp.effectTheme=deepClone$1(e),await this.$root.$syncEmit("campusEffectInit",this),this}async setEffectTheme(e){return this.clearEffectTheme(),this.effectTheme=e,await this._setEffectTheme(e),this}clearEffectTheme(){this.effectControl.destroy(),this.$uiApp.effectTheme=null,this.effectTheme=null}_toJSON(){const e=super._toJSON();return Object.assign(e.kpOption,{effectTheme:deepClone$1(this.effectTheme)}),e}async reset(){return this.clearEffectTheme(),await this.refresh(),this}_destroy(){return this.clearEffectTheme(),this.effectControl.destroyControl(),super._destroy()}get effectControl(){return effectThemeControl}}class LowCodeAdapter extends ThingJSAdapter{async _initApp(){this.$twinComplete=!1;const e=this.$options.rootConfig,A=this._getTwinConfig({authServerUrl:e.twin.thingJsAuthServerUrl,url:this.thingOpts.resourceId.substr(1)});return await this.$uiApp.init(this.thingOpts,A).catch((e=>{console.warn("低代码图表加载失败",e)})),this._waitLowCodeComplete(),this}_waitLowCodeComplete(){setTimeout((()=>{this.twinComplete?this.twinInstance.inited?this.$twinComplete||this._twinCompleted(this.twinInstance):this.twinComplete.one("complete",(e=>{this.$twinComplete||this._twinCompleted(e)})):console.warn("没有获取到孪生实例")}),500)}get twinComplete(){return window.app}}class MapAdapter extends ThingJSAdapter{async _initApp(){this.$twinComplete=!1;const e=this.$options.rootConfig,A=this._getTwinConfig({id:this.thingOpts.id,mapJson:this.thingOpts.urlV1,offline:!1,authServerUrl:e.twin.thingJsAuthServerUrl});await this.$root.$syncEmit("TwinMapInit",this,A);try{A.mapJson&&this.$uiApp.init(this.thingOpts,A,(()=>{this._twinCompleted(this.$uiApp.twinInstance)}))}catch(e){console.error("城市资源加载失败",e)}}_destroyTwin(){this.$uiApp.destroyMap()}}class TopologyAdapter extends ThingJSAdapter{_beforeInit(){return super._beforeInit(),this.isTopology=!0,this}_initApp(){this.$twinComplete=!1;const e=this.$options.rootConfig,A=this.thingOpts.page?`?page=${this.thingOpts.page}`:"",t=this._getTwinConfig({authServerUrl:e.twin.thingJsAuthServerUrl,url:`/diagrams/${this.thingOpts.resourceId}${A}`,isOffline:!1,enableAnimate:!this.$parent.$options.isEdit});return this.$uiApp.init(this.thingOpts,t).once("load",(e=>{this.$twinComplete||this._twinCompleted(e)})),this}_beforeToImage(){this.$uiComp.maskEl.style.backgroundImage=null}resetZoom(){const e=this.$uiApp.app;e&&(e.resetZoom(),e.resetZoom())}}class ModuleManager{constructor(e,A){this.elementMap=e,this.adapterMap=A}install(e){return e.install(this)}}class Module{constructor(e){this.parent=e,this.elementMap=null,this.adapterMap=null,this.moduleManager=null,this.pluginList=null}init({elements:e,adapters:A}){this.pluginList=[],this.elementMap=e,this.adapterMap=A,this.moduleManager=new ModuleManager(e,A)}install(e){const A=this.moduleManager.install(e);this.pluginList.push({Fn:e,instance:A})}getElement(e){return this.elementMap[e]}getElementType(e){const A=this.elementMap;for(const t in A)if(e instanceof A[t])return t}getAdapter(e){return this.adapterMap[e]}getAdapterType(e){const A=this.adapterMap;for(const t in A)if(e instanceof A[t])return t}}class AdapterManager{constructor(e){this.parent=e,this.module=e.module}create(e,A,t,i){const s=this.module.getAdapter(e);if(s)return new s(e,A,t,i);console.error(e+"没有注册")}getType(e){return this.module.getAdapterType(e)}}const comp={state:{compData:[]},get:{getById:(e,A)=>{let t;if(A&&"string"==typeof A)return null===(t=e.compData.find((e=>e.id===A)))||void 0===t?void 0:t.data},getByAlias:(e,A)=>{let t;if(A&&"string"==typeof A)return null===(t=e.compData.find((e=>e.alias===A)))||void 0===t?void 0:t.data},getcompData:e=>e.compData},set:{setUdata:(e,A)=>e.compData=A}},callbackPool={state:{callbackPool:{}},get:{getcallbackPool:e=>e.callbackPool},set:{addCBToStackHostPool:(e,A)=>{if(Array.isArray(A)){const[t,i]=A;if(!t.id||!t.callback)return;const s=e.callbackPool;s[i]||(s[i]=[]),s[i].push(t)}},clearFromStackHostPool(e,A){const t=e.callbackPool,[i,s]=A;if(t[s]){const A=e.callbackPool[s];let t=A.length;for(;t--;){A[t].id===i&&A.splice(t,1)}}}}};class StorageManager{constructor(e){this.statePool={},this.getPool={},this.setPool={},e.forEach((e=>{this.register(e)}))}register(e){Object.assign(this.statePool,e.state),Object.assign(this.getPool,e.get),Object.assign(this.setPool,e.set)}get(e,A){return this.getPool[e](this.statePool,A)}commit(e,A){this.setPool[e](this.statePool,A)}}const store=new StorageManager([comp,callbackPool]);Math.random().toString(36).substr(-8);const isType=(e,A)=>Object.prototype.toString.call(e).includes(A),getCSSTextFromStyleObj=e=>{if(!e)return null;let A="";for(const t in e){if(["bgImageUrl","isBgImage","backgroundColorLgColor","backgroundColorisUseLgColor","webkitTextFillColor","colorisUseLgColor","colorLgColor"].includes(t))continue;const i=/\w/g;let s="";s=t.replace(i,(function(e){return e>="A"&&e<="Z"?"-"+e.toLowerCase():e})),A+=`${s}:${e[t]};`}return A},createDiv=e=>{const A=document.createElement("div");return A.setAttribute("style",e),A},formatData=(e,A,t)=>{const i=e.padStart(A,"0");return t&&i.length>4?i.substring(0,A-4)+"万"+i.substring(A-4,A):i},checkLastChar=function(e){let A="";if("string"==typeof e){const t=e.length;";"!==e.substr(t-1,1)&&(A=";")}return A};class CompBase{constructor(e,A){this.config=A,this.el=e,this.uBizData=A.data,this.options=A.opts,this._options={},this.cbArr=[],this.comTimes=null,this.componentAliasObj={},this.initApi()}get JSCode(){return this.config.options.JSCode||""}get compType(){return this.config.options.type}_initComponent(){this.initBizData(),this.initOptions(),this.runJSCode(),this.initCompDom()}resize(){}initBizData(){}initOptions(){}initCompDom(){}update(){}getOption(){return this.options}setOption(e){this.options=e,this.update()}getData(){return this.uBizData}setData(e){this.uBizData=e,this.update()}runJSCode(){if(this.JSCode){const e=new Function("param",`${this.JSCode}`);if("function"==typeof e)try{e.call(this.api)}catch(e){console.error(`组件执行代码逻辑失败: ${e}`)}}}runTimesFunction(e,A){this.comTimes=null,this.comTimes&&window.clearTimeout(this.comTimes),this.comTimes=window.setTimeout((()=>{this.runTimesFunction(e,A),e.call(this.api)}),parseInt(A))}getCSSTextFromStyle(e){let A="";const t=e=>{if(!e)return null;if(isType(e,"Array"))return e.forEach((e=>{t(e)})),null;if(isType(e,"Object")){const t=this.api.getStyleStringByObject(e);t&&(A+=t,A+=checkLastChar(A))}isType(e,"String")&&(A+=e,A+=checkLastChar(A))};return t(e),A}initApi(){const e=this.compType;this.api={getDom:()=>this.el,getEcharts:()=>window.echarts,getJquery:()=>window.$,getOptions:()=>this.options,setOptions:e=>{this.options=e},getComponentData:()=>this.uBizData},this.api.getSceneDataByAlias=e=>store.get("getByAlias",e)||null,this.api.getPublishDataById=e=>store.get("getById",e)||null,this.api.getPublishDataByAlias=e=>store.get("getByAlias",e)||null,this.api.clearDom=()=>{const e=this.el;window.$(e).empty()},this.api.setStyle=(e,A)=>{if(e&&e instanceof HTMLElement&&A&&"object"==typeof A)for(const t in A)e.style[t]=A[t]},this.api.setStyleByArray=(e,A)=>{let t;if(e instanceof Array&&A instanceof Array&&e.length===A.length){const i=e.length;for(let s=0;s<i;s++){const i=e[s],n=A[s];null===(t=this.api)||void 0===t||t.setStyle(i,n)}}},this.api.setItemValue=(e,A)=>{e&&e instanceof HTMLElement&&("string"==typeof A||"number"==typeof A)&&(e.innerText=A)},this.api.mountToDom=(e,A)=>{A instanceof HTMLElement&&e instanceof HTMLElement&&A.appendChild(e)},this.api.setItemHTML=(e,A)=>{e&&e instanceof HTMLElement&&"string"==typeof A&&(e.innerHTML=A)},this.api.getStyleStringByObject=e=>{let A="";for(const t in e)A+=`${t}:${e[t]};`;return A},this.api.createDOMByDefinition=(e,A,t)=>{if(e&&A&&isType(A,"Array"))return!1;A.forEach((A=>{let i=null;const s=A.type;if(!s)return null;if(["svg","defs","rect","linearGradient","stop"].includes(s)){const e="http://www.w3.org/2000/svg";i=document.createElementNS(e,s)}else i=document.createElement(s);const n=A.style;n&&(i.style.cssText=this.getCSSTextFromStyle(n));const r=A.text;r&&(i.innerText=r),e.appendChild(i),t&&isType(t,"Function")&&t.call(this,i,A),A.children&&this.api.createDOMByDefinition(i,A.children,t)}))},this.api.setComponentSize=(e,A)=>{e&&Number.isInteger(parseInt(e))?this.parent.options.style.width=`${parseInt(e)}px`:console.warn("Javascript脚本中调用setComponentSize函数缺少宽度参数,或者参数宽度不为数字"),A&&Number.isInteger(parseInt(A))?this.parent.options.style.height=`${parseInt(A)}px`:console.warn("Javascript脚本中调用setComponentSize函数缺少高度参数,或者参数高度不为数字")},this.api.setTimes=(e,A)=>{"function"==typeof e&&parseInt(A)?(this.comTimes&&window.clearTimeout(this.comTimes),this.comTimes=null,this.runTimesFunction(e,A)):console.error("setTimes传入参数错误")},this.api.addCallback=e=>{e instanceof Function&&this.cbArr.push(e)},this.api.clearCallback=()=>{this.cbArr=[]},this.api.addCBToStackHostPool=(e,A)=>{const t=[{id:this.config.name,callback:e,self:this},A];return store.commit("addCBToStackHostPool",t)},this.api.clearFromStackHostPool=e=>{const A=[this.config.name,e];return store.commit("clearFromStackHostPool",A)},this.api.clearTimes=()=>{this.comTimes&&window.clearTimeout(this.comTimes),this.comTimes=null},this.api.setComponentData=A=>{if(A)if("ctextlist"===e){if(this.uBizData=window.$.extend(!0,[],A),this.initOptions(),this.initBizData(),!this.options.isCarousel)for(const e of this.uBizData)e.isShow=!0}else this.uBizData=A;else console.warn("没有获取到合法的数据")},this.api.startAnimate=()=>{},window.callCBStack=e=>{if(!e||"string"!=typeof e)return void console.error("call回调队列时参数字符中需要携带队列id,并且参数必须为字符串");if(e.indexOf("，")>=0)return void console.error("call回调队列的参数中不能含有中文逗号,如果传多参，参数之间用英文逗号隔开");const A=e.split(","),[t,...i]=A,s=store.get("getcallbackPool").all;if(s&&s instanceof Array){const e=s.length;for(let A=0;A<e;A++){if(s[A][1]!==t)continue;const e=s[A][0];e.callback.call(e.self,i)}}}}destory(){this.options=void 0,this.uBizData=void 0,this.api=void 0,this.dom&&(this.el?.removeChild(this.dom),this.dom=void 0),window.$(this.el).empty()}}class CompNew extends CompBase{}class Text extends CompNew{_initComponent(){this.initOptions(),this.initCompDom(),this.initBizData(),this.runJSCode()}initCompDom(){const e=document.createElement("div");e.setAttribute("style","width:100%;height:100%;overflow:hidden;"),this.dom=document.createElement("div"),this.dom.innerText=this.uBizData?.value||"数据不符合规范",e.appendChild(this.dom),this.options&&this._setOption(this.options),this.el?.appendChild(e)}initOptions(){if(this.options){const e=this.options;e?.colorLgColor&&e?.colorisUseLgColor&&(e.backgroundImage=e?.colorLgColor.replace(/_/g,","),e["-webkit-background-clip"]="text",e["-webkit-text-fill-color"]=e.webkitTextFillColor),this._setOption(e)}}_setOption(e){this.dom&&(this.compStyle=getCSSTextFromStyleObj(e),this.dom.setAttribute("style",this.compStyle))}initBizData(){let e=this.uBizData;Array.isArray(e)&&(e=e[0]),e||(e={value:"数据为null"}),this._setData(e)}_setData(e){this.dom&&(this.uBizData=e,this.dom.innerText=e.value||"数据不符合规范")}update(){this.initOptions(),this.runJSCode(),this.initBizData()}destory(){this.uBizData=void 0,this.compStyle=void 0,super.destory()}}class Layer extends CompNew{initCompDom(){let e;this.dom=document.createElement("div"),this.initOptions(),null===(e=this.el)||void 0===e||e.appendChild(this.dom)}initOptions(){if(this.dom&&this.options){const e=this.options;let A="height:100%;";e.backgroundColor&&(A+=`background-color:${e.backgroundColor};`),e.isBgImage&&e.bgImageUrl&&(A+=`background-image:${e.bgImageUrl};background-size:100%;background-position:center;background-repeat:no-repeat;`),this.dom.setAttribute("style",A),(null==e?void 0:e.backgroundColorisUseLgColor)&&e.backgroundColorLgColor&&(this.dom.style.background=e.backgroundColorLgColor.replace(/_/g,","))}}update(){this.initOptions(),this.runJSCode()}}function init(e,A){e.forEach(((e,t)=>{e.style.transition="",e.style.transform="",e._height||(e._height=e.style.height),e._display||(e._display=e.style.display),e.ontransitionend=null,t<=A-1?(e.style.display=e._display,e.style.opacity="1"):(e.style.display="none",e.style.opacity="0")}))}function scroll(e,A,t){let i=0;const s=e.length-1;init(e,A);let n,r=!0;return async function o(){const a=e[i+A];await leave(e[i]),a&&await enter(a),i>=s?(init(e,A),i=0):i++,r&&(n=setTimeout((()=>{clearTimeout(n),o()}),1e3*+t))}(),()=>{r=!1,n&&clearTimeout(n)}}function leave(e){return new Promise((A=>{e.style.display=e._display,setTimeout((()=>{e.style.transition="transform 0.5s, opacity 0.5s, height 0.5s",e.style.transform="translateY(20px) rotateX(90deg)",e.style.opacity="0",e.style.height="0",e.ontransitionend=function(){e.style.transition="",e.style.display="none",e.style.opacity="0",e.style.height=e._height,e.ontransitionend=null,A()}}))}))}function enter(e){return new Promise((A=>{e.style.display=e._display,e.style.opacity="0",e.style.transform="translateY(50px)",e.style.transition="",setTimeout((()=>{e.style.transition="transform 0.8s, opacity 0.8s",e.style.opacity="1",e.style.transform="translateY(0)",e.ontransitionend=function(){e.style.transform="translateY(0)",e.style.opacity="1",e.ontransitionend=null,A()}}))}))}class TextList extends CompNew{initBizData(){this.uBizData&&(this.cacheData||(this.cacheData=JSON.parse(JSON.stringify(this.uBizData))),this.uBizData=this.cacheData.map((e=>Object.assign(Object.assign({},e),{cellStyle:{}}))))}initOptions(){const e=this.options;if(!e)return null;const A="px"===e.titleLineheight?"50px":e.titleLineheight,t={color:e.titleColor,textAlign:e.titleTextAlign,fontFamily:e.titleFontFamily,fontSize:e.titleFongSize,fontWeight:e.titleFontWeight,lineHeight:A,backgroundColor:e.titleBackgroundColor,borderColor:e.titleBorderColor,borderStyle:e.titleBorderStyle,borderWidth:e.titleBorderWeight,height:A,background:""},i={textAlign:e.fontTextAlign,lineHeight:e.fontLineHeight},s={borderColor:e.borderColor,borderStyle:e.borderStyle,borderWidth:e.borderWeight},n={color:e.oddFontColor,fontFamily:e.oddFontFamily,fontSize:e.oddFontSize,fontWeight:e.oddFontWeight,height:e.fontLineHeight,backgroundColor:e?.oddBackgroundColor,background:""},r={color:e.evenFontColor,fontFamily:e.evenFontFamily,fontSize:e.evenFontSize,fontWeight:e.evenFontWeight,height:e.fontLineHeight,backgroundColor:e?.evenBackgroundColor,background:""};e?.titleBackgroundColorLgColor&&e?.titleBackgroundColorisUseLgColor&&(t.background=e?.titleBackgroundColorLgColor.replace(/_/g,",")),e?.oddBackgroundColorLgColor&&e?.oddBackgroundColorisUseLgColor&&(n.background=e?.oddBackgroundColorLgColor.replace(/_/g,",")),e?.evenBackgroundColorLgColor&&e?.evenBackgroundColorisUseLgColor&&(r.background=e?.evenBackgroundColorLgColor.replace(/_/g,",")),this.compStyle={titleStyle:getCSSTextFromStyleObj(t),bodyStyle:getCSSTextFromStyleObj(i),borderStyle:getCSSTextFromStyleObj(s),oddStyle:getCSSTextFromStyleObj(n),evenStyle:getCSSTextFromStyleObj(r)}}_destoryDom(){this.textListDom&&window.$(this.textListDom).empty(),this.clearTimer&&this.clearTimer()}createHead(){const{titleStyle:e}=this.compStyle,A=createDiv(`display:flex;${e}`);return this.options.title.forEach((e=>{const t=createDiv(`width:${e.titleWidth};`);t.innerText=e.titleName||"",A.appendChild(t)})),A}createBodyDom(){const{bodyStyle:e,borderStyle:A,oddStyle:t,evenStyle:i}=this.compStyle,s=document.createElement("div");return Array.isArray(this.uBizData)?(this.uBizData.forEach(((n,r)=>{const o=createDiv(`box-sizing:border-box;width:100%;display:flex;${A};${(r+1)%2?t:i}`);this.options.title.forEach((A=>{if(n.cellStyle){let t="";n.cellStyle[A.compName]&&(t=getCSSTextFromStyleObj(n.cellStyle[A.compName])||"");const i=createDiv(`${e};width:${A.titleWidth};${t}`);i.innerText=n[A.compName]||"",o.appendChild(i)}})),s.appendChild(o)})),s):s}initCompDom(){if(this.textListDom?this._destoryDom():(this.textListDom=document.createElement("div"),this.textListDom.setAttribute("style","width:100%;height:100%;overflow:hidden;"),this.el?.appendChild(this.textListDom)),this.compStyle){const e=this.options,A=this.createHead(),t=this.createBodyDom();this.uBizData?.length>0&&e?.isCarousel&&"onebyone"===e.animateType&&(this.clearTimer=scroll(Array.from(t.childNodes),+e.pageNumber,e.carouselCycle)),this.textListDom.appendChild(A),this.textListDom.appendChild(t)}}update(){this.initBizData(),this.initOptions(),this.runJSCode(),this.initCompDom()}getData(){return this.cacheData}setData(e){this.cacheData=e,this.update()}}class Iframe extends CompNew{initCompDom(){let e;this.dom=document.createElement("iframe"),this.dom.setAttribute("style","width:100%;height:100%"),this.initOptions(),null===(e=this.el)||void 0===e||e.appendChild(this.dom)}initOptions(){this.dom&&this.options&&this.options.iframeURL&&!0===this.options.isOpenIframe&&(this.dom.src=/^(http|https):/.test(this.options.iframeURL)?this.options.iframeURL:`http://${this.options.iframeURL}`)}update(){this.initOptions(),this.runJSCode()}}class Progress extends CompNew{initCompDom(){let e;const A=createDiv("width:100%;height:100%;overflow:hidden;");isType(this.uBizData,"Array")&&this.uBizData.forEach((e=>{A.appendChild(this.createProgressDom(e,this.compStyle))})),null===(e=this.el)||void 0===e||e.appendChild(A)}update(){window.$(this.el).empty(),this.initBizData(),this.initOptions(),this.runJSCode(),this.initCompDom()}getData(){return this.cacheData}setData(e){this.cacheData=e,this.update()}initBizData(){isType(this.uBizData,"Array")?(this.cacheData||(this.cacheData=JSON.parse(JSON.stringify(this.uBizData))),this.uBizData=this.cacheData.map((e=>Object.assign(Object.assign({},e),{cProgressColor:{}})))):console.warn("数据不符合规范，cprogress类型数据应该是一个数组")}createProgressDom(e,A){let t="";e.cProgressColor&&(t=getCSSTextFromStyleObj(e.cProgressColor));const{progress:i,title:s,unit:n,progressbg:r}=A,o=createDiv(`${s}`),a=createDiv(`${r}`),l=createDiv(`${n}`);e.title?o.innerHTML=`${e.title}`:o.style.display="none",l.innerHTML=100*e.progress+" %";const c=createDiv(`${i}${t}width:${e.progress*parseInt(this.options.progress_width)}px`);a.appendChild(c);const h=createDiv("display:flex;");return h.appendChild(o),h.appendChild(a),h.appendChild(l),h}initOptions(){this.compStyle||(this.compStyle={progress:"",title:"",unit:""});const e=this.options,A={};for(const t in e){const i=t.split("_");i[1]&&(A[i[0]]?A[i[0]][i[1]]=e[t]:A[i[0]]={[i[1]]:e[t]})}const{title:t,progress:i,unit:s}=A;t?.backgroundColorLgColor&&t?.backgroundColorisUseLgColor&&(t.background=t.backgroundColorLgColor.replace(/_/g,",")),i?.backgroundColorLgColor&&i?.backgroundColorisUseLgColor&&(i.background=i.backgroundColorLgColor.replace(/_/g,",")),s?.backgroundColorLgColor&&s?.backgroundColorisUseLgColor&&(s.background=s.backgroundColorLgColor.replace(/_/g,","));const{backgroundColor:n,borderRadius:r,color:o,height:a,marginTop:l,width:c}=i;A.progressbg={backgroundColor:n,borderRadius:r,height:a,width:c,marginTop:l},A.progress={backgroundColor:o,borderRadius:r,height:a};for(const e in A)this.compStyle[e]=getCSSTextFromStyleObj(A[e])}}class Timecard extends CompNew{initOptions(){if(this.options){const e=this.options;let A=`color:${e.fontColor};font-family:${e.fontFamily};font-size:${e.fontSize};`;this.dateStyle=e.isShowDay?"":"display:none;",this.timerStyle=e.isShowTime?"":"display:none;",e.isLineWarp||(A+="display: flex;",this.dateStyle+=`margin-right:${e.spacing};`),this.compStyle=A,this._setOption()}}initCompDom(){let e;this.dom=createDiv(this.compStyle||""),this.dateDom=createDiv(this.dateStyle||""),this.timeDom=createDiv(this.timerStyle||""),this.dom.appendChild(this.dateDom),this.dom.appendChild(this.timeDom),null===(e=this.el)||void 0===e||e.appendChild(this.dom),this.setCurrentTime()}update(){this.initOptions()}_setOption(){this.dateDom&&this.timeDom&&(this.dateDom.setAttribute("style",this.dateStyle||""),this.timeDom.setAttribute("style",this.timerStyle||""))}_changeInerHTML(e){this.dateDom.innerText=e[0],this.timeDom.innerText=e[1]}_getNowTime(){const e=new Date;return[e.toLocaleTimeString(),e.getFullYear(),e.getMonth()+1,e.getDate(),e]}setCurrentTime(){this._timer&&clearTimeout(this._timer),this._timer=void 0;const[e,A,t,i,s]=this._getNowTime(),n={0:`${A}年${t}月${i}日`,1:`${A}-${t}-${i}`,2:s.toLocaleDateString()},r=this.options?this.options.timeFormat:0;this._changeInerHTML([n[r],e]),this._timer=setTimeout((()=>{this.setCurrentTime()}),1e3)}destory(){this._timer&&clearTimeout(this._timer),this._timer=void 0,this.dateDom=void 0,this.timeDom=void 0,this.dateStyle=void 0,this.timerStyle=void 0,this.compStyle=void 0,super.destory()}}class CompChart extends CompBase{constructor(e,A){super(e,A),this.echartsInstance=void 0}initApi(){super.initApi(),this.api&&(this.api.renderCharts=()=>{setTimeout((()=>{this.echartsInstance?this.echartsInstance.clear():this.echartsInstance=window.echarts&&window.echarts.init(this.el),this.options&&this.echartsInstance.setOption(this.options)}))},this.api.getChartsInstance=()=>this.echartsInstance,this.api.getChartsData=()=>this.uBizData,this.api.getChartsOptions=()=>this.options)}}class Echarts extends CompChart{constructor(e,A){super(e,A),this.el=e,this.dbapitype=this.config.options.dbapitype||"1",this.defaultColor=[["#2b908f","#90ee7e","#f45b5b","#7798BF","#aaeeee","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"],["#C1232B","#27727B","#FCCE10","#E87C25","#B5C334","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD","#D7504B"],["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4"],["#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#7798BF","#aaeeee","#DF5353"],["#E01F54","#001852","#f5e8c8","#b8d2c7","#c6b38e","#a4d8c2","#f3d999","#d3758f","#dcc392","#2e4783","#82b6e9"]]}resize(){this.echartsInstance&&this.echartsInstance.resize()}_initComponent(){this.initBizData(),this.initOptions(),this.runJSCode(),this.initCompDom()}initCompDom(){let e;this.dom||(this.dom=createDiv("width:100%;height:100%;"),null===(e=this.el)||void 0===e||e.appendChild(this.dom),this.echartsInstance=window.echarts&&window.echarts.init(this.dom));const A=this.options;try{this.echartsInstance&&A&&this.echartsInstance.setOption(A)}catch(e){console.error(e)}}update(){this._initComponent()}setAxis(e){isType(e,"Array")&&e.forEach((e=>{this.setAxis(e)})),"category"===e?.type&&(e.data=this.xAxisData)}setSeries(){const e=this.uBizData.length,A=this.options.series.length,t=[];for(let i=0;i<e;i++)if(i<A)this.options.series[i].name=this.uBizData[i].name,this.options.series[i].data=this.uBizData[i].data;else if(A>0){const e=this.options.series[A-1];e.name=this.uBizData[i].name,e.data=this.uBizData[i].data,t.push(e)}t.length>0&&(this.options.series=this.options.series.concat(t))}dealDbapitype1(){if(!isType(this.uBizData,"Array"))return null;this.xAxisData.length>0&&(this.setAxis(this.options.xAxis),this.setAxis(this.options.yAxis)),this.legendData.length>0&&(this.options.legend||(this.options.legend={}),this.options.legend.data=this.legendData),this.setSeries()}dealDbapitype3(){return isType(this.uBizData,"Array")&&this.options&&Object.keys(this.options).length>0?(this.options.series&&(this.options.series[0].data=this.uBizData),void(this.legendData.length>0&&(this.options.legend||(this.options.legend={}),this.options.legend.data=this.legendData))):null}initOptions(){const e=this.dbapitype;if(this.options&&this.xAxisData&&this.legendData){const A=this.options.color;(!A||isType(A,"Array")&&0===A.length)&&(this.options.color=this.defaultColor[0]),"1"===e&&this.dealDbapitype1(),"3"===e&&this.dealDbapitype3(),this.initOptionsFunction(this.options)}}initOptionsFunction(e){if(!e||!isType(e,"Object"))return null;const A=Object.keys(e);for(const t of A){const A=e[t];if(isType(e,"Object")&&this.initOptionsFunction(A),isType(e,"Array"))for(const e of A)this.initOptionsFunction(e);isType(e,"String")&&A.includes("function")&&(e[t]=new Function("return "+A)())}}_dealBizData(e){if(!(e&&isType(e,"Object")&&e.name))return[];const A=[];this.legendData=[],this.xAxisData=[];for(const[t,i]of Object.entries(e))"name"===t&&isType(i,"Array")&&(this.xAxisData=i),"name"!==t&&(isType(i,"Array")&&A.push({name:t,data:i}),this.legendData.push(t));return A}initBizData(){let e=[];const A=this.uBizData,t=this.dbapitype;if("1"===t&&(e=this._dealBizData(A)),"3"===t&&A&&isType(A,"Array")&&A.length>0){e=A,this.legendData=[],this.xAxisData=[];for(const A of e)A.name&&this.legendData.push(A.name)}this.uBizData=e}}class Blankcomponent extends CompNew{update(){this.runJSCode()}}class Countdown extends CompNew{constructor(e,A){super(e,A),this.currentValue=0,this.oldValue=0,this.len=0,this.compDom=null}initCompDom(){let e,{value:A,maxValue:t}=this.uBizData;const{pageAlign:i}=this.options;t||(t=A,A="0"),this.compDom=createDiv(`height:100%;width:100%;overflow:hidden;text-align: ${i};`),this.currentValue=+A,this.len=t.split("").length,t.split("").forEach(((e,A)=>{this.createPage(e,A)})),this.options.split&&this.createPage("0",0),this.loadData(+A,+t),null===(e=this.el)||void 0===e||e.appendChild(this.compDom)}loadData(e,A){this.timer&&clearTimeout(this.timer);const t=Math.floor((A-e)/30)||1;A-this.currentValue>=t?this.currentValue=+this.currentValue+t:this.currentValue=A,this.changeNumber(),+this.currentValue>=+A||(this.timer=setTimeout((()=>{this.oldValue=this.currentValue,this.loadData(e,A)}),1e3))}changeNumber(){let e,A,t;const i=this.options.split,s=(formatData(this.currentValue.toString(),this.len,i)+this.options.unit).split(""),n=(formatData(this.oldValue.toString(),this.len,i)+this.options.unit).split("");if(null===(e=this.compDom)||void 0===e?void 0:e.childNodes)for(let e=0;e<(null===(A=this.compDom)||void 0===A?void 0:A.childNodes.length);e++){const A=null===(t=this.compDom)||void 0===t?void 0:t.childNodes[e];if(A.childNodes[0].setAttribute("data-before",n[e]),A.childNodes[1].setAttribute("data-before",s[e]),A.classList.remove("go"),n[e]!==s[e]){const e=setTimeout((()=>{clearTimeout(e),A.classList.add("go")}),600)}}}update(){window.$(this.el).empty(),this.initOptions(),this.runJSCode(),this.initCompDom()}_createPage(e){if(this.compStyle){const{pageMargin:A}=this.options,t=document.createElement("div"),{font:i,number:s,page:n}=this.compStyle,r=document.createElement("div"),o=document.createElement("div");return r.setAttribute("class","card-font-number front"),o.setAttribute("class","card-font-number next"),t.setAttribute("class","down"),t.appendChild(r),t.appendChild(o),t.setAttribute("style",`${/^[0-9]*$/.test(e)?n+s:i};position: relative;display: inline-block; margin-left: ${A}`),t}}createPage(e,A){let t,i;if(this.compStyle){const s=this._createPage(e);if(s&&(null===(t=this.compDom)||void 0===t||t.appendChild(s)),4===A){const e=this._createPage("0");e&&(null===(i=this.compDom)||void 0===i||i.appendChild(e))}}}initOptions(){const e=this.options,A={color:e.fontColor,fontFamily:e.fontFamily,lineHeight:e.fontLineHeight,fontSize:e.fontSize,textAlign:e.fontTextAlign,fontWeight:e.fontWeight},t={color:e.numberColor,fontFamily:e.numberFontFamily,fontSize:e.numberSize,textAlign:e.numberTextAlign,fontWeight:e.numberWeight},i={borderRadius:e.pageRadius,width:e.pageWidth,height:e.pageHeight,lineHeight:e.pageHeight,textAlign:e.pageAlign,background:e.bottomBackgroundColor};this.compStyle||(this.compStyle={font:"string",number:"string",page:"string"});const s={font:A,number:t,page:i};for(const e in s)this.compStyle[e]=getCSSTextFromStyleObj(s[e]);this.setStyle()}setStyle(){let e=document.getElementById("style_card");e||(e=document.createElement("style"),e.id="style_card",document.head.appendChild(e));let A=`.card-font-number:before,\n      .card-font-number:after {\n        content:attr(data-before);\n        position:absolute;\n        left: 0;\n        right:0;\n        overflow:hidden;\n        box-sizing:border-box;\n      }\n      .card-font-number:before{\n        top:0;\n        bottom:50%;\n        background:${this.options.topBackgroundColor};\n      }\n      .card-font-number:after{\n        top:50%;\n        bottom:0;\n        line-height: 0;\n        background:${this.options.bottomBackgroundColor};\n      }\n      .front:before {\n        z-index: 3;\n      }\n      .next:after {\n        z-index: 2;\n        transform-origin: 50% 0%;\n        transform: perspective(160px) rotateX(180deg);\n      }\n      .front:after, .next:before {\n        z-index: 1;\n      }\n      .go .front:after{\n        animation: fade 0.6s ease-in-out both;\n      }\n      .go .front:before {\n        opacity: 0;\n      }\n      .down:not(.go) .next{\n        display: none;\n      }\n      .go .next:after {\n        animation: backFlipDown 0.6s ease-in-out both;\n      }\n      @keyframes fade {\n        100% {\n          opacity: 0;\n        }\n      }\n      @keyframes frontFlipDown {\n        0% {\n          transform: perspective(160px) rotateX(0deg);\n        }\n\n        100% {\n          transform: perspective(160px) rotateX(-180deg);\n        }\n      }\n      @keyframes backFlipDown {\n        0% {\n          transform: perspective(160px) rotateX(180deg);\n        }\n\n        100% {\n          transform: perspective(160px) rotateX(0deg);\n        }\n      }\n      `;A=A.replace(/[\r\n]/g,""),e.innerText=A}}class Countdownv2 extends CompNew{constructor(e,A){super(e,A),this.currentValue=0,this.len=0}async initCompDom(){let e,A,{value:t,maxValue:i}=this.uBizData;i||(i=t,t="0"),this.currentValue=+t,this.len=i.split("").length,this.compDom=document.createElement("span"),null===(e=this.compDom)||void 0===e||e.setAttribute("style",`display: block;${this.compStyle}`),null===(A=this.el)||void 0===A||A.appendChild(this.compDom),this.creatPromise(),this.loadData(+t,+i),await this.promise,this.options.setCountDown&&await this._loopLoadData(+t,+i)}async _loopLoadData(e,A){this.currentValue=e,this.creatPromise(),this.loadData(e,A),await this.promise;const t=setTimeout((()=>{this._loopLoadData(e,A),clearTimeout(t)}),1e3)}creatPromise(){this.promise&&(this.promise=void 0,this.resolve=void 0),this.promise=new Promise((e=>{this.resolve=e}))}loadData(e,A){const{separate:t,udurationTime:i,udecimal:s}=this.options,n={0:Math.floor((A-e)/30)||1,1:+((A-e)/30).toFixed(1),2:+((A-e)/30).toFixed(2)}[s];if(A-this.currentValue>=n?this.currentValue=+(this.currentValue+n).toFixed(+s):this.currentValue=A,this.compDom.innerHTML=this.formatData(t),+this.currentValue>=+A)return void(this.resolve&&this.resolve());const r=setTimeout((()=>{this.loadData(e,A),clearTimeout(r)}),parseInt(i)/30||50)}formatData(e){const A=this.currentValue.toString().padStart(this.len,this.options.autoNumber);if(!e)return A;const t=A.split(".");return t[0].replace(/(\d)(?=(\d{3})+$)/g,(function(e){return e+","}))+""+(t[1]?"."+t[1]:"")}initOptions(){const{color:e,fontFamily:A,fontSize:t,fontWeight:i,lineHeight:s,fontTextAlign:n,letterSpacing:r}=this.options,o={color:e,fontFamily:A,lineHeight:s,fontSize:t,fontWeight:i,letterSpacing:r,textAlign:n};this.compStyle=getCSSTextFromStyleObj(o)}}class Video extends CompNew{initCompDom(){let e;this.dom=document.createElement("video"),this.dom.setAttribute("style","width:100%;"),null===(e=this.el)||void 0===e||e.appendChild(this.dom)}initOptions(){if(this.dom&&this.options)for(const e in this.options)"videoSrc"===e?this.dom.src=this.options.videoSrc:this.dom.setAttribute(e,this.options[e]?e:"")}update(){this.initOptions()}}const udataImg='<svg width="175px" height="75px" viewBox="0 0 75 34" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n<title>jieshuzujian</title>\n<g id="大屏编辑器" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n    <g id="大屏编辑器-接数组件" transform="translate(-72.000000, -103.000000)">\n        <g id="左侧导航/二级菜单" transform="translate(44.000000, 76.000000)">\n            <g id="卡片/小" transform="translate(16.000000, 16.000000)">\n                <g id="图片/小96" transform="translate(0.000000, 0.000000)">\n                    <g id="jieshuzujian" transform="translate(12.375000, 11.407407)">\n                        <rect id="矩形" x="0" y="0" width="74.25" height="33.1851852"></rect>\n                        <path d="M50.3421875,16.5061728 C50.3421875,23.8467872 44.4246511,29.7975309 37.125,29.7975309 C31.8999056,29.7975309 27.2636158,26.720868 25.1326467,22.1026495 C24.3314718,21.9765021 23.71875,21.2793428 23.71875,20.4382716 C23.71875,19.5075695 24.4690228,18.7530864 25.3945312,18.7530864 C26.3200397,18.7530864 27.0703125,19.5075695 27.0703125,20.4382716 C27.0703125,20.7627404 26.9791232,21.0657913 26.8211106,21.3229216 C28.6519328,25.2885573 32.6358305,27.9308642 37.125,27.9308642 C43.2998777,27.9308642 48.3241631,22.9769481 48.4821084,16.8057152 L48.4859375,16.5061728 L50.3421875,16.5061728 Z M34.531242,17.4449999 L34.51475,18.5608148 L41.2542362,18.5611614 L41.2542362,20.427828 L34.48775,20.4278148 L34.474347,21.359156 L32.0495318,19.5146603 L34.531242,17.4449999 Z M37.125,3.21481481 C42.3634969,3.21481481 46.9937637,6.30572435 49.118067,10.9102843 C49.9185282,11.0358436 50.53125,11.7330029 50.53125,12.5740741 C50.53125,13.5047762 49.7809772,14.2592593 48.8554688,14.2592593 C47.9299603,14.2592593 47.1796875,13.5047762 47.1796875,12.5740741 C47.1796875,12.2496053 47.2708768,11.9465544 47.4288894,11.6894241 C45.60436,7.73613076 41.6255432,5.08148148 37.125,5.08148148 C30.9501223,5.08148148 25.9258369,10.0353975 25.7678916,16.2066304 L25.7640625,16.5061728 L23.9078125,16.5061728 C23.9078125,9.1655585 29.8253489,3.21481481 37.125,3.21481481 Z M40.0950456,11.827716 L42.5767558,13.8973763 L40.1519406,15.741872 L40.13775,14.8098148 L33.0066409,14.8105441 L33.0066409,12.9438774 L40.11075,12.9438148 L40.0950456,11.827716 Z" id="形状结合" fill="#3284FF"></path>\n                    </g>\n                </g>\n            </g>\n        </g>\n    </g>\n</g>\n</svg>';class Udata extends CompNew{initCompDom(){let e,A;this.dom=document.createElement("div"),this.dom.setAttribute("style","display:flex;justify-content:center;align-items:center;");const t=document.createElement("div");t.innerHTML=udataImg,null===(e=this.dom)||void 0===e||e.appendChild(t),null===(A=this.el)||void 0===A||A.appendChild(this.dom)}}const CompMap={ctext:Text,clayout:Layer,ctextlist:TextList,ciframe:Iframe,ciframedpd:Iframe,cprogress:Progress,ctimecard:Timecard,echarts:Echarts,cblankcomponent:Blankcomponent,ccountdown:Countdown,ccountdown_v2:Countdownv2,cvideo:Video,udata:Udata};let isLoad=!1,isLoading=!1,cbList=[];const BaseAdapter=UI.adapterManager.getBaseAdapter();class UdatavAdapter extends BaseAdapter{static factory(e,A,t,i){return new UdatavAdapter(e,A,t,i)}async _initComponent(){const e=this.config.options.type,A=CompMap[e];A?isLoad?this._render(A):isLoading?cbList.push((()=>{this._render(A)})):(isLoading=!0,await this.loadResource(),isLoad=!0,this._render(A),cbList.forEach((e=>{e()})),cbList=[]):(console.warn(`${e}：该类型暂时没有实现，请联系开发者！！！`),this.componentInstance={setOption(){},setData(){},resize(){}},this._componentComplete(),this.complete=!0)}_render(e){this.parent.contentEl.appendChild(this.dom);try{this.componentInstance=new e(this.dom,this.config),this.componentInstance._initComponent(),console.warn("_render",this,this.config),Reflect.has(this.config,"data")&&this.componentInstance.setOption(this.config.data),Reflect.has(this.config,"opts")&&this.componentInstance.setOption(this.config.opts),this._componentComplete(),this.complete=!0}catch(e){console.error(e)}}async loadResource(){const e=["jquery.min.js","echarts410.js","echarts-gl110.js","echarts-liquidfill4echarts4.js"];for(const A of e)await loadScript(A.split(".")[0],`/s-static/lib/${A}`)}setOption(e){e&&(this.config.opts=e,this.componentInstance.setOption(e))}setData(e){this.config.data=e,this.componentInstance.setData(e)}_destroyComponent(){this.componentInstance&&this.componentInstance.destory(),this.config=null,this.dom&&this.parent.contentEl&&this.parent.contentEl.removeChild(this.dom),this.parent.adapter=null,this.parent.previewModeLock=!0,this.parent=null}toJSON(){const e={type:this.type,name:this.name},A=this.componentInstance;return A&&(e.data=this.componentInstance.uBizData,"echarts"===A.compType&&A.config?e.opts=A.config:e.opts=this.componentInstance.options),this.config.option&&(e.option=this.config.option),this.config.options&&(e.options=this.config.options),e}}function getRealDestroyComps(e){const A={},t=[],i=[];return e.forEach((e=>{const t=e.$parent.id;A[t]||(A[t]={comp:e.$parent,children:[]}),A[t].children.push(e),"Group"===e.type?i.push(...e.containers.filter((e=>e.adapter?.$dataAdapter))):e.adapter?.$dataAdapter&&i.push(e)})),Object.keys(A).forEach((e=>{const i=A[e];"Group"===i.comp.type&&i.comp.children.length===i.children.length?t.push(i.comp):t.push(...i.children.sort(((e,A)=>A.$ranking-e.$ranking)))})),{dataAdapterComs:i,destroyComps:t}}function updateCompsAttrs(e,A){e.updateCompsAttrs(A.map((A=>({comp:e.$queryById(A.compId),attrs:deepClone(A.attrs)}))))}async function updateAdaptersUndo(e,{compAdapters:A}){return Promise.all(A.map((A=>{const t=e.$queryById(A.compId);t.adapter.$destroy();const i=getAdapterType(A.old.options,A.old.kpOption);return t.$options.adapterManager.create(i).init(t,A.old.options,A.old.kpOption)})))}async function updateAdaptersRedo(e,{compAdapters:A}){return Promise.all(A.map((A=>{const t=e.$queryById(A.compId);t.adapter.$destroy();const i=getAdapterType(A.new.options,A.new.kpOption);return t.$options.adapterManager.create(i).init(t,A.new.options,A.new.kpOption)})))}function getSubscribeCompList$1(e=[]){const A=[];return e.forEach((function e(t){if("subscribeData"===t?.adapter?.$data.dataSource.dataType){const e=t.adapter.$data.dataSource.typeMap.subscribeData.subscribeComp;A.find((A=>A===e))||A.push(e)}t.children&&t.children.forEach(e)})),A}async function destroyCompsUndo(e,{compObjs:A,dataSubscriberCompsList:t}){const i=[];for(const t of A){const A=e.$options.manager.create(t.compOptions.type);await A.init(e.$queryById(t.parentId),t.compOptions),t.nextId&&A.moveToTarget(e.$queryById(t.nextId),"before"),i.push(A)}getSubscribeCompList$1(i).forEach((e=>e.adapter.$data.refresh())),t.forEach((A=>{const t=A.compId,i=e.$queryById(t);A.dataSubscriberList.forEach((A=>{e.$queryById(A.sourceId).adapter.updateSourceData("subscribeData",{id:t,level:A.level})})),i.adapter.$data.refresh()})),e.select(i)}function destroyCompsRedo(e,{compObjs:A}){e.destroyComps(A.map((A=>e.$queryById(A.compId))))}async function dismissGroupsUndo(e,{groupObjs:A}){const t=[];for(const i of A){const A=e.$options.manager.create("Group");await groupInit(A,i.childrenId.map((A=>e.$queryById(A))),i.option),t.push(A)}e.select(t)}function dismissGroupsRedo(e,{groupObjs:A}){A.forEach((A=>e.$queryById(A.groupId).dismiss()))}function updateCompsAttrsUndo(e,{oldCompsAttrs:A}){updateCompsAttrs(e,A)}function updateCompsAttrsRedo(e,{newCompsAttrs:A}){updateCompsAttrs(e,A)}function __updateSelectUndo(e,{oldSelectCompIds:A,newSelectCompIds:t}){t.filter((e=>!A.includes(e))).forEach((A=>e.$queryById(A)._updateSelect(!1))),e.select(A.map((A=>e.$queryById(A))))}function __updateSelectRedo(e,{oldSelectCompIds:A,newSelectCompIds:t}){A.filter((e=>!t.includes(e))).forEach((A=>e.$queryById(A)._updateSelect(!1))),e.select(t.map((A=>e.$queryById(A))))}async function parseJSONUndo$1(e,{oldDef:A,selectIds:t}){await e.parseJSON(A),e.select(t.map((A=>e.$queryById(A))))}async function parseJSONRedo$1(e,{newDef:A}){await e.parseJSON(A)}function selectUndo$1(e,{selectIds:A}){e.select(A.map((A=>e.$queryById(A))))}function selectRedo$1(e,{compIds:A}){e.select(A.map((A=>e.$queryById(A))))}function alignToUndo(e,{oldCompsAttrs:A}){updateCompsAttrs(e,A)}function alignToRedo(e,{newCompsAttrs:A}){updateCompsAttrs(e,A)}function equidistantUndo(e,{oldCompsAttrs:A}){updateCompsAttrs(e,A)}function equidistantRedo(e,{newCompsAttrs:A}){updateCompsAttrs(e,A)}class CommandUi extends Ui{updateCompsAttrs(e){const A=super.updateCompsAttrs.bind(this);return this.$root.$command.add({name:"更新多个节点的多个属性",type:"fn",args:{value:[e.map((e=>({compId:e.comp.id,attrs:deepClone(e.attrs)})))],handler:function(e,{value:A}){e.updateCompsAttrs(A[0].map((A=>({comp:e.$queryById(A.compId),attrs:A.attrs}))))}},exec(){const t={value:[e]},i=[],s=[];e.forEach((e=>{i.push({compId:e.comp.id,attrs:e.attrs.map((e=>({name:e.name,value:deepClone(e.oldValue)})))}),s.push({compId:e.comp.id,attrs:e.attrs.map((e=>({name:e.name,value:deepClone(e.value)})))})}));return{result:A(e),args:t,params:{oldCompsAttrs:i,newCompsAttrs:s}}},undo:updateCompsAttrsUndo,redo:updateCompsAttrsRedo})}__updateSelect(e){const A=this,t=super.__updateSelect.bind(this);return this.$root.$command.add({name:"更新选择",type:"fn",args:{value:[e.map((e=>e.id))],handler:function(e,A,t){return[t[0].map((A=>e.$queryById(A)))]}},exec(){const i=A.$selectComponent.map((e=>e.id));return{result:t(e),params:{oldSelectCompIds:i,newSelectCompIds:A.$selectComponent.map((e=>e.id))}}},undo:__updateSelectUndo,redo:__updateSelectRedo})}async parseJSON(e,A){const t=this,i=super.parseJSON.bind(this);return this.$root.$command.asyncAdd({name:"导入定义文件",type:"fn",args:{value:[deepClone(e),deepClone(A)]},async exec(){const s=deepClone(e),n=deepClone(A),r=t.toJSON(),o=t.toJSON(),a=t.$selectComponent.map((e=>e.id));return{result:await i(e,A),params:{newDef:s,newOptions:n,oldDef:r,oldOptions:o,selectIds:a}}},undo:parseJSONUndo$1,redo:parseJSONRedo$1})}select(e){const A=this,t=super.select.bind(this);return this.$root.$command.add({name:"选择",type:"fn",args:{value:[e.map((e=>e.id))],handler:function(e,A,t){return[t[0].map((A=>e.$queryById(A)))]}},exec(){const i=A.$selectComponent.map((e=>e.id));return{result:t(e),params:{compIds:e.map((e=>e.id)),selectIds:i}}},undo:selectUndo$1,redo:selectRedo$1})}alignTo(e,A){const t=super.alignTo.bind(this);return this.$root.$command.add({name:"对齐",type:"fn",args:{value:[e,A.map((e=>e.id))],handler:function(e,A,t){return[t[0],t[1].map((A=>e.$queryById(A)))]}},exec(){const i=getCompAttrs(A);return{result:t(e,A),params:{newCompsAttrs:getCompAttrs(A),oldCompsAttrs:i}}},undo:alignToUndo,redo:alignToRedo})}equidistant(e,A,t){const i=super.equidistant.bind(this);return this.$root.$command.add({name:"等间距",type:"fn",args:{value:[e,A.map((e=>e.id)),t],handler:function(e,A,t){const[i,s,n]=t;return[i,s.map((A=>e.$queryById(A))),n]}},exec(){const s=getCompAttrs(A);return{result:i(e,A,t),params:{newCompsAttrs:getCompAttrs(A),oldCompsAttrs:s}}},undo:equidistantUndo,redo:equidistantRedo})}async updateAdapters(e=[],A={}){const t=super.updateAdapters.bind(this);return this.$root.$command.asyncAdd({name:"更新适配器列表",type:"fn",args:{value:[e.map((e=>({compId:e.comp.id,option:e.option}))),deepClone(A)],handler:function(e,A,t){const[i]=t;return[i.map((A=>({comp:e.$queryById(A.compId),option:A.option})))]}},async exec(){const i=e.map((e=>{const A=deepClone(e.comp.adapter.toJSON());return{comp:e.comp,option:A.option,kpOption:A.kpOption}})),s=await t(e,A),n=s.map((e=>{const A=deepClone(e.toJSON()),t=i.find((A=>A.comp===e.$parent));return{compId:e.$parent.id,new:{options:A.option,kpOption:A.kpOption},old:{options:t.option,kpOption:t.kpOption}}}));return{result:s,params:{compAdapters:n}}},undo:updateAdaptersUndo,redo:updateAdaptersRedo})}dismissGroups(e=[]){const A=super.dismissGroups.bind(this);return this.$root.$command.add({name:"解散多个编组",type:"fn",args:{value:[e.map((e=>e.id))],handler:function(e,A,t){const[i]=t;return[i.map((A=>e.$queryById(A)))]}},exec(){const t=e.map((e=>{const A=deepClone(e.toJSON());return{groupId:e.id,option:A.option,childrenId:e.children.map((e=>e.id))}}));return{result:A(e),params:{groupObjs:t}}},undo:dismissGroupsUndo,redo:dismissGroupsRedo})}destroyComps(e=[]){const A=super.destroyComps.bind(this);return this.$root.$command.add({name:"销毁多个节点",key:"destroyComps",type:"fn",args:{value:[e.map((e=>e.id))],handler:function(e,A,t){const[i]=t;return[i.map((A=>e.$queryById(A)))]}},exec(){const{dataAdapterComs:t,destroyComps:i}=getRealDestroyComps(e),s=t.map((e=>({compId:e.id,dataSubscriberList:e.adapter.$data.subscriber.subscriberList.map((e=>({sourceId:e.dataItem.parent.$parent.id,level:deepClone(e.option.level)})))}))),n=i.map((e=>({parentId:e.$parent.id,nextId:e.$next?.id,compId:e.id,compOptions:deepClone(e.toJSON())})));return{result:A(i),params:{compObjs:n,dataSubscriberCompsList:s}}},undo:destroyCompsUndo,redo:destroyCompsRedo})}}function getCompAttrs(e){return e.map((e=>({compId:e.id,attrs:[{name:"top",value:e.top},{name:"left",value:e.left}]})))}function updateAttr$1(e,A,t,i,s){return e.$root.$command.add({name:"更新属性",type:"fn",noAdd:!!t.option.noAdd,args:{selfId:e.id,value:[t.name,i,s],handler:function(e,{selfId:A,value:t}){const[i,s]=t;e.$queryById(A)[i]=s}},exec:()=>({result:A(t,i,s),params:{selfId:e.id,name:t.name,newValue:deepClone(i),oldValue:deepClone(s)}}),undo(e,{selfId:A,name:t,oldValue:i}){e.$queryById(A)[t]=i},redo(e,{selfId:A,name:t,newValue:i}){e.$queryById(A)[t]=i}})}function updateAttrs(e,A,t=[]){return e.$root.$command.add({name:"更新多个属性",type:"fn",args:{selfId:e.id,value:[deepClone(t)],handler:function(e,{selfId:A,value:t}){e.$queryById(A).updateAttrs(...t)}},exec(){const i=t.map((A=>({name:A.name,value:e[A.name]})));return{result:A(t),params:{selfId:e.id,oldAttrs:i,newAttrs:t}}},undo(e,{selfId:A,oldAttrs:t}){e.$queryById(A).updateAttrs(t)},redo(e,{selfId:A,newAttrs:t}){e.$queryById(A).updateAttrs(t)}})}function moveToTarget(e,A,t,i){return e.$root.$command.add({name:"移到目标位置",type:"fn",args:{value:[t.id,i],handler:function(e,A,t){const[i,s]=t;return[e.$queryById(i),s]}},exec(){const s=e.$parent.id,n=e.$next?.id,r=A(t,i),o=e.$parent.id,a=e.$next?.id;return{result:r,params:{type:i,selfId:e.id,targetId:t.id,OldParentId:s,OldNextId:n,newParentId:o,newNextId:a}}},undo(e,{selfId:A,OldNextId:t,OldParentId:i}){const s=e.$queryById(A);t?s.moveToTarget(e.$queryById(t),"before"):s.moveToTarget(e.$queryById(i)),s.select()},redo(e,{selfId:A,newNextId:t,newParentId:i}){const s=e.$queryById(A);t?s.moveToTarget(e.$queryById(t),"before"):s.moveToTarget(e.$queryById(i)),s.select()}})}function groupUndo(e,{groupId:A,compObjs:t}){const i=e.$queryById(A),s=[...i.children];i.dismiss(),t.forEach((({compId:A,nextId:t,parentId:i})=>{t?e.$queryById(A).moveToTarget(e.$queryById(t),"before"):e.$queryById(A).moveToTarget(e.$queryById(i))})),e.select(s)}async function groupRedo(e,{selfId:A,compObjs:t,oldOption:i,oldConfig:s}){const n=e.$queryById(A),r=n.$options.manager.create("Group");await groupInit(r,[n,...t.map((A=>e.$queryById(A.compId)))],i,s)}function selectLayer(e,A){return e.$root.$command.add({name:"选择图层",type:"fn",args:{value:[]},exec(){const t=e.$root.$selectLayer?.id;return{result:A(),params:{oldSelectId:t,newSelectId:e.id}}},undo(e,{oldSelectId:A}){e.$queryById(A).select()},redo(e,{newSelectId:A}){e.$queryById(A).select()}})}async function createContainer(e,A,t,i={}){return e.$root.$command.asyncAdd({name:"创建容器",type:"fn",args:{selfId:e.id,value:[deepClone(t),deepClone(i)],handler:async function(e,{selfId:A,value:t}){await e.$queryById(A).createContainer(...t)}},async exec(){const s=e.$root.$selectComponent.map((e=>e.id)),n=await A(t,i);return{result:n,params:{containerId:n.id,newOptions:deepClone(t),newConfig:deepClone(i),selectIds:s,selfId:e.id,nextId:n.$next?.id}}},undo(e,{containerId:A,selectIds:t}){e.$queryById(A).destroy(),e.select(t.map((A=>e.$queryById(A))))},async redo(e,{nextId:A,selfId:t,newOptions:i,newConfig:s={}}){const n=e.$queryById(t),r=n.$options.manager.create(i.type);await r.init(n,i,s.container),A?r.moveToTarget(e.$queryById(A),"before"):r.moveToTarget(n),s.lock&&(r.isLock=!0),s.select&&r.select()}})}function setSizeUndo(e,{selfId:A,oldAttrs:t,oldZoom:i}){const s=e.$queryById(A);s.updateAttrs(t),s.canvasZoom=i}function setSizeRedo(e,{selfId:A,newAttrs:t}){const i=e.$queryById(A);i.updateAttrs(t),i.updateCanvasCenter()}function updateCanvasCenterUndo(e,{selfId:A,oldZoom:t}){e.$queryById(A).canvasZoom=t}function updateCanvasCenterRedo(e,{selfId:A}){e.$queryById(A).updateCanvasCenter()}function createLayerUndo(e,{layerId:A}){e.$queryById(A).destroy()}async function createLayerRedo(e,{selfId:A,nextId:t,newOptions:i,newConfig:s}){const n=e.$queryById(A),r=n.$options.manager.create(i.type);await r.init(n,i),t?r.moveToTarget(e.$queryById(t),"before"):r.moveToTarget(n),s.select&&r.select()}function selectUndo(e,{selfId:A,selectIds:t}){e.select(t.map((A=>e.$queryById(A))))}function selectRedo(e,{selfId:A}){e.$queryById(A).select()}function resetFilterUndo(e,A){undoExtract(e,A)}function resetFilterRedo(e,{selfId:A}){e.$queryById(A).resetFilter()}function setFilterUndo(e,{selfId:A,oldKey:t,oldValue:i}){e.$queryById(A).setFilter(t,i)}function setFilterRedo(e,{selfId:A,oldKey:t,newValue:i}){e.$queryById(A).setFilter(t,i)}function clearFilerUndo(e,A){undoExtract(e,A)}function clearFilerRedo(e,{selfId:A}){e.$queryById(A).clearFiler()}class CommandCanvas extends Canvas{_updateAttr(e,A,t){return updateAttr$1(this,super._updateAttr.bind(this),e,A,t)}updateAttrs(e=[]){return updateAttrs(this,super.updateAttrs.bind(this),e)}setSize(e=[]){const A=this,t=super.setSize.bind(this);return this.$root.$command.add({name:"设置画布尺寸",type:"fn",args:{value:deepClone(e)},exec(){const i=e.map((e=>({name:e.name,value:A[e.name]}))),s=deepClone(A.canvasZoom);return{result:t(e),params:{selfId:A.id,oldZoom:s,oldAttrs:i,newAttrs:deepClone(e)}}},undo:setSizeUndo,redo:setSizeRedo})}updateCanvasCenter(){const e=this,A=super.updateCanvasCenter.bind(this);return this.$root.$command.add({name:"更新画布居中位置",type:"fn",args:{value:[]},exec(){const t=deepClone(e.canvasZoom);return{result:A(),params:{selfId:e.id,oldZoom:t}}},undo:updateCanvasCenterUndo,redo:updateCanvasCenterRedo})}async createLayer(e={},A={}){const t=this,i=super.createLayer.bind(this);return this.$root.$command.asyncAdd({name:"创建图层",type:"fn",args:{value:[deepClone(e),deepClone(A)]},async exec(){const s=t.$root.$selectComponent.map((e=>e.id)),n=await i(e,A);return{result:n,params:{selfId:t.id,layerId:n.id,selectIds:s,newOptions:deepClone(e),newConfig:deepClone(A),nextId:n.$next?.id}}},undo:createLayerUndo,redo:createLayerRedo})}select(){const e=this,A=super.select.bind(this);return this.$root.$command.add({name:"画布选择",type:"fn",noAdd:e.isSelected,args:{value:[]},exec(){const t=e.$root.$selectComponent.map((e=>e.id));return{result:A(),params:{selectIds:t,selfId:e.id}}},undo:selectUndo,redo:selectRedo})}resetFilter(){const e=this,A=super.resetFilter.bind(this);return this.$root.$command.add({name:"重置滤镜",type:"fn",args:{value:[]},exec:()=>execExtract$1(e,A),undo:resetFilterUndo,redo:resetFilterRedo})}setFilter(e,A){const t=this,i=super.setFilter.bind(this);return this.$root.$command.add({name:"设置滤镜",type:"fn",args:{value:[e,A]},exec(){const s={value:[e,A]},n=deepClone(t.filters[e]);return{result:i(e,A),args:s,params:{selfId:t.id,oldKey:deepClone(e),newValue:deepClone(A),oldValue:n}}},undo:setFilterUndo,redo:setFilterRedo})}clearFiler(){const e=this,A=super.clearFiler.bind(this);return this.$root.$command.add({name:"设置滤镜",type:"fn",args:{value:[]},exec:()=>execExtract$1(e,A),undo:clearFilerUndo,redo:clearFilerRedo})}}function execExtract$1(e,A){const t=deepClone(e.filters);return{result:A(),params:{selfId:e.id,oldValue:t}}}function undoExtract(e,{selfId:A,oldValue:t}){const i=e.$queryById(A);if(t){i.resetFilter();for(const e in t)i.setFilter(e,t[e])}else i.clearFiler()}function getSubscribeCompList(e=[]){const A=[];return e.forEach((function e(t){if("subscribeData"===t?.adapter?.$data.dataSource.dataType){const e=t.adapter.$data.dataSource.typeMap.subscribeData.subscribeComp;A.find((A=>A===e))||A.push(e)}t.children&&t.children.forEach(e)})),A}async function destroyUndo$1(e,{parentId:A,oldOptions:t,nextId:i,dataSubscriberCompsList:s}){const n=e.$queryById(A),r=n.$options.manager.create(t.type);await r.init(n,t,{nextComp:e.$queryById(i)}),getSubscribeCompList(r.containers).forEach((e=>e.adapter.$data.refresh())),s.forEach((A=>{const t=A.compId,i=e.$queryById(t);A.dataSubscriberList.forEach((A=>{e.$queryById(A.sourceId).adapter.updateSourceData("subscribeData",{id:t,level:A.level})})),i.adapter.$data.refresh()}))}function destroyRedo$1(e,{selfId:A}){e.$queryById(A).destroy()}function parserTemplateUndo(e,{compsOptions:A,selectIds:t}){A.forEach((({compId:A})=>e.$queryById(A).destroy())),e.select(t.map((A=>e.$queryById(A))))}async function parserTemplateRedo(e,A){await redoExtract(e,A)}function parseJSONUndo(e,{compsOptions:A,selectIds:t}){A.forEach((({compId:A})=>e.$queryById(A).destroy())),e.select(t.map((A=>e.$queryById(A))))}async function parseJSONRedo(e,A){return redoExtract(e,A)}class CommandLayer extends Layer$1{_updateAttr(e,A,t){return updateAttr$1(this,super._updateAttr.bind(this),e,A,t)}updateAttrs(e=[]){return updateAttrs(this,super.updateAttrs.bind(this),e)}moveToTarget(e,A){return moveToTarget(this,super.moveToTarget.bind(this),e,A)}select(){selectLayer(this,super.select.bind(this))}createContainer(e,A,t){return createContainer(this,super.createContainer.bind(this),e,A)}async parserTemplate(e,A={}){const t=this,i=super.parserTemplate.bind(this);return this.$root.$command.asyncAdd({name:"布局模板",type:"fn",args:{value:[deepClone(e),deepClone(A)]},exec:async()=>execExtract(t,i,e,A),undo:parserTemplateUndo,redo:parserTemplateRedo})}async parseJSON(e,A={}){const t=this,i=super.parseJSON.bind(this);return this.$root.$command.asyncAdd({name:"图层导入定义文件",type:"fn",args:{value:[deepClone(e),deepClone(A)]},exec:async()=>execExtract(t,i,e,A),undo:parseJSONUndo,redo:parseJSONRedo})}destroy(){const e=this,A=super.destroy.bind(this);return this.$root.$command.add({name:"图层销毁",type:"fn",args:{value:[]},exec(){const t=deepClone(e.toJSON()),i=e.$parent.id,s=e.id,n=e.$next?.id,r=e.containers.filter((e=>e.adapter?.$dataAdapter)),o=r.map((e=>({compId:e.id,dataSubscriberList:e.adapter.$data.subscriber.subscriberList.map((e=>({sourceId:e.dataItem.parent.$parent.id,level:deepClone(e.option.level)})))})));return{result:A(),params:{selfId:s,parentId:i,nextId:n,oldOptions:t,dataSubscriberCompsList:o}}},undo:destroyUndo$1,redo:destroyRedo$1})}}async function execExtract(e,A,t,i){const s=e.$root.$selectComponent.map((e=>e.id)),n=await A(t,i);return{result:n,params:{selfId:e.id,oldOptions:deepClone(t),compsOptions:n.map((e=>({compId:e.id,def:deepClone(e.toJSON())}))),oldConfig:deepClone(i),selectIds:s}}}async function redoExtract(e,{compsOptions:A,selfId:t,oldConfig:i}){const s=e.$queryById(t),n=await Promise.all(A.map((({def:e})=>s.$options.manager.create(e.type).init(s,e))));return i.select&&e.select(n),n}async function destroyUndo(e,{parentId:A,parent:t,oldOptions:i,nextId:s}){const n=e.$queryById(A),r=n.$options.manager.create(i.type);await r.init(n,i,{nextComp:e.$queryById(s)})}function destroyRedo(e,{selfId:A}){e.$queryById(A).destroy()}class CommandThingJSLayer extends ThingJSLayer{_updateAttr(e,A,t){return updateAttr$1(this,super._updateAttr.bind(this),e,A,t)}updateAttrs(e=[]){return updateAttrs(this,super.updateAttrs.bind(this),e)}moveToTarget(e,A){return moveToTarget(this,super.moveToTarget.bind(this),e,A)}select(){selectLayer(this,super.select.bind(this))}createContainer(e,A,t){return createContainer(this,super.createContainer.bind(this),e,A)}destroy(){const e=this,A=super.destroy.bind(this);return this.$root.$command.add({name:"3D图层销毁",type:"fn",args:{value:[]},exec(){const t=deepClone(e.toJSON()),i=e.$parent.id,s=e.$next?.id;return{result:A(),params:{selfId:e.id,parentId:i,nextId:s,oldOptions:t}}},undo:destroyUndo,redo:destroyRedo})}}async function dismissUndo(e,{groupId:A,parentId:t,groupOptions:i}){const s=e.$queryById(A);await s.init(e.$queryById(t),i),s.select()}function dismissRedo(e,{groupId:A}){const t=e.$queryById(A),i=[...t.children];t.dismiss(),e.select(i)}function createGroupUndo$1(e,A){groupUndo(e,A)}async function createGroupRedo$1(e,A){await groupRedo(e,A)}class CommandGroup extends Group{_updateAttr(e,A,t){return updateAttr$1(this,super._updateAttr.bind(this),e,A,t)}updateAttrs(e=[]){return updateAttrs(this,super.updateAttrs.bind(this),e)}moveToTarget(e,A){return moveToTarget(this,super.moveToTarget.bind(this),e,A)}async createGroup(e=[],A={},t={}){const i=this,s=super.createGroup.bind(this);return this.$root.$command.asyncAdd({name:"编组创建编组",type:"fn",args:{value:[e.map((e=>e.id)),deepClone(A),deepClone(t)],handler:function(e,A,t){const[i,s,n]=t;return[i.map((A=>e.$queryById(A))),s,n]}},async exec(){const n=e.map((e=>({compId:e.id,parentId:e.$parent.id,nextId:e.$next?.id}))),r=await s(e,A,t);return{result:r,params:{selfId:i.id,groupId:r.id,compObjs:n,oldOption:deepClone(A),oldConfig:deepClone(t)}}},undo:createGroupUndo$1,redo:createGroupRedo$1})}dismiss(){const e=this,A=super.dismiss.bind(this);return this.$root.$command.add({name:"解散编组",type:"fn",args:{value:[]},async exec(){const t=e.$parent.id,i=deepClone(e.toJSON()),s=await A();return{result:s,params:{groupId:s.id,groupOptions:i,parentId:t}}},undo:dismissUndo,redo:dismissRedo})}}function createAdapterUndo(e,{selfId:A,selectIds:t}){e.$queryById(A).adapter.$destroy(),e.select(t.map((A=>e.$queryById(A))))}async function createAdapterRedo(e,{selfId:A,oldOptions:t,oldKpOption:i,oldConfig:s={}}){const n=e.$queryById(A),r=getAdapterType(t,i),o=n.$options.adapterManager.create(r);await o.init(n,t,i,s.adapter),s.select&&n.select(!0)}async function updateAdapterUndo(e,{selfId:A,oldOptions:t,oldKpOption:i}){const s=e.$queryById(A);s.adapter.$destroy();const n=getAdapterType(t,i),r=s.$options.adapterManager.create(n);await r.init(s,t,i)}async function updateAdapterRedo(e,{selfId:A,newOptions:t,newKpOption:i}){const s=e.$queryById(A);s.adapter.$destroy();const n=getAdapterType(t,i),r=s.$options.adapterManager.create(n);await r.init(s,t,i)}function createGroupUndo(e,A){groupUndo(e,A)}async function createGroupRedo(e,A){await groupRedo(e,A)}class CommandContainer extends Container{_updateAttr(e,A,t){return updateAttr$1(this,super._updateAttr.bind(this),e,A,t)}updateAttrs(e=[]){return updateAttrs(this,super.updateAttrs.bind(this),e)}moveToTarget(e,A){return moveToTarget(this,super.moveToTarget.bind(this),e,A)}async createAdapter(e={},A={},t={}){const i=this,s=super.createAdapter.bind(this);return this.$root.$command.asyncAdd({name:"创建适配器",type:"fn",args:{value:[deepClone(e),deepClone(A),deepClone(t)]},async exec(){const n=i.$root.$selectComponent.map((e=>e.id));return{result:await s(e,A,t),params:{selfId:i.id,oldOptions:deepClone(e),oldKpOption:deepClone(A),oldConfig:deepClone(t),selectIds:n}}},undo:createAdapterUndo,redo:createAdapterRedo})}async createGroup(e=[],A={},t={}){const i=this,s=super.createGroup.bind(this);return this.$root.$command.asyncAdd({name:"容器创建编组",type:"fn",args:{value:[e.map((e=>e.id)),deepClone(A),deepClone(t)],handler:function(e,A,t){const[i,s,n]=t;return[i.map((A=>e.$queryById(A))),s,n]}},async exec(){const n=e.map((e=>({compId:e.id,parentId:e.$parent.id,nextId:e.$next?.id}))),r=await s(e,A,t);return{result:r,params:{selfId:i.id,groupId:r.id,compObjs:n,groupOptions:r.toJSON(),oldOption:deepClone(A),oldConfig:deepClone(t)}}},undo:createGroupUndo,redo:createGroupRedo})}async updateAdapter(e={},A={},t={}){const i=this,s=super.updateAdapter.bind(this);return this.$root.$command.asyncAdd({name:"升级适配器",type:"fn",args:{value:[deepClone(e),deepClone(A),deepClone(t)]},async exec(){const n=deepClone(i.adapter.toJSON()),r=n.kpOption,o=n.option,a=await s(e,A),l=deepClone(a.toJSON());return{result:a,params:{selfId:i.id,newOptions:l.option,newKpOption:l.kpOption,newConfig:deepClone(t),oldOptions:o,oldKpOption:r}}},undo:updateAdapterUndo,redo:updateAdapterRedo})}}function updateAttr(e,A,t,i,s){return e.$root.$command.add({name:"更新适配器属性",type:"fn",noAdd:!!t.option.noAdd,args:{selfId:e.$parent.id,value:[t.name,i,s],handler:function(e,{selfId:A,value:t}){const[i,s]=t;e.$queryById(A)[i]=s}},exec:()=>({result:A(t,i,s),params:{selfId:e.$parent.id,name:t.name,newValue:deepClone(i),oldValue:deepClone(s)}}),undo(e,{selfId:A,name:t,oldValue:i}){e.$queryById(A).adapter[t]=i},redo(e,{selfId:A,name:t,newValue:i}){e.$queryById(A).adapter[t]=i}})}async function setEffectThemeUndo(e,{selfId:A,oldEffect:t}){await effectExtract(e,{selfId:A,effect:t})}async function setEffectThemeRedo(e,{selfId:A,newEffect:t}){await effectExtract(e,{selfId:A,effect:t})}async function resetUndo(e,{selfId:A,oldEffect:t}){await effectExtract(e,{selfId:A,effect:t})}async function resetRedo(e,{selfId:A,newEffect:t}){await effectExtract(e,{selfId:A,effect:t})}class CommandCampusAdapter extends CampusAdapter{_updateAttr(e,A,t){return updateAttr(this,super._updateAttr.bind(this),e,A,t)}async refresh(){const e=super.refresh.bind(this);return this.$root.$command.asyncAdd({name:"刷新",type:"fn",noAdd:!0,exec:async()=>({result:await e()})})}async setEffectTheme(e){const A=this,t=super.setEffectTheme.bind(this);return this.$root.$command.asyncAdd({name:"更改园区效果",type:"fn",args:{value:[deepClone(e)]},async exec(){const i=deepClone(A.effectTheme);return{result:await t(e),params:{selfId:A.$parent.id,oldEffect:i,newEffect:deepClone(e)}}},undo:setEffectThemeUndo,redo:setEffectThemeRedo})}async reset(){const e=this,A=super.reset.bind(this);return this.$root.$command.asyncAdd({name:"重置园区效果",type:"fn",async exec(){const t=e.$parent.id,i=deepClone(e.effectTheme),s=await A();return{result:s,params:{selfId:t,oldEffect:i,newEffect:deepClone(s.effectTheme)}}},undo:resetUndo,redo:resetRedo})}}async function effectExtract(e,{selfId:A,effect:t}){const i=e.$queryById(A);t?await i.adapter.setEffectTheme(t):await i.adapter.reset()}function updateDataFieldUndo(e,{selfId:A,oldName:t,oldValue:i}){const s=e.$queryById(A);s.adapter.updateDataField(t,i),s.adapter.$data.refresh()}function updateDataFieldRedo(e,{selfId:A,oldName:t,newValue:i}){const s=e.$queryById(A);s.adapter.updateDataField(t,i),s.adapter.$data.refresh()}function updateDataCloseUndo(e,{selfId:A,oldValue:t}){const i=e.$queryById(A);i.adapter.updateDataClose(t),i.adapter.$data.refresh()}function updateDataCloseRedo(e,{selfId:A,newValue:t}){const i=e.$queryById(A);i.adapter.updateDataClose(t),i.adapter.$data.refresh()}function updateDataTimeUndo(e,{selfId:A,oldValue:t}){const i=e.$queryById(A);i.adapter.updateDataTime(t),i.adapter.$data.refresh()}function updateDataTimeRedo(e,{selfId:A,newValue:t}){const i=e.$queryById(A);i.adapter.updateDataTime(t),i.adapter.$data.refresh()}function updateSourceDataUndo(e,{selfId:A,oldType:t,oldData:i}){e.$queryById(A).adapter.updateSourceData(t,i)}function updateSourceDataRedo(e,{selfId:A,newType:t,newData:i}){e.$queryById(A).adapter.updateSourceData(t,deepClone(i))}function updateFilterMainEnableUndo(e,{selfId:A,oldValue:t}){e.$queryById(A).adapter.updateFilterMainEnable(t)}function updateFilterMainEnableRedo(e,{selfId:A,newValue:t}){e.$queryById(A).adapter.updateFilterMainEnable(t)}function updateFilterEnabledUndo(e,{selfId:A,filterName:t,oldEnabled:i,oldMainEnabled:s}){const n=e.$queryById(A).adapter,r=n.$data.filterWork.getFilterItemByName(t);n.updateFilterEnabled(r,i),s!==n.$data.filterWork.getMainEnabled()&&n.updateFilterMainEnable(s)}function updateFilterEnabledRedo(e,{selfId:A,filterName:t,newEnabled:i}){const s=e.$queryById(A).adapter,n=s.$data.filterWork.getFilterItemByName(t);s.updateFilterEnabled(n,i)}function updateFilterNameUndo(e,{oldName:A,newName:t}){const i=e.$dataManager.filterManager;i.updateName(i.getFilterByName(t),A)}function updateFilterNameRedo(e,{oldName:A,newName:t}){const i=e.$dataManager.filterManager;i.updateName(i.getFilterByName(A),t)}function updateFilterDataUndo(e,{name:A,oldValue:t}){const i=e.$dataManager.filterManager;i.updateData(i.getFilterByName(A),t.code,t.callbackArgs)}function updateFilterDataRedo(e,{name:A,newValue:t}){const i=e.$dataManager.filterManager;i.updateName(i.getFilterByName(A),t.code,t.callbackArgs)}function addFilterUndo(e,{oldOptions:A}){const t=e.$dataManager.filterManager;t.remove(t.getFilterByName(A.name))}function addFilterRedo(e,{selfId:A,oldOptions:t}){e.$queryById(A).adapter.addFilter(deepClone(t))}function removeFilterUndo(e,{filterOptions:A,index:t,useList:i}){const s=e.$dataManager.filterManager.add(deepClone(A),t);i.forEach((A=>{e.$queryById(A.compId).adapter.$data.filterWork.addUse(s,A.enabled,A.index)}))}function removeFilterRedo(e,{filterOptions:A}){const t=e.$dataManager.filterManager;t.remove(t.getFilterByName(A.name))}function useFilterUndo(e,{selfId:A,name:t,mainEnabled:i}){const s=e.$queryById(A);i!==s.adapter.$data.filterWork.getMainEnabled()&&s.adapter.updateFilterMainEnable(i),s.adapter.unUseFilter(e.$dataManager.filterManager.getFilterByName(t))}function useFilterRedo(e,A){commonExtract(e,A)}function unUseFilterUndo(e,A){commonExtract(e,A)}function unUseFilterRedo(e,{selfId:A,name:t}){e.$queryById(A).adapter.unUseFilter(e.$dataManager.filterManager.getFilterByName(t))}function moveFilterUndo(e,{selfId:A,name:t,oldValue:i}){const s=e.$queryById(A).adapter,n=e.$dataManager.filterManager,r=n.getFilterByName(t),o=n.getFilterByName(i.targetName);s.moveFilter(s.$data.filterWork.getFilterItem(r),s.$data.filterWork.getFilterItem(o),i.type)}function moveFilterRedo(e,{selfId:A,name:t,newValue:i}){const s=e.$queryById(A).adapter,n=e.$dataManager.filterManager,r=n.getFilterByName(t),o=n.getFilterByName(i.targetName);s.moveFilter(s.$data.filterWork.getFilterItem(r),s.$data.filterWork.getFilterItem(o),i.type)}class CommandConchAdapter extends ConchAdapter{_updateAttr(e,A,t){return updateAttr(this,super._updateAttr.bind(this),e,A,t)}updateDataField(e,A){const t=this,i=super.updateDataField.bind(this);return this.$root.$command.add({name:"更新字段映射",type:"fn",args:{value:[e,A]},exec(){const s=deepClone(t.$data.fieldMapping.get(e)?.field.value);return{result:i(e,A),params:{selfId:t.$parent.id,oldName:e,oldValue:s,newValue:deepClone(A)}}},undo:updateDataFieldUndo,redo:updateDataFieldRedo})}updateDataClose(e){const A=this,t=super.updateDataClose.bind(this);return this.$root.$command.add({name:"更新数据定时器开关",type:"fn",args:{value:[e]},exec(){const i=deepClone(A.$data.timerItem.get().close);return{result:t(e),params:{selfId:A.$parent.id,oldValue:i,newValue:deepClone(e)}}},undo:updateDataCloseUndo,redo:updateDataCloseRedo})}updateDataTime(e){const A=this,t=super.updateDataTime.bind(this);return this.$root.$command.add({name:"更新数据定时器时间",type:"fn",args:{value:[e]},exec(){const i=deepClone(A.$data.timerItem.get().time);return{result:t(e),params:{selfId:A.$parent.id,oldValue:i,newValue:deepClone(e)}}},undo:updateDataTimeUndo,redo:updateDataTimeRedo})}updateSourceData(e,A){const t=this,i=super.updateSourceData.bind(this);return this.$root.$command.add({name:"更新源数据",type:"fn",args:{value:[e,deepClone(A)]},exec(){const s=t.$data.dataSource.dataType,n=deepClone(t.$data.dataSource.get(s));return{result:i(e,A),params:{selfId:t.$parent.id,oldType:s,oldData:n,newType:e,newData:deepClone(A)}}},undo:updateSourceDataUndo,redo:updateSourceDataRedo})}updateFilterMainEnable(e){const A=this,t=super.updateFilterMainEnable.bind(this);return this.$root.$command.add({name:"更新过滤器总开关",type:"fn",args:{value:[e]},exec(){const i=A.$data.filterWork.getMainEnabled();return{result:t(e),params:{selfId:A.$parent.id,oldValue:i,newValue:e}}},undo:updateFilterMainEnableUndo,redo:updateFilterMainEnableRedo})}updateFilterEnabled(e,A){const t=this,i=super.updateFilterEnabled.bind(this);return this.$root.$command.add({name:"更新过滤器状态",type:"fn",args:{value:[e.filter.name,A],handler:function(e,A,t){const[i,s]=t;return[A.adapter.$data.filterWork.getFilterItemByName(i),s]}},exec(){const s=deepClone(e.filter.enabled),n=t.$data.filterWork.getMainEnabled();return{result:i(e,A),params:{selfId:t.$parent.id,filterName:e.filter.name,oldEnabled:s,oldMainEnabled:n,newEnabled:deepClone(A)}}},undo:updateFilterEnabledUndo,redo:updateFilterEnabledRedo})}updateFilterName(e,A){const t=super.updateFilterName.bind(this);return this.$root.$command.add({name:"更新过滤器名称",type:"fn",args:{value:[e.name,A],handler:function(e,A,t){const[i,s]=t;return[e.$dataManager.filterManager.getFilterByName(i),s]}},exec(){const i=e.filter.name;return{result:t(e,A),params:{oldName:i,newName:A}}},undo:updateFilterNameUndo,redo:updateFilterNameRedo})}updateFilterData(e,A,t){const i=super.updateFilterData.bind(this);return this.$root.$command.add({name:"更新过滤器数据",type:"fn",args:{value:[e.name,A,deepClone(t)],handler:function(e,A,t){const[i,s,n]=t;return[e.$dataManager.filterManager.getFilterByName(i),s,n]}},exec(){const s={code:e.filter.code,callbackArgs:deepClone(e.filter.callbackArgs)};return{result:i(e,A,t),params:{name:e.filter.name,oldValue:s,newValue:{code:A,callbackArgs:deepClone(t)}}}},undo:updateFilterDataUndo,redo:updateFilterDataRedo})}addFilter(e){const A=this,t=super.addFilter.bind(this);return this.$root.$command.add({name:"添加过滤器",type:"fn",args:{value:[deepClone(e)]},exec:()=>({result:t(e),params:{selfId:A.$parent.id,oldOptions:deepClone(e)}}),undo:addFilterUndo,redo:addFilterRedo})}removeFilter(e){const A=this,t=super.removeFilter.bind(this);return this.$root.$command.add({name:"删除过滤器",type:"fn",args:{value:[e.name],handler:function(e,A,t){const[i]=t;return[e.$dataManager.filterManager.getFilterByName(i)]}},exec(){const i={name:e.name,code:e.code,callbackArgs:deepClone(e.callbackArgs)},s=A.$data.dataManager.filterManager.getFilterIndex(e),n=e.list.map((A=>({compId:A.parent.parent.$parent.id,enabled:A.enabled,index:A.getFilterItemIndex(e)})));return{result:t(e),params:{filterOptions:i,index:s,useList:n}}},undo:removeFilterUndo,redo:removeFilterRedo})}useFilter(e,A){const t=this,i=super.useFilter.bind(this);return this.$root.$command.add({name:"使用过滤器",type:"fn",args:{value:[e.name,A],handler:function(e,A,t){const[i,s]=t;return[e.$dataManager.filterManager.getFilterByName(i),s]}},exec(){const s=t.$data.filterWork.getMainEnabled();return{result:i(e,A),params:{selfId:t.$parent.id,name:e.name,mainEnabled:s,enabled:A}}},undo:useFilterUndo,redo:useFilterRedo})}unUseFilter(e){const A=this,t=super.unUseFilter.bind(this);return this.$root.$command.add({name:"移除使用过滤器",type:"fn",args:{value:[e.name],handler:function(e,A,t){const[i]=t;return[e.$dataManager.filterManager.getFilterByName(i)]}},exec(){const i=A.$data.filterWork.getFilterItem(e).enabled;return{result:t(e),params:{selfId:A.$parent.id,name:e.name,enabled:i}}},undo:unUseFilterUndo,redo:unUseFilterRedo})}moveFilter(e,A,t){const i=this,s=super.moveFilter.bind(this);return this.$root.$command.add({name:"移动过滤器",type:"fn",args:{value:[e.filter.name,A.filter.name,t],handler:function(e,A,t){const[i,s,n]=t,r=A.adapter.$data.filterWork;return[r.getFilterItemByName(i),r.getFilterItemByName(s),n]}},exec(){const n=i.$data.filterWork,r=n.getFilterItemIndex(e);let o,a;r?(o="after",a=n.filterList[r-1]):(o="before",a=n.filterList[r+1]);const l={targetName:a.filter.name,type:o};return{result:s(e,A,t),params:{selfId:i.$parent.id,name:e.filter.name,oldValue:l,newValue:{targetName:A.filter.name,type:t}}}},undo:moveFilterUndo,redo:moveFilterRedo})}}function commonExtract(e,{selfId:A,name:t,enabled:i}){e.$queryById(A).adapter.useFilter(e.$dataManager.filterManager.getFilterByName(t),i)}class CommandLowCodeAdapter extends LowCodeAdapter{_updateAttr(e,A,t){return updateAttr(this,super._updateAttr.bind(this),e,A,t)}}class CommandMapAdapter extends MapAdapter{_updateAttr(e,A,t){return updateAttr(this,super._updateAttr.bind(this),e,A,t)}}class CommandTopologyAdapter extends TopologyAdapter{_updateAttr(e,A,t){return updateAttr(this,super._updateAttr.bind(this),e,A,t)}}class CommandUdatavAdapter extends UdatavAdapter$1{_updateAttr(e,A,t){return updateAttr(this,super._updateAttr.bind(this),e,A,t)}}function getModules(e=!1){return e?{elements:{Ui:CommandUi,Canvas:CommandCanvas,ThingJSLayer:CommandThingJSLayer,Layer:CommandLayer,Group:CommandGroup,Container:CommandContainer,DefaultContainer:CommandContainer},adapters:{CampusAdapter:CommandCampusAdapter,LowCodeAdapter:CommandLowCodeAdapter,MapAdapter:CommandMapAdapter,TopologyAdapter:CommandTopologyAdapter,UdatavAdapter:CommandUdatavAdapter,ConchAdapter:CommandConchAdapter}}:{elements:{Ui:Ui,Canvas:Canvas,ThingJSLayer:ThingJSLayer,Layer:Layer$1,Group:Group,Container:Container,DefaultContainer:Container},adapters:{CampusAdapter:CampusAdapter,LowCodeAdapter:LowCodeAdapter,MapAdapter:MapAdapter,TopologyAdapter:TopologyAdapter,UdatavAdapter:UdatavAdapter$1,ConchAdapter:ConchAdapter}}}class Diagram{static getUid(e){return e.toLowerCase()+"-"+window.Math.random().toString(24).slice(-10)}constructor(e={}){this.dom=null,this.config=e,this.module=new Module(this),this.manager=new Manager$1(this),this.adapterManager=new AdapterManager(this),this.isEdit="edit"===e.mode,this.canShortcutKey=!0,this.module.init(getModules(this.isEdit)),this.ui=this.manager.create("Ui"),this.state={initComplete:null,complete:null,canvasComplete:null,offline:!1,undo:null,redo:null,select:{layer:null,isSingle:null,isSingleHasAdapter:null,isSingleCanvas:null,isSingleGroup:null,isSingleContainer:null,isSingleTwin:null,isSingleTwinTopology:null,isMultiple:null,hasTwinContainer:null,hasEmptyContainer:null,hasDataContainer:null,single:null,twinContainer:null,comps:[]},canvasZoom:1,enableCanvasZoom:!0,textEditing:!1,contextMenuRunning:!0},this.status=null,UI.adapterManager.register("UdatavAdapter",UdatavAdapter)}async init(e){return this.status?console.warn("已经初始化过了"):(this.status=!0,this.state.canvasComplete=!1,this.state.initComplete=!1,this.$emit("initComplete",this),this.dom=e,this._initEvent(),await this.ui.init(this,{type:"Ui",option:this.config.uiOption},this.config.uiConfig,this.config),this.state.initComplete=!0,this.state.canvasComplete=!0,this.$emit("initCompleted",this)),this}_initEvent(){const e=()=>{this.state.undo=this.ui.$command.canUndo(),this.state.redo=this.ui.$command.canRedo()};this.$on("commandAdd",e),this.$on("commandUndo",e),this.$on("commandRedo",e),this.$on("commandClear",e),this.$on("CommandBeforeExec",e),this.$on("CommandExec",e),this.$on("hook:selectLayer",(e=>{this.state.select.layer=e})),this.$on("hook:unSelectLayer",(e=>{this.state.select.layer===e&&(this.state.select.layer=null),this.state.select.layer=e})),this.$on("updateSelectComponent",(e=>{const A=1===e.length,t=A?e[0]:null;this.state.select.isSingle=A,this.state.select.isSingleHasAdapter=!!t?.adapter,this.state.select.isSingleCanvas=t&&"Canvas"===t.type,this.state.select.isSingleGroup=t&&"Group"===t.type,this.state.select.isSingleContainer=t&&"Container"===t.type,this.state.select.isSingleTwin=!!t?.adapter?.isThing,this.state.select.isSingleTwinTopology=!!t?.adapter?.isTopology,this.state.select.isMultiple=!A,this.state.select.hasTwinContainer=!!e.find((e=>e?.$twinContainers?.length||e?.adapter?.isThing)),this.state.select.hasEmptyContainer=!!e.find((e=>!e.adapter)),this.state.select.hasDataContainer=!!e.find((e=>e.adapter?.$dataAdapter)),this.state.select.single=t,this.state.select.comps=e})),this.$on("updateCanvasZoom",(e=>{this.state.canvasZoom=e})),this.$on("mounted:Canvas",(()=>{this.state.canvasComplete=!0})),this.$on("beforeDestroy:Canvas",(()=>{this.state.canvasComplete=!1})),this.$on("createdTwin",(e=>{if(!e.isTopology){const A=e.$uiComp.id,t=this.ui.queryById(A);this.state.select.twinContainer=t}})),this.$on("destroyedTwin",(e=>{e.isTopology||(this.state.select.twinContainer=null)}))}startShortcutKey(){this.canShortcutKey=!0}stopShortcutKey(){this.canShortcutKey=!1}$on(e,A,t){return this.ui.$on(e,A,t)}$once(e,A,t){return this.ui.$once(e,A,t)}$off(e,A,t){return this.ui.$off(e,A,t)}$emit(e,...A){return this.ui.$emit(e,...A)}get canvas(){return this.ui?.$canvas}get currentLayer(){return this.canvas?.$currentLayer}get selectComponent(){return this.ui?.$selectComponent||[]}}var name="kunpeng",version="2.10.23",description="",main="index.js",scripts={dev:"node build/dev.js",start:"node build/dev.js","start:dev":"node build/dev.js dev","start:release":"node build/dev.js release","start:prod":"node build/dev.js prod",build:"node build/build.js","build:dev":"node build/build.js dev","build:release":"node build/build.js release","build:prod":"node build/build.js prod","offline:dev":"node build/build.js dev offline","offline:release":"node build/build.js release offline","offline:prod":"node build/build.js prod offline","private:dev":"node build/build.js dev private","private:release":"node build/build.js release private","private:prod":"node build/build.js prod private","build:offline":"node build/build.js prod offline","build:show":"node build/build.js prod show",release:"release-it --no-npm.publish","start:sdk":"rollup -c -w --environment NODE_ENV:development","build:sdk":"rollup -c --environment NODE_ENV:production","visualizer:sdk":"rollup -c --environment NODE_ENV:production,VISUALIZER",unit:"jest --config test/unit/jest.conf.js --coverage",e2e:"node test/e2e/runner.js",test:"npm run unit && npm run e2e",lint:"eslint --ext .js,.vue",dll:"webpack --config ./build/webpack.dll.conf.js",postinstall:"patch-package"},repository={type:"git",url:"git@git.uino.com:hundun/kunpeng.git"},keywords=[],author="",license="ISC",devDependencies={"@babel/core":"^7.16.5","@babel/eslint-parser":"^7.16.5","@babel/generator":"^7.21.4","@babel/parser":"^7.21.4","@babel/preset-env":"^7.16.5","@babel/traverse":"^7.21.4","@release-it/conventional-changelog":"^3.3.0","@rollup/plugin-alias":"^4.0.3","@rollup/plugin-commonjs":"^24.0.1","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.0.1","@rollup/plugin-terser":"^0.4.0","babel-jest":"^27.4.5","babel-loader":"^8.2.3","babel-plugin-import":"^1.13.3","babel-plugin-lodash":"^3.3.4","babel-plugin-syntax-jsx":"^6.18.0","babel-plugin-transform-vue-jsx":"^3.7.0","babel-register":"^6.26.0",chalk:"2.4.2","compression-webpack-plugin":"^9.2.0","copy-webpack-plugin":"^10.2.0","core-js":"^3.20.0","css-loader":"^6.5.1",eslint:"^8.5.0","eslint-config-prettier":"^8.3.0","eslint-config-standard":"^16.0.3","eslint-friendly-formatter":"^4.0.1","eslint-plugin-import":"^2.25.3","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.0.0","eslint-plugin-promise":"^6.0.0","eslint-plugin-standard":"^5.0.0","eslint-plugin-vue":"^8.2.0","eslint-webpack-plugin":"^3.1.1","file-loader":"^6.2.0","friendly-errors-webpack-plugin":"^1.7.0","html-webpack-plugin":"^5.5.0",jest:"^27.4.5","jest-serializer-vue":"^2.0.2",less:"^4.1.3","less-loader":"^11.0.0","mini-css-extract-plugin":"^2.4.5","monaco-editor-webpack-plugin":"^4.1.2","node-notifier":"^10.0.0","optimize-css-assets-webpack-plugin":"^6.0.1",ora:"3.4.0","patch-package":"^6.4.7",portfinder:"^1.0.28",prettier:"^2.5.1","release-it":"^14.11.8",rimraf:"^3.0.2",rollup:"^2.79.1","rollup-plugin-polyfill-node":"^0.12.0","rollup-plugin-visualizer":"^5.9.0",semver:"^7.3.5",shelljs:"^0.8.4",stylus:"^0.56.0","stylus-loader":"^6.2.0","url-loader":"^4.1.1","vue-jest":"^3.0.7","vue-loader":"14","vue-style-loader":"^4.1.3","vue-template-compiler":"2.6.14",webpack:"^5.65.0","webpack-bundle-analyzer":"^4.5.0","webpack-cli":"^4.9.1","webpack-dev-server":"^4.6.0","webpack-merge":"^5.8.0"},dependencies={"@uino/thing-blueprint-editor":"^0.32.0","@uino/thing-ui-canvas":"^0.1.110","@uino/thing-ui-property-panel":"^0.4.89","@uino/thing.ui.components":"^0.1.86","alife-logger":"^1.8.30","ant-design-vue":"^1.7.8",axios:"^0.24.0","crypto-js":"^4.1.1",lodash:"^4.17.21","monaco-editor":"^0.27.0","opentype.js":"^1.3.4",vue:"2.6.14","vue-router":"^3.5.3",vuex:"^3.6.2","x-data-spreadsheet":"^1.1.9"},engines={node:">= 8.0.0",npm:">= 3.0.0"},browserslist=["> 1%","last 2 versions","not ie <= 8"],pak={name:name,version:version,description:description,main:main,private:!0,scripts:scripts,repository:repository,keywords:keywords,author:author,license:license,devDependencies:devDependencies,dependencies:dependencies,engines:engines,browserslist:browserslist};function getDiagramOptions(e={}){const A=e.ThingBlueprintEditor||window.ThingBlueprintEditor,t=A?.default;const i=e?.dataSource;return{uiOption:{id:Diagram.getUid("Canvas"),style:defaultUiOptions.style},uiConfig:getUiConfig(1),ThingBlueprintEditor:e.ThingBlueprintEditor||window.ThingBlueprintEditor,Blueprint:t,BlueprintModules:A,twin:{disable:e.hide3D,configFormatter:function(A,t){const i=e.offline;switch(t.$type){case"CampusAdapter":i&&(A.urlV1=`/campus/${t.thingOpts.code}`);break;case"LowCodeAdapter":i&&(A.url=`/lowCode/${t.thingOpts.name}.js`);break;case"MapAdapter":A.offline=i;break;case"TopologyAdapter":i&&(A.url=`/topo/${t.thingOpts.resourceId}/diagram.json`,A.isOffline=!0)}return A},thingJsAuthServerUrl:"http://47.94.3.222:2044/spray/processrequest1"},prefix:"https://charts.thingjs.com",data:{disable:i?.disable,websocketUrl:i?.http?.server||"wss://charts.thingjs.com/spray/websocket",restApiTimeout:6e4,restApiMaxQueue:5}}}function isStaticPrefix(e){return/^\/s-static/.test(e)||/^url\(\/s-static/.test(e)}function replacePath(e,A){const{prefix:t,offline:i}=A;return e.replace("/s-static",""+(t+(i?"":"/s-static")))}function transfromImg(e,A){const{prefix:t}=A;Object.entries(e).forEach((([i,s])=>{isType$2(s,"String")&&isStaticPrefix(s)&&(e[i]=replacePath(s,A)),"series"===i&&Array.isArray(s)&&s.forEach((e=>{e.symbol&&(e.symbol=e.symbol.replace("image://",t))})),isType$2(s,"Array")&&s.forEach((e=>transfromImg(e,A))),isType$2(s,"Object")&&transfromImg(s,A)}))}function eachChildren(e,A){Array.isArray(e)&&e.forEach((e=>{A(e),eachChildren(e.children,A)}))}function transformDef(e,A={}){const t=deepClone(e),{userData:i,scene:s}=t,{prefix:n,offline:r}=A;Object.values(i).forEach((e=>{e.option?.prefix&&(e.option.prefix=r?`${n}`:n+"/s-static"),e.opts&&transfromImg(e.opts,A),e.theme&&transfromImg(e.theme,A),e.events&&transfromImg(e.events,A)})),eachChildren(s.children,(e=>{const t=e.option?.style?.backgroundImage;isType$2(t,"String")&&isStaticPrefix(t)&&(e.option.style.backgroundImage=replacePath(t,A))}));const o=s.option.style.backgroundImage||s.option.style.background;return o&&(s.option.style.backgroundImage=replacePath(o,A)),t}function requestApi(e){return fetch(e).then((e=>200!==e.status?console.warn("接口返回异常"):e.text()))}UI.use(filterModule),UI.use(bluePrintNodeModule),UI.use(sprayToUIModule),UI.use(KeyMapMoudle),UI.use(templateParser),UI.use(snapshotModule);const request=(e,A)=>fetch(e,{method:A}).then((e=>e.text())).then((e=>{try{return JSON.parse(e)}catch(e){console.warn("解析失败",e)}}));class PreviewThingJSUI{constructor(e){this.options=e,this.wrapper=null,this.init()}async init(){this.promise=new Promise((e=>{this.resolve=e}));const e=this.options,{baseUrl:A,offline:t}=e,i=A||"https://charts.thingjs.com";let s=e.container||e.el;if(isType$2(s,"String")&&s.includes("#")&&(s=document.getElementById(s.replace("#",""))),!(s&&s instanceof HTMLElement))return console.warn("需要有效节点");this.wrapper=document.createElement("div"),this.wrapper.style="display: none; width: 100%; height: 100%;pointer-events: none;position: relative;",s.appendChild(this.wrapper);const n={...e,prefix:i,container:this.wrapper};if(window.conch&&(window.conch.__globalVar.printLog=!1,window.conch.errorHandler=function(e,A){console.warn(`${e.parent.name}(${e.parent.id})执行错误`,A)}),!t){const A=await this._getInfoByConfig(i,e);return A&&this.createInstance(A,n)}const r=await request(`${i}/bundle.json`);if(!r)return console.warn("该路径下bundle文件不存在");const{main:o,type:a}=r;if("chart"===a&&await this.loadCompBundle(r,n),"dashboard"===a){n.prefix=`${i}/web`;const e=await request(`${i}/web/scene-data/${o}`);await this.createInstance(e,n)}}async _getInfoByConfig(e,A){const t=`${e}/spray/scene/scene/config`,i={method:"POST",body:A.id,headers:{"Content-Type":"text/plain"}},s=await fetch(t,i).then((e=>e.json()));return 200!==s?.code?console.warn("接口返回异常",s?.message):s.data?{config:s.data,code:await requestApi(`${e}/s-static/scene/${A.id}.js`),def:await requestApi(`${e}/s-static/scene-def/${A.id}.def`),bluePrint:window.ThingBlueprintEditor&&await requestApi(`${e}/s-static/blue-print/${A.id}.json`)}:null}async createInstance(e={},A={}){const t=A.container,i=new Diagram(getDiagramOptions(A));let s;if(await i.init(t),window.ui=i.ui.$ui,await this._loadResources(e,A),e.def)try{s=JSON.parse(e.def)}catch(e){console.error("解析定义文件失败",e)}s&&await this._parseJSON(i,{def:s,scene:e,config:A})}mountedLayer(e){!e.visible&&e.isSelected&&e.show()}mountedContainer(e){e.adapter.isThing&&this.options.hide3D&&e.hidden()}async _parseJSON(e,{def:A,scene:t,config:i}){e.ui.$on("mounted:Layer",this.mountedLayer,this),e.ui.$on("mounted:Container",this.mountedContainer,this);const s=transformDef(e.ui.transformDef(A),i);await e.ui.parseJSON(s,{jsCode:t.jsCode,bluePrint:t.bluePrint}),this.wrapper.style.display="block",i.hideCanvasBackground&&(e.canvas.backgroundColor="transparent",e.canvas.backgroundImage="");const n=e.ui.$canvas.layers.filter((e=>!e.isThingLayer));n.some((e=>e.visible))||n[0].show(),e.ui.$canvas.containers.forEach((e=>{e?.adapter?.$dataAdapter&&e.hidden()})),e.ui.$ui.containers.forEach((e=>e.adapterResize())),e.ui.$ui.play((e=>{e()})),this.resolve&&this.resolve(e.ui.$ui),i.complete&&i.complete(e.ui.$ui)}async _loadResources(e,A){if(!e.config)return!1;let t=null;try{t=JSON.parse(e.config)}catch(e){console.error("资源解析失败",e)}if(t){const{offline:e}=this.options;await loadResources(t,{prefix:t=>A.prefix+(e?t.replace("/s-static",""):t)})}}async loadCompBundle(e,A){const{main:t,id:i}=e,{prefix:s}=A;await loadScript(t,`${s}/${t}`);const n=new window.conch[`C${i}`](A.container,{prefix:s},window.Vue);await n.render(),this.resolve&&this.resolve(n)}waitForComplete(){return this.promise}}window.THING||(window.THING={}),window.THING.CHARTS||(window.THING.CHARTS=PreviewThingJSUI,window.THING.CHARTS.version=pak.version),window.THING.CHARTS.Utils||(window.THING.CHARTS.Utils={}),window.THING.CHARTS.Utils.loadBundle=function(e,A={}){return new PreviewThingJSUI({...A,baseUrl:e,offline:!0})}}));
