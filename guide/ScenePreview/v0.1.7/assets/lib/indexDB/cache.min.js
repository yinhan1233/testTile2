!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}({"./libs/localStorageDB.js":
/*!********************************!*\
  !*** ./libs/localStorageDB.js ***!
  \********************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){!function(){var t=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;if(t){var e,n={k:"",v:""},r=t.open("thingjs",1);r.onsuccess=function(t){e=this.result},r.onerror=function(t){console.error("indexedDB request error"),console.log(t)},r.onupgradeneeded=function(t){e=null,t.target.result.createObjectStore("cached",{keyPath:"k"}).transaction.oncomplete=function(t){e=t.target.db}},window.ldb={get:function t(n,r){e?e.transaction("cached").objectStore("cached").get(n).onsuccess=function(t){var e=t.target.result&&t.target.result.v||null;r(e)}:setTimeout((function(){t(n,r)}),100)},set:function(t,r){n.k=t,n.v=r,e.transaction("cached","readwrite").objectStore("cached").put(n)},del:function(t){e.transaction("cached","readwrite").objectStore("cached").delete(t)},clear:function(){e.transaction("cached","readwrite").objectStore("cached").clear()}}}else console.error("indexDB not supported")}()},"./src/main.js":
/*!*********************************!*\
  !*** ./src/main.js + 4 modules ***!
  \*********************************/
/*! exports provided: CachedDownloader */
/*! all exports used */function(t,e,n){"use strict";n.r(e),n.d(e,"CachedDownloader",(function(){return r})),n(/*! ../../libs/localStorageDB.js */"./libs/localStorageDB.js");class r{constructor(){return this._lib=null,this._initializing=!1,this._onRequest=null,this}init(){if(!this._initializing){this._initializing=!0;var t=window.ldb;this._lib={setItem:function(e,n){t.set(e,n)},getItem:function(e,n){t.get(e,t=>{n(0,t)})},delItem:function(e){t.del(e)},clear:function(){t.clear()}}}}setItem(t,e){this._lib&&this._lib.set(t,e)}getItem(t,e){this._lib&&this._lib.get(t,t=>{e(0,t)})}delItem(t){this._lib&&this._lib.del(t)}clear(){this._lib&&this._lib.clear()}get onRequest(){return this._onRequest}set onRequest(t){this._onRequest=t}}r.getInstance=function(){return r.instance=r.instance||new r,r.instance.init(),r.instance},r.getStorage=function(t){var e=r.getInstance();if(t){var n=e.onRequest;if(!n||!n(t))return null}return e._lib};var i=XMLHttpRequest.prototype.open,o=function(t,e){var n=r.getStorage(t);n&&n.setItem(t,e)},s=function(t,e,n){for(var r in i.apply(e,n),e.addEventListener=e._addEventListener,e._callbacks)e._callbacks[r].forEach(t=>{e.addEventListener(r,t)});e.addEventListener("load",(function(e){var n=this.response;n&&(200!==this.status&&0!==this.status||o(t,n))})),e.send=e._send,e.send(),delete e._addEventListener,delete e._send};class a{constructor(t){var e=this,n=t.onSetProperty,r=t.onGetProperty;return this.handler={set:function(t,r,i){if("src"===r){var o=e.proxy.onloadstart;o&&o(t,i);var s=e.proxy.onloadend;if(s){var a=function(){s(t),t.removeEventListener("load",a)},c=function(){s(t),t.removeEventListener("error",c)};t.addEventListener("load",a,!1),t.addEventListener("error",c,!1)}}if(n){var u=n(r,i);if(void 0!==u)return u}return t[r]=i},get:function(t,e){if("addEventListener"==e||"removeEventListener"==e)return function(){t[e](arguments[0],arguments[1],arguments[2])};if(r){var n=r(e);if(void 0!==n)return n}return"owner"==e?t:t[e]}},this.image=t.image,this.proxy=new Proxy(this.image,this.handler),this.proxy}}var c=document.createElement("canvas"),u=c.getContext("2d");var l,d=function(t,e){var n=r.getStorage();n&&(c.width=e.naturalWidth,c.height=e.naturalHeight,u.drawImage(function(t){var e=t.owner;return e||t}(e),0,0),c.toBlob((function(e){n.setItem(t,e)})))},f=function(t,e){var n;return(n=new a({image:e,onSetProperty:function(r,i){if(!e._done_&&!e._skip_set_property_&&"src"==r){var o=i;return t.getItem(o,(function(t,r){var i,s,a;t?(e._done_=!0,n.src=o):r?(e._done_=!0,i=r,s=function(t){n.src=t},(a=new FileReader).onload=function(t){s(t.target.result)},a.readAsDataURL(i)):(e._skip_set_property_=!0,n.src=o)})),i}},onGetProperty:function(t){if("src"==t)return e._url}})).onloadstart=function(t,e){t._url=e},n.onloadend=function(t){t._done_||d(t._url,t)},n};XMLHttpRequest.prototype.open=function(){var t=arguments,e=arguments[1],n=r.getStorage(e);n?(this._addEventListener=this.addEventListener,this.addEventListener=function(t,e){this._callbacks=this._callbacks||{},this._callbacks[t]=this._callbacks[t]||[],this._callbacks[t].push(e)},this._send=this.send,this.send=function(){n.getItem(e,(n,r)=>{if(n)s(e,this,t);else if(r){var i=this._callbacks;if(i){var o=i.load;o&&o.forEach(t=>{t.call({response:r,status:200})})}}else s(e,this,t)})}):(i.apply(this,arguments),this.addEventListener("load",(function(t){var n=this.response;200!==this.status&&0!==this.status||o(e,n)})))},l=document.createElementNS,document.createElementNS=function(){var t=l.apply(this,arguments),e=r.getStorage();if(e){if("http://www.w3.org/1999/xhtml"==arguments[0]&&"img"==arguments[1])return f(e,t)}else t.addEventListener("load",(function(){var e=t.src;d(e,t)}));return t}},0:
/*!***************************!*\
  !*** multi ./src/main.js ***!
  \***************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports=n(/*! ./src/main.js */"./src/main.js")}})}));